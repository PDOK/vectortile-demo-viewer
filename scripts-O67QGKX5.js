(self.webpackChunkview_component=self.webpackChunkview_component||[]).push([[792],{319:(qe,Fn,ke)=>{"use strict";let Tt=null,Z=1;function Et(n){const t=Tt;return Tt=n,t}function Ot(n){if((!pe(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Z)){if(!n.producerMustRecompute(n)&&!It(n))return n.dirty=!1,void(n.lastCleanEpoch=Z);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Z}}function It(n){he(n);for(let t=0;t<n.producerNode.length;t++){const e=n.producerNode[t],i=n.producerLastReadVersion[t];if(i!==e.version||(Ot(e),i!==e.version))return!0}return!1}function dt(n,t){if(function(s){s.liveConsumerNode??=[],s.liveConsumerIndexOfThis??=[]}(n),he(n),n.liveConsumerNode.length===1)for(let i=0;i<n.producerNode.length;i++)dt(n.producerNode[i],n.producerIndexOfThis[i]);const e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[t],s=n.liveConsumerNode[t];he(s),s.producerIndexOfThis[i]=t}}function pe(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function he(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Pe=null;function rt(n){return typeof n=="function"}function xe(n){const t=n(e=>{Error.call(e),e.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Ae=xe(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((e,i)=>`${i+1}) ${e.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function _e(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class be{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const r of e)r.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(rt(i))try{i()}catch(r){t=r instanceof Ae?r.errors:[r]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const r of s)try{U(r)}catch(o){t=t??[],o instanceof Ae?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Ae(t)}}add(t){var e;if(t&&t!==this)if(this.closed)U(t);else{if(t instanceof be){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&_e(e,t)}remove(t){const{_finalizers:e}=this;e&&_e(e,t),t instanceof be&&t._removeParent(this)}}be.EMPTY=(()=>{const n=new be;return n.closed=!0,n})();const A=be.EMPTY;function j(n){return n instanceof be||n&&"closed"in n&&rt(n.remove)&&rt(n.add)&&rt(n.unsubscribe)}function U(n){rt(n)?n():n.unsubscribe()}const et={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},nt={setTimeout(n,t,...e){const{delegate:i}=nt;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=nt;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function C(n){nt.setTimeout(()=>{const{onUnhandledError:t}=et;if(!t)throw n;t(n)})}function T(){}const z=it("C",void 0,void 0);function it(n,t,e){return{kind:n,value:t,error:e}}let Q=null;function vt(n){if(et.useDeprecatedSynchronousErrorHandling){const t=!Q;if(t&&(Q={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=Q;if(Q=null,e)throw i}}else n()}class lt extends be{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,j(t)&&t.add(this)):this.destination=Me}static create(t,e,i){return new Ee(t,e,i)}next(t){this.isStopped?Yt(function(i){return it("N",i,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Yt(function(i){return it("E",void 0,i)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Yt(z,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const X=Function.prototype.bind;function yt(n,t){return X.call(n,t)}class ft{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){Ce(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){Ce(i)}else Ce(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Ce(e)}}}class Ee extends lt{constructor(t,e,i){let s;if(super(),rt(t)||!t)s={next:t??void 0,error:e??void 0,complete:i??void 0};else{let r;this&&et.useDeprecatedNextContext?(r=Object.create(t),r.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&yt(t.next,r),error:t.error&&yt(t.error,r),complete:t.complete&&yt(t.complete,r)}):s=t}this.destination=new ft(s)}}function Ce(n){et.useDeprecatedSynchronousErrorHandling?function(e){et.useDeprecatedSynchronousErrorHandling&&Q&&(Q.errorThrown=!0,Q.error=e)}(n):C(n)}function Yt(n,t){const{onStoppedNotification:e}=et;e&&nt.setTimeout(()=>e(n,t))}const Me={closed:!0,next:T,error:function(t){throw t},complete:T},Bo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function cc(n){return n}let ei=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,s){const r=function(a){return a&&a instanceof lt||function(h){return h&&rt(h.next)&&rt(h.error)&&rt(h.complete)}(a)&&j(a)}(e)?e:new Ee(e,i,s);return vt(()=>{const{operator:o,source:a}=this;r.add(o?o.call(r,a):a?this._subscribe(r):this._trySubscribe(r))}),r}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Wg(i))((s,r)=>{const o=new Ee({next:a=>{try{e(a)}catch(l){r(l),o.unsubscribe()}},error:r,complete:s});this.subscribe(o)})}_subscribe(e){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(e)}[Bo](){return this}pipe(...e){return function(s){return s.length===0?cc:s.length===1?s[0]:function(r){return s.reduce((o,a)=>a(o),r)}}(e)(this)}toPromise(e){return new(e=Wg(e))((i,s)=>{let r;this.subscribe(o=>r=o,o=>s(o),()=>i(r))})}}return n.create=t=>new n(t),n})();function Wg(n){var t;return(t=n??et.Promise)!==null&&t!==void 0?t:Promise}const h2=xe(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Wo=(()=>{class n extends ei{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Ug(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new h2}next(e){vt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){vt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){vt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:s,observers:r}=this;return i||s?A:(this.currentObservers=null,r.push(e),new be(()=>{this.currentObservers=null,_e(r,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:s,isStopped:r}=this;i?e.error(s):r&&e.complete()}asObservable(){const e=new ei;return e.source=this,e}}return n.create=(t,e)=>new Ug(t,e),n})();class Ug extends Wo{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.next)===null||i===void 0||i.call(e,t)}error(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.error)===null||i===void 0||i.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,i;return(i=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&i!==void 0?i:A}}class Hg extends Wo{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function $i(n){return t=>{if(function(i){return rt(i?.lift)}(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ki(n,t,e,i,s){return new u2(n,t,e,i,s)}class u2 extends lt{constructor(t,e,i,s,r,o){super(t),this.onFinalize=r,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(l){t.error(l)}}:super._next,this._error=s?function(a){try{s(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}}function Ji(n,t){return $i((e,i)=>{let s=0;e.subscribe(Ki(i,r=>{i.next(n.call(t,r,s++))}))})}function fe(n){for(let t in n)if(n[t]===fe)return t;throw Error("Could not find renamed property on target object.")}function fi(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(fi).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(t==null)return""+t;const e=t.indexOf(`
`);return e===-1?t:t.substring(0,e)}function Xg(n,t){return n==null||n===""?t===null?"":t:t==null||t===""?n:n+" "+t}const c2=fe({__forward_ref__:fe});function Zg(n){return n.__forward_ref__=Zg,n.toString=function(){return fi(this())},n}function Qi(n){return function(e){return typeof e=="function"&&e.hasOwnProperty(c2)&&e.__forward_ref__===Zg}(n)?n():n}function Yg(n){return n&&!!n.\u0275providers}class Nt extends Error{constructor(t,e){super(function(s,r){return`NG0${Math.abs(s)}${r?": "+r:""}`}(t,e)),this.code=t}}const d2=fe({\u0275cmp:fe}),p2=fe({\u0275dir:fe}),f2=fe({\u0275pipe:fe}),g2=fe({\u0275mod:fe}),$g=fe({\u0275fac:fe}),Uo=fe({__NG_ELEMENT_ID__:fe}),Kg=fe({__NG_ENV_ID__:fe});function Jg(n){return typeof n=="string"?n:n==null?"":String(n)}function dc(n,t){throw new Nt(-201,!1)}function m2(n,t){n==null&&function(i,s,r,o){throw new Error(`ASSERTION ERROR: ${i}`+(o==null?"":` [Expected=> ${r} ${o} ${s} <=Actual]`))}(t,n,null,"!=")}function zt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function vr(n){return{providers:n.providers||[],imports:n.imports||[]}}function pc(n){return Qg(n,e0)||Qg(n,n0)}function Qg(n,t){return n.hasOwnProperty(t)?n[t]:null}function t0(n){return n&&(n.hasOwnProperty(i0)||n.hasOwnProperty(y2))?n[i0]:null}const e0=fe({\u0275prov:fe}),i0=fe({\u0275inj:fe}),n0=fe({ngInjectableDef:fe}),y2=fe({ngInjectorDef:fe});var Lt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Lt||{});let fc;function Ni(n){const t=fc;return fc=n,t}function s0(n,t,e){const i=pc(n);return i&&i.providedIn=="root"?i.value===void 0?i.value=i.factory():i.value:e&Lt.Optional?null:t!==void 0?t:void dc()}const oi=globalThis;class jt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=zt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Ho={},gc="__NG_DI_FLAG__",Sl="ngTempTokenPath",_2=/\n/gm,r0="__source";let Xo;function as(n){const t=Xo;return Xo=n,t}function v2(n,t=Lt.Default){if(Xo===void 0)throw new Nt(-203,!1);return Xo===null?s0(n,void 0,t):Xo.get(n,t&Lt.Optional?null:void 0,t)}function ot(n,t=Lt.Default){return(function(){return fc}()||v2)(Qi(n),t)}function Re(n,t=Lt.Default){return ot(n,El(t))}function El(n){return typeof n>"u"||typeof n=="number"?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function mc(n){const t=[];for(let e=0;e<n.length;e++){const i=Qi(n[e]);if(Array.isArray(i)){if(i.length===0)throw new Nt(900,!1);let s,r=Lt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=x2(a);typeof l=="number"?l===-1?s=a.token:r|=l:s=a}t.push(ot(s,r))}else t.push(ot(i))}return t}function o0(n,t){return n[gc]=t,n.prototype[gc]=t,n}function x2(n){return n[gc]}function Tl(n){return{toString:n}.toString()}var a0=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(a0||{}),On=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(On||{});const Zo={},tn=[];function l0(n,t,e){let i=n.length;for(;;){const s=n.indexOf(t,e);if(s===-1)return s;if(s===0||n.charCodeAt(s-1)<=32){const r=t.length;if(s+r===i||n.charCodeAt(s+r)<=32)return s}e=s+1}}function yc(n,t,e){let i=0;for(;i<e.length;){const s=e[i];if(typeof s=="number"){if(s!==0)break;i++;const r=e[i++],o=e[i++],a=e[i++];n.setAttribute(t,o,a,r)}else{const r=s,o=e[++i];w2(r)?n.setProperty(t,r,o):n.setAttribute(t,r,o),i++}}return i}function b2(n){return n===3||n===4||n===6}function w2(n){return n.charCodeAt(0)===64}function _c(n,t){if(t!==null&&t.length!==0)if(n===null||n.length===0)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const s=t[i];typeof s=="number"?e=s:e===0||C2(n,e,s,null,e===-1||e===2?t[++i]:null)}}return n}function C2(n,t,e,i,s){let r=0,o=n.length;if(t===-1)o=-1;else for(;r<n.length;){const a=n[r++];if(typeof a=="number"){if(a===t){o=-1;break}if(a>t){o=r-1;break}}}for(;r<n.length;){const a=n[r];if(typeof a=="number")break;if(a===e){if(i===null)return void(s!==null&&(n[r+1]=s));if(i===n[r+1])return void(n[r+2]=s)}r++,i!==null&&r++,s!==null&&r++}o!==-1&&(n.splice(o,0,t),r=o+1),n.splice(r++,0,e),i!==null&&n.splice(r++,0,i),s!==null&&n.splice(r++,0,s)}const h0="ng-template";function M2(n,t,e){let i=0,s=!0;for(;i<n.length;){let r=n[i++];if(typeof r=="string"&&s){const o=n[i++];if(e&&r==="class"&&l0(o.toLowerCase(),t,0)!==-1)return!0}else{if(r===1){for(;i<n.length&&typeof(r=n[i++])=="string";)if(r.toLowerCase()===t)return!0;return!1}typeof r=="number"&&(s=!1)}}return!1}function u0(n){return n.type===4&&n.value!==h0}function S2(n,t,e){return t===(n.type!==4||e?n.value:h0)}function E2(n,t,e){let i=4;const s=n.attrs||[],r=function(l){for(let h=0;h<l.length;h++)if(b2(l[h]))return h;return l.length}(s);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if(typeof l!="number"){if(!o)if(4&i){if(i=2|1&i,l!==""&&!S2(n,l,e)||l===""&&t.length===1){if(en(i))return!1;o=!0}}else{const h=8&i?l:t[++a];if(8&i&&n.attrs!==null){if(!M2(n.attrs,h,e)){if(en(i))return!1;o=!0}continue}const u=T2(8&i?"class":l,s,u0(n),e);if(u===-1){if(en(i))return!1;o=!0;continue}if(h!==""){let c;c=u>r?"":s[u+1].toLowerCase();const d=8&i?c:null;if(d&&l0(d,h,0)!==-1||2&i&&h!==c){if(en(i))return!1;o=!0}}}}else{if(!o&&!en(i)&&!en(l))return!1;if(o&&en(l))continue;o=!1,i=l|1&i}}return en(i)||o}function en(n){return!(1&n)}function T2(n,t,e,i){if(t===null)return-1;let s=0;if(i||!e){let r=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(o===3||o===6)r=!0;else{if(o===1||o===2){let a=t[++s];for(;typeof a=="string";)a=t[++s];continue}if(o===4)break;if(o===0){s+=4;continue}}s+=r?1:2}return-1}return function(o,a){let l=o.indexOf(4);if(l>-1)for(l++;l<o.length;){const h=o[l];if(typeof h=="number")return-1;if(h===a)return l;l++}return-1}(t,n)}function I2(n,t,e=!1){for(let i=0;i<t.length;i++)if(E2(n,t[i],e))return!0;return!1}function c0(n,t){return n?":not("+t.trim()+")":t}function k2(n){let t=n[0],e=1,i=2,s="",r=!1;for(;e<n.length;){let o=n[e];if(typeof o=="string")if(2&i){const a=n[++e];s+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?s+="."+o:4&i&&(s+=" "+o);else s!==""&&!en(o)&&(t+=c0(r,s),s=""),i=o,r=r||!en(i);e++}return s!==""&&(t+=c0(r,s)),t}function Yo(n){return Tl(()=>{const t=m0(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===a0.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||On.Emulated,styles:n.styles||tn,_:null,schemas:n.schemas||null,tView:null,id:""};y0(e);const i=n.dependencies;return e.directiveDefs=_0(i,!1),e.pipeDefs=_0(i,!0),e.id=function(r){let o=0;const a=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const l of a)o=Math.imul(31,o)+l.charCodeAt(0)|0;return o+=2147483648,"c"+o}(e),e})}function P2(n){return br(n)||f0(n)}function R2(n){return n!==null}function xr(n){return Tl(()=>({type:n.type,bootstrap:n.bootstrap||tn,declarations:n.declarations||tn,imports:n.imports||tn,exports:n.exports||tn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function d0(n,t){if(n==null)return Zo;const e={};for(const i in n)if(n.hasOwnProperty(i)){let s=n[i],r=s;Array.isArray(s)&&(r=s[1],s=s[0]),e[s]=i,t&&(t[s]=r)}return e}function p0(n){return Tl(()=>{const t=m0(n);return y0(t),t})}function F2(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function br(n){return n[d2]||null}function f0(n){return n[p2]||null}function g0(n){return n[f2]||null}function m0(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:n.inputs||Zo,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||tn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:d0(n.inputs,t),outputs:d0(n.outputs),debugInfo:null}}function y0(n){n.features?.forEach(t=>t(n))}function _0(n,t){if(!n)return null;const e=t?g0:P2;return()=>(typeof n=="function"?n():n).map(i=>e(i)).filter(R2)}const An=0,Gt=1,bt=2,ai=3,nn=4,sn=5,Il=6,v0=7,Ln=8,wr=9,Dn=10,gi=11,$o=12,x0=13,Cr=14,fn=15,kl=16,Mr=17,Ko=18,Pl=19,b0=20,Jo=21,vc=22,Us=23,ls=25,w0=1,Hs=7,Rl=9,zi=10;var xc=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(xc||{});function Sr(n){return Array.isArray(n)&&typeof n[w0]=="object"}function Nn(n){return Array.isArray(n)&&n[w0]===!0}function C0(n){return!!(4&n.flags)}function Fl(n){return n.componentOffset>-1}function M0(n){return!(1&~n.flags)}function Qo(n){return!!n.template}function O2(n){return!!(512&n[bt])}function ta(n,t){return n.hasOwnProperty($g)?n[$g]:null}class S0{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ol(){return E0}function E0(n){return n.type.prototype.ngOnChanges&&(n.setInput=L2),A2}function A2(){const n=I0(this),t=n?.current;if(t){const e=n.previous;if(e===Zo)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function L2(n,t,e,i){const s=this.declaredInputs[e],r=I0(n)||function(u,c){return u[T0]=c}(n,{previous:Zo,current:null}),o=r.current||(r.current={}),a=r.previous,l=a[s];o[s]=new S0(l&&l.currentValue,t,a===Zo),n[i]=t}Ol.ngInherit=!0;const T0="__ngSimpleChanges__";function I0(n){return n[T0]||null}const hs=function(n,t,e){};let D2=!1;function zn(n){for(;Array.isArray(n);)n=n[An];return n}function k0(n,t){return zn(t[n])}function gn(n,t){return zn(t[n.index])}function P0(n,t){return n.data[t]}function Er(n,t){const e=t[n];return Sr(e)?e:e[An]}function bc(n){return!(128&~n[bt])}function Al(n,t){return t==null?null:n[t]}function R0(n){n[Mr]=0}function N2(n){1024&n[bt]||(n[bt]|=1024,bc(n)&&ea(n))}function F0(n){return 9216&n[bt]||n[Us]?.dirty}function wc(n){F0(n)?ea(n):64&n[bt]&&(function(){return D2}()?(n[bt]|=1024,ea(n)):n[Dn].changeDetectionScheduler?.notify())}function ea(n){n[Dn].changeDetectionScheduler?.notify();let t=ia(n);for(;t!==null&&!(8192&t[bt])&&(t[bt]|=8192,bc(t));)t=ia(t)}function ia(n){const t=n[ai];return Nn(t)?t[ai]:t}const qt={lFrame:G0(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function O0(){return qt.bindingsEnabled}function ii(){return qt.lFrame.lView}function Xs(){return qt.lFrame.tView}function jn(){let n=A0();for(;n!==null&&n.type===64;)n=n.parent;return n}function A0(){return qt.lFrame.currentTNode}function na(n,t){const e=qt.lFrame;e.currentTNode=n,e.isParent=t}function L0(){return qt.lFrame.isParent}function D0(){return qt.lFrame.bindingIndex++}function z2(n,t){const e=qt.lFrame;e.bindingIndex=e.bindingRootIndex=n,Cc(t)}function Cc(n){qt.lFrame.currentDirectiveIndex=n}function N0(n){qt.lFrame.currentQueryIndex=n}function j2(n){const t=n[Gt];return t.type===2?t.declTNode:t.type===1?n[sn]:null}function z0(n,t,e){if(e&Lt.SkipSelf){let s=t,r=n;for(;s=s.parent,!(s!==null||e&Lt.Host||(s=j2(r),s===null||(r=r[Cr],10&s.type))););if(s===null)return!1;t=s,n=r}const i=qt.lFrame=j0();return i.currentTNode=t,i.lView=n,!0}function Mc(n){const t=j0(),e=n[Gt];qt.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function j0(){const n=qt.lFrame,t=n===null?null:n.child;return t===null?G0(n):t}function G0(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=t),t}function q0(){const n=qt.lFrame;return qt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const V0=q0;function Sc(){const n=q0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Tr(){return qt.lFrame.selectedIndex}function Zs(n){qt.lFrame.selectedIndex=n}let B0=!0;function Ec(){return B0}function Tc(n){B0=n}function Ic(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const s=n.data[e].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:o,ngAfterViewInit:a,ngAfterViewChecked:l,ngOnDestroy:h}=s;r&&(n.contentHooks??=[]).push(-e,r),o&&((n.contentHooks??=[]).push(e,o),(n.contentCheckHooks??=[]).push(e,o)),a&&(n.viewHooks??=[]).push(-e,a),l&&((n.viewHooks??=[]).push(e,l),(n.viewCheckHooks??=[]).push(e,l)),h!=null&&(n.destroyHooks??=[]).push(e,h)}}function Ll(n,t,e){W0(n,t,3,e)}function Dl(n,t,e,i){(3&n[bt])===e&&W0(n,t,e,i)}function kc(n,t){let e=n[bt];(3&e)===t&&(e&=16383,e+=1,n[bt]=e)}function W0(n,t,e,i){const s=i??-1,r=t.length-1;let o=0;for(let a=i!==void 0?65535&n[Mr]:0;a<r;a++)if(typeof t[a+1]=="number"){if(o=t[a],i!=null&&o>=i)break}else t[a]<0&&(n[Mr]+=65536),(o<s||s==-1)&&(G2(n,e,t,a),n[Mr]=(4294901760&n[Mr])+a+2),a++}function U0(n,t){hs(4,n,t);const e=Et(null);try{t.call(n)}finally{Et(e),hs(5,n,t)}}function G2(n,t,e,i){const s=e[i]<0,r=e[i+1],o=n[s?-e[i]:e[i]];s?n[bt]>>14<n[Mr]>>16&&(3&n[bt])===t&&(n[bt]+=16384,U0(o,r)):U0(o,r)}const Ir=-1;class Pc{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function H0(n){return n!==Ir}function Nl(n){return 32767&n}function zl(n,t){let e=function(r){return r>>16}(n),i=t;for(;e>0;)i=i[Cr],e--;return i}let Rc=!0;function X0(n){const t=Rc;return Rc=n,t}const Z0=255,Y0=5;let q2=0;const mn={};function $0(n,t){const e=K0(n,t);if(e!==-1)return e;const i=t[Gt];i.firstCreatePass&&(n.injectorIndex=t.length,Fc(i.data,n),Fc(t,null),Fc(i.blueprint,null));const s=Oc(n,t),r=n.injectorIndex;if(H0(s)){const o=Nl(s),a=zl(s,t),l=a[Gt].data;for(let h=0;h<8;h++)t[r+h]=a[o+h]|l[o+h]}return t[r+8]=s,r}function Fc(n,t){n.push(0,0,0,0,0,0,0,0,t)}function K0(n,t){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||t[n.injectorIndex+8]===null?-1:n.injectorIndex}function Oc(n,t){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let e=0,i=null,s=t;for(;s!==null;){if(i=sm(s),i===null)return Ir;if(e++,s=s[Cr],i.injectorIndex!==-1)return i.injectorIndex|e<<16}return Ir}function V2(n,t,e){(function(s,r,o){let a;typeof o=="string"?a=o.charCodeAt(0)||0:o.hasOwnProperty(Uo)&&(a=o[Uo]),a==null&&(a=o[Uo]=q2++);const l=a&Z0;r.data[s+(l>>Y0)]|=1<<l})(n,t,e)}function J0(n,t,e){if(e&Lt.Optional||n!==void 0)return n;dc()}function Q0(n,t,e,i){if(e&Lt.Optional&&i===void 0&&(i=null),!(e&(Lt.Self|Lt.Host))){const s=n[wr],r=Ni(void 0);try{return s?s.get(t,i,e&Lt.Optional):s0(t,i,e&Lt.Optional)}finally{Ni(r)}}return J0(i,0,e)}function tm(n,t,e,i=Lt.Default,s){if(n!==null){if(2048&t[bt]&&!(i&Lt.Self)){const o=function(l,h,u,c,d){let p=l,f=h;for(;p!==null&&f!==null&&2048&f[bt]&&!(512&f[bt]);){const g=em(p,f,u,c|Lt.Self,mn);if(g!==mn)return g;let m=p.parent;if(!m){const y=f[b0];if(y){const _=y.get(u,mn,c);if(_!==mn)return _}m=sm(f),f=f[Cr]}p=m}return d}(n,t,e,i,mn);if(o!==mn)return o}const r=em(n,t,e,i,mn);if(r!==mn)return r}return Q0(t,e,i,s)}function em(n,t,e,i,s){const r=function(a){if(typeof a=="string")return a.charCodeAt(0)||0;const l=a.hasOwnProperty(Uo)?a[Uo]:void 0;return typeof l=="number"?l>=0?l&Z0:W2:l}(e);if(typeof r=="function"){if(!z0(t,n,i))return i&Lt.Host?J0(s,0,i):Q0(t,e,i,s);try{let o;if(o=r(i),o!=null||i&Lt.Optional)return o;dc()}finally{V0()}}else if(typeof r=="number"){let o=null,a=K0(n,t),l=Ir,h=i&Lt.Host?t[fn][sn]:null;for((a===-1||i&Lt.SkipSelf)&&(l=a===-1?Oc(n,t):t[a+8],l!==Ir&&nm(i,!1)?(o=t[Gt],a=Nl(l),t=zl(l,t)):a=-1);a!==-1;){const u=t[Gt];if(im(r,a,u.data)){const c=B2(a,t,e,o,i,h);if(c!==mn)return c}l=t[a+8],l!==Ir&&nm(i,t[Gt].data[a+8]===h)&&im(r,a,t)?(o=u,a=Nl(l),t=zl(l,t)):a=-1}}return s}function B2(n,t,e,i,s,r){const o=t[Gt],a=o.data[n+8],l=function(u,c,d,p,f){const g=u.providerIndexes,m=c.data,y=1048575&g,_=u.directiveStart,v=g>>20,x=f?y+v:u.directiveEnd;for(let b=p?y:y+v;b<x;b++){const M=m[b];if(b<_&&d===M||b>=_&&M.type===d)return b}if(f){const b=m[_];if(b&&Qo(b)&&b.type===d)return _}return null}(a,o,e,i==null?Fl(a)&&Rc:i!=o&&!!(3&a.type),s&Lt.Host&&r===a);return l!==null?sa(t,o,l,a):mn}function sa(n,t,e,i){let s=n[e];const r=t.data;if(function(a){return a instanceof Pc}(s)){const o=s;o.resolving&&function(u,c){const d=c?`. Dependency path: ${c.join(" > ")} > ${u}`:"";throw new Nt(-200,`Circular dependency in DI detected for ${u}${d}`)}(function(u){return typeof u=="function"?u.name||u.toString():typeof u=="object"&&u!=null&&typeof u.type=="function"?u.type.name||u.type.toString():Jg(u)}(r[e]));const a=X0(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ni(o.injectImpl):null;z0(n,i,Lt.Default);try{s=n[e]=o.factory(void 0,r,n,i),t.firstCreatePass&&e>=i.directiveStart&&function(u,c,d){const{ngOnChanges:p,ngOnInit:f,ngDoCheck:g}=c.type.prototype;if(p){const m=E0(c);(d.preOrderHooks??=[]).push(u,m),(d.preOrderCheckHooks??=[]).push(u,m)}f&&(d.preOrderHooks??=[]).push(0-u,f),g&&((d.preOrderHooks??=[]).push(u,g),(d.preOrderCheckHooks??=[]).push(u,g))}(e,r[e],t)}finally{l!==null&&Ni(l),X0(a),o.resolving=!1,V0()}}return s}function im(n,t,e){return!!(e[t+(n>>Y0)]&1<<n)}function nm(n,t){return!(n&Lt.Self||n&Lt.Host&&t)}class ra{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return tm(this._tNode,this._lView,t,El(i),e)}}function W2(){return new ra(jn(),ii())}function sm(n){const t=n[Gt],e=t.type;return e===2?t.declTNode:e===1?n[sn]:null}const jl="__parameters__";function rm(n,t,e){return Tl(()=>{const i=function(o){return function(...a){if(o){const l=o(...a);for(const h in l)this[h]=l[h]}}}(t);function s(...r){if(this instanceof s)return i.apply(this,r),this;const o=new s(...r);return a.annotation=o,a;function a(l,h,u){const c=l.hasOwnProperty(jl)?l[jl]:Object.defineProperty(l,jl,{value:[]})[jl];for(;c.length<=u;)c.push(null);return(c[u]=c[u]||[]).push(o),l}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}function Ac(n,t){n.forEach(e=>Array.isArray(e)?Ac(e,t):t(e))}function om(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Gl(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function U2(n,t,e){let i=oa(n,t);return i>=0?n[1|i]=e:(i=~i,function(r,o,a,l){let h=r.length;if(h==o)r.push(a,l);else if(h===1)r.push(l,r[0]),r[0]=a;else{for(h--,r.push(r[h-1],r[h]);h>o;)r[h]=r[h-2],h--;r[o]=a,r[o+1]=l}}(n,i,t,e)),i}function Lc(n,t){const e=oa(n,t);if(e>=0)return n[1|e]}function oa(n,t){return function(i,s,r){let o=0,a=i.length>>r;for(;a!==o;){const l=o+(a-o>>1),h=i[l<<r];if(s===h)return l<<r;h>s?a=l:o=l+1}return~(a<<r)}(n,t,1)}const H2=o0(rm("Optional"),8),X2=o0(rm("SkipSelf"),4),ql=new jt("ENVIRONMENT_INITIALIZER"),am=new jt("INJECTOR",-1),lm=new jt("INJECTOR_DEF_TYPES");class hm{get(t,e=Ho){if(e===Ho){const i=new Error(`NullInjectorError: No provider for ${fi(t)}!`);throw i.name="NullInjectorError",i}return e}}function Z2(...n){return{\u0275providers:um(0,n),\u0275fromNgModule:!0}}function um(n,...t){const e=[],i=new Set;let s;const r=o=>{e.push(o)};return Ac(t,o=>{const a=o;Dc(a,r,[],i)&&(s||=[],s.push(a))}),s!==void 0&&cm(s,r),e}function cm(n,t){for(let e=0;e<n.length;e++){const{ngModule:i,providers:s}=n[e];Nc(s,r=>{t(r,i)})}}function Dc(n,t,e,i){if(!(n=Qi(n)))return!1;let s=null,r=t0(n);const o=!r&&br(n);if(r||o){if(o&&!o.standalone)return!1;s=n}else{const l=n.ngModule;if(r=t0(l),!r)return!1;s=l}const a=i.has(s);if(o){if(a)return!1;if(i.add(s),o.dependencies){const l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(const h of l)Dc(h,t,e,i)}}else{if(!r)return!1;{if(r.imports!=null&&!a){let h;i.add(s);try{Ac(r.imports,u=>{Dc(u,t,e,i)&&(h||=[],h.push(u))})}finally{}h!==void 0&&cm(h,t)}if(!a){const h=ta(s)||(()=>new s);t({provide:s,useFactory:h,deps:tn},s),t({provide:lm,useValue:s,multi:!0},s),t({provide:ql,useValue:()=>ot(s),multi:!0},s)}const l=r.providers;if(l!=null&&!a){const h=n;Nc(l,u=>{t(u,h)})}}}return s!==n&&n.providers!==void 0}function Nc(n,t){for(let e of n)Yg(e)&&(e=e.\u0275providers),Array.isArray(e)?Nc(e,t):t(e)}const Y2=fe({provide:String,useValue:fe});function dm(n){return n!==null&&typeof n=="object"&&Y2 in n}function zc(n){return typeof n=="function"}const jc=new jt("Set Injector scope."),Vl={},$2={};let Gc;function qc(){return Gc===void 0&&(Gc=new hm),Gc}class Ys{}class Vc extends Ys{get destroyed(){return this._destroyed}constructor(t,e,i,s){super(),this.parent=e,this.source=i,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Wc(t,o=>this.processProvider(o)),this.records.set(am,kr(void 0,this)),s.has("environment")&&this.records.set(Ys,kr(void 0,this));const r=this.records.get(jc);r!=null&&typeof r.value=="string"&&this.scopes.add(r.value),this.injectorDefTypes=new Set(this.get(lm,tn,Lt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of t)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=as(this),i=Ni(void 0);try{return t()}finally{as(e),Ni(i)}}get(t,e=Ho,i=Lt.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Kg))return t[Kg](this);i=El(i);const s=as(this),r=Ni(void 0);try{if(!(i&Lt.SkipSelf)){let o=this.records.get(t);if(o===void 0){const a=function(h){return typeof h=="function"||typeof h=="object"&&h instanceof jt}(t)&&pc(t);o=a&&this.injectableDefInScope(a)?kr(Bc(t),Vl):null,this.records.set(t,o)}if(o!=null)return this.hydrate(t,o)}return(i&Lt.Self?qc():this.parent).get(t,e=i&Lt.Optional&&e===Ho?null:e)}catch(o){if(o.name==="NullInjectorError"){if((o[Sl]=o[Sl]||[]).unshift(fi(t)),s)throw o;return function(l,h,u,c){const d=l[Sl];throw h[r0]&&d.unshift(h[r0]),l.message=function(f,g,m,y=null){f=f&&f.charAt(0)===`
`&&f.charAt(1)=="\u0275"?f.slice(2):f;let _=fi(g);if(Array.isArray(g))_=g.map(fi).join(" -> ");else if(typeof g=="object"){let v=[];for(let x in g)if(g.hasOwnProperty(x)){let b=g[x];v.push(x+":"+(typeof b=="string"?JSON.stringify(b):fi(b)))}_=`{${v.join(", ")}}`}return`${m}${y?"("+y+")":""}[${_}]: ${f.replace(_2,`
  `)}`}(`
`+l.message,d,u,c),l.ngTokenPath=d,l[Sl]=null,l}(o,t,"R3InjectorError",this.source)}throw o}finally{Ni(r),as(s)}}resolveInjectorInitializers(){const t=as(this),e=Ni(void 0);try{const i=this.get(ql,tn,Lt.Self);for(const s of i)s()}finally{as(t),Ni(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(fi(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Nt(205,!1)}processProvider(t){let e=zc(t=Qi(t))?t:Qi(t&&t.provide);const i=function(r){return dm(r)?kr(void 0,r.useValue):kr(function(a,l,h){let u;if(zc(a)){const c=Qi(a);return ta(c)||Bc(c)}if(dm(a))u=()=>Qi(a.useValue);else if(function(d){return!(!d||!d.useFactory)}(a))u=()=>a.useFactory(...mc(a.deps||[]));else if(function(d){return!(!d||!d.useExisting)}(a))u=()=>ot(Qi(a.useExisting));else{const c=Qi(a&&(a.useClass||a.provide));if(!function(p){return!!p.deps}(a))return ta(c)||Bc(c);u=()=>new c(...mc(a.deps))}return u}(r),Vl)}(t);if(!zc(t)&&t.multi===!0){let s=this.records.get(e);s||(s=kr(void 0,Vl,!0),s.factory=()=>mc(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===Vl&&(e.value=$2,e.value=e.factory()),typeof e.value=="object"&&e.value&&function(s){return s!==null&&typeof s=="object"&&typeof s.ngOnDestroy=="function"}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Qi(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}}function Bc(n){const t=pc(n),e=t!==null?t.factory:ta(n);if(e!==null)return e;if(n instanceof jt)throw new Nt(204,!1);if(n instanceof Function)return function(s){if(s.length>0)throw new Nt(204,!1);const r=function(a){return a&&(a[e0]||a[n0])||null}(s);return r!==null?()=>r.factory(s):()=>new s}(n);throw new Nt(204,!1)}function kr(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Wc(n,t){for(const e of n)Array.isArray(e)?Wc(e,t):e&&Yg(e)?Wc(e.\u0275providers,t):t(e)}function pm(n,t=null,e=null,i){const s=fm(n,t,e,i);return s.resolveInjectorInitializers(),s}function fm(n,t=null,e=null,i,s=new Set){const r=[e||tn,Z2(n)];return i=i||(typeof n=="object"?void 0:fi(n)),new Vc(r,t||qc(),i||null,s)}let Uc,aa=(()=>{class n{static#t=this.THROW_IF_NOT_FOUND=Ho;static#e=this.NULL=new hm;static create(e,i){if(Array.isArray(e))return pm({name:""},i,e,"");{const s=e.name??"";return pm({name:s},e.parent,e.providers,s)}}static#i=this.\u0275prov=zt({token:n,providedIn:"any",factory:()=>ot(am)});static#n=this.__NG_ELEMENT_ID__=-1}return n})();const Hc=new jt("AppId",{providedIn:"root",factory:()=>K2}),K2="ng",gm=new jt("Platform Initializer"),Pr=new jt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),mm=new jt("CSP nonce",{providedIn:"root",factory:()=>function(){if(Uc!==void 0)return Uc;if(typeof document<"u")return document;throw new Nt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function ym(n){return!(128&~n.flags)}var $s=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}($s||{});const _m=new Map;let J2=0;const vm="__ngContext__";function Ks(n,t){Sr(t)?(n[vm]=t[Pl],function(i){_m.set(i[Pl],i)}(t)):n[vm]=t}let Q2;function Xc(n,t){return Q2(n,t)}function Rr(n,t,e,i,s){if(i!=null){let r,o=!1;Nn(i)?r=i:Sr(i)&&(o=!0,i=i[An]);const a=zn(i);n===0&&e!==null?s==null?Mm(t,e,a):Bl(t,e,a,s||null,!0):n===1&&e!==null?Bl(t,e,a,s||null,!0):n===2?function(h,u,c){const d=$c(h,u);d&&function(f,g,m,y){f.removeChild(g,m,y)}(h,d,u,c)}(t,a,o):n===3&&t.destroyNode(a),r!=null&&function(h,u,c,d,p){const f=c[Hs];f!==zn(c)&&Rr(u,h,d,f,p);for(let g=zi;g<c.length;g++){const m=c[g];Ul(m[Gt],m,h,u,d,f)}}(t,n,r,e,s)}}function xm(n,t,e){return n.createElement(t,e)}function bm(n,t){t[Dn].changeDetectionScheduler?.notify(),Ul(n,t,t[gi],2,null,null)}function wm(n,t){const e=n[Rl],i=e.indexOf(t);e.splice(i,1)}function Zc(n,t){if(n.length<=zi)return;const e=zi+t,i=n[e];if(i){const s=i[kl];s!==null&&s!==n&&wm(s,i),t>0&&(n[e-1][nn]=i[nn]);const r=Gl(n,zi+t);(function(l,h){bm(l,h),h[An]=null,h[sn]=null})(i[Gt],i);const o=r[Ko];o!==null&&o.detachView(r[Gt]),i[ai]=null,i[nn]=null,i[bt]&=-129}return i}function Cm(n,t){if(!(256&t[bt])){const e=t[gi];e.destroyNode&&Ul(n,t,e,3,null,null),function(s){let r=s[$o];if(!r)return Yc(s[Gt],s);for(;r;){let o=null;if(Sr(r))o=r[$o];else{const a=r[zi];a&&(o=a)}if(!o){for(;r&&!r[nn]&&r!==s;)Sr(r)&&Yc(r[Gt],r),r=r[ai];r===null&&(r=s),Sr(r)&&Yc(r[Gt],r),o=r&&r[nn]}r=o}}(t)}}function Yc(n,t){if(!(256&t[bt])){t[bt]&=-129,t[bt]|=256,t[Us]&&function(s){if(he(s),pe(s))for(let r=0;r<s.producerNode.length;r++)dt(s.producerNode[r],s.producerIndexOfThis[r]);s.producerNode.length=s.producerLastReadVersion.length=s.producerIndexOfThis.length=0,s.liveConsumerNode&&(s.liveConsumerNode.length=s.liveConsumerIndexOfThis.length=0)}(t[Us]),function(s,r){let o;if(s!=null&&(o=s.destroyHooks)!=null)for(let a=0;a<o.length;a+=2){const l=r[o[a]];if(!(l instanceof Pc)){const h=o[a+1];if(Array.isArray(h))for(let u=0;u<h.length;u+=2){const c=l[h[u]],d=h[u+1];hs(4,c,d);try{d.call(c)}finally{hs(5,c,d)}}else{hs(4,l,h);try{h.call(l)}finally{hs(5,l,h)}}}}}(n,t),function(s,r){const o=s.cleanup,a=r[v0];if(o!==null)for(let h=0;h<o.length-1;h+=2)if(typeof o[h]=="string"){const u=o[h+3];u>=0?a[u]():a[-u].unsubscribe(),h+=2}else o[h].call(a[o[h+1]]);a!==null&&(r[v0]=null);const l=r[Jo];if(l!==null){r[Jo]=null;for(let h=0;h<l.length;h++)(0,l[h])()}}(n,t),t[Gt].type===1&&t[gi].destroy();const e=t[kl];if(e!==null&&Nn(t[ai])){e!==t[ai]&&wm(e,t);const i=t[Ko];i!==null&&i.detachView(n)}(function(s){_m.delete(s[Pl])})(t)}}function tw(n,t,e){return function(s,r,o){let a=r;for(;a!==null&&40&a.type;)a=(r=a).parent;if(a===null)return o[An];{const{componentOffset:l}=a;if(l>-1){const{encapsulation:h}=s.data[a.directiveStart+l];if(h===On.None||h===On.Emulated)return null}return gn(a,o)}}(n,t.parent,e)}function Bl(n,t,e,i,s){n.insertBefore(t,e,i,s)}function Mm(n,t,e){n.appendChild(t,e)}function Sm(n,t,e,i,s){i!==null?Bl(n,t,e,i,s):Mm(n,t,e)}function $c(n,t){return n.parentNode(t)}let Em,ew=function(t,e,i){return 40&t.type?gn(t,i):null};function Kc(n,t,e,i){const s=tw(n,i,t),r=t[gi],o=function(l,h,u){return ew(l,h,u)}(i.parent||t[sn],i,t);if(s!=null)if(Array.isArray(e))for(let a=0;a<e.length;a++)Sm(r,s,e[a],o,!1);else Sm(r,s,e,o,!1);Em!==void 0&&Em(r,i,t,e,s)}function Wl(n,t){if(t!==null){const e=t.type;if(3&e)return gn(t,n);if(4&e)return Jc(-1,n[t.index]);if(8&e){const i=t.child;if(i!==null)return Wl(n,i);{const s=n[t.index];return Nn(s)?Jc(-1,s):zn(s)}}if(32&e)return Xc(t,n)()||zn(n[t.index]);{const i=Tm(n,t);return i!==null?Array.isArray(i)?i[0]:Wl(ia(n[fn]),i):Wl(n,t.next)}}return null}function Tm(n,t){return t!==null?n[fn][sn].projection[t.projection]:null}function Jc(n,t){const e=zi+n+1;if(e<t.length){const i=t[e],s=i[Gt].firstChild;if(s!==null)return Wl(i,s)}return t[Hs]}function Qc(n,t,e,i,s,r,o){for(;e!=null;){const a=i[e.index],l=e.type;if(o&&t===0&&(a&&Ks(zn(a),i),e.flags|=2),32&~e.flags)if(8&l)Qc(n,t,e.child,i,s,r,!1),Rr(t,n,s,a,r);else if(32&l){const h=Xc(e,i);let u;for(;u=h();)Rr(t,n,s,u,r);Rr(t,n,s,a,r)}else 16&l?iw(n,t,i,e,s,r):Rr(t,n,s,a,r);e=o?e.projectionNext:e.next}}function Ul(n,t,e,i,s,r){Qc(e,i,n.firstChild,t,s,r,!1)}function iw(n,t,e,i,s,r){const o=e[fn],a=o[sn].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Rr(t,n,s,a[l],r);else{let l=a;const h=o[ai];ym(i)&&(l.flags|=128),Qc(n,t,l,h,s,r,!0)}}function Im(n,t,e){e===""?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function km(n,t,e){const{mergedAttrs:i,classes:s,styles:r}=e;i!==null&&yc(n,t,i),s!==null&&Im(n,t,s),r!==null&&function(a,l,h){a.setAttribute(l,"style",h)}(n,t,r)}class nw{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class sw{}let rw=()=>null;function td(n,t,e=!1){return rw(n,t,e)}class ow{}class Pm{}class aw{resolveComponentFactory(t){throw function(i){const s=Error(`No component factory found for ${fi(i)}.`);return s.ngComponent=i,s}(t)}}let Fr=(()=>{class n{static#t=this.NULL=new aw}return n})();function lw(){return Hl(jn(),ii())}function Hl(n,t){return new la(gn(n,t))}let la=(()=>{class n{constructor(e){this.nativeElement=e}static#t=this.__NG_ELEMENT_ID__=lw}return n})();class Rm{}let hw=(()=>{class n{static#t=this.\u0275prov=zt({token:n,providedIn:"root",factory:()=>null})}return n})();const ed={};function Fm(n){return!!function(e){return e!==null&&(typeof e=="function"||typeof e=="object")}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}class uw{constructor(){}supports(t){return Fm(t)}create(t){return new dw(t)}}const cw=(n,t)=>t;class dw{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||cw}forEachItem(t){let e;for(e=this._itHead;e!==null;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,s=0,r=null;for(;e||i;){const o=!i||e&&e.currentIndex<Am(i,s,r)?e:i,a=Am(o,s,r),l=o.currentIndex;if(o===i)s--,i=i._nextRemoved;else if(e=e._next,o.previousIndex==null)s++;else{r||(r=[]);const h=a-s,u=l-s;if(h!=u){for(let c=0;c<h;c++){const d=c<r.length?r[c]:r[c]=0,p=d+c;u<=p&&p<h&&(r[c]=d+1)}r[o.previousIndex]=u-h}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)t(e)}diff(t){if(t==null&&(t=[]),!Fm(t))throw new Nt(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,i,s,r=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)i=t[a],s=this._trackByFn(a,i),r!==null&&Object.is(r.trackById,s)?(o&&(r=this._verifyReinsertion(r,i,s,a)),Object.is(r.item,i)||this._addIdentityChange(r,i)):(r=this._mismatch(r,i,s,a),o=!0),r=r._next}else e=0,function(l,h){if(Array.isArray(l))for(let u=0;u<l.length;u++)h(l[u]);else{const u=l[Symbol.iterator]();let c;for(;!(c=u.next()).done;)h(c.value)}}(t,a=>{s=this._trackByFn(e,a),r!==null&&Object.is(r.trackById,s)?(o&&(r=this._verifyReinsertion(r,a,s,e)),Object.is(r.item,a)||this._addIdentityChange(r,a)):(r=this._mismatch(r,a,s,e),o=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;t!==null;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;t!==null;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,s){let r;return t===null?r=this._itTail:(r=t._prev,this._remove(t)),(t=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null))!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,s)):(t=this._linkedRecords===null?null:this._linkedRecords.get(i,s))!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,s)):t=this._addAfter(new pw(e,i),r,s),t}_verifyReinsertion(t,e,i,s){let r=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return r!==null?t=this._reinsertAfter(r,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;t!==null;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,r=t._nextRemoved;return s===null?this._removalsHead=r:s._nextRemoved=r,r===null?this._removalsTail=s:r._prevRemoved=s,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=this._additionsTail===null?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const s=e===null?this._itHead:e._next;return t._next=s,t._prev=e,s===null?this._itTail=t:s._prev=t,e===null?this._itHead=t:e._next=t,this._linkedRecords===null&&(this._linkedRecords=new Om),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){this._linkedRecords!==null&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return e===null?this._itHead=i:e._next=i,i===null?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=this._movesTail===null?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Om),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=this._identityChangesTail===null?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class pw{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class fw{constructor(){this._head=null,this._tail=null}add(t){this._head===null?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;i!==null;i=i._nextDup)if((e===null||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return e===null?this._head=i:e._nextDup=i,i===null?this._tail=e:i._prevDup=e,this._head===null}}class Om{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new fw,this.map.set(e,i)),i.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}}function Am(n,t,e){const i=n.previousIndex;if(i===null)return i;let s=0;return e&&i<e.length&&(s=e[i]),i+t+s}function Lm(){return new Dm([new uw])}let Dm=(()=>{class n{static#t=this.\u0275prov=zt({token:n,providedIn:"root",factory:Lm});constructor(e){this.factories=e}static create(e,i){if(i!=null){const s=i.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||Lm()),deps:[[n,new X2,new H2]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i!=null)return i;throw new Nt(901,!1)}}return n})();function Xl(n,t,e,i,s=!1){for(;e!==null;){const r=t[e.index];r!==null&&i.push(zn(r)),Nn(r)&&gw(r,i);const o=e.type;if(8&o)Xl(n,t,e.child,i);else if(32&o){const a=Xc(e,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Tm(t,e);if(Array.isArray(a))i.push(...a);else{const l=ia(t[fn]);Xl(l[Gt],l,a,i,!0)}}e=s?e.projectionNext:e.next}return i}function gw(n,t){for(let e=zi;e<n.length;e++){const i=n[e],s=i[Gt].firstChild;s!==null&&Xl(i[Gt],i,s,t)}n[Hs]!==n[An]&&t.push(n[Hs])}let Nm=[];const mw={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{ea(n.lView)},consumerOnSignalRead(){this.lView[Us]=this}};function zm(n){return Gm(n[$o])}function jm(n){return Gm(n[nn])}function Gm(n){for(;n!==null&&!Nn(n);)n=n[nn];return n}function id(n){return n.ngOriginalError}class Or{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&id(t);for(;e&&id(e);)e=id(e);return e||null}}const qm=new jt("",{providedIn:"root",factory:()=>Re(Or).handleError.bind(void 0)}),yw=new jt("",{providedIn:"root",factory:()=>!1}),Ar={};function us(n=1){Vm(Xs(),ii(),Tr()+n,!1)}function Vm(n,t,e,i){if(!i)if(3&~t[bt]){const s=n.preOrderHooks;s!==null&&Dl(t,s,0,e)}else{const s=n.preOrderCheckHooks;s!==null&&Ll(t,s,e)}Zs(e)}function Le(n,t=Lt.Default){const e=ii();return e===null?ot(n,t):tm(jn(),e,Qi(n),t)}function Zl(n,t,e,i,s,r,o,a,l,h,u){const c=t.blueprint.slice();return c[An]=s,c[bt]=204|i,(h!==null||n&&2048&n[bt])&&(c[bt]|=2048),R0(c),c[ai]=c[Cr]=n,c[Ln]=e,c[Dn]=o||n&&n[Dn],c[gi]=a||n&&n[gi],c[wr]=l||n&&n[wr]||null,c[sn]=r,c[Pl]=function(){return J2++}(),c[Il]=u,c[b0]=h,c[fn]=t.type==2?n[fn]:c,c}function Yl(n,t,e,i,s){let r=n.data[t];if(r===null)r=function(a,l,h,u,c){const d=A0(),p=L0(),f=a.data[l]=function(m,y,_,v,x,b){let M=y?y.injectorIndex:-1,w=0;return function(){return qt.skipHydrationRootTNode!==null}()&&(w|=128),{type:_,index:v,insertBeforeIndex:null,injectorIndex:M,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:w,providerIndexes:0,value:x,attrs:b,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:y,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,p?d:d&&d.parent,h,l,u,c);return a.firstChild===null&&(a.firstChild=f),d!==null&&(p?d.child==null&&f.parent!==null&&(d.child=f):d.next===null&&(d.next=f,f.prev=d)),f}(n,t,e,i,s),function(){return qt.lFrame.inI18n}()&&(r.flags|=32);else if(64&r.type){r.type=e,r.value=i,r.attrs=s;const o=function(){const l=qt.lFrame,h=l.currentTNode;return l.isParent?h:h.parent}();r.injectorIndex=o===null?-1:o.injectorIndex}return na(r,!0),r}function Bm(n,t,e,i){if(e===0)return-1;const s=t.length;for(let r=0;r<e;r++)t.push(i),n.blueprint.push(i),n.data.push(null);return s}function Wm(n,t,e,i,s){const r=Tr(),o=2&i;try{Zs(-1),o&&t.length>ls&&Vm(n,t,ls,!1),hs(o?2:0,s),e(i,s)}finally{Zs(r),hs(o?3:1,s)}}function Um(n,t,e){if(C0(t)){const i=Et(null);try{const s=t.directiveEnd;for(let r=t.directiveStart;r<s;r++){const o=n.data[r];o.contentQueries&&o.contentQueries(1,e[r],r)}}finally{Et(i)}}}function Hm(n,t,e){O0()&&(function(s,r,o,a){const l=o.directiveStart,h=o.directiveEnd;Fl(o)&&function(d,p,f){const g=gn(p,d),m=Zm(f);let y=16;f.signals?y=4096:f.onPush&&(y=64);const _=$l(d,Zl(d,m,null,y,g,p,null,d[Dn].rendererFactory.createRenderer(g,f),null,null,null));d[p.index]=_}(r,o,s.data[l+o.componentOffset]),s.firstCreatePass||$0(o,r),Ks(a,r);const u=o.initialInputs;for(let c=l;c<h;c++){const d=s.data[c],p=sa(r,s,c,o);Ks(p,r),u!==null&&ww(0,c-l,p,d,0,u),Qo(d)&&(Er(o.index,r)[Ln]=sa(r,s,c,o))}}(n,t,e,gn(e,t)),!(64&~e.flags)&&Qm(n,t,e))}function Xm(n,t,e=gn){const i=t.localNames;if(i!==null){let s=t.index+1;for(let r=0;r<i.length;r+=2){const o=i[r+1],a=o===-1?e(t,n):n[o];n[s++]=a}}}function Zm(n){const t=n.tView;return t===null||t.incompleteFirstPass?n.tView=nd(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function nd(n,t,e,i,s,r,o,a,l,h,u){const c=ls+i,d=c+s,p=function(m,y){const _=[];for(let v=0;v<y;v++)_.push(v<m?null:Ar);return _}(c,d),f=typeof h=="function"?h():h;return p[Gt]={type:n,blueprint:p,template:e,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof r=="function"?r():r,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1,ssrId:u}}let _w=()=>null;function Ym(n,t,e,i){for(let s in n)if(n.hasOwnProperty(s)){e=e===null?{}:e;const r=n[s];i===null?$m(e,t,s,r):i.hasOwnProperty(s)&&$m(e,t,i[s],r)}return e}function $m(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function Km(n,t,e,i){if(O0()){const s=i===null?null:{"":-1},r=function(h,u){const c=h.directiveRegistry;let d=null,p=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];if(I2(u,g.selectors,!1))if(d||(d=[]),Qo(g))if(g.findHostDirectiveDefs!==null){const m=[];p=p||new Map,g.findHostDirectiveDefs(g,m,p),d.unshift(...m,g),sd(h,u,m.length)}else d.unshift(g),sd(h,u,0);else p=p||new Map,g.findHostDirectiveDefs?.(g,d,p),d.push(g)}return d===null?null:[d,p]}(n,e);let o,a;r===null?o=a=null:[o,a]=r,o!==null&&Jm(n,t,e,o,s,a),s&&function(h,u,c){if(u){const d=h.localNames=[];for(let p=0;p<u.length;p+=2){const f=c[u[p+1]];if(f==null)throw new Nt(-301,!1);d.push(u[p],f)}}}(e,i,s)}e.mergedAttrs=_c(e.mergedAttrs,e.attrs)}function Jm(n,t,e,i,s,r){for(let h=0;h<i.length;h++)V2($0(e,t),n,i[h].type);(function(u,c,d){u.flags|=1,u.directiveStart=c,u.directiveEnd=c+d,u.providerIndexes=c})(e,n.data.length,i.length);for(let h=0;h<i.length;h++){const u=i[h];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=Bm(n,t,i.length,null);for(let h=0;h<i.length;h++){const u=i[h];e.mergedAttrs=_c(e.mergedAttrs,u.hostAttrs),bw(n,e,t,l,u),xw(l,u,s),u.contentQueries!==null&&(e.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(e.flags|=64);const c=u.type.prototype;!o&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),o=!0),!a&&(c.ngOnChanges||c.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}(function(u,c,d){const p=c.directiveEnd,f=u.data,g=c.attrs,m=[];let y=null,_=null;for(let v=c.directiveStart;v<p;v++){const x=f[v],b=d?d.get(x):null,M=b?b.outputs:null;y=Ym(x.inputs,v,y,b?b.inputs:null),_=Ym(x.outputs,v,_,M);const w=y===null||g===null||u0(c)?null:Cw(y,v,g);m.push(w)}y!==null&&(y.hasOwnProperty("class")&&(c.flags|=8),y.hasOwnProperty("style")&&(c.flags|=16)),c.initialInputs=m,c.inputs=y,c.outputs=_})(n,e,r)}function Qm(n,t,e){const i=e.directiveStart,s=e.directiveEnd,r=e.index,o=function(){return qt.lFrame.currentDirectiveIndex}();try{Zs(r);for(let a=i;a<s;a++){const l=n.data[a],h=t[a];Cc(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&vw(l,h)}}finally{Zs(-1),Cc(o)}}function vw(n,t){n.hostBindings!==null&&n.hostBindings(1,t)}function sd(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function xw(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Qo(t)&&(e[""]=n)}}function bw(n,t,e,i,s){n.data[i]=s;const r=s.factory||(s.factory=ta(s.type)),o=new Pc(r,Qo(s),Le);n.blueprint[i]=o,e[i]=o,function(l,h,u,c,d){const p=d.hostBindings;if(p){let f=l.hostBindingOpCodes;f===null&&(f=l.hostBindingOpCodes=[]);const g=~h.index;(function(y){let _=y.length;for(;_>0;){const v=y[--_];if(typeof v=="number"&&v<0)return v}return 0})(f)!=g&&f.push(g),f.push(u,c,p)}}(n,t,i,Bm(n,e,s.hostVars,Ar),s)}function ww(n,t,e,i,s,r){const o=r[t];if(o!==null)for(let a=0;a<o.length;)ty(i,e,o[a++],o[a++],o[a++])}function ty(n,t,e,i,s){const r=Et(null);try{const o=n.inputTransforms;o!==null&&o.hasOwnProperty(i)&&(s=o[i].call(t,s)),n.setInput!==null?n.setInput(t,s,e,i):t[i]=s}finally{Et(r)}}function Cw(n,t,e){let i=null,s=0;for(;s<e.length;){const r=e[s];if(r!==0)if(r!==5){if(typeof r=="number")break;if(n.hasOwnProperty(r)){i===null&&(i=[]);const o=n[r];for(let a=0;a<o.length;a+=2)if(o[a]===t){i.push(r,o[a+1],e[s+1]);break}}s+=2}else s+=2;else s+=4}return i}function ey(n,t,e,i){return[n,!0,0,t,null,i,null,e,null,null]}function iy(n,t){const e=n.contentQueries;if(e!==null){const i=Et(null);try{for(let s=0;s<e.length;s+=2){const r=e[s+1];if(r!==-1){const o=n.data[r];N0(e[s]),o.contentQueries(2,t[r],r)}}}finally{Et(i)}}}function $l(n,t){return n[$o]?n[x0][nn]=t:n[$o]=t,n[x0]=t,t}function rd(n,t,e){N0(0);const i=Et(null);try{t(n,e)}finally{Et(i)}}function od(n,t,e,i,s){for(let r=0;r<e.length;){const o=e[r++],a=e[r++];ty(n.data[o],t[o],i,a,s)}}function Mw(n,t=!0){const e=n[Dn],i=e.rendererFactory;i.begin?.();try{(function(r){ad(r,0);let o=0;for(;F0(r);){if(o===100)throw new Nt(103,!1);o++,ad(r,1)}})(n)}catch(s){throw t&&function(o,a){const l=o[wr],h=l?l.get(Or,null):null;h&&h.handleError(a)}(n,s),s}finally{i.end?.(),e.inlineEffectRunner?.flush()}}function Sw(n,t,e,i){const s=t[bt];if(!(256&~s))return;t[Dn].inlineEffectRunner?.flush(),Mc(t);let r=null,o=null;(function(l){return l.type!==2})(n)&&(o=function(l){return l[Us]??function(u){const c=Nm.pop()??Object.create(mw);return c.lView=u,c}(l)}(t),r=function(l){return l&&(l.nextProducerIndex=0),Et(l)}(o));try{R0(t),function(c){return qt.lFrame.bindingIndex=c}(n.bindingStartIndex),e!==null&&Wm(n,t,e,2,i);const a=!(3&~s);if(a){const u=n.preOrderCheckHooks;u!==null&&Ll(t,u,null)}else{const u=n.preOrderHooks;u!==null&&Dl(t,u,0,null),kc(t,0)}if(function(c){for(let d=zm(c);d!==null;d=jm(d)){if(!(d[bt]&xc.HasTransplantedViews))continue;const p=d[Rl];for(let f=0;f<p.length;f++)N2(p[f])}}(t),ny(t,0),n.contentQueries!==null&&iy(n,t),a){const u=n.contentCheckHooks;u!==null&&Ll(t,u)}else{const u=n.contentHooks;u!==null&&Dl(t,u,1),kc(t,1)}(function(c,d){const p=c.hostBindingOpCodes;if(p!==null)try{for(let f=0;f<p.length;f++){const g=p[f];if(g<0)Zs(~g);else{const m=g,y=p[++f],_=p[++f];z2(y,m),_(2,d[m])}}}finally{Zs(-1)}})(n,t);const l=n.components;l!==null&&ry(t,l,0);const h=n.viewQuery;if(h!==null&&rd(2,h,i),a){const u=n.viewCheckHooks;u!==null&&Ll(t,u)}else{const u=n.viewHooks;u!==null&&Dl(t,u,2),kc(t,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),t[vc]){for(const u of t[vc])u();t[vc]=null}t[bt]&=-73}catch(a){throw ea(t),a}finally{o!==null&&(function(l,h){if(Et(h),l&&l.producerNode!==void 0&&l.producerIndexOfThis!==void 0&&l.producerLastReadVersion!==void 0){if(pe(l))for(let u=l.nextProducerIndex;u<l.producerNode.length;u++)dt(l.producerNode[u],l.producerIndexOfThis[u]);for(;l.producerNode.length>l.nextProducerIndex;)l.producerNode.pop(),l.producerLastReadVersion.pop(),l.producerIndexOfThis.pop()}}(o,r),function(l){l.lView[Us]!==l&&(l.lView=null,Nm.push(l))}(o)),Sc()}}function ny(n,t){for(let e=zm(n);e!==null;e=jm(e))for(let i=zi;i<e.length;i++)sy(e[i],t)}function Ew(n,t,e){sy(Er(t,n),e)}function sy(n,t){bc(n)&&ad(n,t)}function ad(n,t){const e=n[Gt],i=n[bt],s=n[Us];let r=!!(t===0&&16&i);if(r||=!!(64&i&&t===0),r||=!!(1024&i),r||=!(!s?.dirty||!It(s)),s&&(s.dirty=!1),n[bt]&=-9217,r)Sw(e,n,e.template,n[Ln]);else if(8192&i){ny(n,1);const o=e.components;o!==null&&ry(n,o,1)}}function ry(n,t,e){for(let i=0;i<t.length;i++)Ew(n,t[i],e)}function oy(n){for(n[Dn].changeDetectionScheduler?.notify();n;){n[bt]|=64;const t=ia(n);if(O2(n)&&!t)return n;n=t}return null}class ha{get rootNodes(){const t=this._lView,e=t[Gt];return Xl(e,t,e.firstChild,[])}constructor(t,e,i=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ln]}set context(t){this._lView[Ln]=t}get destroyed(){return!(256&~this._lView[bt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[ai];if(Nn(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(Zc(t,i),Gl(e,i))}this._attachedToViewContainer=!1}Cm(this._lView[Gt],this._lView)}onDestroy(t){(function(i,s){if(!(256&~i[bt]))throw new Nt(911,!1);i[Jo]===null&&(i[Jo]=[]),i[Jo].push(s)})(this._lView,t)}markForCheck(){oy(this._cdRefInjectingView||this._lView)}detach(){this._lView[bt]&=-129}reattach(){wc(this._lView),this._lView[bt]|=128}detectChanges(){this._lView[bt]|=1024,Mw(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Nt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,bm(this._lView[Gt],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Nt(902,!1);this._appRef=t,wc(this._lView)}}let ay=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=Tw}return n})();function Tw(n){return function(e,i,s){if(Fl(e)&&!s){const r=Er(e.index,i);return new ha(r,r)}return 47&e.type?new ha(i[fn],i):null}(jn(),ii(),!(16&~n))}const ly=new Set;function ld(n){return t=>{setTimeout(n,void 0,t)}}const Mi=class extends Wo{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let s=t,r=e||(()=>null),o=i;if(t&&typeof t=="object"){const l=t;s=l.next?.bind(l),r=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(r=ld(r),s&&(s=ld(s)),o&&(o=ld(o)));const a=super.subscribe({next:s,error:r,complete:o});return t instanceof be&&t.add(a),a}};function hy(...n){}class We{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Mi(!1),this.onMicrotaskEmpty=new Mi(!1),this.onStable=new Mi(!1),this.onError=new Mi(!1),typeof Zone>"u")throw new Nt(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&e,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function(){const o=typeof oi.requestAnimationFrame=="function";let a=oi[o?"requestAnimationFrame":"setTimeout"],l=oi[o?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&a&&l){const h=a[Zone.__symbol__("OriginalDelegate")];h&&(a=h);const u=l[Zone.__symbol__("OriginalDelegate")];u&&(l=u)}return{nativeRequestAnimationFrame:a,nativeCancelAnimationFrame:l}}().nativeRequestAnimationFrame,function(o){const a=()=>{(function(h){h.isCheckStableRunning||h.lastRequestAnimationFrameId!==-1||(h.lastRequestAnimationFrameId=h.nativeRequestAnimationFrame.call(oi,()=>{h.fakeTopEventTask||(h.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{h.lastRequestAnimationFrameId=-1,ud(h),h.isCheckStableRunning=!0,hd(h),h.isCheckStableRunning=!1},void 0,()=>{},()=>{})),h.fakeTopEventTask.invoke()}),ud(h))})(o)};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,u,c,d,p)=>{if(function(g){return!(!Array.isArray(g)||g.length!==1)&&g[0].data?.__ignore_ng_zone__===!0}(p))return l.invokeTask(u,c,d,p);try{return uy(o),l.invokeTask(u,c,d,p)}finally{(o.shouldCoalesceEventChangeDetection&&c.type==="eventTask"||o.shouldCoalesceRunChangeDetection)&&a(),cy(o)}},onInvoke:(l,h,u,c,d,p,f)=>{try{return uy(o),l.invoke(u,c,d,p,f)}finally{o.shouldCoalesceRunChangeDetection&&a(),cy(o)}},onHasTask:(l,h,u,c)=>{l.hasTask(u,c),h===u&&(c.change=="microTask"?(o._hasPendingMicrotasks=c.microTask,ud(o),hd(o)):c.change=="macroTask"&&(o.hasPendingMacrotasks=c.macroTask))},onHandleError:(l,h,u,c)=>(l.handleError(u,c),o.runOutsideAngular(()=>o.onError.emit(c)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!We.isInAngularZone())throw new Nt(909,!1)}static assertNotInAngularZone(){if(We.isInAngularZone())throw new Nt(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,s){const r=this._inner,o=r.scheduleEventTask("NgZoneEvent: "+s,t,Iw,hy,hy);try{return r.runTask(o,e,i)}finally{r.cancelTask(o)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const Iw={};function hd(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ud(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1)}function uy(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function cy(n){n._nesting--,hd(n)}class kw{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Mi,this.onMicrotaskEmpty=new Mi,this.onStable=new Mi,this.onError=new Mi}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,s){return t.apply(e,i)}}let dy=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of e)i();return!!this.handler?.execute()||e.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#t=this.\u0275prov=zt({token:n,providedIn:"root",factory:()=>new n})}return n})();function Pw(n,t){const e=Er(t,n),i=e[Gt];(function(o,a){for(let l=a.length;l<o.blueprint.length;l++)a.push(o.blueprint[l])})(i,e);const s=e[An];s!==null&&e[Il]===null&&(e[Il]=td(s,e[wr])),cd(i,e,e[Ln])}function cd(n,t,e){Mc(t);try{const i=n.viewQuery;i!==null&&rd(1,i,e);const s=n.template;s!==null&&Wm(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&iy(n,t),n.staticViewQueries&&rd(2,n.viewQuery,e);const r=n.components;r!==null&&function(a,l){for(let h=0;h<l.length;h++)Pw(a,l[h])}(t,r)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[bt]&=-5,Sc()}}function dd(n,t,e){let i=e?n.styles:null,s=e?n.classes:null,r=0;if(t!==null)for(let o=0;o<t.length;o++){const a=t[o];typeof a=="number"?r=a:r==1?s=Xg(s,a):r==2&&(i=Xg(i,a+": "+t[++o]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=s:n.classesWithoutHost=s}class py extends Fr{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=br(t);return new gy(e,this.ngModule)}}function fy(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class Rw{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=El(i);const s=this.injector.get(t,ed,i);return s!==ed||e===ed?s:this.parentInjector.get(t,e,i)}}class gy extends Pm{get inputs(){const t=this.componentDef,e=t.inputTransforms,i=fy(t.inputs);if(e!==null)for(const s of i)e.hasOwnProperty(s.propName)&&(s.transform=e[s.propName]);return i}get outputs(){return fy(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function(s){return s.map(k2).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,s){let r=(s=s||this.ngModule)instanceof Ys?s:s?.injector;r&&this.componentDef.getStandaloneInjector!==null&&(r=this.componentDef.getStandaloneInjector(r)||r);const o=r?new Rw(t,r):t,a=o.get(Rm,null);if(a===null)throw new Nt(407,!1);const l={rendererFactory:a,sanitizer:o.get(hw,null),inlineEffectRunner:null,afterRenderEventManager:o.get(dy,null),changeDetectionScheduler:o.get(sw,null)},h=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=i?function(v,x,b,M){const w=M.get(yw,!1)||b===On.ShadowDom,S=v.selectRootElement(x,w);return function(I){_w(I)}(S),S}(h,i,this.componentDef.encapsulation,o):xm(h,u,function(v){const x=v.toLowerCase();return x==="svg"?"svg":x==="math"?"math":null}(u));let d=512;this.componentDef.signals?d|=4096:this.componentDef.onPush||(d|=16);let p=null;c!==null&&(p=td(c,o,!0));const f=nd(0,null,null,1,0,null,null,null,null,null,null),g=Zl(null,f,null,d,null,null,l,h,o,null,p);let m,y;Mc(g);try{const _=this.componentDef;let v,x=null;_.findHostDirectiveDefs?(v=[],x=new Map,_.findHostDirectiveDefs(_,v,x),v.push(_)):v=[_];const b=function(S,k){const I=S[Gt],R=ls;return S[R]=k,Yl(I,R,2,"#host",null)}(g,c),M=function(S,k,I,R,E,q,O){const P=E[Gt];(function(F,N,at,tt){for(const _t of F)N.mergedAttrs=_c(N.mergedAttrs,_t.hostAttrs);N.mergedAttrs!==null&&(dd(N,N.mergedAttrs,!0),at!==null&&km(tt,at,N))})(R,S,k,O);let L=null;k!==null&&(L=td(k,E[wr]));const D=q.rendererFactory.createRenderer(k,I);let G=16;I.signals?G=4096:I.onPush&&(G=64);const $=Zl(E,Zm(I),null,G,E[S.index],S,q,D,null,null,L);return P.firstCreatePass&&sd(P,S,R.length-1),$l(E,$),E[S.index]=$}(b,c,_,v,g,l,h);y=P0(f,ls),c&&function(S,k,I,R){if(R)yc(S,I,["ng-version","17.0.9"]);else{const{attrs:E,classes:q}=function(P){const L=[],D=[];let G=1,$=2;for(;G<P.length;){let K=P[G];if(typeof K=="string")$===2?K!==""&&L.push(K,P[++G]):$===8&&D.push(K);else{if(!en($))break;$=K}G++}return{attrs:L,classes:D}}(k.selectors[0]);E&&yc(S,I,E),q&&q.length>0&&Im(S,I,q.join(" "))}}(h,_,c,i),e!==void 0&&function(S,k,I){const R=S.projection=[];for(let E=0;E<k.length;E++){const q=I[E];R.push(q!=null?Array.from(q):null)}}(y,this.ngContentSelectors,e),m=function(S,k,I,R,E,q){const O=jn(),P=E[Gt],L=gn(O,E);Jm(P,E,O,I,null,R);for(let G=0;G<I.length;G++)Ks(sa(E,P,O.directiveStart+G,O),E);Qm(P,E,O),L&&Ks(L,E);const D=sa(E,P,O.directiveStart+O.componentOffset,O);if(S[Ln]=E[Ln]=D,q!==null)for(const G of q)G(D,k);return Um(P,O,S),D}(M,_,v,x,g,[Ow]),cd(f,g,null)}finally{Sc()}return new Fw(this.componentType,m,Hl(y,g),g,y)}}class Fw extends ow{constructor(t,e,i,s,r){super(),this.location=i,this._rootLView=s,this._tNode=r,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new ha(s,void 0,!1),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let s;if(i!==null&&(s=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const r=this._rootLView;od(r[Gt],r,s,t,e),this.previousInputValues.set(t,e),oy(Er(this._tNode.index,r))}}get injector(){return new ra(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Ow(){const n=jn();Ic(ii()[Gt],n)}function pd(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Kl(n,t){return n<<17|t<<2}function Js(n){return n>>17&32767}function fd(n){return 2|n}function Lr(n){return(131068&n)>>2}function gd(n,t){return-131069&n|t<<2}function md(n){return 1|n}function my(n,t,e,i){const s=n[e+1],r=t===null;let o=i?Js(s):Lr(s),a=!1;for(;o!==0&&(a===!1||r);){const l=n[o+1];Aw(n[o],t)&&(a=!0,n[o+1]=i?md(l):fd(l)),o=i?Js(l):Lr(l)}a&&(n[e+1]=i?fd(s):md(s))}function Aw(n,t){return n===null||t==null||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||typeof t!="string")&&oa(n,t)>=0}function cs(n,t,e){const i=ii();return pd(i,D0(),t)&&function(r,o,a,l,h,u,c,d){const p=gn(o,a);let f,g=o.inputs;!d&&g!=null&&(f=g[l])?(od(r,a,f,l,h),Fl(o)&&function(y,_){const v=Er(_,y);16&v[bt]||(v[bt]|=64)}(a,o.index)):3&o.type&&(l=function(y){return y==="class"?"className":y==="for"?"htmlFor":y==="formaction"?"formAction":y==="innerHtml"?"innerHTML":y==="readonly"?"readOnly":y==="tabindex"?"tabIndex":y}(l),h=c!=null?c(h,o.value||"",l):h,u.setProperty(p,l,h))}(Xs(),function(){const r=qt.lFrame;return P0(r.tView,r.selectedIndex)}(),i,n,t,i[gi],e,!1),cs}function yy(n,t,e,i,s){const r=s?"class":"style";od(n,e,t.inputs[r],r,i)}function Jl(n,t,e){return function(s,r,o,a){const l=ii(),h=Xs(),u=function(d){const p=qt.lFrame,f=p.bindingIndex;return p.bindingIndex=p.bindingIndex+d,f}(2);h.firstUpdatePass&&function(d,p,f,g){const m=d.data;if(m[f+1]===null){const y=m[Tr()],_=function(x,b){return b>=x.expandoStartIndex}(d,f);(function(x,b){return!!(x.flags&(b?8:16))})(y,g)&&p===null&&!_&&(p=!1),p=function(x,b,M,w){const S=function(R){const E=qt.lFrame.currentDirectiveIndex;return E===-1?null:R[E]}(x);let k=w?b.residualClasses:b.residualStyles;if(S===null)(w?b.classBindings:b.styleBindings)===0&&(M=ua(M=yd(null,x,b,M,w),b.attrs,w),k=null);else{const I=b.directiveStylingLast;if(I===-1||x[I]!==S)if(M=yd(S,x,b,M,w),k===null){let R=function(q,O,P){const L=P?O.classBindings:O.styleBindings;if(Lr(L)!==0)return q[Js(L)]}(x,b,w);R!==void 0&&Array.isArray(R)&&(R=yd(null,x,b,R[1],w),R=ua(R,b.attrs,w),function(q,O,P,L){q[Js(P?O.classBindings:O.styleBindings)]=L}(x,b,w,R))}else k=function(E,q,O){let P;const L=q.directiveEnd;for(let D=1+q.directiveStylingLast;D<L;D++)P=ua(P,E[D].hostAttrs,O);return ua(P,q.attrs,O)}(x,b,w)}return k!==void 0&&(w?b.residualClasses=k:b.residualStyles=k),M}(m,y,p,g),function(x,b,M,w,S,k){let I=k?b.classBindings:b.styleBindings,R=Js(I),E=Lr(I);x[w]=M;let q,O=!1;if(Array.isArray(M)?(q=M[1],(q===null||oa(M,q)>0)&&(O=!0)):q=M,S)if(E!==0){const P=Js(x[R+1]);x[w+1]=Kl(P,R),P!==0&&(x[P+1]=gd(x[P+1],w)),x[R+1]=function(D,G){return 131071&D|G<<17}(x[R+1],w)}else x[w+1]=Kl(R,0),R!==0&&(x[R+1]=gd(x[R+1],w)),R=w;else x[w+1]=Kl(E,0),R===0?R=w:x[E+1]=gd(x[E+1],w),E=w;O&&(x[w+1]=fd(x[w+1])),my(x,q,w,!0),my(x,q,w,!1),function(L,D,G,$,K){const F=K?L.residualClasses:L.residualStyles;F!=null&&typeof D=="string"&&oa(F,D)>=0&&(G[$+1]=md(G[$+1]))}(b,q,x,w,k),I=Kl(R,E),k?b.classBindings=I:b.styleBindings=I}(m,y,p,f,_,g)}}(h,s,u,a),r!==Ar&&pd(l,u,r)&&function(d,p,f,g,m,y,_,v){if(!(3&p.type))return;const x=d.data,b=x[v+1],M=function(S){return!(1&~S)}(b)?_y(x,p,f,m,Lr(b),_):void 0;Ql(M)||(Ql(y)||function(S){return!(2&~S)}(b)&&(y=_y(x,null,f,m,v,_)),function(S,k,I,R,E){if(k)E?S.addClass(I,R):S.removeClass(I,R);else{let q=R.indexOf("-")===-1?void 0:$s.DashCase;E==null?S.removeStyle(I,R,q):(typeof E=="string"&&E.endsWith("!important")&&(E=E.slice(0,-10),q|=$s.Important),S.setStyle(I,R,E,q))}}(g,_,k0(Tr(),f),m,y))}(h,h.data[Tr()],l,l[gi],s,l[u+1]=function(d,p){return d==null||d===""||(typeof p=="string"?d+=p:typeof d=="object"&&(d=fi(function(g){return g instanceof nw?g.changingThisBreaksApplicationSecurity:g}(d)))),d}(r,o),a,u)}(n,t,e,!1),Jl}function yd(n,t,e,i,s){let r=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(a===-1?a=e.directiveStart:a++;a<o&&(r=t[a],i=ua(i,r.hostAttrs,s),r!==n);)a++;return n!==null&&(e.directiveStylingLast=a),i}function ua(n,t,e){const i=e?1:2;let s=-1;if(t!==null)for(let r=0;r<t.length;r++){const o=t[r];typeof o=="number"?s=o:s===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),U2(n,o,!!e||t[++r]))}return n===void 0?null:n}function _y(n,t,e,i,s,r){const o=t===null;let a;for(;s>0;){const l=n[s],h=Array.isArray(l),u=h?l[1]:l,c=u===null;let d=e[s+1];d===Ar&&(d=c?tn:void 0);let p=c?Lc(d,i):u===i?d:void 0;if(h&&!Ql(p)&&(p=Lc(l,i)),Ql(p)&&(a=p,o))return a;const f=n[s+1];s=o?Js(f):Lr(f)}if(t!==null){let l=r?t.residualClasses:t.residualStyles;l!=null&&(a=Lc(l,i))}return a}function Ql(n){return n!==void 0}function vy(n,t){return!t||t.firstChild===null||ym(n)}function Lw(n,t,e,i=!0){const s=t[Gt];if(function(a,l,h,u){const c=zi+u,d=h.length;u>0&&(h[c-1][nn]=l),u<d-zi?(l[nn]=h[c],om(h,zi+u,l)):(h.push(l),l[nn]=null),l[ai]=h;const p=l[kl];p!==null&&h!==p&&function(m,y){const _=m[Rl];y[fn]!==y[ai][ai][fn]&&(m[bt]|=xc.HasTransplantedViews),_===null?m[Rl]=[y]:_.push(y)}(p,l);const f=l[Ko];f!==null&&f.insertView(a),wc(l),l[bt]|=128}(s,t,n,e),i){const o=Jc(e,n),a=t[gi],l=$c(a,n[Hs]);l!==null&&function(u,c,d,p,f,g){p[An]=f,p[sn]=c,Ul(u,p,d,1,f,g)}(s,n[sn],a,t,l,o)}const r=t[Il];r!==null&&r.firstChild!==null&&(r.firstChild=null)}let _d=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=Dw}return n})();function Dw(){return function(t,e){let i;const s=e[t.index];return Nn(s)?i=s:(i=ey(s,e,null,t),e[t.index]=i,$l(e,i)),zw(i,e,t,s),new xy(i,t,e)}(jn(),ii())}const Nw=_d,xy=class extends Nw{constructor(n,t,e){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=e}get element(){return Hl(this._hostTNode,this._hostLView)}get injector(){return new ra(this._hostTNode,this._hostLView)}get parentInjector(){const n=Oc(this._hostTNode,this._hostLView);if(H0(n)){const t=zl(n,this._hostLView),e=Nl(n);return new ra(t[Gt].data[e+8],t)}return new ra(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=by(this._lContainer);return t!==null&&t[n]||null}get length(){return this._lContainer.length-zi}createEmbeddedView(n,t,e){let i,s;typeof e=="number"?i=e:e!=null&&(i=e.index,s=e.injector);const r=n.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(r,i,vy(this._hostTNode,null)),r}createComponent(n,t,e,i,s){const r=n&&!function(c){return typeof c=="function"}(n);let o;if(r)o=t;else{const u=t||{};o=u.index,e=u.injector,i=u.projectableNodes,s=u.environmentInjector||u.ngModuleRef}const a=r?n:new gy(br(n)),l=e||this.parentInjector;if(!s&&a.ngModule==null){const u=(r?l:this.parentInjector).get(Ys,null);u&&(s=u)}br(a.componentType??{});const h=a.create(l,i,null,s);return this.insertImpl(h.hostView,o,vy(this._hostTNode,null)),h}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,e){const i=n._lView;if(function(a){return Nn(a[ai])}(i)){const o=this.indexOf(n);if(o!==-1)this.detach(o);else{const a=i[ai],l=new xy(a,a[sn],a[ai]);l.detach(l.indexOf(n))}}const s=this._adjustIndex(t),r=this._lContainer;return Lw(r,i,s,e),n.attachToViewContainerRef(),om(vd(r),s,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=by(this._lContainer);return t!==null?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),e=Zc(this._lContainer,t);e&&(Gl(vd(this._lContainer),t),Cm(e[Gt],e))}detach(n){const t=this._adjustIndex(n,-1),e=Zc(this._lContainer,t);return e&&Gl(vd(this._lContainer),t)!=null?new ha(e):null}_adjustIndex(n,t=0){return n??this.length+t}};function by(n){return n[8]}function vd(n){return n[8]||(n[8]=[])}let zw=function(t,e,i,s){if(t[Hs])return;let r;r=8&i.type?zn(s):function(a,l){const h=a[gi],u=h.createComment(""),c=gn(l,a);return Bl(h,$c(h,c),u,function(p,f){return p.nextSibling(f)}(h,c),!1),u}(e,i),t[Hs]=r},jw=()=>!1;function Dr(n,t,e,i,s,r,o,a){const l=ii(),h=Xs(),u=n+ls,c=h.firstCreatePass?function(g,m,y,_,v,x,b,M,w){const S=m.consts,k=Yl(m,g,4,b||null,Al(S,M));Km(m,y,k,Al(S,w)),Ic(m,k);const I=k.tView=nd(2,k,_,v,x,m.directiveRegistry,m.pipeRegistry,null,m.schemas,S,null);return m.queries!==null&&(m.queries.template(m,k),I.queries=m.queries.embeddedTView(k)),k}(u,h,l,t,e,i,s,r,o):h.data[u];na(c,!1);const d=Gw(h,l,c,n);Ec()&&Kc(h,l,d,c),Ks(d,l);const p=ey(d,l,d,c);return l[u]=p,$l(l,p),function(g,m,y){return jw(g,m,y)}(p,c,l),M0(c)&&Hm(h,l,c),o!=null&&Xm(l,c,a),Dr}let Gw=function(t,e,i,s){return Tc(!0),e[gi].createComment("")};function mi(n,t,e,i){const s=ii(),r=Xs(),o=ls+n,a=s[gi],l=r.firstCreatePass?function(d,p,f,g,m,y){const _=p.consts,v=Yl(p,d,2,g,Al(_,m));return Km(p,f,v,Al(_,y)),v.attrs!==null&&dd(v,v.attrs,!1),v.mergedAttrs!==null&&dd(v,v.mergedAttrs,!0),p.queries!==null&&p.queries.elementStart(p,v),v}(o,r,s,t,e,i):r.data[o],h=qw(r,s,l,a,t,n);s[o]=h;const u=M0(l);return na(l,!0),km(a,h,l),32&~l.flags&&Ec()&&Kc(r,s,h,l),function(){return qt.lFrame.elementDepthCount}()===0&&Ks(h,s),function(){qt.lFrame.elementDepthCount++}(),u&&(Hm(r,s,l),Um(r,l,s)),i!==null&&Xm(s,l),mi}function Si(){let n=jn();L0()?function(){qt.lFrame.isParent=!1}():(n=n.parent,na(n,!1));const t=n;(function(s){return qt.skipHydrationRootTNode===s})(t)&&function(){qt.skipHydrationRootTNode=null}(),function(){qt.lFrame.elementDepthCount--}();const e=Xs();return e.firstCreatePass&&(Ic(e,n),C0(n)&&e.queries.elementEnd(n)),t.classesWithoutHost!=null&&function(s){return!!(8&s.flags)}(t)&&yy(e,t,ii(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&function(s){return!!(16&s.flags)}(t)&&yy(e,t,ii(),t.stylesWithoutHost,!1),Si}function Nr(n,t,e,i){return mi(n,t,e,i),Si(),Nr}let qw=(n,t,e,i,s,r)=>(Tc(!0),xm(i,s,function(){return qt.lFrame.currentNamespace}()));const Qs=void 0;var Vw=["en",[["a","p"],["AM","PM"],Qs],[["AM","PM"],Qs,Qs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Qs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Qs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Qs,"{1} 'at' {0}",Qs],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return e===1&&i===0?1:5}];let xd={};function rn(n){const t=function(r){return r.toLowerCase().replace(/_/g,"-")}(n);let e=wy(t);if(e)return e;const i=t.split("-")[0];if(e=wy(i),e)return e;if(i==="en")return Vw;throw new Nt(701,!1)}function wy(n){return n in xd||(xd[n]=oi.ng&&oi.ng.common&&oi.ng.common.locales&&oi.ng.common.locales[n]),xd[n]}var Ve=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Ve||{});const th="en-US";let Bw=th;function Cy(n){return!!n&&typeof n.then=="function"}function Ww(n){return!!n&&typeof n.subscribe=="function"}function eh(n=1){return function(e){return(qt.lFrame.contextLView=function(s,r){for(;s>0;)r=r[Cr],s--;return r}(e,qt.lFrame.contextLView))[Ln]}(n)}function zr(n,t=""){const e=ii(),i=Xs(),s=n+ls,r=i.firstCreatePass?Yl(i,s,1,t,null):i.data[s],o=Uw(i,e,r,t,n);e[s]=o,Ec()&&Kc(i,e,o,r),na(r,!1)}let Uw=(n,t,e,i,s)=>(Tc(!0),function(o,a){return o.createText(a)}(t[gi],i));function ih(n){return My("",n,""),ih}function My(n,t,e){const i=ii(),s=function(o,a,l,h){return pd(o,D0(),l)?a+Jg(l)+h:Ar}(i,n,t,e);return s!==Ar&&function(o,a,l){const h=k0(a,o);(function(c,d,p){c.setValue(d,p)})(o[gi],h,l)}(i,Tr(),s),My}class ca{}class Hw{}class Sy extends ca{constructor(t,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new py(this);const s=function(o,a){const l=o[g2]||null;if(!l&&a===!0)throw new Error(`Type ${fi(o)} does not have '\u0275mod' property.`);return l}(t);this._bootstrapComponents=function(o){return o instanceof Function?o():o}(s.bootstrap),this._r3Injector=fm(t,e,[{provide:ca,useValue:this},{provide:Fr,useValue:this.componentFactoryResolver},...i],fi(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Xw extends Hw{constructor(t){super(),this.moduleType=t}create(t){return new Sy(this.moduleType,t,[])}}class Zw extends ca{constructor(t){super(),this.componentFactoryResolver=new py(this),this.instance=null;const e=new Vc([...t.providers,{provide:ca,useValue:this},{provide:Fr,useValue:this.componentFactoryResolver}],t.parent||qc(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}let Yw=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=um(0,e.type),s=i.length>0?function(o,a,l=null){return new Zw({providers:o,parent:a,debugName:l,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,s)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static#t=this.\u0275prov=zt({token:n,providedIn:"environment",factory:()=>new n(ot(Ys))})}return n})();function da(n){(function(e){ly.has(e)||(ly.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))})("NgStandalone"),n.getStandaloneInjector=t=>t.get(Yw).getOrCreateStandaloneInjector(n)}let bd=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=Jw}return n})();const $w=bd,Kw=class extends $w{constructor(n,t,e){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=e}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,e){const i=function(r,o,a,l){const h=o.tView,u=Zl(r,h,a,4096&r[bt]?4096:16,null,o,null,null,null,l?.injector??null,l?.dehydratedView??null);u[kl]=r[o.index];const c=r[Ko];return c!==null&&(u[Ko]=c.createEmbeddedView(h)),cd(h,u,a),u}(this._declarationLView,this._declarationTContainer,n,{injector:t,dehydratedView:e});return new ha(i)}};function Jw(){return function(t,e){return 4&t.type?new Kw(e,t,Hl(t,e)):null}(jn(),ii())}let nh=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Hg(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Ey=new jt(""),sh=new jt("");let wd,Cd=(()=>{class n{constructor(e,i,s){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,wd||(function(o){wd=o}(s),s.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{We.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,s){let r=-1;i&&i>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==r),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:s})}whenStable(e,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,s){return[]}static#t=this.\u0275fac=function(e){return new(e||n)(ot(We),ot(Md),ot(sh))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})(),Md=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return wd?.findTestabilityInTree(this,e,i)??null}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Qw=new jt("Application Initializer");let Ty=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=Re(Qw,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const s of this.appInits){const r=s();if(Cy(r))e.push(r);else if(Ww(r)){const o=new Promise((a,l)=>{r.subscribe({complete:a,error:l})});e.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(s=>{this.reject(s)}),e.length===0&&i(),this.initialized=!0}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const tC=new jt("appBootstrapListener");function Iy(n,t){return Array.isArray(t)?t.reduce(Iy,n):{...n,...t}}let rh=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Re(qm),this.afterRenderEffectManager=Re(dy),this.componentTypes=[],this.components=[],this.isStable=Re(nh).hasPendingTasks.pipe(Ji(e=>!e)),this._injector=Re(Ys)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const s=e instanceof Pm;if(!this._injector.get(Ty).done)throw!s&&function(c){const d=br(c)||f0(c)||g0(c);return d!==null&&d.standalone}(e),new Nt(405,!1);let r;r=s?e:this._injector.get(Fr).resolveComponentFactory(e),this.componentTypes.push(r.componentType);const o=function(c){return c.isBoundToModule}(r)?void 0:this._injector.get(ca),a=r.create(aa.NULL,[],i||r.selector,o),l=a.location.nativeElement,h=a.injector.get(Ey,null);return h?.registerApplication(l),a.onDestroy(()=>{this.detachView(a.hostView),oh(this.components,a),h?.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Nt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{try{this.afterRenderEffectManager.execute()}catch(e){this.internalErrorHandler(e)}this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;oh(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(tC,[]);[...this._bootstrapListeners,...i].forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>oh(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Nt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oh(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let eC=(()=>{class n{constructor(){this.zone=Re(We),this.applicationRef=Re(rh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iC(){const n=Re(We),t=Re(Or);return e=>n.runOutsideAngular(()=>t.handleError(e))}let nC=(()=>{class n{constructor(){this.subscription=new be,this.initialized=!1,this.zone=Re(We),this.pendingTasks=Re(nh)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{We.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{We.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Sd=new jt("LocaleId",{providedIn:"root",factory:()=>Re(Sd,Lt.Optional|Lt.SkipSelf)||function(){return typeof $localize<"u"&&$localize.locale||th}()}),ky=new jt("PlatformDestroyListeners");let Py=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const s=function(o="zone.js",a){return o==="noop"?new kw:o==="zone.js"?new We(a):o}(i?.ngZone,function(o){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:o?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:o?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const r=function(l,h,u){return new Sy(l,h,u)}(e.moduleType,this.injector,function(l){return[{provide:We,useFactory:l},{provide:ql,multi:!0,useFactory:()=>{const h=Re(eC,{optional:!0});return()=>h.initialize()}},{provide:ql,multi:!0,useFactory:()=>{const h=Re(nC);return()=>{h.initialize()}}},{provide:qm,useFactory:iC}]}(()=>s)),o=r.injector.get(Or,null);return s.runOutsideAngular(()=>{const a=s.onError.subscribe({next:l=>{o.handleError(l)}});r.onDestroy(()=>{oh(this._modules,r),a.unsubscribe()})}),function(l,h,u){try{const c=u();return Cy(c)?c.catch(d=>{throw h.runOutsideAngular(()=>l.handleError(d)),d}):c}catch(c){throw h.runOutsideAngular(()=>l.handleError(c)),c}}(o,s,()=>{const a=r.injector.get(Ty);return a.runInitializers(),a.donePromise.then(()=>(function(h){m2(h,"Expected localeId to be defined"),typeof h=="string"&&(Bw=h.toLowerCase().replace(/_/g,"-"))}(r.injector.get(Sd,th)||th),this._moduleDoBootstrap(r),r))})})}bootstrapModule(e,i=[]){const s=Iy({},i);return function(o,a,l){const h=new Xw(l);return Promise.resolve(h)}(0,0,e).then(r=>this.bootstrapModuleFactory(r,s))}_moduleDoBootstrap(e){const i=e.injector.get(rh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Nt(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Nt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(ky,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#t=this.\u0275fac=function(e){return new(e||n)(ot(aa))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),pa=null;const Ry=new jt("AllowMultipleToken");function Fy(n,t,e=[]){const i=`Platform: ${t}`,s=new jt(i);return(r=[])=>{let o=Oy();if(!o||o.injector.get(Ry,!1)){const a=[...e,...r,{provide:s,useValue:!0}];n?n(a):function(h){if(pa&&!pa.get(Ry,!1))throw new Nt(400,!1);(function(){(function(p){Pe=p})(()=>{throw new Nt(600,!1)})})(),pa=h;const u=h.get(Py);(function(d){d.get(gm,null)?.forEach(p=>p())})(h)}(function(h=[],u){return aa.create({name:u,providers:[{provide:jc,useValue:"platform"},{provide:ky,useValue:new Set([()=>pa=null])},...h]})}(a,i))}return function(l){const h=Oy();if(!h)throw new Nt(401,!1);return h}()}}function Oy(){return pa?.get(Py)??null}const sC=Fy(null,"core",[]);let rC=(()=>{class n{constructor(e){}static#t=this.\u0275fac=function(e){return new(e||n)(ot(rh))};static#e=this.\u0275mod=xr({type:n});static#i=this.\u0275inj=vr({})}return n})(),Ed=null;function Td(){return Ed}class oC{}const ds=new jt("DocumentToken");var li=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(li||{}),ge=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(ge||{}),Ei=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Ei||{}),Gn=function(n){return n[n.Decimal=0]="Decimal",n[n.Group=1]="Group",n[n.List=2]="List",n[n.PercentSign=3]="PercentSign",n[n.PlusSign=4]="PlusSign",n[n.MinusSign=5]="MinusSign",n[n.Exponential=6]="Exponential",n[n.SuperscriptingExponent=7]="SuperscriptingExponent",n[n.PerMille=8]="PerMille",n[n.Infinity=9]="Infinity",n[n.NaN=10]="NaN",n[n.TimeSeparator=11]="TimeSeparator",n[n.CurrencyDecimal=12]="CurrencyDecimal",n[n.CurrencyGroup=13]="CurrencyGroup",n}(Gn||{});function ah(n,t){return ji(rn(n)[Ve.DateFormat],t)}function lh(n,t){return ji(rn(n)[Ve.TimeFormat],t)}function hh(n,t){return ji(rn(n)[Ve.DateTimeFormat],t)}function uh(n,t){const e=rn(n),i=e[Ve.NumberSymbols][t];if(typeof i>"u"){if(t===Gn.CurrencyDecimal)return e[Ve.NumberSymbols][Gn.Decimal];if(t===Gn.CurrencyGroup)return e[Ve.NumberSymbols][Gn.Group]}return i}function Ay(n){if(!n[Ve.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Ve.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ji(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function Id(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const aC=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,fa={},lC=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var qn=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(qn||{}),$t=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}($t||{}),Kt=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(Kt||{});function hC(n,t,e,i){let s=function(u){if(Ny(u))return u;if(typeof u=="number"&&!isNaN(u))return new Date(u);if(typeof u=="string"){if(u=u.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(u)){const[f,g=1,m=1]=u.split("-").map(y=>+y);return ch(f,g-1,m)}const d=parseFloat(u);if(!isNaN(u-d))return new Date(d);let p;if(p=u.match(aC))return function(g){const m=new Date(0);let y=0,_=0;const v=g[8]?m.setUTCFullYear:m.setFullYear,x=g[8]?m.setUTCHours:m.setHours;g[9]&&(y=Number(g[9]+g[10]),_=Number(g[9]+g[11])),v.call(m,Number(g[1]),Number(g[2])-1,Number(g[3]));const b=Number(g[4]||0)-y,M=Number(g[5]||0)-_,w=Number(g[6]||0),S=Math.floor(1e3*parseFloat("0."+(g[7]||0)));return x.call(m,b,M,w,S),m}(p)}const c=new Date(u);if(!Ny(c))throw new Error(`Unable to convert "${u}" into a date`);return c}(n);t=Vn(e,t)||t;let r,o=[];for(;t;){if(r=lC.exec(t),!r){o.push(t);break}{o=o.concat(r.slice(1));const h=o.pop();if(!h)break;t=h}}let a=s.getTimezoneOffset();i&&(a=Dy(i,a),s=function(u,c,d){const p=d?-1:1,f=u.getTimezoneOffset();return function(m,y){return(m=new Date(m.getTime())).setMinutes(m.getMinutes()+y),m}(u,p*(Dy(c,f)-f))}(s,i,!0));let l="";return o.forEach(h=>{const u=function(d){if(Pd[d])return Pd[d];let p;switch(d){case"G":case"GG":case"GGG":p=ve(Kt.Eras,ge.Abbreviated);break;case"GGGG":p=ve(Kt.Eras,ge.Wide);break;case"GGGGG":p=ve(Kt.Eras,ge.Narrow);break;case"y":p=Be($t.FullYear,1,0,!1,!0);break;case"yy":p=Be($t.FullYear,2,0,!0,!0);break;case"yyy":p=Be($t.FullYear,3,0,!1,!0);break;case"yyyy":p=Be($t.FullYear,4,0,!1,!0);break;case"Y":p=gh(1);break;case"YY":p=gh(2,!0);break;case"YYY":p=gh(3);break;case"YYYY":p=gh(4);break;case"M":case"L":p=Be($t.Month,1,1);break;case"MM":case"LL":p=Be($t.Month,2,1);break;case"MMM":p=ve(Kt.Months,ge.Abbreviated);break;case"MMMM":p=ve(Kt.Months,ge.Wide);break;case"MMMMM":p=ve(Kt.Months,ge.Narrow);break;case"LLL":p=ve(Kt.Months,ge.Abbreviated,li.Standalone);break;case"LLLL":p=ve(Kt.Months,ge.Wide,li.Standalone);break;case"LLLLL":p=ve(Kt.Months,ge.Narrow,li.Standalone);break;case"w":p=kd(1);break;case"ww":p=kd(2);break;case"W":p=kd(1,!0);break;case"d":p=Be($t.Date,1);break;case"dd":p=Be($t.Date,2);break;case"c":case"cc":p=Be($t.Day,1);break;case"ccc":p=ve(Kt.Days,ge.Abbreviated,li.Standalone);break;case"cccc":p=ve(Kt.Days,ge.Wide,li.Standalone);break;case"ccccc":p=ve(Kt.Days,ge.Narrow,li.Standalone);break;case"cccccc":p=ve(Kt.Days,ge.Short,li.Standalone);break;case"E":case"EE":case"EEE":p=ve(Kt.Days,ge.Abbreviated);break;case"EEEE":p=ve(Kt.Days,ge.Wide);break;case"EEEEE":p=ve(Kt.Days,ge.Narrow);break;case"EEEEEE":p=ve(Kt.Days,ge.Short);break;case"a":case"aa":case"aaa":p=ve(Kt.DayPeriods,ge.Abbreviated);break;case"aaaa":p=ve(Kt.DayPeriods,ge.Wide);break;case"aaaaa":p=ve(Kt.DayPeriods,ge.Narrow);break;case"b":case"bb":case"bbb":p=ve(Kt.DayPeriods,ge.Abbreviated,li.Standalone,!0);break;case"bbbb":p=ve(Kt.DayPeriods,ge.Wide,li.Standalone,!0);break;case"bbbbb":p=ve(Kt.DayPeriods,ge.Narrow,li.Standalone,!0);break;case"B":case"BB":case"BBB":p=ve(Kt.DayPeriods,ge.Abbreviated,li.Format,!0);break;case"BBBB":p=ve(Kt.DayPeriods,ge.Wide,li.Format,!0);break;case"BBBBB":p=ve(Kt.DayPeriods,ge.Narrow,li.Format,!0);break;case"h":p=Be($t.Hours,1,-12);break;case"hh":p=Be($t.Hours,2,-12);break;case"H":p=Be($t.Hours,1);break;case"HH":p=Be($t.Hours,2);break;case"m":p=Be($t.Minutes,1);break;case"mm":p=Be($t.Minutes,2);break;case"s":p=Be($t.Seconds,1);break;case"ss":p=Be($t.Seconds,2);break;case"S":p=Be($t.FractionalSeconds,1);break;case"SS":p=Be($t.FractionalSeconds,2);break;case"SSS":p=Be($t.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":p=ph(qn.Short);break;case"ZZZZZ":p=ph(qn.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":p=ph(qn.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":p=ph(qn.Long);break;default:return null}return Pd[d]=p,p}(h);l+=u?u(s,e,a):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function ch(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Vn(n,t){const e=function(r){return rn(r)[Ve.LocaleId]}(n);if(fa[e]=fa[e]||{},fa[e][t])return fa[e][t];let i="";switch(t){case"shortDate":i=ah(n,Ei.Short);break;case"mediumDate":i=ah(n,Ei.Medium);break;case"longDate":i=ah(n,Ei.Long);break;case"fullDate":i=ah(n,Ei.Full);break;case"shortTime":i=lh(n,Ei.Short);break;case"mediumTime":i=lh(n,Ei.Medium);break;case"longTime":i=lh(n,Ei.Long);break;case"fullTime":i=lh(n,Ei.Full);break;case"short":const s=Vn(n,"shortTime"),r=Vn(n,"shortDate");i=dh(hh(n,Ei.Short),[s,r]);break;case"medium":const o=Vn(n,"mediumTime"),a=Vn(n,"mediumDate");i=dh(hh(n,Ei.Medium),[o,a]);break;case"long":const l=Vn(n,"longTime"),h=Vn(n,"longDate");i=dh(hh(n,Ei.Long),[l,h]);break;case"full":const u=Vn(n,"fullTime"),c=Vn(n,"fullDate");i=dh(hh(n,Ei.Full),[u,c])}return i&&(fa[e][t]=i),i}function dh(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return t!=null&&i in t?t[i]:e})),n}function on(n,t,e="-",i,s){let r="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,r=e));let o=String(n);for(;o.length<t;)o="0"+o;return i&&(o=o.slice(o.length-t)),r+o}function Be(n,t,e=0,i=!1,s=!1){return function(r,o){let a=function(u,c){switch(u){case $t.FullYear:return c.getFullYear();case $t.Month:return c.getMonth();case $t.Date:return c.getDate();case $t.Hours:return c.getHours();case $t.Minutes:return c.getMinutes();case $t.Seconds:return c.getSeconds();case $t.FractionalSeconds:return c.getMilliseconds();case $t.Day:return c.getDay();default:throw new Error(`Unknown DateType value "${u}".`)}}(n,r);if((e>0||a>-e)&&(a+=e),n===$t.Hours)a===0&&e===-12&&(a=12);else if(n===$t.FractionalSeconds)return function(u,c){return on(u,3).substring(0,c)}(a,t);const l=uh(o,Gn.MinusSign);return on(a,t,l,i,s)}}function ve(n,t,e=li.Format,i=!1){return function(s,r){return function(a,l,h,u,c,d){switch(h){case Kt.Months:return function(m,y,_){const v=rn(m),x=ji([v[Ve.MonthsFormat],v[Ve.MonthsStandalone]],y);return ji(x,_)}(l,c,u)[a.getMonth()];case Kt.Days:return function(m,y,_){const v=rn(m),x=ji([v[Ve.DaysFormat],v[Ve.DaysStandalone]],y);return ji(x,_)}(l,c,u)[a.getDay()];case Kt.DayPeriods:const p=a.getHours(),f=a.getMinutes();if(d){const g=function(v){const x=rn(v);return Ay(x),(x[Ve.ExtraData][2]||[]).map(b=>typeof b=="string"?Id(b):[Id(b[0]),Id(b[1])])}(l),m=function(v,x,b){const M=rn(v);Ay(M);const w=ji([M[Ve.ExtraData][0],M[Ve.ExtraData][1]],x)||[];return ji(w,b)||[]}(l,c,u),y=g.findIndex(_=>{if(Array.isArray(_)){const[v,x]=_,b=p>=v.hours&&f>=v.minutes,M=p<x.hours||p===x.hours&&f<x.minutes;if(v.hours<x.hours){if(b&&M)return!0}else if(b||M)return!0}else if(_.hours===p&&_.minutes===f)return!0;return!1});if(y!==-1)return m[y]}return function(m,y,_){const v=rn(m),x=ji([v[Ve.DayPeriodsFormat],v[Ve.DayPeriodsStandalone]],y);return ji(x,_)}(l,c,u)[p<12?0:1];case Kt.Eras:return function(m,y){return ji(rn(m)[Ve.Eras],y)}(l,u)[a.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${h}`)}}(s,r,n,t,e,i)}}function ph(n){return function(t,e,i){const s=-1*i,r=uh(e,Gn.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case qn.Short:return(s>=0?"+":"")+on(o,2,r)+on(Math.abs(s%60),2,r);case qn.ShortGMT:return"GMT"+(s>=0?"+":"")+on(o,1,r);case qn.Long:return"GMT"+(s>=0?"+":"")+on(o,2,r)+":"+on(Math.abs(s%60),2,r);case qn.Extended:return i===0?"Z":(s>=0?"+":"")+on(o,2,r)+":"+on(Math.abs(s%60),2,r);default:throw new Error(`Unknown zone width "${n}"`)}}}const uC=0,fh=4;function Ly(n){return ch(n.getFullYear(),n.getMonth(),n.getDate()+(fh-n.getDay()))}function kd(n,t=!1){return function(e,i){let s;if(t){const r=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+r)/7)}else{const r=Ly(e),o=function(h){const u=ch(h,uC,1).getDay();return ch(h,0,1+(u<=fh?fh:fh+7)-u)}(r.getFullYear()),a=r.getTime()-o.getTime();s=1+Math.round(a/6048e5)}return on(s,n,uh(i,Gn.MinusSign))}}function gh(n,t=!1){return function(e,i){return on(Ly(e).getFullYear(),n,uh(i,Gn.MinusSign),t)}}const Pd={};function Dy(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function Ny(n){return n instanceof Date&&!isNaN(n.valueOf())}function zy(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[s,r]=i==-1?[e,""]:[e.slice(0,i),e.slice(i+1)];if(s.trim()===t)return decodeURIComponent(r)}return null}class cC{constructor(t,e,i,s){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=s}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let jy=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,s){this._viewContainer=e,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((s,r,o)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new cC(s.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)i.remove(r===null?void 0:r);else if(r!==null){const a=i.get(r);i.move(a,o),Gy(a,s)}});for(let s=0,r=i.length;s<r;s++){const o=i.get(s).context;o.index=s,o.count=r,o.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{Gy(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,i){return!0}static#t=this.\u0275fac=function(e){return new(e||n)(Le(_d),Le(bd),Le(Dm))};static#e=this.\u0275dir=p0({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function Gy(n,t){n.context.$implicit=t.item}let Rd=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new dC,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){qy("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){qy("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#t=this.\u0275fac=function(e){return new(e||n)(Le(_d),Le(bd))};static#e=this.\u0275dir=p0({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class dC{constructor(){this.$implicit=null,this.ngIf=null}}function qy(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${fi(t)}'.`)}const pC=new jt("DATE_PIPE_DEFAULT_TIMEZONE"),fC=new jt("DATE_PIPE_DEFAULT_OPTIONS");let gC=(()=>{class n{constructor(e,i,s){this.locale=e,this.defaultTimezone=i,this.defaultOptions=s}transform(e,i,s,r){if(e==null||e===""||e!=e)return null;try{return hC(e,i??this.defaultOptions?.dateFormat??"mediumDate",r||this.locale,s??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch{throw function(l,h){return new Nt(2100,!1)}()}}static#t=this.\u0275fac=function(e){return new(e||n)(Le(Sd,16),Le(pC,24),Le(fC,24))};static#e=this.\u0275pipe=F2({name:"date",type:n,pure:!0,standalone:!0})}return n})(),ga=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275mod=xr({type:n});static#i=this.\u0275inj=vr({})}return n})();const Vy="browser";function By(n){return n==="server"}class Wy{}class mC extends oC{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Fd extends mC{static makeCurrent(){(function(e){Ed||(Ed=e)})(new Fd)}onAndCancel(t,e,i){return t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){const e=function(){return ma=ma||document.querySelector("base"),ma?ma.getAttribute("href"):null}();return e==null?null:function(s){return new URL(s,document.baseURI).pathname}(e)}resetBaseElement(){ma=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return zy(document.cookie,t)}}let ma=null,yC=(()=>{class n{build(){return new XMLHttpRequest}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const Od=new jt("EventManagerPlugins");let Uy=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(s=>{s.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,s){return this._findPluginFor(i).addEventListener(e,i,s)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(s=>s.supports(e)),!i)throw new Nt(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#t=this.\u0275fac=function(e){return new(e||n)(ot(Od),ot(We))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();class Hy{constructor(t){this._doc=t}}const Ad="ng-app-id";let Xy=(()=>{class n{constructor(e,i,s,r={}){this.doc=e,this.appId=i,this.nonce=s,this.platformId=r,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=By(r),this.resetHostNodes()}addStyles(e){for(const i of e)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(s=>s.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${Ad}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(e,i){const s=this.styleRef;if(s.has(e)){const r=s.get(e);return r.usage+=i,r.usage}return s.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const s=this.styleNodesInDOM,r=s?.get(i);if(r?.parentNode===e)return s.delete(i),r.removeAttribute(Ad),r;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Ad,this.appId),e.appendChild(o),o}}addStyleToHost(e,i){const s=this.getStyleElement(e,i),r=this.styleRef,o=r.get(i)?.elements;o?o.push(s):r.set(i,{elements:[s],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ds),ot(Hc),ot(mm,8),ot(Pr))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const Ld={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Dd=/%COMP%/g,_C=new jt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function Zy(n,t){return t.map(e=>e.replace(Dd,n))}let Yy=(()=>{class n{constructor(e,i,s,r,o,a,l,h=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=r,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=By(a),this.defaultRenderer=new Nd(e,o,l,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===On.ShadowDom&&(i={...i,encapsulation:On.Emulated});const s=this.getOrCreateRenderer(e,i);return s instanceof Ky?s.applyToHost(e):s instanceof zd&&s.applyStyles(),s}getOrCreateRenderer(e,i){const s=this.rendererByCompId;let r=s.get(i.id);if(!r){const o=this.doc,a=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,c=this.platformIsServer;switch(i.encapsulation){case On.Emulated:r=new Ky(l,h,i,this.appId,u,o,a,c);break;case On.ShadowDom:return new vC(l,h,e,i,o,a,this.nonce,c);default:r=new zd(l,h,i,u,o,a,c)}s.set(i.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}static#t=this.\u0275fac=function(e){return new(e||n)(ot(Uy),ot(Xy),ot(Hc),ot(_C),ot(ds),ot(Pr),ot(We),ot(mm))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();class Nd{constructor(t,e,i,s){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=s,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(Ld[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){($y(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&($y(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i=typeof t=="string"?this.doc.querySelector(t):t;if(!i)throw new Nt(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,s){if(s){e=s+":"+e;const r=Ld[s];r?t.setAttributeNS(r,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const s=Ld[i];s?t.removeAttributeNS(s,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,s){s&($s.DashCase|$s.Important)?t.style.setProperty(e,i,s&$s.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&$s.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t!=null&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i){if(typeof t=="string"&&!(t=Td().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(i))}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))===!1&&e.preventDefault()}}}function $y(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}class vC extends Nd{constructor(t,e,i,s,r,o,a,l){super(t,r,o,l),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const h=Zy(s.id,s.styles);for(const u of h){const c=document.createElement("style");a&&c.setAttribute("nonce",a),c.textContent=u,this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class zd extends Nd{constructor(t,e,i,s,r,o,a,l){super(t,r,o,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=s,this.styles=l?Zy(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Ky extends zd{constructor(t,e,i,s,r,o,a,l){const h=s+"-"+i.id;super(t,e,i,r,o,a,l,h),this.contentAttr=function(c){return"_ngcontent-%COMP%".replace(Dd,c)}(h),this.hostAttr=function(c){return"_nghost-%COMP%".replace(Dd,c)}(h)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let xC=(()=>{class n extends Hy{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,s){return e.addEventListener(i,s,!1),()=>this.removeEventListener(e,i,s)}removeEventListener(e,i,s){return e.removeEventListener(i,s)}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ds))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const Jy=["alt","control","meta","shift"],bC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wC={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let CC=(()=>{class n extends Hy{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,i,s){const r=n.parseEventName(i),o=n.eventCallback(r.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Td().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),s=i.shift();if(i.length===0||s!=="keydown"&&s!=="keyup")return null;const r=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),Jy.forEach(h=>{const u=i.indexOf(h);u>-1&&(i.splice(u,1),o+=h+".")}),o+=r,i.length!=0||r.length===0)return null;const l={};return l.domEventName=s,l.fullKey=o,l}static matchEventFullKeyCode(e,i){let s=bC[e.key]||e.key,r="";return i.indexOf("code.")>-1&&(s=e.code,r="code."),!(s==null||!s)&&(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Jy.forEach(o=>{o!==s&&(0,wC[o])(e)&&(r+=o+".")}),r+=s,r===i)}static eventCallback(e,i,s){return r=>{n.matchEventFullKeyCode(r,e)&&s.runGuarded(()=>i(r))}}static _normalizeKey(e){return e==="esc"?"escape":e}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ds))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const MC=Fy(sC,"browser",[{provide:Pr,useValue:Vy},{provide:gm,useValue:function(){Fd.makeCurrent()},multi:!0},{provide:ds,useFactory:function(){return function(e){Uc=e}(document),document},deps:[]}]),SC=new jt(""),EC=[{provide:sh,useClass:class{addToWindow(t){oi.getAngularTestability=(e,i=!0)=>{const s=t.findTestabilityInTree(e,i);if(s==null)throw new Nt(5103,!1);return s},oi.getAllAngularTestabilities=()=>t.getAllTestabilities(),oi.getAllAngularRootElements=()=>t.getAllRootElements(),oi.frameworkStabilizers||(oi.frameworkStabilizers=[]),oi.frameworkStabilizers.push(e=>{const i=oi.getAllAngularTestabilities();let s=i.length,r=!1;const o=function(a){r=r||a,s--,s==0&&e(r)};i.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(t,e,i){return e==null?null:t.getTestability(e)??(i?Td().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:Ey,useClass:Cd,deps:[We,Md,sh]},{provide:Cd,useClass:Cd,deps:[We,Md,sh]}],TC=[{provide:jc,useValue:"root"},{provide:Or,useFactory:function(){return new Or},deps:[]},{provide:Od,useClass:xC,multi:!0,deps:[ds,We,Pr]},{provide:Od,useClass:CC,multi:!0,deps:[ds]},Yy,Xy,Uy,{provide:Rm,useExisting:Yy},{provide:Wy,useClass:yC,deps:[]},[]];let IC=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:Hc,useValue:e.appId}]}}static#t=this.\u0275fac=function(e){return new(e||n)(ot(SC,12))};static#e=this.\u0275mod=xr({type:n});static#i=this.\u0275inj=vr({providers:[...TC,...EC],imports:[ga,rC]})}return n})();typeof window<"u";const yn=class{constructor(t){this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},jd=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function ps(n,t){return n>t?1:n<t?-1:0}function Gd(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let s=1;s<i;++s){const r=n[s];if(r===t)return s;if(r<t)return e(t,n[s-1],r)>0?s-1:s}return i-1}if(e>0){for(let s=1;s<i;++s)if(n[s]<t)return s-1;return i-1}if(e<0){for(let s=1;s<i;++s)if(n[s]<=t)return s;return i-1}for(let s=1;s<i;++s){if(n[s]==t)return s;if(n[s]<t)return n[s-1]-t<t-n[s]?s-1:s}return i-1}function kC(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function _n(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let s=0;s<i;s++)n[n.length]=e[s]}function fs(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function jr(){return!0}function Gr(){return!1}function qr(){}function Qy(n){let t,e,i,s=!1;return function(){const r=Array.prototype.slice.call(arguments);return(!s||this!==i||!fs(r,e))&&(s=!0,i=this,e=r,t=n.apply(this,arguments)),t}}function mh(n){return function(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}()}function ya(n){for(const t in n)delete n[t]}function gs(n){let t;for(t in n)return!1;return!t}const yh=class extends jd{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),s=i[t]||(i[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,s=this.listeners_&&this.listeners_[i];if(!s)return;const r=e?new yn(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;i in o||(o[i]=0,a[i]=0),++o[i];for(let h=0,u=s.length;h<u;++h)if(l="handleEvent"in s[h]?s[h].handleEvent(r):s[h].call(this,r),l===!1||r.propagationStopped){l=!1;break}if(--o[i]==0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,qr);delete o[i]}return l}disposeInternal(){this.listeners_&&ya(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const s=i.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[s]=qr,++this.pendingRemovals_[t]):(i.splice(s,1),i.length===0&&delete this.listeners_[t]))}};function Dt(n,t,e,i,s){if(i&&i!==n&&(e=e.bind(i)),s){const o=e;e=function(){n.removeEventListener(t,e),o.apply(this,arguments)}}const r={target:n,type:t,listener:e};return n.addEventListener(t,e),r}function _h(n,t,e,i){return Dt(n,t,e,i,!0)}function me(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),ya(n))}const t1=class extends yh{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent("change")}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=Dt(this,t[r],e);return s}return Dt(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const s=t.length;i=new Array(s);for(let r=0;r<s;++r)i[r]=_h(this,t[r],e)}else i=_h(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)(function(r){if(Array.isArray(r))for(let o=0,a=r.length;o<a;++o)me(r[o]);else me(r)})(i);else if(Array.isArray(t))for(let s=0,r=t.length;s<r;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}};function gt(){throw new Error("Unimplemented abstract method.")}let PC=0;function wt(n){return n.ol_uid||(n.ol_uid=String(++PC))}class e1 extends yn{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const an=class extends t1{constructor(t){super(),wt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new e1(i,t,e)),i="propertychange",this.hasListener(i)&&this.dispatchEvent(new e1(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const s=this.values_||(this.values_={});if(i)s[t]=e;else{const r=s[t];s[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],gs(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};class vh extends yn{constructor(t,e,i){super(t),this.element=e,this.index=i}}const vn=class extends an{constructor(t,e){if(super(),this.unique_=!!(e=e||{}).unique,this.array_=t||[],this.unique_)for(let i=0,s=this.array_.length;i<s;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,s=e.length;i<s;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get("length")}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new vh("add",e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,s=e.length;i<s;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new vh("remove",e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new vh("remove",i,t)),this.dispatchEvent(new vh("add",e,t))}updateLength_(){this.set("length",this.array_.length)}assertUnique_(t,e){for(let i=0,s=this.array_.length;i<s;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},ms=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",RC=ms.includes("firefox"),FC=(ms.includes("safari")&&!ms.includes("chrom")&&(ms.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ms)),ms.includes("webkit")&&!ms.includes("edge")),i1=ms.includes("macintosh"),n1=typeof devicePixelRatio<"u"?devicePixelRatio:1,qd=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,s1=typeof Image<"u"&&Image.prototype.decode,r1=function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n}();function Vt(n,t){if(!n)throw new Error(t)}const o1=new Array(6);function a1(n){return xh(n,1,0,0,1,0,0)}function Vd(n,t){const e=n[0],i=n[1],s=n[2],r=n[3],o=n[4],a=n[5],l=t[0],h=t[1],u=t[2],c=t[3],d=t[4],p=t[5];return n[0]=e*l+s*h,n[1]=i*l+r*h,n[2]=e*u+s*c,n[3]=i*u+r*c,n[4]=e*d+s*p+o,n[5]=i*d+r*p+a,n}function xh(n,t,e,i,s,r,o){return n[0]=t,n[1]=e,n[2]=i,n[3]=s,n[4]=r,n[5]=o,n}function Ue(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function Bd(n,t,e){return Vd(n,xh(o1,t,0,0,e,0,0))}function Bn(n,t,e,i,s,r,o,a){const l=Math.sin(r),h=Math.cos(r);return n[0]=i*h,n[1]=s*l,n[2]=-i*l,n[3]=s*h,n[4]=o*i*h-a*i*l+t,n[5]=o*s*l+a*s*h+e,n}function Wd(n,t){const e=function(u){return u[0]*u[3]-u[1]*u[2]}(t);Vt(e!==0,"Transformation matrix cannot be inverted");const i=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5];return n[0]=o/e,n[1]=-s/e,n[2]=-r/e,n[3]=i/e,n[4]=(r*l-o*a)/e,n[5]=-(i*l-s*a)/e,n}let l1;function h1(n){const t="matrix("+n.join(", ")+")";if(qd)return t;const e=l1||(l1=document.createElement("div"));return e.style.transform=t,e.style.transform}const Xe={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function _a(n){const t=[1/0,1/0,-1/0,-1/0];for(let e=0,i=n.length;e<i;++e)va(t,n[e]);return t}function ys(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function u1(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function tr(n,t,e){let i,s;return i=t<n[0]?n[0]-t:n[2]<t?t-n[2]:0,s=e<n[1]?n[1]-e:n[3]<e?e-n[3]:0,i*i+s*s}function bh(n,t){return Ud(n,t[0],t[1])}function _s(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function Ud(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Hd(n,t){const e=t[0],i=t[1];let s=Xe.UNKNOWN;return e<n[0]?s|=Xe.LEFT:e>n[2]&&(s|=Xe.RIGHT),i<n[1]?s|=Xe.BELOW:i>n[3]&&(s|=Xe.ABOVE),s===Xe.UNKNOWN&&(s=Xe.INTERSECTING),s}function xn(n,t,e,i,s){return s?(s[0]=n,s[1]=t,s[2]=e,s[3]=i,s):[n,t,e,i]}function Vr(n){return xn(1/0,1/0,-1/0,-1/0,n)}function c1(n,t){const e=n[0],i=n[1];return xn(e,i,e,i,t)}function Xd(n,t,e,i,s){return p1(Vr(s),n,t,e,i)}function Br(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function d1(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function va(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function p1(n,t,e,i,s){for(;e<i;e+=s)OC(n,t[e],t[e+1]);return n}function OC(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function Zd(n,t){let e;return e=t(Wr(n)),!!(e||(e=t(xa(n)),e)||(e=t(ba(n)),e)||(e=t(Gi(n)),e))&&e}function Yd(n){let t=0;return wa(n)||(t=ee(n)*Ti(n)),t}function Wr(n){return[n[0],n[1]]}function xa(n){return[n[2],n[1]]}function ln(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function AC(n,t){let e;if(t==="bottom-left")e=Wr(n);else if(t==="bottom-right")e=xa(n);else if(t==="top-left")e=Gi(n);else{if(t!=="top-right")throw new Error("Invalid corner");e=ba(n)}return e}function $d(n,t,e,i,s){const[r,o,a,l,h,u,c,d]=Kd(n,t,e,i);return xn(Math.min(r,a,h,c),Math.min(o,l,u,d),Math.max(r,a,h,c),Math.max(o,l,u,d),s)}function Kd(n,t,e,i){const s=t*i[0]/2,r=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=s*o,h=s*a,u=r*o,c=r*a,d=n[0],p=n[1];return[d-l+c,p-h-u,d-l-c,p-h+u,d+l-c,p+h+u,d+l+c,p+h-u,d-l+c,p-h-u]}function Ti(n){return n[3]-n[1]}function er(n,t,e){const i=e||[1/0,1/0,-1/0,-1/0];return Fe(n,t)?(i[0]=n[0]>t[0]?n[0]:t[0],i[1]=n[1]>t[1]?n[1]:t[1],i[2]=n[2]<t[2]?n[2]:t[2],i[3]=n[3]<t[3]?n[3]:t[3]):Vr(i),i}function Gi(n){return[n[0],n[3]]}function ba(n){return[n[2],n[3]]}function ee(n){return n[2]-n[0]}function Fe(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function wa(n){return n[2]<n[0]||n[3]<n[1]}function f1(n,t,e,i){if(wa(n))return Vr(e);let s=[];if(i>1){const a=n[2]-n[0],l=n[3]-n[1];for(let h=0;h<i;++h)s.push(n[0]+a*h/i,n[1],n[2],n[1]+l*h/i,n[2]-a*h/i,n[3],n[0],n[3]-l*h/i)}else s=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];t(s,s,2);const r=[],o=[];for(let a=0,l=s.length;a<l;a+=2)r.push(s[a]),o.push(s[a+1]);return function(l,h,u){return xn(Math.min.apply(null,l),Math.min.apply(null,h),Math.max.apply(null,l),Math.max.apply(null,h),u)}(r,o,e)}function g1(n,t){const e=t.getExtent(),i=ln(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const s=ee(e),r=Math.floor((i[0]-e[0])/s)*s;n[0]-=r,n[2]-=r}return n}const Ca={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Ur={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Ur.max=Ur.whitepoint[2].D65,Ur.rgb=function(n,t){var e,i,s,r=n[0]/(t=t||Ur.whitepoint[2].E)[0],o=n[1]/t[1],a=n[2]/t[2];return i=-.96924363628087*r+1.87596750150772*o+.041555057407175*a,s=.055630079696993*r+-.20397695888897*o+1.056971514242878*a,e=(e=3.240969941904521*r+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(s=Math.min(Math.max(0,s),1))]},Ca.xyz=function(n,t){var e=n[0]/255,i=n[1]/255,s=n[2]/255;return[(.41239079926595*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.35758433938387*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.18048078840183*(s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92))*(t=t||Ur.whitepoint[2].E)[0],(.21263900587151*e+.71516867876775*i+.072192315360733*s)*t[1],(.019330818715591*e+.11919477979462*i+.95053215224966*s)*t[2]]};const hn=Ur,Jd={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(n,t,e){var i,s,r,o,a,l,h;return(r=n[0])===0?[0,0,0]:(i=n[1]/(13*r)+4*(a=hn.whitepoint[e=e||2][t=t||"D65"][0])/(a+15*(l=hn.whitepoint[e][t][1])+3*(h=hn.whitepoint[e][t][2]))||0,s=n[2]/(13*r)+9*l/(a+15*l+3*h)||0,[9*(o=r>8?l*Math.pow((r+16)/116,3):l*r*.0011070564598794539)*i/(4*s)||0,o,o*(12-3*i-20*s)/(4*s)||0])}};hn.luv=function(n,t,e){var i,s,r,o,a,l,h,u,c,d,p;d=4*(h=hn.whitepoint[e=e||2][t=t||"D65"][0])/(h+15*(u=hn.whitepoint[e][t][1])+3*(c=hn.whitepoint[e][t][2])),p=9*u/(h+15*u+3*c),i=4*(o=n[0])/(o+15*(a=n[1])+3*(l=n[2]))||0,s=9*a/(o+15*a+3*l)||0;var f=a/u;return[r=f<=.008856451679035631?903.2962962962961*f:116*Math.pow(f,1/3)-16,13*r*(i-d),13*r*(s-p)]};var m1={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(n){var t,e=n[1];return t=n[2]/360*2*Math.PI,[n[0],e*Math.cos(t),e*Math.sin(t)]},xyz:function(n){return Jd.xyz(m1.luv(n))}};const LC=m1;Jd.lchuv=function(n){var t=n[0],e=n[1],i=n[2],s=Math.sqrt(e*e+i*i),r=360*Math.atan2(i,e)/2/Math.PI;return r<0&&(r+=360),[t,s,r]},hn.lchuv=function(n){return Jd.lchuv(hn.luv(n))};var y1=ke(605);const DC=function(t){var e,i,s=[],r=1;if(typeof t=="number")return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(typeof t=="number")return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),y1[t])s=y1[t].slice(),i="rgb";else if(t==="transparent")r=0,i="rgb",s=[0,0,0];else if(t[0]==="#"){var o=t.slice(1),a=o.length;r=1,a<=4?(s=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],a===4&&(r=parseInt(o[3]+o[3],16)/255)):(s=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],a===8&&(r=parseInt(o[6]+o[7],16)/255)),s[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var l=(i=e[1].replace(/a$/,""))==="cmyk"?4:i==="gray"?1:3;s=e[2].trim().split(/\s*[,\/]\s*|\s+/),i==="color"&&(i=s.shift()),r=(s=s.map(function(h,u){if(h[h.length-1]==="%")return h=parseFloat(h)/100,u===3?h:i==="rgb"?255*h:i[0]==="h"||i[0]==="l"&&!u?100*h:i==="lab"?125*h:i==="lch"?u<2?150*h:360*h:i[0]!=="o"||u?i==="oklab"?.4*h:i==="oklch"?u<2?.4*h:360*h:h:h;if(i[u]==="h"||u===2&&i[i.length-1]==="h"){if(_1[h]!==void 0)return _1[h];if(h.endsWith("deg"))return parseFloat(h);if(h.endsWith("turn"))return 360*parseFloat(h);if(h.endsWith("grad"))return 360*parseFloat(h)/400;if(h.endsWith("rad"))return 180*parseFloat(h)/Math.PI}return h==="none"?0:parseFloat(h)})).length>l?s.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(s=t.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:s,alpha:r}};var _1={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Qd={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var t,e,i,s,r,o=n[0]/360,a=n[1]/100,l=n[2]/100,h=0;if(a===0)return[r=255*l,r,r];for(t=2*l-(e=l<.5?l*(1+a):l+a-l*a),s=[0,0,0];h<3;)(i=o+1/3*-(h-1))<0?i++:i>1&&i--,s[h++]=255*(r=6*i<1?t+6*(e-t)*i:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t);return s}};function Te(n,t,e){return Math.min(Math.max(n,t),e)}function NC(n,t,e,i,s,r){const o=s-e,a=r-i;if(o!==0||a!==0){const l=((n-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=s,i=r):l>0&&(e+=o*l,i+=a*l)}return Wn(n,t,e,i)}function Wn(n,t,e,i){const s=e-n,r=i-t;return s*s+r*r}function wh(n){return n*Math.PI/180}function Hr(n,t){const e=n%t;return e*t<0?e+t:e}function Ii(n,t,e){return n+e*(t-n)}function Ch(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function Mh(n,t){return Math.floor(Ch(n,t))}function Sh(n,t){return Math.ceil(Ch(n,t))}function v1(n){return typeof n=="string"?n:w1(n)}Ca.hsl=function(n){var t,e,i=n[0]/255,s=n[1]/255,r=n[2]/255,o=Math.min(i,s,r),a=Math.max(i,s,r),l=a-o;return a===o?t=0:i===a?t=(s-r)/l:s===a?t=2+(r-i)/l:r===a&&(t=4+(i-s)/l),(t=Math.min(60*t,360))<0&&(t+=360),e=(o+a)/2,[t,100*(a===o?0:e<=.5?l/(a+o):l/(2-a-o)),100*e]};const zC=1024,Ma={};let tp=0;function jC(n){if(n.length===4)return n;const t=n.slice();return t[3]=1,t}function x1(n){const t=hn.lchuv(Ca.xyz(n));return t[3]=n[3],t}function ep(n){if(Ma.hasOwnProperty(n))return Ma[n];if(tp>=zC){let e=0;for(const i in Ma)3&e++||(delete Ma[i],--tp)}const t=function(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var s,r=DC(i);if(!r.space)return[];const o=r.space[0]==="h"?Qd.min:Ca.min,a=r.space[0]==="h"?Qd.max:Ca.max;return(s=Array(3))[0]=Math.min(Math.max(r.values[0],o[0]),a[0]),s[1]=Math.min(Math.max(r.values[1],o[1]),a[1]),s[2]=Math.min(Math.max(r.values[2],o[2]),a[2]),r.space[0]==="h"&&(s=Qd.rgb(s)),s.push(Math.min(Math.max(r.alpha,0),1)),s}(n);if(t.length!==4)throw new Error('Failed to parse "'+n+'" as color');for(const e of t)if(isNaN(e))throw new Error('Failed to parse "'+n+'" as color');return b1(t),Ma[n]=t,++tp,t}function Eh(n){return Array.isArray(n)?n:ep(n)}function b1(n){return n[0]=Te(n[0]+.5|0,0,255),n[1]=Te(n[1]+.5|0,0,255),n[2]=Te(n[2]+.5|0,0,255),n[3]=Te(n[3],0,1),n}function w1(n){let t=n[0];t!=(0|t)&&(t=t+.5|0);let e=n[1];e!=(0|e)&&(e=e+.5|0);let i=n[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+t+","+e+","+i+","+(n[3]===void 0?1:Math.round(100*n[3])/100)+")"}function C1(n,t,e){return t+":"+n+":"+(e?v1(e):"null")}const Th=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_)!(3&t++)&&!this.cache_[e].hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}get(t,e,i){const s=C1(t,e,i);return s in this.cache_?this.cache_[s]:null}set(t,e,i,s){const r=C1(t,e,i);this.cache_[r]=s,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},M1=class extends an{constructor(t){super(),this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e.opacity=t.opacity!==void 0?t.opacity:1,Vt(typeof e.opacity=="number","Layer opacity must be a number"),e.visible=t.visible===void 0||t.visible,e.zIndex=t.zIndex,e.maxResolution=t.maxResolution!==void 0?t.maxResolution:1/0,e.minResolution=t.minResolution!==void 0?t.minResolution:0,e.minZoom=t.minZoom!==void 0?t.minZoom:-1/0,e.maxZoom=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0||t},i=this.getZIndex();return e.opacity=Te(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i!==void 0||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return gt()}getLayerStatesArray(t){return gt()}getExtent(){return this.get("extent")}getMaxResolution(){return this.get("maxResolution")}getMinResolution(){return this.get("minResolution")}getMinZoom(){return this.get("minZoom")}getMaxZoom(){return this.get("maxZoom")}getOpacity(){return this.get("opacity")}getSourceState(){return gt()}getVisible(){return this.get("visible")}getZIndex(){return this.get("zIndex")}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set("extent",t)}setMaxResolution(t){this.set("maxResolution",t)}setMinResolution(t){this.set("minResolution",t)}setMaxZoom(t){this.set("maxZoom",t)}setMinZoom(t){this.set("minZoom",t)}setOpacity(t){Vt(typeof t=="number","Layer opacity must be a number"),this.set("opacity",t)}setVisible(t){this.set("visible",t)}setZIndex(t){this.set("zIndex",t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},un={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},S1=42,ip=256,Xr={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},Un=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Xr[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Sa=6378137,Zr=Math.PI*Sa,GC=[-Zr,-Zr,Zr,Zr],qC=[-180,-85,180,85],Ih=Sa*Math.log(Math.tan(Math.PI/2));class Yr extends Un{constructor(t){super({code:t,units:"m",extent:GC,global:!0,worldExtent:qC,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Sa)}})}}const E1=[new Yr("EPSG:3857"),new Yr("EPSG:102100"),new Yr("EPSG:102113"),new Yr("EPSG:900913"),new Yr("http://www.opengis.net/def/crs/EPSG/0/3857"),new Yr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function VC(n,t,e){const i=n.length;e=e>1?e:2,t===void 0&&(t=e>2?n.slice():new Array(i));for(let s=0;s<i;s+=e){t[s]=Zr*n[s]/180;let r=Sa*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));r>Ih?r=Ih:r<-Ih&&(r=-Ih),t[s+1]=r}return t}function BC(n,t,e){const i=n.length;e=e>1?e:2,t===void 0&&(t=e>2?n.slice():new Array(i));for(let s=0;s<i;s+=e)t[s]=180*n[s]/Zr,t[s+1]=360*Math.atan(Math.exp(n[s+1]/Sa))/Math.PI-90;return t}const T1=[-180,-90,180,90],WC=6378137*Math.PI/180;class ir extends Un{constructor(t,e){super({code:t,units:"degrees",extent:T1,axisOrientation:e,global:!0,metersPerUnit:WC,worldExtent:T1})}}const I1=[new ir("CRS:84"),new ir("EPSG:4326","neu"),new ir("urn:ogc:def:crs:OGC:1.3:CRS84"),new ir("urn:ogc:def:crs:OGC:2:84"),new ir("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ir("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ir("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let np={},$r={};function Kr(n,t,e){const i=n.getCode(),s=t.getCode();i in $r||($r[i]={}),$r[i][s]=e}function k1(n,t){let e;return n in $r&&t in $r[n]&&(e=$r[n][t]),e}function kh(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function sp(n,t){const e=Math.cos(t),i=Math.sin(t),s=n[1]*e+n[0]*i;return n[0]=n[0]*e-n[1]*i,n[1]=s,n}function P1(n,t){const e=n[0]-t[0],i=n[1]-t[1];return e*e+i*i}function R1(n,t){return Math.sqrt(P1(n,t))}function rp(n,t){if(t.canWrapX()){const e=ee(t.getExtent()),i=F1(n,t,e);i&&(n[0]-=i*e)}return n}function F1(n,t,e){const i=t.getExtent();let s=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||ee(i),s=Math.floor((n[0]-i[0])/e)),s}const UC=63710088e-1;function O1(n,t,e){e=e||UC;const i=wh(n[1]),s=wh(t[1]),r=(s-i)/2,o=wh(t[0]-n[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const A1={info:1,warn:2,error:3,none:4};let HC=A1.info;function L1(...n){HC>A1.warn||console.warn(...n)}let op=!0;function D1(n){op=!(n===void 0||n)}function ap(n,t){if(t!==void 0)for(let e=0,i=n.length;e<i;++e)t[e]=n[e];else t=n.slice();return t}function N1(n,t){if(t!==void 0&&n!==t){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];n=t}return n}function z1(n){(function(e,i){np[e]=i})(n.getCode(),n),Kr(n,n,ap)}function Bt(n){return typeof n=="string"?function(e){return np[e]||np[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}(n):n||null}function j1(n,t,e,i){let s;const r=(n=Bt(n)).getPointResolutionFunc();if(r){if(s=r(t,e),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(s=s*o/Xr[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")s=t;else{const a=Ea(n,Bt("EPSG:4326"));if(a===N1&&o!=="degrees")s=t*n.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2),s=(O1(h.slice(0,2),h.slice(2,4))+O1(h.slice(4,6),h.slice(6,8)))/2}const l=i?Xr[i]:n.getMetersPerUnit();l!==void 0&&(s/=l)}}return s}function lp(n){(function(e){e.forEach(z1)})(n),n.forEach(function(t){n.forEach(function(e){t!==e&&Kr(t,e,ap)})})}function hp(n,t){return n?typeof n=="string"?Bt(n):n:Bt(t)}function G1(n){return function(t,e,i){const s=t.length;i=i!==void 0?i:2,e=e!==void 0?e:new Array(s);for(let r=0;r<s;r+=i){const o=n(t.slice(r,r+i)),a=o.length;for(let l=0,h=i;l<h;++l)e[r+l]=l>=a?t[r+l]:o[l]}return e}}function XC(n,t,e,i){const s=Bt(n),r=Bt(t);Kr(s,r,G1(e)),Kr(r,s,G1(i))}function q1(n,t){return D1(),Ph(n,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function vs(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||Ea(n,t)===ap)&&e}function Ea(n,t){let e=k1(n.getCode(),t.getCode());return e||(e=N1),e}function Jr(n,t){return Ea(Bt(n),Bt(t))}function Ph(n,t,e){return Jr(t,e)(n,void 0,n.length)}function V1(n,t,e,i){return f1(n,Jr(t,e),void 0,i)}let qi=null;function Ta(){return qi}function up(n,t){return qi?Ph(n,t,qi):n}function Vi(n,t){return qi?Ph(n,qi,t):(op&&!kh(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(op=!1,L1("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function cp(n,t){return qi?V1(n,t,qi):n}function nr(n,t){return qi?V1(n,qi,t):n}function ZC(n,t){if(!qi)return n;const e=Bt(t).getMetersPerUnit(),i=qi.getMetersPerUnit();return e&&i?n*e/i:n}function B1(n,t,e){return function(i){let s,r;if(n.canWrapX()){const o=n.getExtent(),a=ee(o);r=F1(i=i.slice(0),n,a),r&&(i[0]=i[0]-r*a),i[0]=Te(i[0],o[0],o[2]),i[1]=Te(i[1],o[1],o[3]),s=e(i)}else s=e(i);return r&&t.canWrapX()&&(s[0]+=r*ee(t.getExtent())),s}}function W1(n,t,e){return function(i,s,r,o,a){if(!i)return;if(!s&&!t)return i;const l=t?0:r[0]*s,h=t?0:r[1]*s,u=a?a[0]:0,c=a?a[1]:0;let d=n[0]+l/2+u,p=n[2]-l/2+u,f=n[1]+h/2+c,g=n[3]-h/2+c;d>p&&(d=(p+d)/2,p=d),f>g&&(f=(g+f)/2,g=f);let m=Te(i[0],d,p),y=Te(i[1],f,g);if(o&&e&&s){const _=30*s;m+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-p)/_),y+=-_*Math.log(1+Math.max(0,f-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-g)/_)}return[m,y]}}function YC(n){return n}function dp(n,t,e,i){const s=ee(t)/e[0],r=Ti(t)/e[1];return i?Math.min(n,Math.max(s,r)):Math.min(n,Math.min(s,r))}function pp(n,t,e){let i=Math.min(n,t);return i*=Math.log(1+50*Math.max(0,n/t-1))/50+1,e&&(i=Math.max(i,e),i/=Math.log(1+50*Math.max(0,e/n-1))/50+1),Te(i,e/2,2*t)}function U1(n,t,e,i,s){return e=e===void 0||e,function(r,o,a,l){if(r!==void 0){const h=i?dp(n,i,a,s):n;return e&&l?pp(r,h,t):Te(r,t,h)}}}function fp(n){if(n!==void 0)return 0}function H1(n){if(n!==void 0)return n}function X1(n){return Math.pow(n,3)}function Qr(n){return 1-X1(1-n)}function $C(n){return 3*n*n-2*n*n*n}function KC(n){return n}function xs(n,t,e,i,s,r){r=r||[];let o=0;for(let a=t;a<e;a+=i){const l=n[a],h=n[a+1];r[o++]=s[0]*l+s[2]*h+s[4],r[o++]=s[1]*l+s[3]*h+s[5]}return r&&r.length!=o&&(r.length=o),r}function gp(n,t,e,i,s,r,o){o=o||[];const a=Math.cos(s),l=Math.sin(s),h=r[0],u=r[1];let c=0;for(let d=t;d<e;d+=i){const p=n[d]-h,f=n[d+1]-u;o[c++]=h+p*a-f*l,o[c++]=u+p*l+f*a;for(let g=d+2;g<d+i;++g)o[c++]=n[g]}return o&&o.length!=c&&(o.length=c),o}(function(){lp(E1),lp(I1),function(e,i,s,r){e.forEach(function(o){i.forEach(function(a){Kr(o,a,s),Kr(a,o,r)})})}(I1,E1,VC,BC)})();const Z1=[1,0,0,1,0,0],Y1=class extends an{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Qy((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(i),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return gt()}closestPointXY(t,e,i,s){return gt()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return this.closestPointXY(t[0],t[1],e=e||[NaN,NaN],1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return gt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Vr(e),this.extentRevision_=this.getRevision()}return function(i,s){return s?(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s):i}(this.extent_,t)}rotate(t,e){gt()}scale(t,e,i){gt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return gt()}getType(){return gt()}applyTransform(t){gt()}intersectsExtent(t){return gt()}translate(t,e){gt()}transform(t,e){const i=Bt(t),s=i.getUnits()=="tile-pixels"?function(r,o,a){const l=i.getExtent(),h=i.getWorldExtent(),u=Ti(h)/Ti(l);return Bn(Z1,h[0],h[3],u,-u,0,0,0),xs(r,0,r.length,a,Z1,o),Jr(i,e)(r,o,a)}:Jr(i,e);return this.applyTransform(s),this}};function sr(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function Rh(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}const bs=class extends Y1{constructor(){super(),this.layout="XY",this.stride=2}computeExtent(t){return Xd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return gt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Rh(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){gt()}setLayout(t,e,i){let s;if(t)s=Rh(t);else{for(let r=0;r<i;++r){if(e.length===0)return this.layout="XY",void(this.stride=2);e=e[0]}s=e.length,t=sr(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();gp(i,0,i.length,s,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=ln(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();(function(a,l,h,u,c,d,p,f){f=f||[];const g=p[0],m=p[1];let y=0;for(let _=l;_<h;_+=u){const v=a[_+1]-m;f[y++]=g+c*(a[_]-g),f[y++]=m+d*v;for(let x=_+2;x<_+u;++x)f[y++]=a[x]}f&&f.length!=y&&(f.length=y)})(s,0,s.length,r,t,e,i,s),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();(function(o,a,l,h,u,c,d){d=d||[];let p=0;for(let f=a;f<l;f+=h){d[p++]=o[f]+u,d[p++]=o[f+1]+c;for(let g=f+2;g<f+h;++g)d[p++]=o[g]}d&&d.length!=p&&(d.length=p)})(i,0,i.length,s,t,e,i),this.changed()}}};function $1(n,t,e,i,s,r,o){const a=n[t],l=n[t+1],h=n[e]-a,u=n[e+1]-l;let c;if(h===0&&u===0)c=t;else{const d=((s-a)*h+(r-l)*u)/(h*h+u*u);if(d>1)c=e;else{if(d>0){for(let p=0;p<i;++p)o[p]=Ii(n[t+p],n[e+p],d);return void(o.length=i)}c=t}}for(let d=0;d<i;++d)o[d]=n[c+d];o.length=i}function mp(n,t,e,i,s){let r=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],l=n[t+1],h=Wn(r,o,a,l);h>s&&(s=h),r=a,o=l}return s}function yp(n,t,e,i,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];s=mp(n,t,a,i,s),t=a}return s}function _p(n,t,e,i,s,r,o,a,l,h,u){if(t==e)return h;let c,d;if(s===0){if(d=Wn(o,a,n[t],n[t+1]),d<h){for(c=0;c<i;++c)l[c]=n[t+c];return l.length=i,d}return h}u=u||[NaN,NaN];let p=t+i;for(;p<e;)if($1(n,p-i,p,i,o,a,u),d=Wn(o,a,u[0],u[1]),d<h){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/s|0,1);if(r&&($1(n,e-i,t,i,o,a,u),d=Wn(o,a,u[0],u[1]),d<h)){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i}return h}function vp(n,t,e,i,s,r,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=e.length;c<d;++c){const p=e[c];h=_p(n,t,p,i,s,r,o,a,l,h,u),t=p}return h}function K1(n,t,e,i){for(let s=0,r=e.length;s<r;++s)n[t++]=e[s];return t}function Fh(n,t,e,i){for(let s=0,r=e.length;s<r;++s){const o=e[s];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function Ia(n,t,e,i,s){s=s||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=Fh(n,t,e[o],i);s[r++]=l,t=l}return s.length=r,s}function J1(n,t,e,i,s){s=s||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=Ia(n,t,e[o],i,s[r]);l.length===0&&(l[0]=t),s[r++]=l,t=l[l.length-1]}return s.length=r,s}function Oh(n,t,e,i,s,r,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)r[o++]=n[t],r[o++]=n[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-i];let u=0;for(;h.length>0;){const c=h.pop(),d=h.pop();let p=0;const f=n[d],g=n[d+1],m=n[c],y=n[c+1];for(let _=d+i;_<c;_+=i){const v=NC(n[_],n[_+1],f,g,m,y);v>p&&(u=_,p=v)}p>s&&(l[(u-t)/i]=1,d+i<u&&h.push(d,u),u+i<c&&h.push(u,c))}for(let c=0;c<a;++c)l[c]&&(r[o++]=n[t+c*i],r[o++]=n[t+c*i+1]);return o}function Q1(n,t,e,i,s,r,o,a){for(let l=0,h=e.length;l<h;++l){const u=e[l];o=Oh(n,t,u,i,s,r,o),a.push(o),t=u}return o}function rr(n,t){return t*Math.round(n/t)}function JC(n,t,e,i,s,r,o){if(t==e)return o;let a,l,h=rr(n[t],s),u=rr(n[t+1],s);t+=i,r[o++]=h,r[o++]=u;do if(a=rr(n[t],s),l=rr(n[t+1],s),(t+=i)==e)return r[o++]=a,r[o++]=l,o;while(a==h&&l==u);for(;t<e;){const c=rr(n[t],s),d=rr(n[t+1],s);if(t+=i,c==a&&d==l)continue;const p=a-h,f=l-u,g=c-h,m=d-u;p*m==f*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(f<0&&m<f||f==m||f>0&&m>f)?(a=c,l=d):(r[o++]=a,r[o++]=l,h=a,u=l,a=c,l=d)}return r[o++]=a,r[o++]=l,o}function xp(n,t,e,i,s,r,o,a){for(let l=0,h=e.length;l<h;++l){const u=e[l];o=JC(n,t,u,i,s,r,o),a.push(o),t=u}return o}function ws(n,t,e,i,s){s=s!==void 0?s:[];let r=0;for(let o=t;o<e;o+=i)s[r++]=n.slice(o,o+i);return s.length=r,s}function ka(n,t,e,i,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];s[r++]=ws(n,t,l,i,s[r]),t=l}return s.length=r,s}function bp(n,t,e,i,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];s[r++]=l.length===1&&l[0]===t?[]:ka(n,t,l,i,s[r]),t=l[l.length-1]}return s.length=r,s}function t_(n,t,e,i){let s=0,r=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];s+=o*a-r*l,r=a,o=l}return s/2}function e_(n,t,e,i){let s=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];s+=t_(n,t,a,i),t=a}return s}class Ah extends bs{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e===void 0||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Ah(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,s){return s<tr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),_p(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,s))}getArea(){return t_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ws(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Oh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ah(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fh(this.flatCoordinates,0,t,this.stride),this.changed()}}const i_=Ah;class wp extends bs{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new wp(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){const r=this.flatCoordinates,o=Wn(t,e,r[0],r[1]);if(o<s){const a=this.stride;for(let l=0;l<a;++l)i[l]=r[l];return i.length=a,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return c1(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Ud(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=K1(this.flatCoordinates,0,t),this.changed()}}const Hn=wp;function QC(n,t,e,i,s){return!Zd(s,function(r){return!or(n,t,e,i,r[0],r[1])})}function or(n,t,e,i,s,r){let o=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){const h=n[t],u=n[t+1];l<=r?u>r&&(h-a)*(r-l)-(s-a)*(u-l)>0&&o++:u<=r&&(h-a)*(r-l)-(s-a)*(u-l)<0&&o--,a=h,l=u}return o!==0}function Cp(n,t,e,i,s,r){if(e.length===0||!or(n,t,e[0],i,s,r))return!1;for(let o=1,a=e.length;o<a;++o)if(or(n,e[o-1],e[o],i,s,r))return!1;return!0}function Mp(n,t,e,i,s,r,o){let a,l,h,u,c,d,p;const f=s[r+1],g=[];for(let _=0,v=e.length;_<v;++_){const x=e[_];for(u=n[x-i],d=n[x-i+1],a=t;a<x;a+=i)c=n[a],p=n[a+1],(f<=d&&p<=f||d<=f&&f<=p)&&(h=(f-d)/(p-d)*(c-u)+u,g.push(h)),u=c,d=p}let m=NaN,y=-1/0;for(g.sort(ps),u=g[0],a=1,l=g.length;a<l;++a){c=g[a];const _=Math.abs(c-u);_>y&&(h=(u+c)/2,Cp(n,t,e,i,h,f)&&(m=h,y=_)),u=c}return isNaN(m)&&(m=s[r]),o?(o.push(m,f,y),o):[m,f,y]}function n_(n,t,e,i,s){let r=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Mp(n,t,l,i,s,2*o,r),t=l[l.length-1]}return r}function s_(n,t,e,i,s){let r;for(t+=i;t<e;t+=i)if(r=s(n.slice(t-i,t),n.slice(t,t+i)),r)return r;return!1}function Lh(n,t,e,i,s){const r=p1([1/0,1/0,-1/0,-1/0],n,t,e,i);return!!Fe(s,r)&&(!!(_s(s,r)||r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3])||s_(n,t,e,i,function(o,a){return function(h,u,c){let d=!1;const p=Hd(h,u),f=Hd(h,c);if(p===Xe.INTERSECTING||f===Xe.INTERSECTING)d=!0;else{const g=h[0],m=h[1],y=h[2],_=h[3],v=c[0],x=c[1],b=(x-u[1])/(v-u[0]);let M,w;f&Xe.ABOVE&&!(p&Xe.ABOVE)&&(M=v-(x-_)/b,d=M>=g&&M<=y),!d&&f&Xe.RIGHT&&!(p&Xe.RIGHT)&&(w=x-(v-y)*b,d=w>=m&&w<=_),!d&&f&Xe.BELOW&&!(p&Xe.BELOW)&&(M=v-(x-m)/b,d=M>=g&&M<=y),!d&&f&Xe.LEFT&&!(p&Xe.LEFT)&&(w=x-(v-g)*b,d=w>=m&&w<=_)}return d}(s,o,a)}))}function r_(n,t,e,i,s){return!!(Lh(n,t,e,i,s)||or(n,t,e,i,s[0],s[1])||or(n,t,e,i,s[0],s[3])||or(n,t,e,i,s[2],s[1])||or(n,t,e,i,s[2],s[3]))}function o_(n,t,e,i,s){if(!r_(n,t,e[0],i,s))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(QC(n,e[r-1],e[r],i,s)&&!Lh(n,e[r-1],e[r],i,s))return!1;return!0}function tM(n,t,e,i){for(;t<e-i;){for(let s=0;s<i;++s){const r=n[t+s];n[t+s]=n[e-i+s],n[e-i+s]=r}t+=i,e-=i}}function Sp(n,t,e,i){let s=0,r=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];s+=(a-r)*(l+o),r=a,o=l}return s===0?void 0:s>0}function Ep(n,t,e,i,s){s=s!==void 0&&s;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=Sp(n,t,a,i);if(r===0){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;t=a}return!0}function a_(n,t,e,i,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(!Ep(n,t,a,i,s))return!1;a.length&&(t=a[a.length-1])}return!0}function Dh(n,t,e,i,s){s=s!==void 0&&s;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=Sp(n,t,a,i);(r===0?s&&l||!s&&!l:s&&!l||!s&&l)&&tM(n,t,a,i),t=a}return t}function Tp(n,t,e,i,s){for(let r=0,o=e.length;r<o;++r)t=Dh(n,t,e[r],i,s);return t}function l_(n,t){const e=[];let i,s=0,r=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=Sp(n,s,l,2);if(i===void 0&&(i=h),h===i)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,s=l}return e}class Pa extends bs{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?_n(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Pa(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<tr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yp(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vp(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,s))}containsXY(t,e){return Cp(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return e_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Dh(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ka(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ln(this.getExtent());this.flatInteriorPoint_=Mp(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Hn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new i_(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,s=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new i_(e.slice(r,l),t);s.push(h),r=l}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ep(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Dh(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=xp(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Pa(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return o_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ia(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const Cs=Pa;function Nh(n){if(wa(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],s=n[3],r=[t,e,t,s,i,s,i,e,t,e];return new Pa(r,"XY",[r.length])}function zh(n,t){setTimeout(function(){n(t)},0)}function Ip(n,t,e,i,s){const r=Math.cos(-s);let o=Math.sin(-s),a=n[0]*r-n[1]*o,l=n[1]*r+n[0]*o;return a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o,[a*r-l*o,l*r+a*o]}const ki=class extends an{constructor(t){super(),t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.projection_=hp(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.nextCenter_=null,this.cancelAnchor_=void 0,t.projection&&D1(),t.center&&(t.center=Vi(t.center,this.projection_)),t.extent&&(t.extent=nr(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in un)delete e[a];this.setProperties(e,!0);const i=function(l){let h,u,c,d=l.minZoom!==void 0?l.minZoom:0,p=l.maxZoom!==void 0?l.maxZoom:28;const f=l.zoomFactor!==void 0?l.zoomFactor:2,g=l.multiWorld!==void 0&&l.multiWorld,m=l.smoothResolutionConstraint===void 0||l.smoothResolutionConstraint,y=l.showFullExtent!==void 0&&l.showFullExtent,_=hp(l.projection,"EPSG:3857"),v=_.getExtent();let x=l.constrainOnlyCenter,b=l.extent;if(!g&&!b&&_.isGlobal()&&(x=!1,b=v),l.resolutions!==void 0){const M=l.resolutions;u=M[d],c=M[p]!==void 0?M[p]:M[M.length-1],h=l.constrainResolution?function(S,k,I,R){return k=k===void 0||k,function(E,q,O,P){if(E!==void 0){const L=S[0],D=S[S.length-1],G=I?dp(L,I,O,R):L;if(P)return k?pp(E,G,D):Te(E,D,G);const $=Math.min(G,E),K=Math.floor(Gd(S,$,q));return S[K]>G&&K<S.length-1?S[K+1]:S[K]}}}(M,m,!x&&b,y):U1(u,c,m,!x&&b,y)}else{const M=(v?Math.max(ee(v),Ti(v)):360*Xr.degrees/_.getMetersPerUnit())/ip/Math.pow(2,0),w=M/Math.pow(2,28);u=l.maxResolution,u!==void 0?d=0:u=M/Math.pow(f,d),c=l.minResolution,c===void 0&&(c=l.maxZoom!==void 0?l.maxResolution!==void 0?u/Math.pow(f,p):M/Math.pow(f,p):w),p=d+Math.floor(Math.log(u/c)/Math.log(f)),c=u/Math.pow(f,p-d),h=l.constrainResolution?function(k,I,R,E,q,O){return E=E===void 0||E,R=R!==void 0?R:0,function(P,L,D,G){if(P!==void 0){const $=q?dp(I,q,D,O):I;if(G)return E?pp(P,$,R):Te(P,R,$);const K=1e-9,F=Math.ceil(Math.log(I/$)/Math.log(k)-K),N=-L*(.5-K)+.5,at=Math.min($,P),tt=Math.floor(Math.log(I/at)/Math.log(k)+N),_t=Math.max(F,tt);return Te(I/Math.pow(k,_t),R,$)}}}(f,u,c,m,!x&&b,y):U1(u,c,m,!x&&b,y)}return{constraint:h,maxResolution:u,minResolution:c,minZoom:d,zoomFactor:f}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const s=function(l){if(l.extent!==void 0)return W1(l.extent,l.constrainOnlyCenter,l.smoothExtentConstraint===void 0||l.smoothExtentConstraint);const h=hp(l.projection,"EPSG:3857");if(l.multiWorld!==!0&&h.isGlobal()){const u=h.getExtent().slice();return u[0]=-1/0,u[2]=1/0,W1(u,!1,!1)}return YC}(t),r=i.constraint,o=function(l){if(l.enableRotation===void 0||l.enableRotation){const h=l.constrainRotation;return h===void 0||h===!0?function(c){const d=c===void 0?wh(5):c;return function(p,f){return f||p===void 0?p:Math.abs(p)<=d?0:p}}():h===!1?H1:typeof h=="number"?function(c){const d=2*Math.PI/c;return function(p,f){return f?p:p!==void 0?p=Math.floor(p/d+.5)*d:void 0}}(h):H1}return fp}(t);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const s=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution();this.setCenterInternal([i[0]+r/2*(s[3]-e[3]+e[1]-s[1]),i[1]-r/2*(s[0]-e[0]+e[2]-s[2])])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let s=arguments[i];s.center&&(s=Object.assign({},s),s.center=Vi(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=Vi(s.anchor,this.getProjection())),e[i]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&typeof arguments[i-1]=="function"&&(e=arguments[i-1],--i);let s=0;for(;s<i&&!this.isDef();++s){const c=arguments[s];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(s===i)return void(e&&zh(e,!0));let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;s<i;++s){const c=arguments[s],d={start:r,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||$C,callback:e};if(c.center&&(d.sourceCenter=o,d.targetCenter=c.center.slice(),o=d.targetCenter),c.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(c.zoom),a=d.targetResolution):c.resolution&&(d.sourceResolution=a,d.targetResolution=c.resolution,a=d.targetResolution),c.rotation!==void 0){d.sourceRotation=l;const p=Hr(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+p,l=d.targetRotation}(u=d).sourceCenter&&u.targetCenter&&!kh(u.sourceCenter,u.targetCenter)||u.sourceResolution!==u.targetResolution||u.sourceRotation!==u.targetRotation?r+=d.duration:d.complete=!0,h.push(d)}var u;this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const s=this.animations_[e];if(s[0].callback&&zh(s[0].callback,!1),!t)for(let r=0,o=s.length;r<o;++r){const a=s[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const s=this.animations_[i];let r=!0;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.complete)continue;let h=l.duration>0?(t-l.start)/l.duration:1;h>=1?(l.complete=!0,h=1):r=!1;const u=l.easing(h);if(l.sourceCenter){const c=l.sourceCenter[0],d=l.sourceCenter[1],p=l.targetCenter[0],f=l.targetCenter[1];this.nextCenter_=l.targetCenter,this.targetCenter_=[c+u*(p-c),d+u*(f-d)]}if(l.sourceResolution&&l.targetResolution){const c=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),p=this.constraints_.resolution(c,0,d,!0);this.targetCenter_=this.calculateCenterZoom(p,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=c,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const c=u===1?Hr(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(c,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=c}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(r){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&zh(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const s=this.getCenterInternal();return s!==void 0&&(i=[s[0]-e[0],s[1]-e[1]],sp(i,t-this.getRotation()),function(o,a){o[0]+=+a[0],o[1]+=+a[1]}(i,e)),i}calculateCenterZoom(t,e){let i;const s=this.getCenterInternal(),r=this.getResolution();return s!==void 0&&r!==void 0&&(i=[e[0]-t*(e[0]-s[0])/r,e[1]-t*(e[1]-s[1])/r]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],s=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&up(t,this.getProjection())}getCenterInternal(){return this.get(un.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return cp(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Vt(e,"The view center is not defined");const i=this.getResolution();Vt(i!==void 0,"The view resolution is not defined");const s=this.getRotation();return Vt(s!==void 0,"The view rotation is not defined"),$d(e,i,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(un.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(nr(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=ee(t)/e[0],s=Ti(t)/e[1];return Math.max(i,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=Math.log(e/this.minResolution_)/Math.log(t);return function(s){return e/Math.pow(t,s*i)}}getRotation(){return this.get(un.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),s=Math.log(i/this.minResolution_)/e;return function(r){return Math.log(i/r)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=Ip(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,i)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,s=this.minZoom_||0;if(this.resolutions_){const r=Gd(this.resolutions_,t,1);s=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return s+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=Te(Math.floor(t),0,this.resolutions_.length-2);return this.resolutions_[e]/Math.pow(this.resolutions_[e]/this.resolutions_[e+1],Te(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Vt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t))Vt(!wa(t),"Cannot fit empty extent provided as `geometry`"),i=Nh(nr(t,this.getProjection()));else if(t.getType()==="Circle"){const s=nr(t.getExtent(),this.getProjection());i=Nh(s),i.rotate(this.getRotation(),ln(s))}else{const s=Ta();i=s?t.clone().transform(s,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),s=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let c=0,d=r.length;c<d;c+=o){const p=r[c]*i-r[c+1]*s,f=r[c]*s+r[c+1]*i;a=Math.min(a,p),l=Math.min(l,f),h=Math.max(h,p),u=Math.max(u,f)}return[a,l,h,u]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0&&e.nearest;let o;o=e.minResolution!==void 0?e.minResolution:e.maxZoom!==void 0?this.getResolutionForZoom(e.maxZoom):0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-s[1]-s[3],i[1]-s[0]-s[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,r?0:1);const h=this.getRotation(),u=Math.sin(h),c=Math.cos(h),d=ln(a);d[0]+=(s[1]-s[3])/2*l,d[1]+=(s[0]-s[2])/2*l;const p=this.getConstrainedCenter([d[0]*c-d[1]*u,d[1]*c+d[0]*u],l),f=e.callback?e.callback:qr;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},f):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),zh(f,!0))}centerOn(t,e,i){this.centerOnInternal(Vi(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Ip(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,s){let r;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=Ip(t,s,[a[0]/2+o[3],a[1]/2+o[0]],e,i);r=[t[0]-l[0],t[1]-l[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=up(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Vi(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,s,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Vi(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Vi(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(un.ROTATION)!==s&&this.set(un.ROTATION,s),this.get(un.RESOLUTION)!==o&&(this.set(un.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(un.CENTER)||!kh(this.get(un.CENTER),a))&&this.set(un.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const s=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,s,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(t===0&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,void this.applyTargetState_();i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!kh(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:t,easing:Qr,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&Vi(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function kp(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}const jh=class extends M1{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener("source",this.handleSourcePropertyChange_),this.setSource(t.source?t.source:null)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get("source")||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!this.sourceReady_&&this.getSource().getState()==="ready"&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(me(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Dt(t,"change",this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let s;!t&&i&&(t=i.getView()),e=t instanceof ki?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),s=e.layerStatesArray?e.layerStatesArray.find(o=>o.layer===this):this.getLayerState();const r=this.getExtent();return kp(s,e.viewState)&&(!r||Fe(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let s=e(t instanceof ki?t.getViewStateAndExtent():t);return Array.isArray(s)||(s=[s]),s}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(me(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(me(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Dt(t,"precompose",function(e){const i=e.frameState.layerStatesArray,s=this.getLayerState(!1);Vt(!i.some(function(r){return r.layer===s.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),i.push(s)},this),this.mapRenderKey_=Dt(this,"change",t.render,t),this.changed())}setSource(t){this.set("source",t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function eM(n,t){Th.expire()}const iM=class extends jd{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){gt()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,s=t.pixelToCoordinateTransform;Bn(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Wd(s,i)}forEachFeatureAtCoordinate(t,e,i,s,r,o,a,l){let h;const u=e.viewState;function c(x,b,M,w){return r.call(o,b,x?M:null,w)}const d=u.projection,p=rp(t.slice(),d),f=[[0,0]];if(d.canWrapX()&&s){const x=ee(d.getExtent());f.push([-x,0],[x,0])}const g=e.layerStatesArray,m=g.length,y=[],_=[];for(let x=0;x<f.length;x++)for(let b=m-1;b>=0;--b){const M=g[b],w=M.layer;if(w.hasRenderer()&&kp(M,u)&&a.call(l,w)){const S=w.getRenderer(),k=w.getSource();if(S&&k){const I=k.getWrapX()?p:t,R=c.bind(null,M.managed);_[0]=I[0]+f[x][0],_[1]=I[1]+f[x][1],h=S.forEachFeatureAtCoordinate(_,e,i,R,y)}if(h)return h}}if(y.length===0)return;const v=1/y.length;return y.forEach((x,b)=>x.distanceSq+=b*v),y.sort((x,b)=>x.distanceSq-b.distanceSq),y.some(x=>h=x.callback(x.feature,x.layer,x.geometry)),h}hasFeatureAtCoordinate(t,e,i,s,r,o){return this.forEachFeatureAtCoordinate(t,e,i,s,jr,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(t){gt()}flushDeclutterItems(t){}scheduleExpireIconCache(t){Th.canExpireCache()&&t.postRenderFunctions.push(eM)}},h_=class extends yn{constructor(t,e,i,s){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=s}},Gh="ol-hidden",Ra="ol-unselectable",u_="ol-unsupported",qh="ol-control",c_="ol-collapsed",nM=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),d_=["style","variant","weight","size","lineHeight","family"],p_=function(n){const t=n.match(nM);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,s=d_.length;i<s;++i){const r=t[i+1];r!==void 0&&(e[d_[i]]=r)}return e.families=e.family.split(/,\s?/),e};function Ke(n,t,e,i){let s;return s=e&&e.length?e.shift():qd?new OffscreenCanvas(n||300,t||300):document.createElement("canvas"),n&&(s.width=n),t&&(s.height=t),s.getContext("2d",i)}function Fa(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function sM(n){let t=n.offsetWidth;const e=getComputedStyle(n);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function rM(n){let t=n.offsetHeight;const e=getComputedStyle(n);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function Vh(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function Bh(n){return n&&n.parentNode?n.parentNode.removeChild(n):null}function f_(n){for(;n.lastChild;)n.removeChild(n.lastChild)}const g_="10px sans-serif",yi="#000",to="round",Xn=[],eo="round",Oa="#000",Aa="center",Wh="middle",ar=[0,0,0,0],bn=new an;let Pp,io=null;const Rp={},m_=function(){const n="32px ",t=["monospace","serif"],e=t.length,i="wmytzilWMYTZIL@#/&?$%10\uF013";let s,r;function o(l,h,u){let c=!0;for(let d=0;d<e;++d){const p=t[d];if(r=Uh(l+" "+h+" "+n+p,i),u!=p){const f=Uh(l+" "+h+" "+n+u+","+p,i);c=c&&f!=r}}return!!c}function a(){let l=!0;const h=bn.getKeys();for(let u=0,c=h.length;u<c;++u){const d=h[u];bn.get(d)<100&&(o.apply(this,d.split(`
`))?(ya(Rp),io=null,Pp=void 0,bn.set(d,100)):(bn.set(d,bn.get(d)+1,!0),l=!1))}l&&(clearInterval(s),s=void 0)}return function(l){const h=p_(l);if(!h)return;const u=h.families;for(let c=0,d=u.length;c<d;++c){const p=u[c],f=h.style+`
`+h.weight+`
`+p;bn.get(f)===void 0&&(bn.set(f,100,!0),o(h.style,h.weight,p)||(bn.set(f,0,!0),s===void 0&&(s=setInterval(a,32))))}}}(),oM=function(){let n;return function(t){let e=Rp[t];if(e==null){if(qd){const i=p_(t),s=y_(t,"\u017Dg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);Rp[t]=e}return e}}();function y_(n,t){return io||(io=Ke(1,1)),n!=Pp&&(io.font=n,Pp=io.font),io.measureText(t)}function Uh(n,t){return y_(n,t).width}function __(n,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((s,r)=>Math.max(s,Uh(n,r)),0);return e[t]=i,i}const aM=class extends iM{constructor(t){super(t),this.fontChangeListenerKey_=Dt(bn,"propertychange",t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Ra+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const s=new h_(t,void 0,e);i.dispatchEvent(s)}}disposeInternal(){me(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent("precompose",t);const e=t.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),i=t.viewState;this.children_.length=0;const s=this.declutterLayers_;s.length=0;let r=null;for(let o=0,a=e.length;o<a;++o){const l=e[o];t.layerIndex=o;const h=l.layer,u=h.getSourceState();if(!kp(l,i)||u!="ready"&&u!="undefined"){h.unrender();continue}const c=h.render(t,r);c&&(c!==r&&(this.children_.push(c),r=c),"getDeclutter"in h&&s.push(h))}this.flushDeclutterItems(t),function(a,l){const h=a.childNodes;for(let u=0;;++u){const c=h[u],d=l[u];if(!c&&!d)break;if(c!==d){if(!c){a.appendChild(d);continue}if(!d){a.removeChild(c),--u;continue}a.insertBefore(d,c)}}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class Ms extends yn{constructor(t,e){super(t),this.layer=e}}class Fp extends M1{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener("layers",this.handleLayersChanged_),i?Array.isArray(i)?i=new vn(i.slice(),{unique:!0}):Vt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new vn(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(me),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Dt(t,"add",this.handleLayersAdd_,this),Dt(t,"remove",this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(me);ya(this.listenerKeys_);const e=t.getArray();for(let i=0,s=e.length;i<s;i++){const r=e[i];this.registerLayerListeners_(r),this.dispatchEvent(new Ms("addlayer",r))}this.changed()}registerLayerListeners_(t){const e=[Dt(t,"propertychange",this.handleLayerChange_,this),Dt(t,"change",this.handleLayerChange_,this)];t instanceof Fp&&e.push(Dt(t,"addlayer",this.handleLayerGroupAdd_,this),Dt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[wt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ms("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ms("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ms("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=wt(e);this.listenerKeys_[i].forEach(me),delete this.listenerKeys_[i],this.dispatchEvent(new Ms("removelayer",e)),this.changed()}getLayers(){return this.get("layers")}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let s=0,r=i.length;s<r;++s)this.dispatchEvent(new Ms("removelayer",i[s]))}this.set("layers",t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const s=this.getLayerState();let r=s.zIndex;!t&&s.zIndex===void 0&&(r=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=s.opacity,l.visible=l.visible&&s.visible,l.maxResolution=Math.min(l.maxResolution,s.maxResolution),l.minResolution=Math.max(l.minResolution,s.minResolution),l.minZoom=Math.max(l.minZoom,s.minZoom),l.maxZoom=Math.min(l.maxZoom,s.maxZoom),s.extent!==void 0&&(l.extent=l.extent!==void 0?er(l.extent,s.extent):s.extent),l.zIndex===void 0&&(l.zIndex=r)}return e}getSourceState(){return"ready"}}const La=Fp,no=class extends yn{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}},Zn=class extends no{constructor(t,e,i,s,r,o){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0&&s,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},ie={SINGLECLICK:"singleclick",CLICK:"click",DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},lM=class extends yh{constructor(t,e){super(t),this.map_=t,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=Dt(i,"pointerdown",this.handlePointerDown_,this),this.relayedListenerKey_=Dt(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener("touchmove",this.boundHandleTouchMove_,!!r1&&{passive:!1})}emulateClick_(t){let e=new Zn(ie.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Zn(ie.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Zn(ie.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==ie.POINTERUP||e.type==ie.POINTERCANCEL){delete this.trackedTouches_[i];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==e.target){delete this.trackedTouches_[s];break}}else(e.type==ie.POINTERDOWN||e.type==ie.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Zn(ie.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(me),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new Zn(ie.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Dt(i,ie.POINTERMOVE,this.handlePointerMove_,this),Dt(i,ie.POINTERUP,this.handlePointerUp_,this),Dt(this.element_,ie.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Dt(this.element_.getRootNode(),ie.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Zn(ie.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Zn(ie.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(me(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener("touchmove",this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(me(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(me),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Op=1/0,hM=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ya(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const s=this.keyFunction_(i);return delete this.queuedElements_[s],i}enqueue(t){Vt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Op&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,s=e.length,r=e[t],o=i[t],a=t;for(;t<s>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),u=h<s&&i[h]<i[l]?h:l;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,s=this.priorities_,r=i[e],o=s[e];for(;e>t;){const a=this.getParentIndex_(e);if(!(s[a]>o))break;i[e]=i[a],s[e]=s[a],e=a}i[e]=r,s[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let s=0;const r=e.length;let o,a,l;for(a=0;a<r;++a)o=e[a],l=t(o),l==Op?delete this.queuedElements_[this.keyFunction_(o)]:(i[s]=l,e[s++]=o);e.length=s,i.length=s,this.heapify_()}},Y={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},uM=class extends hM{constructor(t,e){super(function(i){return t.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener("change",this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===Y.LOADED||i===Y.ERROR||i===Y.EMPTY){i!==Y.ERROR&&e.removeEventListener("change",this.boundHandleTileChange_);const s=e.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,s,r,o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;)s=this.dequeue()[0],r=s.getKey(),i=s.getState(),i===Y.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,s.load())}},Da=class extends an{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Bh(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Bh(this.element);for(let e=0,i=this.listenerKeys.length;e<i;++e)me(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==qr&&this.listenerKeys.push(Dt(t,"postrender",this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}},cM=class extends Da{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed===void 0||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible===void 0||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",s=t.expandClassName!==void 0?t.expandClassName:e+"-expand",r=t.collapseLabel!==void 0?t.collapseLabel:"\u203A",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=s):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener("click",this.handleClick_.bind(this),!1);const h=this.element;h.className=e+" "+Ra+" "+qh+(this.collapsed_&&this.collapsible_?" "+c_:"")+(this.collapsible_?"":" ol-uncollapsible"),h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(s=>s.getAttributions(t)))),i=!this.getMap().getAllLayers().some(s=>s.getSource()&&s.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!fs(e,this.renderedAttributions_)){f_(this.ulElement_);for(let s=0,r=e.length;s<r;++s){const o=document.createElement("li");o.innerHTML=e[s],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(c_),this.collapsed_?Vh(this.collapseLabel_,this.label_):Vh(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},dM=class extends Da{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"\u21E7",s=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(s));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener("click",this.handleClick_.bind(this),!1);const a=this.element;a.className=e+" "+Ra+" "+qh,a.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide===void 0||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Gh)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();e!==void 0&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Qr}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const s="rotate("+i+"rad)";if(this.autoHide_){const r=this.element.classList.contains(Gh);r||i!==0?r&&i!==0&&this.element.classList.remove(Gh):this.element.classList.add(Gh)}this.label_.style.transform=s}this.rotation_=i}},pM=class extends Da{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,s=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",r=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"\u2013",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener("click",this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=h,c.appendChild(typeof a=="string"?document.createTextNode(a):a),c.addEventListener("click",this.handleClick_.bind(this,-i),!1);const d=this.element;d.className=e+" "+Ra+" "+qh,d.appendChild(u),d.appendChild(c),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(i!==void 0){const s=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:s,duration:this.duration_,easing:Qr})):e.setZoom(s)}}};function v_(n){n=n||{};const t=new vn;return(n.zoom===void 0||n.zoom)&&t.push(new pM(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&t.push(new dM(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&t.push(new cM(n.attributionOptions)),t}function Ap(n,t,e,i){const s=n.getZoom();if(s===void 0)return;const r=n.getConstrainedZoom(s+t),o=n.getResolutionForZoom(r);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Qr})}const Na=class extends an{constructor(t){super(),t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get("active")}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set("active",t)}setMap(t){this.map_=t}},fM=class extends Na{constructor(t){super(),this.delta_=(t=t||{}).delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==ie.DBLCLICK){const i=t.originalEvent,s=t.coordinate,r=i.shiftKey?-this.delta_:this.delta_;Ap(t.map.getView(),r,s,this.duration_),i.preventDefault(),e=!0}return!e}};function Lp(n){const t=n.length;let e=0,i=0;for(let s=0;s<t;s++)e+=n[s].clientX,i+=n[s].clientY;return{clientX:e/t,clientY:i/t}}const so=class extends Na{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ie.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ie.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==ie.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==ie.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Dp(n){const t=arguments;return function(e){let i=!0;for(let s=0,r=t.length;s<r&&(i=i&&t[s](e),i);++s);return i}}const gM=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},x_=function(n){return!n.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(n)},Np=jr,b_=function(n){const t=n.originalEvent;return t.button==0&&!(FC&&i1&&t.ctrlKey)},mM=Gr,zp=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},w_=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},C_=function(n){const t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},jp=function(n){const t=n.originalEvent;return Vt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},yM=function(n){const t=n.originalEvent;return Vt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0},_M=class extends so{constructor(t){super({stopDown:Gr}),this.kinetic_=(t=t||{}).kinetic,this.lastCentroid=null,this.panning_=!1;const e=t.condition?t.condition:Dp(zp,yM);this.condition_=t.onFocusOnly?Dp(x_,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,s=e.getEventPixel(Lp(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const r=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],o=t.map.getView();(function(l,h){l[0]*=h,l[1]*=h})(r,o.getResolution()),sp(r,o.getRotation()),o.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-s*Math.cos(r),a[1]-s*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Qr})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},vM=class extends so{constructor(t){t=t||{},super({stopDown:Gr}),this.condition_=t.condition?t.condition:gM,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!jp(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===fp)return;const s=e.getSize(),r=t.pixel,o=Math.atan2(s[1]/2-r[1],r[0]-s[0]/2);this.lastAngle_!==void 0&&i.adjustRotationInternal(-(o-this.lastAngle_)),this.lastAngle_=o}handleUpEvent(t){return!jp(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!(jp(t)&&b_(t)&&this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)}},xM=class extends jd{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+i,s.top=Math.min(t[1],e[1])+i,s.width=Math.abs(e[0]-t[0])+i,s.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Cs([i])}getGeometry(){return this.geometry_}};class Gp extends yn{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const bM=class extends so{constructor(t){super(),this.box_=new xM((t=t||{}).className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:b_,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const s=i[0]-e[0],r=i[1]-e[1];return s*s+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Gp("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Gp(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Gp("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},wM=class extends bM{constructor(t){super({condition:(t=t||{}).condition?t.condition:w_,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=e.rotatedExtentForGeometry(i),r=e.getResolutionForExtentInternal(s),o=e.getResolution()/r;i=i.clone(),i.scale(o*o)}e.fitInternal(i,{duration:this.duration_,easing:Qr})}},CM=class extends Na{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return zp(e)&&C_(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type=="keydown"){const i=t.originalEvent,s=i.key;if(this.condition_(t)&&(s=="ArrowDown"||s=="ArrowLeft"||s=="ArrowRight"||s=="ArrowUp")){const r=t.map.getView(),o=r.getResolution()*this.pixelDelta_;let a=0,l=0;s=="ArrowDown"?l=-o:s=="ArrowLeft"?a=-o:s=="ArrowRight"?a=o:l=o;const h=[a,l];sp(h,r.getRotation()),function(c,d,p){const f=c.getCenterInternal();f&&c.animateInternal({duration:p!==void 0?p:250,easing:KC,center:c.getConstrainedCenter([f[0]+d[0],f[1]+d[1]])})}(r,h,this.duration_),i.preventDefault(),e=!0}}return!e}},MM=class extends Na{constructor(t){super(),this.condition_=(t=t||{}).condition?t.condition:function(e){return!function(i){const s=i.originalEvent;return i1?s.metaKey:s.ctrlKey}(e)&&C_(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type=="keydown"||t.type=="keypress"){const i=t.originalEvent,s=i.key;if(this.condition_(t)&&(s==="+"||s==="-")){const r=s==="+"?this.delta_:-this.delta_;Ap(t.map.getView(),r,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},SM=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const s=this.points_[e+2]-this.points_[i+2];if(s<1e3/60)return!1;const r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},EM=class extends Na{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor===void 0||t.useAnchor,this.constrainResolution_=t.constrainResolution!==void 0&&t.constrainResolution;const e=t.condition?t.condition:Np;this.condition_=t.onFocusOnly?Dp(x_,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!=="wheel")return!0;const e=t.map,i=t.originalEvent;let s;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type=="wheel"&&(s=i.deltaY,RC&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=n1),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const r=Date.now();this.startTime_===void 0&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=e.getView();if(this.mode_==="trackpad"&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=s;const a=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),a),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-Te(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Ap(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},TM=class extends so{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Gr),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],s=this.targetPointers[1],r=Math.atan2(s.clientY-i.clientY,s.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=r-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=r;const o=t.map,a=o.getView();a.getConstraints().rotation!==fp&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Lp(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},IM=class extends so{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Gr),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],s=this.targetPointers[1],r=i.clientX-s.clientX,o=i.clientY-s.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Lp(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_,this.lastScaleDelta_>1?1:-1),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function M_(n){return n[0]>0&&n[1]>0}function ni(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}function S_(n){n instanceof jh?n.setMapInternal(null):n instanceof La&&n.getLayers().forEach(S_)}function E_(n,t){if(n instanceof jh)n.setMapInternal(t);else if(n instanceof La){const e=n.getLayers().getArray();for(let i=0,s=e.length;i<s;++i)E_(e[i],t)}}const ro=class extends an{constructor(t){super();const e=function(r){let o=null;r.keyboardEventTarget!==void 0&&(o=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);const a={},l=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new La({layers:r.layers});let h,u,c;return a.layergroup=l,a.target=r.target,a.view=r.view instanceof ki?r.view:new ki,r.controls!==void 0&&(Array.isArray(r.controls)?h=new vn(r.controls.slice()):(Vt(typeof r.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),h=r.controls)),r.interactions!==void 0&&(Array.isArray(r.interactions)?u=new vn(r.interactions.slice()):(Vt(typeof r.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),u=r.interactions)),r.overlays!==void 0?Array.isArray(r.overlays)?c=new vn(r.overlays.slice()):(Vt(typeof r.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),c=r.overlays):c=new vn,{controls:h,interactions:u,keyboardEventTarget:o,overlays:c,values:a}}(t=t||{});this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:n1,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||v_(),this.interactions=e.interactions||function(r){r=r||{};const o=new vn,a=new SM(-.005,.05,100);return(r.altShiftDragRotate===void 0||r.altShiftDragRotate)&&o.push(new vM),(r.doubleClickZoom===void 0||r.doubleClickZoom)&&o.push(new fM({delta:r.zoomDelta,duration:r.zoomDuration})),(r.dragPan===void 0||r.dragPan)&&o.push(new _M({onFocusOnly:r.onFocusOnly,kinetic:a})),(r.pinchRotate===void 0||r.pinchRotate)&&o.push(new TM),(r.pinchZoom===void 0||r.pinchZoom)&&o.push(new IM({duration:r.zoomDuration})),(r.keyboard===void 0||r.keyboard)&&(o.push(new CM),o.push(new MM({delta:r.zoomDelta,duration:r.zoomDuration}))),(r.mouseWheelZoom===void 0||r.mouseWheelZoom)&&o.push(new EM({onFocusOnly:r.onFocusOnly,duration:r.zoomDuration})),(r.shiftDragZoom===void 0||r.shiftDragZoom)&&o.push(new wM({duration:r.zoomDuration})),o}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new uM(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener("layergroup",this.handleLayerGroupChanged_),this.addChangeListener("view",this.handleViewChanged_),this.addChangeListener("size",this.handleSizeChanged_),this.addChangeListener("target",this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof ki)&&t.view.then(function(s){i.setView(new ki(s))}),this.controls.addEventListener("add",s=>{s.element.setMap(this)}),this.controls.addEventListener("remove",s=>{s.element.setMap(null)}),this.interactions.addEventListener("add",s=>{s.element.setMap(this)}),this.interactions.addEventListener("remove",s=>{s.element.setMap(null)}),this.overlays_.addEventListener("add",s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener("remove",s=>{const r=s.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){E_(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(t);return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,(i=i!==void 0?i:{}).hitTolerance!==void 0?i.hitTolerance:0,i.checkWrapped!==!1,e,null,i.layerFilter!==void 0?i.layerFilter:jr,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(s){i.push(s)},e),i}getAllLayers(){const t=[];return function e(i){i.forEach(function(s){s instanceof La?e(s.getLayers()):t.push(s)})}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,(e=e!==void 0?e:{}).hitTolerance!==void 0?e.hitTolerance:0,e.checkWrapped!==!1,e.layerFilter!==void 0?e.layerFilter:jr,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/(e.width/i[0]),(s.clientY-e.top)/(e.height/i[1])]}getTarget(){return this.get("target")}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return up(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Ue(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get("layergroup")}setLayers(t){const e=this.getLayerGroup();if(t instanceof vn)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const s=t[e];if(!s.visible)continue;const r=s.layer.getRenderer();if(r&&!r.ready)return!0;const o=s.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Vi(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Ue(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get("size")}getView(){return this.get("view")}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,s){return function(o,a,l,h,u){if(!o||!(l in o.wantedTiles)||!o.wantedTiles[l][a.getKey()])return Op;const c=o.viewState.center,d=h[0]-c[0],p=h[1]-c[1];return 65536*Math.log(u)+Math.sqrt(d*d+p*p)/u}(this.frameState_,t,e,i,s)}handleBrowserEvent(t,e){const i=new Zn(e=e||t.type,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i==="pointerdown"||i==="wheel"||i==="keydown"){const s=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():s,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(r===s?s.documentElement:r).contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const s=this.getInteractions().getArray().slice();for(let r=s.length-1;r>=0;r--){const o=s[r];if(o.getMap()===this&&o.getActive()&&this.getTargetElement()&&(!o.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let s=this.maxTilesLoading_,r=s;if(t){const o=t.viewHints;if(o[0]||o[1]){const a=Date.now()-t.time>8;s=a?0:8,r=a?0:2}}e.getTilesLoading()<s&&(e.reprioritize(),e.loadMoreTiles(s,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener("rendercomplete")&&this.renderer_.dispatchRenderEvent("rendercomplete",t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new no("loadend",this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new no("loadstart",this,t))));const i=this.postRenderFunctions_;for(let s=0,r=i.length;s<r;++s)i[s](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,s=this.targetChangeHandlerKeys_.length;i<s;++i)me(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener("contextmenu",this.boundHandleBrowserEvent_),this.viewport_.removeEventListener("wheel",this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Bh(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new aM(this)),this.mapBrowserEventHandler_=new lM(this,this.moveTolerance_);for(const r in ie)this.mapBrowserEventHandler_.addEventListener(ie[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener("contextmenu",this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener("wheel",this.boundHandleBrowserEvent_,!!r1&&{passive:!1});const i=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[Dt(i,"keydown",this.handleBrowserEvent,this),Dt(i,"keypress",this.handleBrowserEvent,this)];const s=e.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(me(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(me(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Dt(t,"propertychange",this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Dt(t,"change",this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(me),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ms("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Dt(t,"propertychange",this.render,this),Dt(t,"change",this.render,this),Dt(t,"addlayer",this.handleLayerAdd_,this),Dt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const s=t[e].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){S_(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),s=this.frameState_;let r=null;if(e!==void 0&&M_(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:$d(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:wt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=$d(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),s&&(!this.previousExtent_||!wa(this.previousExtent_)&&!Br(r.extent,this.previousExtent_))&&(this.dispatchEvent(new no("movestart",this,s)),this.previousExtent_=Vr(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!Br(r.extent,this.previousExtent_)&&(this.dispatchEvent(new no("moveend",this,r)),u1(r.extent,this.previousExtent_))),this.dispatchEvent(new no("postrender",this,r)),this.renderComplete_=this.hasListener("loadstart")||this.hasListener("loadend")||this.hasListener("rendercomplete")?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ms("removelayer",e)),this.set("layergroup",t)}setSize(t){this.set("size",t)}setTarget(t){this.set("target",t)}setView(t){if(!t||t instanceof ki)return void this.set("view",t);this.set("view",new ki);const e=this;t.then(function(i){e.setView(new ki(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const s=getComputedStyle(t),r=t.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),o=t.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(r)&&!isNaN(o)&&(e=[r,o],!M_(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&L1("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!fs(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},Hh=class extends yh{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent("change")}release(){this.state===Y.ERROR&&this.setState(Y.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==Y.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==Y.LOADED){t.interimTile=null;break}t.getState()==Y.LOADING?e=t:t.getState()==Y.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==Y.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){gt()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(i===-1)return 1}else i=e,this.transitionStarts_[t]=i;const s=e-i+1e3/60;return s>=this.transition_?1:X1(s/this.transition_)}inTransition(t){return!!this.transition_&&this.transitionStarts_[t]!==-1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},T_=class extends Hh{constructor(t,e,i,s,r,o){super(t,e,o),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=Y.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=Y.ERROR,this.unlistenImage_(),this.image_=function(){const e=Ke(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;this.state=t.naturalWidth&&t.naturalHeight?Y.LOADED:Y.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==Y.ERROR&&(this.state=Y.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Y.IDLE&&(this.state=Y.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(e,i,s){const r=e;let o=!0,a=!1,l=!1;const h=[_h(r,"load",function(){l=!0,a||i()})];return r.src&&s1?(a=!0,r.decode().then(function(){o&&i()}).catch(function(u){o&&(l?i():s())})):h.push(_h(r,"error",s)),function(){o=!1,h.forEach(me)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},kM=class{constructor(t,e,i,s,r,o){this.sourceProj_=t,this.targetProj_=e;let a={};const l=Jr(this.targetProj_,this.sourceProj_);this.transformInv_=function(_){const v=_[0]+"/"+_[1];return a[v]||(a[v]=l(_)),a[v]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&ee(s)>=ee(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ee(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ee(this.targetProj_.getExtent()):null;const h=Gi(i),u=ba(i),c=xa(i),d=Wr(i),p=this.transformInv_(h),f=this.transformInv_(u),g=this.transformInv_(c),m=this.transformInv_(d),y=10+(o?Math.max(0,Math.ceil(Math.log2(Yd(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,c,d,p,f,g,m,y),this.wrapsXInSource_){let _=1/0;this.triangles_.forEach(function(v,x,b){_=Math.min(_,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-_>this.sourceWorldWidth_/2){const x=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];x[0][0]-_>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-_>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-_>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);const b=Math.min(x[0][0],x[1][0],x[2][0]);Math.max(x[0][0],x[1][0],x[2][0])-b<this.sourceWorldWidth_/2&&(v.source=x)}})}a={}}addTriangle_(t,e,i,s,r,o){this.triangles_.push({source:[s,r,o],target:[t,e,i]})}addQuad_(t,e,i,s,r,o,a,l,h){const u=_a([r,o,a,l]),c=this.sourceWorldWidth_?ee(u)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&c>.5&&c<1;let f=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(f=ee(_a([t,e,i,s]))/this.targetWorldWidth_>.25||f),!p&&this.sourceProj_.isGlobal()&&c&&(f=c>.25||f)),!f&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Fe(u,this.maxSourceExtent_))return;let g=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(l[0])&&isFinite(l[1]))){if(h>0)f=!0;else if(g=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1),g!=1&&g!=2&&g!=4&&g!=8)return}if(h>0){if(!f){const m=this.transformInv_([(t[0]+i[0])/2,(t[1]+i[1])/2]);let y;y=p?(Hr(r[0],d)+Hr(a[0],d))/2-Hr(m[0],d):(r[0]+a[0])/2-m[0];const _=(r[1]+a[1])/2-m[1];f=y*y+_*_>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m),_=[(s[0]+t[0])/2,(s[1]+t[1])/2],v=this.transformInv_(_);this.addQuad_(t,e,m,_,r,o,y,v,h-1),this.addQuad_(_,m,i,s,v,y,a,l,h-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],y=this.transformInv_(m),_=[(i[0]+s[0])/2,(i[1]+s[1])/2],v=this.transformInv_(_);this.addQuad_(t,m,_,s,r,y,v,l,h-1),this.addQuad_(m,e,i,_,y,o,a,v,h-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&g||this.addTriangle_(t,i,s,r,a,l),14&g||this.addTriangle_(t,i,e,r,a,o),g&&(13&g||this.addTriangle_(e,s,t,o,l,r),7&g||this.addTriangle_(e,s,i,o,l,a))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,i,s){const r=e.source;va(t,r[0]),va(t,r[1]),va(t,r[2])}),t}getTriangles(){return this.triangles_}};let qp;const oo=[];function I_(n,t,e,i,s){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,s),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,s)),n.restore()}function Vp(n,t){return Math.abs(n[4*t]-210)>2||Math.abs(n[4*t+3]-191.25)>2}function k_(n,t,e,i){const s=Ph(e,t,n);let r=j1(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(r*=o);const a=n.getMetersPerUnit();a!==void 0&&(r/=a);const l=n.getExtent();if(!l||bh(l,s)){const h=j1(n,r,s)/r;isFinite(h)&&h>0&&(r/=h)}return r}const Bp=class extends Hh{constructor(t,e,i,s,r,o,a,l,h,u,c,d){super(r,Y.IDLE,d),this.renderEdges_=c!==void 0&&c,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const p=s.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const m=f?er(p,f):p;if(Yd(m)===0)return void(this.state=Y.EMPTY);const y=t.getExtent();y&&(g=g?er(g,y):y);const _=s.getResolution(this.wrappedTileCoord_[0]),v=function(M,w,S,k){const I=ln(S);let R=k_(M,w,I,k);return(!isFinite(R)||R<=0)&&Zd(S,function(E){return R=k_(M,w,E,k),isFinite(R)&&R>0}),R}(t,i,m,_);if(!isFinite(v)||v<=0)return void(this.state=Y.EMPTY);if(this.triangulation_=new kM(t,i,m,g,v*(u!==void 0?u:.5),_),this.triangulation_.getTriangles().length===0)return void(this.state=Y.EMPTY);this.sourceZ_=e.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(x[1]=Te(x[1],g[1],g[3]),x[3]=Te(x[3],g[1],g[3])):x=er(x,g)),Yd(x)){const b=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let M=b.minX;M<=b.maxX;M++)for(let w=b.minY;w<=b.maxY;w++){const S=h(this.sourceZ_,M,w,a);S&&this.sourceTiles_.push(S)}this.sourceTiles_.length===0&&(this.state=Y.EMPTY)}else this.state=Y.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{e&&e.getState()==Y.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,t.length===0)this.state=Y.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s=typeof i=="number"?i:i[0],r=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(u,c,d,p,f,g,m,y,_,v,x,b,M){const w=Ke(Math.round(d*u),Math.round(d*c),oo);if(b||(w.imageSmoothingEnabled=!1),_.length===0)return w.canvas;function S(E){return Math.round(E*d)/d}w.scale(d,d),w.globalCompositeOperation="lighter";const k=[1/0,1/0,-1/0,-1/0];let I;if(_.forEach(function(E,q,O){d1(k,E.extent)}),!M||_.length!==1||v!==0){const E=ee(k),q=Ti(k);I=Ke(Math.round(d*E/p),Math.round(d*q/p),oo),b||(I.imageSmoothingEnabled=!1);const O=d/p;_.forEach(function(P,L,D){const G=P.extent[0]-k[0],$=-(P.extent[3]-k[3]),K=ee(P.extent),F=Ti(P.extent);P.image.width>0&&P.image.height>0&&I.drawImage(P.image,v,v,P.image.width-2*v,P.image.height-2*v,G*O,$*O,K*O,F*O)})}const R=Gi(m);return y.getTriangles().forEach(function(E,q,O){const P=E.source,L=E.target;let D=P[0][0],G=P[0][1],$=P[1][0],K=P[1][1],F=P[2][0],N=P[2][1];const at=S((L[0][0]-R[0])/g),tt=S(-(L[0][1]-R[1])/g),_t=S((L[1][0]-R[0])/g),Pt=S(-(L[1][1]-R[1])/g),Wt=S((L[2][0]-R[0])/g),Ht=S(-(L[2][1]-R[1])/g),Qt=D,ye=G;D=0,G=0,$-=Qt,K-=ye,F-=Qt,N-=ye;const W=function(ut){const ae=ut.length;for(let At=0;At<ae;At++){let je=At,Ze=Math.abs(ut[At][At]);for(let ce=At+1;ce<ae;ce++){const Ie=Math.abs(ut[ce][At]);Ie>Ze&&(Ze=Ie,je=ce)}if(Ze===0)return null;const ui=ut[je];ut[je]=ut[At],ut[At]=ui;for(let ce=At+1;ce<ae;ce++){const Ie=-ut[ce][At]/ut[At][At];for(let mt=At;mt<ae+1;mt++)At==mt?ut[ce][mt]=0:ut[ce][mt]+=Ie*ut[At][mt]}}const Ut=new Array(ae);for(let At=ae-1;At>=0;At--){Ut[At]=ut[At][ae]/ut[At][At];for(let je=At-1;je>=0;je--)ut[je][ae]-=ut[je][At]*Ut[At]}return Ut}([[$,K,0,0,_t-at],[F,N,0,0,Wt-at],[0,0,$,K,Pt-tt],[0,0,F,N,Ht-tt]]);if(!W)return;if(w.save(),w.beginPath(),function(){if(qp===void 0){const ut=Ke(6,6,oo);ut.globalCompositeOperation="lighter",ut.fillStyle="rgba(210, 0, 0, 0.75)",I_(ut,4,5,4,0),I_(ut,4,5,0,5);const ae=ut.getImageData(0,0,3,3).data;qp=Vp(ae,0)||Vp(ae,4)||Vp(ae,8),Fa(ut),oo.push(ut.canvas)}return qp}()||!b){w.moveTo(_t,Pt);const ue=4,ut=at-_t,ae=tt-Pt;for(let Ut=0;Ut<ue;Ut++)w.lineTo(_t+S((Ut+1)*ut/ue),Pt+S(Ut*ae/(ue-1))),Ut!=ue-1&&w.lineTo(_t+S((Ut+1)*ut/ue),Pt+S((Ut+1)*ae/(ue-1)));w.lineTo(Wt,Ht)}else w.moveTo(_t,Pt),w.lineTo(at,tt),w.lineTo(Wt,Ht);let we;if(w.clip(),w.transform(W[0],W[2],W[1],W[3],at,tt),w.translate(k[0]-Qt,k[3]-ye),I)we=I.canvas,w.scale(p/d,-p/d);else{const ue=_[0],ut=ue.extent;we=ue.image,w.scale(ee(ut)/we.width,-Ti(ut)/we.height)}w.drawImage(we,0,0),w.restore()}),I&&(Fa(I),oo.push(I.canvas)),x&&(w.save(),w.globalCompositeOperation="source-over",w.strokeStyle="black",w.lineWidth=1,y.getTriangles().forEach(function(E,q,O){const P=E.target,L=(P[0][0]-R[0])/g,D=-(P[0][1]-R[1])/g,G=(P[1][0]-R[0])/g,$=-(P[1][1]-R[1])/g,K=(P[2][0]-R[0])/g,F=-(P[2][1]-R[1])/g;w.beginPath(),w.moveTo(G,$),w.lineTo(L,D),w.lineTo(K,F),w.closePath(),w.stroke()}),w.restore()),w.canvas}(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Y.LOADED}this.changed()}load(){if(this.state==Y.IDLE){this.state=Y.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{const i=e.getState();if(i==Y.IDLE||i==Y.LOADING){t++;const s=Dt(e,"change",function(r){const o=e.getState();(o==Y.LOADED||o==Y.ERROR||o==Y.EMPTY)&&(me(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,i,s){e.getState()==Y.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(me),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Fa(this.canvas_.getContext("2d")),oo.push(this.canvas_),this.canvas_=null),super.release()}},PM=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Vt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Vt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Vt(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function P_(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function ao(n,t,e){return n+"/"+t+"/"+e}function R_(n){return ao(n[0],n[1],n[2])}function F_(n){return n.split("/").map(Number)}const Wp=class extends PM{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=F_(this.peekFirstKey())[0];this.forEach(e=>{e.tileCoord[0]!==t&&(this.remove(R_(e.tileCoord)),e.release())})}};function O_(n){return n?Array.isArray(n)?function(t){return n}:typeof n=="function"?n:function(t){return[n]}:null}const A_=class extends an{constructor(t){super(),this.projection=Bt(t.projection),this.attributions_=O_(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible===void 0||t.attributionsCollapsible,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,s){e.viewResolver=i,e.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=O_(t),this.changed()}setState(t){this.state_=t,this.changed()}};class L_{constructor(t,e,i,s){this.minX=t,this.maxX=e,this.minY=i,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function lo(n,t,e,i,s){return s!==void 0?(s.minX=n,s.maxX=t,s.minY=e,s.maxY=i,s):new L_(n,t,e,i)}const D_=L_,ho=[0,0,0],Ss=class{constructor(t){let e;if(this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,Vt(function(r,o,a){const l=o||ps;return r.every(function(h,u){if(u===0)return!0;const c=l(r[u-1],h);return!(c>0||a&&c===0)})}(this.resolutions_,(s,r)=>r-s,!0),"`resolutions` must be sorted in descending order"),!t.origins)for(let s=0,r=this.resolutions_.length-1;s<r;++s)if(e){if(this.resolutions_[s]/this.resolutions_[s+1]!==e){e=void 0;break}}else e=this.resolutions_[s]/this.resolutions_[s+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,Vt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Gi(i)),Vt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,Vt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:ip,Vt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((s,r)=>{const o=new D_(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const s=this.getTileRangeForExtentAndZ(t,e);for(let r=s.minX,o=s.maxX;r<=o;++r)for(let a=s.minY,l=s.maxY;a<=l;++a)i([e,r,a])}forEachTileCoordParentTileRange(t,e,i,s){let r,o,a,l=null,h=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,s);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),r=lo(o,o,a,a,i)):r=this.getTileRangeForExtentAndZ(l,h,i),e(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const r=2*t[1],o=2*t[2];return lo(r,r+1,o,o+1,e)}const s=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const s=t[0],r=t[1],o=t[2];if(e===s)return lo(r,o,r,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-s),h=Math.floor(r*l),u=Math.floor(o*l);return e<s?lo(h,h,u,u,i):lo(h,Math.floor(l*(r+1))-1,u,Math.floor(l*(o+1))-1,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,ho);const s=ho[1],r=ho[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,ho),lo(s,ho[1],r,ho[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),s=ni(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*s[0]*i,e[1]-(t[2]+.5)*s[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),s=this.getResolution(t[0]),r=ni(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*s,a=i[1]-(t[2]+1)*r[1]*s;return xn(o,a,o+r[0]*s,a+r[1]*s,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,s,r){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=ni(this.getTileSize(o),this.tmpSize_);let u=a*(t-l[0])/i/h[0],c=a*(l[1]-e)/i/h[1];return s?(u=Sh(u,5)-1,c=Sh(c,5)-1):(u=Mh(u,5),c=Mh(c,5)),P_(o,u,c,r)}getTileCoordForXYAndZ_(t,e,i,s,r){const o=this.getOrigin(i),a=this.getResolution(i),l=ni(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/a/l[0],u=(o[1]-e)/a/l[1];return s?(h=Sh(h,5)-1,u=Sh(u,5)-1):(h=Mh(h,5),u=Mh(u,5)),P_(i,h,u,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return Te(Gd(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return r_(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let s=this.minZoom;s<e;++s)i[s]=this.getTileRangeForExtentAndZ(t,s);this.fullTileRanges_=i}};function N_(n){let t=n.getDefaultTileGrid();return t||(t=function(i,s,r,o){return function(l,h,u,c){c=c!==void 0?c:"top-left";const d=z_(l,h,u);return new Ss({extent:l,origin:AC(l,c),resolutions:d,tileSize:u})}(za(i),s,r,o)}(n),n.setDefaultTileGrid(t)),t}function Xh(n){const t=n||{},e=t.extent||Bt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:z_(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Ss(i)}function z_(n,t,e,i){t=t!==void 0?t:S1,e=ni(e!==void 0?e:ip);const s=Ti(n),r=ee(n);i=i>0?i:Math.max(r/e[0],s/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function za(n){let t=(n=Bt(n)).getExtent();if(!t){const e=180*Xr.degrees/n.getMetersPerUnit();t=xn(-e,-e,e,e)}return t}class RM extends yn{constructor(t,e){super(t),this.tile=e}}const FM=class extends A_{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.opaque_=t.opaque!==void 0&&t.opaque,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null,this.tileGrid&&ni(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new Wp(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,s){const r=this.getTileCacheForProjection(t);if(!r)return!1;let o,a,l,h=!0;for(let u=i.minX;u<=i.maxX;++u)for(let c=i.minY;c<=i.maxY;++c)a=ao(e,u,c),l=!1,r.containsKey(a)&&(o=r.get(a),l=o.getState()===Y.LOADED,l&&(l=s(o)!==!1)),l||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,s,r){return gt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:N_(t)}getTileCacheForProjection(t){const e=this.getProjection();return Vt(e===null||vs(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const s=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=ni(s.getTileSize(t),this.tmpSize);return r==1?o:function(l,h,u){return u===void 0&&(u=[0,0]),u[0]=l[0]*h+.5|0,u[1]=l[1]*h+.5|0,u}(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(r,o,a){const l=o[0],h=r.getTileCoordCenter(o),u=za(a);if(!bh(u,h)){const c=ee(u),d=Math.ceil((u[0]-h[0])/c);return h[0]+=c*d,r.getTileCoordForCoordAndZ(h,l)}return o}(i,t,e)),function(r,o){const a=r[0],l=r[1],h=r[2];if(o.getMinZoom()>a||a>o.getMaxZoom())return!1;const u=o.getFullTileRange(a);return!u||u.containsXY(l,h)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,s){}};function OM(n,t){const e=/\{z\}/g,i=/\{x\}/g,s=/\{y\}/g,r=/\{-y\}/g;return function(o,a,l){if(o)return n.replace(e,o[0].toString()).replace(i,o[1].toString()).replace(s,o[2].toString()).replace(r,function(){const h=t.getFullTileRange(o[0]);if(!h)throw new Error("The {-y} placeholder requires a tile grid with extent");return(h.getHeight()-o[2]-1).toString()})}}function j_(n,t){const e=n.length,i=new Array(e);for(let s=0;s<e;++s)i[s]=OM(n[s],t);return Up(i)}function Up(n){return n.length===1?n[0]:function(t,e,i){if(!t)return;const s=function(a){return(a[1]<<a[0])+a[2]}(t),r=Hr(s,n.length);return n[r](t,e,i)}}function Hp(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),s=e[2].charCodeAt(0);let r;for(r=i;r<=s;++r)t.push(n.replace(e[0],String.fromCharCode(r)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let s=parseInt(e[1],10);s<=i;s++)t.push(n.replace(e[0],s.toString()));return t}return t.push(n),t}class Xp extends FM{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Xp.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=wt(e),s=e.getState();let r;s==Y.LOADING?(this.tileLoadingKeys_[i]=!0,r="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=s==Y.ERROR?"tileloaderror":s==Y.LOADED?"tileloadend":void 0),r!=null&&this.dispatchEvent(new RM(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=Hp(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(j_(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const s=ao(t,e,i);this.tileCache.containsKey(s)&&this.tileCache.get(s)}}const G_=Xp;function AM(n,t){n.getImage().src=t}const Zp=class extends G_{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:AM,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate===void 0||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:T_,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const s in this.tileCacheForProjection){const r=this.tileCacheForProjection[s];r.expireCache(r==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!vs(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!vs(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||vs(e,t)))return this.tileGrid;const i=wt(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=N_(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||vs(e,t))return this.tileCache;const i=wt(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Wp(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,s,r,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,r),h=l?this.tileUrlFunction(l,s,r):void 0,u=new this.tileClass(a,h!==void 0?Y.IDLE:Y.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener("change",this.handleTileChange.bind(this)),u}getTile(t,e,i,s,r){const o=this.getProjection();if(!o||!r||vs(o,r))return this.getTileInternal(t,e,i,s,o||r);const a=this.getTileCacheForProjection(r),l=[t,e,i];let h;const u=R_(l);a.containsKey(u)&&(h=a.get(u));const c=this.getKey();if(h&&h.key==c)return h;const d=this.getTileGridForProjection(o),p=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(l,r),g=new Bp(o,d,r,p,l,f,this.getTilePixelRatio(s),this.getGutter(),(m,y,_,v)=>this.getTileInternal(m,y,_,v,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,h?(g.interimTile=h,g.refreshInterimChain(),a.replace(u,g)):a.set(u,g),g}getTileInternal(t,e,i,s,r){let o=null;const a=ao(t,e,i),l=this.getKey();if(this.tileCache.containsKey(a)){if(o=this.tileCache.get(a),o.key!=l){const h=o;o=this.createTile_(t,e,i,s,r,l),o.interimTile=h.getState()==Y.IDLE?h.interimTile:h,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,i,s,r,l),this.tileCache.set(a,o);return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const i=Bt(t);if(i){const s=wt(i);s in this.tileGridForProjection||(this.tileGridForProjection[s]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},q_=class extends Zp{constructor(t){const e=(t=t||{}).projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:Xh({extent:za(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}},LM=class extends q_{constructor(t){super({opaque:!1,projection:(t=t||{}).projection,tileGrid:t.tileGrid,wrapX:t.wrapX===void 0||t.wrapX,zDirection:t.zDirection,url:t.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(e,i)=>{const s=e.getTileCoord()[0],r=ni(this.tileGrid.getTileSize(s)),o=Ke(r[0],r[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,r[0]+.5,r[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,r[0]/2,r[1]/2,r[0]),o.fillText(i,r[0]/2,r[1]/2,r[0]),e.setImage(o.canvas)}})}},V_=class extends Hh{constructor(t,e,i,s,r,o){super(t,e,o),this.extent=null,this.format_=s,this.features_=null,this.projection=null,this.tileLoadFunction_=r,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==Y.IDLE&&(this.setState(Y.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(Y.ERROR)}setFeatures(t){this.features_=t,this.setState(Y.LOADED)}setLoader(t){this.loader_=t}},B_=[],DM=class extends Hh{constructor(t,e,i,s){super(t,e,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.getSourceTiles=s.bind(void 0,this),this.wrappedTileCoord=i}getContext(t){const e=wt(t);return e in this.context_||(this.context_[e]=Ke(1,1,B_)),this.context_[e]}hasContext(t){return wt(t)in this.context_}getImage(t){return this.hasContext(t)?this.getContext(t).canvas:null}getReplayState(t){const e=wt(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){for(const t in this.context_){const e=this.context_[t];Fa(e),B_.push(e.canvas),delete this.context_[t]}super.release()}};let NM=!1;function W_(n,t,e,i,s,r,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,s):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=NM,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();let u;h=="json"?u=JSON.parse(a.responseText):h=="text"?u=a.responseText:h=="xml"?(u=a.responseXML,u||(u=new DOMParser().parseFromString(a.responseText,"application/xml"))):h=="arraybuffer"&&(u=a.response),u?r(t.readFeatures(u,{extent:e,featureProjection:s}),t.readProjection(u)):o()}else o()},a.onerror=o,a.send()}function U_(n,t){return function(e,i,s,r,o){const a=this;W_(n,t,e,i,s,function(l,h){a.addFeatures(l),r!==void 0&&r(l)},o||qr)}}const Yp=class extends G_{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||za(e),s=t.tileGrid||Xh({extent:i,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,opaque:!1,projection:e,state:t.state,tileGrid:s,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:H_,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache=new Wp(this.tileCache.highWaterMark),this.overlaps_=t.overlaps==null||t.overlaps,this.tileClass=t.tileClass?t.tileClass:V_,this.tileGrids_={}}getFeaturesInExtent(t){const e=[],i=this.tileCache;if(i.getCount()===0)return e;const s=F_(i.peekFirstKey())[0],r=this.tileGrid;return i.forEach(function(o){if(o.tileCoord[0]!==s||o.getState()!==Y.LOADED)return;const a=o.getSourceTiles();for(let l=0,h=a.length;l<h;++l){const u=a[l];if(Fe(t,r.getTileCoordExtent(u.tileCoord))){const c=u.getFeatures();if(c)for(let d=0,p=c.length;d<p;++d){const f=c[d],g=f.getGeometry();Fe(t,g.getExtent())&&e.push(f)}}}}),e}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(t,e){const i=this.getTileCacheForProjection(t),s=Object.keys(e).reduce((r,o)=>{const a=function(u){const[c,d,p]=u.substring(u.lastIndexOf("/")+1,u.length).split(",").map(Number);return ao(c,d,p)}(o),l=i.peek(a);if(l){const h=l.sourceTiles;for(let u=0,c=h.length;u<c;++u)r[h[u].getKey()]=!0}return r},{});super.expireCache(t,e),this.sourceTileCache.expireCache(s)}getSourceTiles(t,e,i){if(i.getState()===Y.IDLE){i.setState(Y.LOADING);const s=i.wrappedTileCoord,r=this.getTileGridForProjection(e),o=r.getTileCoordExtent(s),a=r.getResolution(s[0]);ys(o,-a,o);const l=this.tileGrid,h=l.getExtent();h&&er(o,h,o);const u=l.getZForResolution(a,this.zDirection);l.forEachTileCoord(o,u,c=>{const d=this.tileUrlFunction(c,t,e),p=this.sourceTileCache.containsKey(d)?this.sourceTileCache.get(d):new this.tileClass(c,d?Y.IDLE:Y.EMPTY,d,this.format_,this.tileLoadFunction);i.sourceTiles.push(p);const f=p.getState();if(f<Y.LOADED){const g=m=>{this.handleTileChange(m);const y=p.getState();if(y===Y.LOADED||y===Y.ERROR){const _=p.getKey();_ in i.errorTileKeys?p.getState()===Y.LOADED&&delete i.errorTileKeys[_]:i.loadingSourceTiles--,y===Y.ERROR?i.errorTileKeys[_]=!0:p.removeEventListener("change",g),i.loadingSourceTiles===0&&i.setState(gs(i.errorTileKeys)?Y.LOADED:Y.ERROR)}};p.addEventListener("change",g),i.loadingSourceTiles++}f===Y.IDLE&&(p.extent=l.getTileCoordExtent(c),p.projection=e,p.resolution=l.getResolution(c[0]),this.sourceTileCache.set(d,p),p.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(c=>c.getState()===Y.ERROR)?Y.ERROR:Y.LOADED)}return i.sourceTiles}getTile(t,e,i,s,r){const o=ao(t,e,i),a=this.getKey();let l;if(this.tileCache.containsKey(o)&&(l=this.tileCache.get(o),l.key===a))return l;const h=[t,e,i];let u=this.getTileCoordForTileUrlFunction(h,r);const c=this.getTileGrid().getExtent(),d=this.getTileGridForProjection(r);if(u&&c){const g=d.getTileCoordExtent(u);ys(g,-d.getResolution(t),g),Fe(c,g)||(u=null)}let p=!0;if(u!==null){const g=this.tileGrid,m=d.getResolution(t),y=g.getZForResolution(m,1),_=d.getTileCoordExtent(u);ys(_,-m,_),g.forEachTileCoord(_,y,v=>{p=p&&!this.tileUrlFunction(v,s,r)})}const f=new DM(h,p?Y.EMPTY:Y.IDLE,u,this.getSourceTiles.bind(this,s,r));return f.key=a,l?(f.interimTile=l,f.refreshInterimChain(),this.tileCache.replace(o,f)):this.tileCache.set(o,f),f}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const s=this.tileGrid,r=s.getResolutions().slice(),o=r.map(function(h,u){return s.getOrigin(u)}),a=r.map(function(h,u){return s.getTileSize(u)}),l=S1+1;for(let h=r.length;h<l;++h)r.push(r[h-1]/2),o.push(o[h-1]),a.push(a[h-1]);i=new Ss({extent:s.getExtent(),origins:o,resolutions:r,tileSizes:a}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const s=ni(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(s[0]*e),Math.round(s[1]*e)]}updateCacheSize(t,e){super.updateCacheSize(2*t,e),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(e).highWaterMark}};function H_(n,t){n.setLoader(function(e,i,s){W_(t,n.getFormat(),e,i,s,n.onLoad.bind(n),n.onError.bind(n))})}let zM=null;var lr=1,hr=2,uo=3,$p=5,X_=6378137,jM=6356752314e-3,Z_=.0066943799901413165,ja=484813681109536e-20,B=Math.PI/2,J=1e-10,Je=.017453292519943295,wn=57.29577951308232,ne=Math.PI/4,Ga=2*Math.PI,De=3.14159265359,GM={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const qM={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Y_=/[\s_\-\/\(\)]/g;function Es(n,t){if(n[t])return n[t];for(var e,i=Object.keys(n),s=t.toLowerCase().replace(Y_,""),r=-1;++r<i.length;)if((e=i[r]).toLowerCase().replace(Y_,"")===s)return n[e]}function Kp(n){var t,e,i,s={},r=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var h=l.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),o={proj:"projName",datum:"datumCode",rf:function(a){s.rf=parseFloat(a)},lat_0:function(a){s.lat0=a*Je},lat_1:function(a){s.lat1=a*Je},lat_2:function(a){s.lat2=a*Je},lat_ts:function(a){s.lat_ts=a*Je},lon_0:function(a){s.long0=a*Je},lon_1:function(a){s.long1=a*Je},lon_2:function(a){s.long2=a*Je},alpha:function(a){s.alpha=parseFloat(a)*Je},gamma:function(a){s.rectified_grid_angle=parseFloat(a)},lonc:function(a){s.longc=a*Je},x_0:function(a){s.x0=parseFloat(a)},y_0:function(a){s.y0=parseFloat(a)},k_0:function(a){s.k0=parseFloat(a)},k:function(a){s.k0=parseFloat(a)},a:function(a){s.a=parseFloat(a)},b:function(a){s.b=parseFloat(a)},r_a:function(){s.R_A=!0},zone:function(a){s.zone=parseInt(a,10)},south:function(){s.utmSouth=!0},towgs84:function(a){s.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){s.to_meter=parseFloat(a)},units:function(a){s.units=a;var l=Es(qM,a);l&&(s.to_meter=l.to_meter)},from_greenwich:function(a){s.from_greenwich=a*Je},pm:function(a){var l=Es(GM,a);s.from_greenwich=(l||parseFloat(a))*Je},nadgrids:function(a){a==="@null"?s.datumCode="none":s.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(s.axis=a)},approx:function(){s.approx=!0}};for(t in r)e=r[t],t in o?typeof(i=o[t])=="function"?i(e):s[i]=e:s[t]=e;return typeof s.datumCode=="string"&&s.datumCode!=="WGS84"&&(s.datumCode=s.datumCode.toLowerCase()),s}const VM=function(t){return new Yn(t).output()};var qa=1,BM=/\s/,WM=/[A-Za-z]/,UM=/[A-Za-z84_]/,Zh=/[,\]]/,$_=/[\d\.E\-\+]/;function Yn(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=qa}function K_(n,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var i=e.reduce(function(s,r){return co(r,s),s},t?{}:n);t&&(n[t]=i)}function co(n,t){if(Array.isArray(n)){var e=n.shift();if(e==="PARAMETER"&&(e=n.shift()),n.length===1)return Array.isArray(n[0])?(t[e]={},void co(n[0],t[e])):void(t[e]=n[0]);if(n.length)if(e!=="TOWGS84"){if(e==="AXIS")return e in t||(t[e]=[]),void t[e].push(n);var i;switch(Array.isArray(e)||(t[e]={}),e){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[e]={name:n[0].toLowerCase(),convert:n[1]},void(n.length===3&&co(n[2],t[e]));case"SPHEROID":case"ELLIPSOID":return t[e]={name:n[0],a:n[1],rf:n[2]},void(n.length===4&&co(n[3],t[e]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return n[0]=["name",n[0]],void K_(t,e,n);default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return co(n,t[e]);return K_(t,e,n)}}else t[e]=n;else t[e]=!0}else t[n]=!0}Yn.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==4)for(;BM.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case qa:return this.neutral(n);case 2:return this.keyword(n);case 4:return this.quoted(n);case 5:return this.afterquote(n);case 3:return this.number(n);case-1:return}},Yn.prototype.afterquote=function(n){if(n==='"')return this.word+='"',void(this.state=4);if(Zh.test(n))return this.word=this.word.trim(),void this.afterItem(n);throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)},Yn.prototype.afterItem=function(n){return n===","?(this.word!==null&&this.currentObject.push(this.word),this.word=null,void(this.state=qa)):n==="]"?(this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=qa,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Yn.prototype.number=function(n){if(!$_.test(n)){if(Zh.test(n))return this.word=parseFloat(this.word),void this.afterItem(n);throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)}this.word+=n},Yn.prototype.quoted=function(n){n!=='"'?this.word+=n:this.state=5},Yn.prototype.keyword=function(n){if(UM.test(n))this.word+=n;else{if(n==="["){var t=[];return t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=qa)}if(!Zh.test(n))throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place);this.afterItem(n)}},Yn.prototype.neutral=function(n){if(WM.test(n))return this.word=n,void(this.state=2);if(n==='"')return this.word="",void(this.state=4);if($_.test(n))return this.word=n,void(this.state=3);if(!Zh.test(n))throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place);this.afterItem(n)},Yn.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===-1)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var HM=.017453292519943295;function Cn(n){return n*HM}function J_(n){var t=VM(n),e=t.shift(),i=t.shift();t.unshift(["name",i]),t.unshift(["type",e]);var s={};return co(t,s),function(o){if(o.type==="GEOGCS"?o.projName="longlat":o.type==="LOCAL_CS"?(o.projName="identity",o.local=!0):o.projName=typeof o.PROJECTION=="object"?Object.keys(o.PROJECTION)[0]:o.PROJECTION,o.AXIS){for(var a="",l=0,h=o.AXIS.length;l<h;++l){var u=[o.AXIS[l][0].toLowerCase(),o.AXIS[l][1].toLowerCase()];u[0].indexOf("north")!==-1||(u[0]==="y"||u[0]==="lat")&&u[1]==="north"?a+="n":u[0].indexOf("south")!==-1||(u[0]==="y"||u[0]==="lat")&&u[1]==="south"?a+="s":u[0].indexOf("east")!==-1||(u[0]==="x"||u[0]==="lon")&&u[1]==="east"?a+="e":(u[0].indexOf("west")!==-1||(u[0]==="x"||u[0]==="lon")&&u[1]==="west")&&(a+="w")}a.length===2&&(a+="u"),a.length===3&&(o.axis=a)}o.UNIT&&(o.units=o.UNIT.name.toLowerCase(),o.units==="metre"&&(o.units="meter"),o.UNIT.convert&&(o.type==="GEOGCS"?o.DATUM&&o.DATUM.SPHEROID&&(o.to_meter=o.UNIT.convert*o.DATUM.SPHEROID.a):o.to_meter=o.UNIT.convert));var c=o.GEOGCS;function d(p){return p*(o.to_meter||1)}o.type==="GEOGCS"&&(c=o),c&&(o.datumCode=c.DATUM?c.DATUM.name.toLowerCase():c.name.toLowerCase(),o.datumCode.slice(0,2)==="d_"&&(o.datumCode=o.datumCode.slice(2)),(o.datumCode==="new_zealand_geodetic_datum_1949"||o.datumCode==="new_zealand_1949")&&(o.datumCode="nzgd49"),(o.datumCode==="wgs_1984"||o.datumCode==="world_geodetic_system_1984")&&(o.PROJECTION==="Mercator_Auxiliary_Sphere"&&(o.sphere=!0),o.datumCode="wgs84"),o.datumCode.slice(-6)==="_ferro"&&(o.datumCode=o.datumCode.slice(0,-6)),o.datumCode.slice(-8)==="_jakarta"&&(o.datumCode=o.datumCode.slice(0,-8)),~o.datumCode.indexOf("belge")&&(o.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(o.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),o.ellps.toLowerCase().slice(0,13)==="international"&&(o.ellps="intl"),o.a=c.DATUM.SPHEROID.a,o.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(o.datum_params=c.DATUM.TOWGS84),~o.datumCode.indexOf("osgb_1936")&&(o.datumCode="osgb36"),~o.datumCode.indexOf("osni_1952")&&(o.datumCode="osni52"),(~o.datumCode.indexOf("tm65")||~o.datumCode.indexOf("geodetic_datum_of_1965"))&&(o.datumCode="ire65"),o.datumCode==="ch1903+"&&(o.datumCode="ch1903"),~o.datumCode.indexOf("israel")&&(o.datumCode="isr93")),o.b&&!isFinite(o.b)&&(o.b=o.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Cn],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Cn],["x0","false_easting",d],["y0","false_northing",d],["long0","central_meridian",Cn],["lat0","latitude_of_origin",Cn],["lat0","standard_parallel_1",Cn],["lat1","standard_parallel_1",Cn],["lat2","standard_parallel_2",Cn],["azimuth","Azimuth"],["alpha","azimuth",Cn],["srsCode","name"]].forEach(function(p){return function(g,m){var y=m[0],_=m[1];!(y in g)&&_ in g&&(g[y]=g[_],m.length===3&&(g[y]=m[2](g[y])))}(o,p)}),!o.long0&&o.longc&&(o.projName==="Albers_Conic_Equal_Area"||o.projName==="Lambert_Azimuthal_Equal_Area")&&(o.long0=o.longc),o.lat_ts||!o.lat1||o.projName!=="Stereographic_South_Pole"&&o.projName!=="Polar Stereographic (variant B)"?!o.lat_ts&&o.lat0&&o.projName==="Polar_Stereographic"&&(o.lat_ts=o.lat0,o.lat0=Cn(o.lat0>0?90:-90)):(o.lat0=Cn(o.lat1>0?90:-90),o.lat_ts=o.lat1)}(s),s}function Mn(n){var t=this;if(arguments.length===2){var e=arguments[1];Mn[n]=typeof e=="string"?e.charAt(0)==="+"?Kp(arguments[1]):J_(arguments[1]):e}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){Array.isArray(i)?Mn.apply(t,i):Mn(i)});if(typeof n=="string"){if(n in Mn)return Mn[n]}else"EPSG"in n?Mn["EPSG:"+n.EPSG]=n:"ESRI"in n?Mn["ESRI:"+n.ESRI]=n:"IAU2000"in n?Mn["IAU2000:"+n.IAU2000]=n:console.log(n);return}}(function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]})(Mn);const Yh=Mn;var XM=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],ZM=["3857","900913","3785","102113"];function Q_(n,t){var e,i;if(n=n||{},!t)return n;for(i in t)(e=t[i])!==void 0&&(n[i]=e);return n}function Sn(n,t,e){var i=n*t;return e/Math.sqrt(1-i*i)}function Va(n){return n<0?-1:1}function st(n){return Math.abs(n)<=De?n:n-Va(n)*Ga}function cn(n,t,e){var i=n*e;return i=Math.pow((1-i)/(1+i),.5*n),Math.tan(.5*(B-t))/i}function Ba(n,t){for(var e,i,s=.5*n,r=B-2*Math.atan(t),o=0;o<=15;o++)if(e=n*Math.sin(r),r+=i=B-2*Math.atan(t*Math.pow((1-e)/(1+e),s))-r,Math.abs(i)<=1e-10)return r;return-9999}function tv(n){return n}var YM=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):Sn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(t){var e,i,s=t.x,r=t.y;if(r*wn>90&&r*wn<-90&&s*wn>180&&s*wn<-180||Math.abs(Math.abs(r)-B)<=J)return null;if(this.sphere)e=this.x0+this.a*this.k0*st(s-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(ne+.5*r));else{var o=Math.sin(r),a=cn(this.e,r,o);e=this.x0+this.a*this.k0*st(s-this.long0),i=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,s=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=B-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if((i=Ba(this.e,o))===-9999)return null}return e=st(this.long0+s/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:tv,inverse:tv,names:["longlat","identity"]}],$h={},Kh=[];function ev(n,t){var e=Kh.length;return n.names?(Kh[e]=n,n.names.forEach(function(i){$h[i.toLowerCase()]=e}),this):(console.log(t),!0)}const $M={start:function(){YM.forEach(ev)},add:ev,get:function(t){if(!t)return!1;var e=t.toLowerCase();return typeof $h[e]<"u"&&Kh[$h[e]]?Kh[$h[e]]:void 0}};var Jp={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},KM=Jp.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Jp.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var JM={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},militargeographische_institut:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},iv={};function QM(n){if(n.length===0)return null;var t=n[0]==="@";return t&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:n,mandatory:!t,grid:iv[n]||null,isNull:!1}}function po(n){return n/3600*Math.PI/180}function Qp(n,t,e){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(t,e)))}function tS(n){return n.map(function(t){return[po(t.longitudeShift),po(t.latitudeShift)]})}function eS(n,t,e){return{name:Qp(n,t+8,t+16).trim(),parent:Qp(n,t+24,t+24+8).trim(),lowerLatitude:n.getFloat64(t+72,e),upperLatitude:n.getFloat64(t+88,e),lowerLongitude:n.getFloat64(t+104,e),upperLongitude:n.getFloat64(t+120,e),latitudeInterval:n.getFloat64(t+136,e),longitudeInterval:n.getFloat64(t+152,e),gridNodeCount:n.getInt32(t+168,e)}}function iS(n,t,e,i){for(var s=t+176,r=[],o=0;o<e.gridNodeCount;o++){var a={latitudeShift:n.getFloat32(s+16*o,i),longitudeShift:n.getFloat32(s+16*o+4,i),latitudeAccuracy:n.getFloat32(s+16*o+8,i),longitudeAccuracy:n.getFloat32(s+16*o+12,i)};r.push(a)}return r}function Wa(n,t){if(!(this instanceof Wa))return new Wa(n);t=t||function(h){if(h)throw h};var e=function(u){if(!function(f){return typeof f=="string"}(u))return u;if(function(f){return f in Yh}(u))return Yh[u];if(function(f){return XM.some(function(g){return f.indexOf(g)>-1})}(u)){var c=J_(u);if(function(f){var g=Es(f,"authority");if(g){var m=Es(g,"epsg");return m&&ZM.indexOf(m)>-1}}(c))return Yh["EPSG:3857"];var d=function(f){var g=Es(f,"extension");if(g)return Es(g,"proj4")}(c);return d?Kp(d):c}return function(f){return f[0]==="+"}(u)?Kp(u):void 0}(n);if(typeof e=="object"){var i=Wa.projections.get(e.projName);if(i){if(e.datumCode&&e.datumCode!=="none"){var s=Es(JM,e.datumCode);s&&(e.datum_params=e.datum_params||(s.towgs84?s.towgs84.split(","):null),e.ellps=s.ellipse,e.datumName=s.datumName?s.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var r=function(u,c,d,p,f){if(!u){var g=Es(Jp,p);g||(g=KM),u=g.a,c=g.b,d=g.rf}return d&&!c&&(c=(1-1/d)*u),(d===0||Math.abs(u-c)<J)&&(f=!0,c=u),{a:u,b:c,rf:d,sphere:f}}(e.a,e.b,e.rf,e.ellps,e.sphere),o=function(u,c,d,p){var f=u*u,g=c*c,m=(f-g)/f,y=0;return p?(f=(u*=1-m*(.16666666666666666+m*(.04722222222222222+.022156084656084655*m)))*u,m=0):y=Math.sqrt(m),{es:m,e:y,ep2:(f-g)/g}}(r.a,r.b,0,e.R_A),a=function(u){return u===void 0?null:u.split(",").map(QM)}(e.nadgrids),l=e.datum||function(u,c,d,p,f,g,m){var y={};return y.datum_type=u===void 0||u==="none"?$p:4,c&&(y.datum_params=c.map(parseFloat),(y.datum_params[0]!==0||y.datum_params[1]!==0||y.datum_params[2]!==0)&&(y.datum_type=lr),y.datum_params.length>3&&(y.datum_params[3]!==0||y.datum_params[4]!==0||y.datum_params[5]!==0||y.datum_params[6]!==0)&&(y.datum_type=hr,y.datum_params[3]*=ja,y.datum_params[4]*=ja,y.datum_params[5]*=ja,y.datum_params[6]=y.datum_params[6]/1e6+1)),m&&(y.datum_type=uo,y.grids=m),y.a=d,y.b=p,y.es=f,y.ep2=g,y}(e.datumCode,e.datum_params,r.a,r.b,o.es,o.ep2,a);Q_(this,e),Q_(this,i),this.a=r.a,this.b=r.b,this.rf=r.rf,this.sphere=r.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),t(null,this)}else t(n)}else t(n)}(Wa.projections=$M).start();const Ua=Wa;function nv(n,t,e){var i,s,r,o=n.x,a=n.y,l=n.z?n.z:0;if(a<-B&&a>-1.001*B)a=-B;else if(a>B&&a<1.001*B)a=B;else{if(a<-B)return{x:-1/0,y:-1/0,z:n.z};if(a>B)return{x:1/0,y:1/0,z:n.z}}return o>Math.PI&&(o-=2*Math.PI),s=Math.sin(a),r=Math.cos(a),{x:((i=e/Math.sqrt(1-t*(s*s)))+l)*r*Math.cos(o),y:(i+l)*r*Math.sin(o),z:(i*(1-t)+l)*s}}function sv(n,t,e,i){var s,r,o,a,l,h,u,c,d,p,f,g,m,y,_,v=n.x,x=n.y,b=n.z?n.z:0;if(s=Math.sqrt(v*v+x*x),r=Math.sqrt(v*v+x*x+b*b),s/e<1e-12){if(y=0,r/e<1e-12)return _=-i,{x:n.x,y:n.y,z:n.z}}else y=Math.atan2(x,v);o=b/r,c=(a=s/r)*(1-t)*(l=1/Math.sqrt(1-t*(2-t)*a*a)),d=o*l,m=0;do m++,h=t*(u=e/Math.sqrt(1-t*d*d))/(u+(_=s*c+b*d-u*(1-t*d*d))),g=(f=o*(l=1/Math.sqrt(1-h*(2-h)*a*a)))*c-(p=a*(1-h)*l)*d,c=p,d=f;while(g*g>1e-24&&m<30);return{x:y,y:Math.atan(f/Math.abs(p)),z:_}}function Jh(n){return n===lr||n===hr}function rv(n,t,e){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-e.x,y:e.y},s={x:Number.NaN,y:Number.NaN},r=[];t:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(r.push(a.name),a.isNull){s=i;break}if(a.grid!==null)for(var l=a.grid.subgrids,h=0,u=l.length;h<u;h++){var c=l[h],d=(Math.abs(c.del[1])+Math.abs(c.del[0]))/1e4;if(!(c.ll[1]-d>i.y||c.ll[0]-d>i.x||c.ll[1]+(c.lim[1]-1)*c.del[1]+d<i.y||c.ll[0]+(c.lim[0]-1)*c.del[0]+d<i.x||(s=nS(i,t,c),isNaN(s.x))))break t}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*wn+" "+i.y*wn+" tried: '"+r+"'"),-1):(e.x=-s.x,e.y=s.y,0)}function nS(n,t,e){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var s={x:n.x,y:n.y};s.x-=e.ll[0],s.y-=e.ll[1],s.x=st(s.x-Math.PI)+Math.PI;var r=ov(s,e);if(t){if(isNaN(r.x))return i;r.x=s.x-r.x,r.y=s.y-r.y;var o,a,l=9;do{if(a=ov(r,e),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}r.x+=(o={x:s.x-(a.x+r.x),y:s.y-(a.y+r.y)}).x,r.y+=o.y}while(l--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=st(r.x+e.ll[0]),i.y=r.y+e.ll[1]}else isNaN(r.x)||(i.x=n.x+r.x,i.y=n.y+r.y);return i}function ov(n,t){var e,i={x:n.x/t.del[0],y:n.y/t.del[1]},s=Math.floor(i.x),r=Math.floor(i.y),o=i.x-1*s,a=i.y-1*r,l={x:Number.NaN,y:Number.NaN};if(s<0||s>=t.lim[0]||r<0||r>=t.lim[1])return l;var h=t.cvs[e=r*t.lim[0]+s][0],u=t.cvs[e][1];e++;var c=t.cvs[e][0],d=t.cvs[e][1],p=t.cvs[e+=t.lim[0]][0],f=t.cvs[e][1];e--;var g=t.cvs[e][1],m=o*a,y=o*(1-a),_=(1-o)*(1-a),v=(1-o)*a;return l.x=_*h+y*c+v*t.cvs[e][0]+m*p,l.y=_*u+y*d+v*g+m*f,l}function av(n,t,e){var i,s,r,o=e.x,a=e.y,l=e.z||0,h={};for(r=0;r<3;r++)if(!t||r!==2||e.z!==void 0)switch(r===0?(i=o,s="ew".indexOf(n.axis[r])!==-1?"x":"y"):r===1?(i=a,s="ns".indexOf(n.axis[r])!==-1?"y":"x"):(i=l,s="z"),n.axis[r]){case"e":case"n":h[s]=i;break;case"w":case"s":h[s]=-i;break;case"u":e[s]!==void 0&&(h.z=i);break;case"d":e[s]!==void 0&&(h.z=-i);break;default:return null}return h}function lv(n){var t={x:n[0],y:n[1]};return n.length>2&&(t.z=n[2]),n.length>3&&(t.m=n[3]),t}function hv(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!=n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Qh(n,t,e,i){var s,r=(e=Array.isArray(e)?lv(e):{x:e.x,y:e.y,z:e.z,m:e.m}).z!==void 0;if(function(a){hv(a.x),hv(a.y)}(e),n.datum&&t.datum&&function(a,l){return(a.datum.datum_type===lr||a.datum.datum_type===hr||a.datum.datum_type===uo)&&l.datumCode!=="WGS84"||(l.datum.datum_type===lr||l.datum.datum_type===hr||l.datum.datum_type===uo)&&a.datumCode!=="WGS84"}(n,t)&&(e=Qh(n,s=new Ua("WGS84"),e,i),n=s),i&&n.axis!=="enu"&&(e=av(n,!1,e)),n.projName==="longlat")e={x:e.x*Je,y:e.y*Je,z:e.z||0};else if(n.to_meter&&(e={x:e.x*n.to_meter,y:e.y*n.to_meter,z:e.z||0}),!(e=n.inverse(e)))return;if(n.from_greenwich&&(e.x+=n.from_greenwich),e=function(a,l,h){if(function(m,y){return!(m.datum_type!==y.datum_type||m.a!==y.a||Math.abs(m.es-y.es)>5e-11)&&(m.datum_type===lr?m.datum_params[0]===y.datum_params[0]&&m.datum_params[1]===y.datum_params[1]&&m.datum_params[2]===y.datum_params[2]:m.datum_type!==hr||m.datum_params[0]===y.datum_params[0]&&m.datum_params[1]===y.datum_params[1]&&m.datum_params[2]===y.datum_params[2]&&m.datum_params[3]===y.datum_params[3]&&m.datum_params[4]===y.datum_params[4]&&m.datum_params[5]===y.datum_params[5]&&m.datum_params[6]===y.datum_params[6])}(a,l)||a.datum_type===$p||l.datum_type===$p)return h;var u=a.a,c=a.es;if(a.datum_type===uo){if(rv(a,!1,h)!==0)return;u=X_,c=Z_}var d=l.a,p=l.b,f=l.es;return l.datum_type===uo&&(d=X_,p=jM,f=Z_),c!==f||u!==d||Jh(a.datum_type)||Jh(l.datum_type)?(h=nv(h,c,u),Jh(a.datum_type)&&(h=function(m,y,_){if(y===lr)return{x:m.x+_[0],y:m.y+_[1],z:m.z+_[2]};if(y===hr){var v=_[3],x=_[4],b=_[5],M=_[6];return{x:M*(m.x-b*m.y+x*m.z)+_[0],y:M*(b*m.x+m.y-v*m.z)+_[1],z:M*(-x*m.x+v*m.y+m.z)+_[2]}}}(h,a.datum_type,a.datum_params)),Jh(l.datum_type)&&(h=function(m,y,_){if(y===lr)return{x:m.x-_[0],y:m.y-_[1],z:m.z-_[2]};if(y===hr){var v=_[3],x=_[4],b=_[5],M=_[6],w=(m.x-_[0])/M,S=(m.y-_[1])/M,k=(m.z-_[2])/M;return{x:w+b*S-x*k,y:-b*w+S+v*k,z:x*w-v*S+k}}}(h,l.datum_type,l.datum_params)),h=sv(h,f,d,p),l.datum_type!==uo||rv(l,!0,h)===0?h:void 0):h}(n.datum,t.datum,e))return t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),t.projName==="longlat"?e={x:e.x*wn,y:e.y*wn,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),i&&t.axis!=="enu"?av(t,!0,e):(e&&!r&&delete e.z,e)}var uv=Ua("WGS84");function tf(n,t,e,i){var s,r,o;return Array.isArray(e)?(s=Qh(n,t,e,i)||{x:NaN,y:NaN},e.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof s.z=="number"?[s.x,s.y,s.z].concat(e.splice(3)):[s.x,s.y,e[2]].concat(e.splice(3)):[s.x,s.y].concat(e.splice(2)):[s.x,s.y]):(r=Qh(n,t,e,i),(o=Object.keys(e)).length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;r[a]=e[a]}),r)}function cv(n){return n instanceof Ua?n:n.oProj?n.oProj:Ua(n)}const Pi=function(t,e,i){t=cv(t);var s,r=!1;return typeof e>"u"?(e=t,t=uv,r=!0):(typeof e.x<"u"||Array.isArray(e))&&(i=e,e=t,t=uv,r=!0),e=cv(e),i?tf(t,e,i):(s={forward:function(o,a){return tf(t,e,o,a)},inverse:function(o,a){return tf(e,t,o,a)}},r&&(s.oProj=e),s)};var dv=6,pv="AJSAJS",fv="AFAFAF",fo=65,_i=73,Bi=79,Ha=86,Xa=90;const sS={forward:gv,inverse:function(t){var e=nf(vv(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:mv};function gv(n,t){return t=t||5,function(i,s){var r="00000"+i.easting,o="00000"+i.northing;return i.zoneNumber+i.zoneLetter+function(l,h,u){var c=_v(u);return function(p,f,g){var m=g-1,y=pv.charCodeAt(m),_=fv.charCodeAt(m),v=y+p-1,x=_+f,b=!1;return v>Xa&&(v=v-Xa+fo-1,b=!0),(v===_i||y<_i&&v>_i||(v>_i||y<_i)&&b)&&v++,(v===Bi||y<Bi&&v>Bi||(v>Bi||y<Bi)&&b)&&++v===_i&&v++,v>Xa&&(v=v-Xa+fo-1),x>Ha?(x=x-Ha+fo-1,b=!0):b=!1,(x===_i||_<_i&&x>_i||(x>_i||_<_i)&&b)&&x++,(x===Bi||_<Bi&&x>Bi||(x>Bi||_<Bi)&&b)&&++x===_i&&x++,x>Ha&&(x=x-Ha+fo-1),String.fromCharCode(v)+String.fromCharCode(x)}(Math.floor(l/1e5),Math.floor(h/1e5)%20,c)}(i.easting,i.northing,i.zoneNumber)+r.substr(r.length-5,s)+o.substr(o.length-5,s)}(function(i){var s,r,o,a,l,h,u,c=i.lat,d=i.lon,p=6378137,f=.00669438,g=.9996,m=ef(c),y=ef(d);u=Math.floor((d+180)/6)+1,d===180&&(u=60),c>=56&&c<64&&d>=3&&d<12&&(u=32),c>=72&&c<84&&(d>=0&&d<9?u=31:d>=9&&d<21?u=33:d>=21&&d<33?u=35:d>=33&&d<42&&(u=37)),h=ef(6*(u-1)-180+3),s=f/(1-f),r=p/Math.sqrt(1-f*Math.sin(m)*Math.sin(m)),o=Math.tan(m)*Math.tan(m),a=s*Math.cos(m)*Math.cos(m);var _=g*r*((l=Math.cos(m)*(y-h))+(1-o+a)*l*l*l/6+(5-18*o+o*o+72*a-58*s)*l*l*l*l*l/120)+5e5,v=g*(p*(.9983242984503243*m-.002514607064228144*Math.sin(2*m)+2639046602129982e-21*Math.sin(4*m)-35*f*f*f/3072*Math.sin(6*m))+r*Math.tan(m)*(l*l/2+(5-o+9*a+4*a*a)*l*l*l*l/24+(61-58*o+o*o+600*a-330*s)*l*l*l*l*l*l/720));return c<0&&(v+=1e7),{northing:Math.round(v),easting:Math.round(_),zoneNumber:u,zoneLetter:rS(c)}}({lat:n[1],lon:n[0]}),t)}function mv(n){var t=nf(vv(n.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function ef(n){return n*(Math.PI/180)}function yv(n){return n/Math.PI*180}function nf(n){var t=n.northing,e=n.easting,i=n.zoneLetter,s=n.zoneNumber;if(s<0||s>60)return null;var r,o,a,l,h,u,c,d,p,f=.9996,g=6378137,m=.00669438,y=(1-Math.sqrt(1-m))/(1+Math.sqrt(1-m)),_=e-5e5,v=t;i<"N"&&(v-=1e7),c=6*(s-1)-180+3,r=m/(1-m),p=(d=v/f/6367449145945056e-9)+(3*y/2-27*y*y*y/32)*Math.sin(2*d)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*d)+151*y*y*y/96*Math.sin(6*d),o=g/Math.sqrt(1-m*Math.sin(p)*Math.sin(p)),a=Math.tan(p)*Math.tan(p),l=r*Math.cos(p)*Math.cos(p),h=g*(1-m)/Math.pow(1-m*Math.sin(p)*Math.sin(p),1.5),u=_/(o*f);var x=p-o*Math.tan(p)/h*(u*u/2-(5+3*a+10*l-4*l*l-9*r)*u*u*u*u/24+(61+90*a+298*l+45*a*a-252*r-3*l*l)*u*u*u*u*u*u/720);x=yv(x);var b,M=(u-(1+2*a+l)*u*u*u/6+(5-2*l+28*a-3*l*l+8*r+24*a*a)*u*u*u*u*u/120)/Math.cos(p);if(M=c+yv(M),n.accuracy){var w=nf({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});b={top:w.lat,right:w.lon,bottom:x,left:M}}else b={lat:x,lon:M};return b}function rS(n){var t="Z";return 84>=n&&n>=72?t="X":72>n&&n>=64?t="W":64>n&&n>=56?t="V":56>n&&n>=48?t="U":48>n&&n>=40?t="T":40>n&&n>=32?t="S":32>n&&n>=24?t="R":24>n&&n>=16?t="Q":16>n&&n>=8?t="P":8>n&&n>=0?t="N":0>n&&n>=-8?t="M":-8>n&&n>=-16?t="L":-16>n&&n>=-24?t="K":-24>n&&n>=-32?t="J":-32>n&&n>=-40?t="H":-40>n&&n>=-48?t="G":-48>n&&n>=-56?t="F":-56>n&&n>=-64?t="E":-64>n&&n>=-72?t="D":-72>n&&n>=-80&&(t="C"),t}function _v(n){var t=n%dv;return t===0&&(t=dv),t}function vv(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var t,e=n.length,i=null,s="",r=0;!/[A-Z]/.test(t=n.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+n;s+=t,r++}var o=parseInt(s,10);if(r===0||r+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(r++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;i=n.substring(r,r+=2);for(var l=_v(o),h=function(v,x){for(var b=pv.charCodeAt(x-1),M=1e5,w=!1;b!==v.charCodeAt(0);){if(++b===_i&&b++,b===Bi&&b++,b>Xa){if(w)throw"Bad character: "+v;b=fo,w=!0}M+=1e5}return M}(i.charAt(0),l),u=function(v,x){if(v>"V")throw"MGRSPoint given invalid Northing "+v;for(var b=fv.charCodeAt(x-1),M=0,w=!1;b!==v.charCodeAt(0);){if(++b===_i&&b++,b===Bi&&b++,b>Ha){if(w)throw"Bad character: "+v;b=fo,w=!0}M+=1e5}return M}(i.charAt(1),l);u<oS(a);)u+=2e6;var c=e-r;if(c%2!=0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var d,p,f,g=c/2,m=0,y=0;return g>0&&(d=1e5/Math.pow(10,g),p=n.substring(r,r+g),m=parseFloat(p)*d,f=n.substring(r+g),y=parseFloat(f)*d),{easting:m+h,northing:y+u,zoneLetter:a,zoneNumber:o,accuracy:d}}function oS(n){var t;switch(n){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+n}function go(n,t,e){if(!(this instanceof go))return new go(n,t,e);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof t>"u"){var i=n.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=n,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}go.fromMGRS=function(n){return new go(mv(n))},go.prototype.toMGRS=function(n){return gv([this.x,this.y],n)};const aS=go;var xv=.01953125,bv=.01068115234375;function wv(n){var t=[];t[0]=1-n*(.25+n*(.046875+n*(xv+n*bv))),t[1]=n*(.75-n*(.046875+n*(xv+n*bv)));var e=n*n;return t[2]=e*(.46875-n*(.013020833333333334+.007120768229166667*n)),t[3]=(e*=n)*(.3645833333333333-.005696614583333333*n),t[4]=e*n*.3076171875,t}function tu(n,t,e,i){return i[0]*n-(e*=t)*(i[1]+(t*=t)*(i[2]+t*(i[3]+t*i[4])))}function Cv(n,t,e){for(var i=1/(1-t),s=n,r=20;r;--r){var o=Math.sin(s),a=1-t*o*o;if(s-=a=(tu(s,o,Math.cos(s),e)-n)*(a*Math.sqrt(a))*i,Math.abs(a)<J)return s}return s}const eu={init:function(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=wv(this.es),this.ml0=tu(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,s,r=t.y,o=st(t.x-this.long0),a=Math.sin(r),l=Math.cos(r);if(this.es){var h=l*o,u=Math.pow(h,2),c=this.ep2*Math.pow(l,2),d=Math.pow(c,2),p=Math.abs(l)>J?Math.tan(r):0,f=Math.pow(p,2),g=Math.pow(f,2);e=1-this.es*Math.pow(a,2),h/=Math.sqrt(e);var m=tu(r,a,l,this.en);i=this.a*(this.k0*h*(1+u/6*(1-f+c+u/20*(5-18*f+g+14*c-58*f*c+u/42*(61+179*g-g*f-479*f)))))+this.x0,s=this.a*(this.k0*(m-this.ml0+a*o*h/2*(1+u/12*(5-f+9*c+4*d+u/30*(61+g-58*f+270*c-330*f*c+u/56*(1385+543*g-g*f-3111*f))))))+this.y0}else{var y=l*Math.sin(o);if(Math.abs(Math.abs(y)-1)<J)return 93;if(i=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,s=l*Math.cos(o)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(s))>=1){if(y-1>J)return 93;s=0}else s=Math.acos(s);r<0&&(s=-s),s=this.a*this.k0*(s-this.lat0)+this.y0}return t.x=i,t.y=s,t},inverse:function(t){var e,i,s,r,o=1/this.a*(t.x-this.x0),a=1/this.a*(t.y-this.y0);if(this.es)if(i=Cv(e=this.ml0+a/this.k0,this.es,this.en),Math.abs(i)<B){var l=Math.sin(i),h=Math.cos(i),u=Math.abs(h)>J?Math.tan(i):0,c=this.ep2*Math.pow(h,2),d=Math.pow(c,2),p=Math.pow(u,2),f=Math.pow(p,2);e=1-this.es*Math.pow(l,2);var g=o*Math.sqrt(e)/this.k0,m=Math.pow(g,2);s=i-(e*=u)*m/(1-this.es)*.5*(1-m/12*(5+3*p-9*c*p+c-4*d-m/30*(61+90*p-252*c*p+45*f+46*c-m/56*(1385+3633*p+4095*f+1574*f*p)))),r=st(this.long0+g*(1-m/6*(1+2*p+c-m/20*(5+28*p+24*f+8*c*p+6*c-m/42*(61+662*p+1320*f+720*f*p))))/h)}else s=B*Va(a),r=0;else{var y=Math.exp(o/this.k0),_=.5*(y-1/y),v=Math.cos(this.lat0+a/this.k0);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(_,2))),s=Math.asin(e),a<0&&(s=-s),r=_===0&&v===0?0:st(Math.atan2(_,v)+this.long0)}return t.x=r,t.y=s,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function Mv(n){var t=Math.exp(n);return(t-1/t)/2}function Wi(n,t){n=Math.abs(n),t=Math.abs(t);var e=Math.max(n,t),i=Math.min(n,t)/(e||1);return e*Math.sqrt(1+Math.pow(i,2))}function sf(n,t){for(var e,i=2*Math.cos(2*t),s=n.length-1,r=n[s],o=0;--s>=0;)e=i*r-o+n[s],o=r,r=e;return t+e*Math.sin(2*t)}function Sv(n,t,e){for(var i,s,r=Math.sin(t),o=Math.cos(t),a=Mv(e),l=function(y){var _=Math.exp(y);return(_+1/_)/2}(e),h=2*o*l,u=-2*r*a,c=n.length-1,d=n[c],p=0,f=0,g=0;--c>=0;)i=f,s=p,d=h*(f=d)-i-u*(p=g)+n[c],g=u*f-s+h*p;return[(h=r*l)*d-(u=o*a)*g,h*g+u*d]}const iu={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(eu.init.apply(this),this.forward=eu.forward,this.inverse=eu.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),this.cgb[1]=(i*=e)*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),this.cgb[2]=(i*=e)*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),this.cgb[3]=(i*=e)*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),this.cgb[4]=(i*=e)*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),this.cgb[5]=(i*=e)*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),this.utg[2]=(i*=e)*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),this.utg[3]=(i*=e)*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),this.utg[4]=(i*=e)*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),this.utg[5]=(i*=e)*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var s=sf(this.cbg,this.lat0);this.Zb=-this.Qn*(s+function(o,a){for(var l,h=2*Math.cos(a),u=o.length-1,c=o[u],d=0;--u>=0;)l=h*c-d+o[u],d=c,c=l;return Math.sin(a)*l}(this.gtu,2*s))},forward:function(t){var e=st(t.x-this.long0),i=t.y;i=sf(this.cbg,i);var s=Math.sin(i),r=Math.cos(i),o=Math.sin(e),a=Math.cos(e);i=Math.atan2(s,a*r),e=Math.atan2(o*r,Wi(s,r*a)),e=function(d){var p=Math.abs(d);return p=function(g){var m=1+g,y=m-1;return y===0?g:g*Math.log(m)/y}(p*(1+p/(Wi(1,p)+1))),d<0?-p:p}(Math.tan(e));var l,h,u=Sv(this.gtu,2*i,2*e);return i+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(l=1/0,h=1/0),t.x=l,t.y=h,t},inverse:function(t){var e,i,s=1/this.a*(t.x-this.x0),r=1/this.a*(t.y-this.y0);if(r=(r-this.Zb)/this.Qn,s/=this.Qn,Math.abs(s)<=2.623395162778){var o=Sv(this.utg,2*r,2*s);r+=o[0],s+=o[1],s=Math.atan(Mv(s));var a=Math.sin(r),l=Math.cos(r),h=Math.sin(s),u=Math.cos(s);r=Math.atan2(a*u,Wi(h,u*l)),e=st((s=Math.atan2(h,u*l))+this.long0),i=sf(this.cgb,r)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},lS={init:function(){var t=function(i,s){if(i===void 0){if((i=Math.floor(30*(st(s)+Math.PI)/Math.PI)+1)<0)return 0;if(i>60)return 60}return i}(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Je,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,iu.init.apply(this),this.forward=iu.forward,this.inverse=iu.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function rf(n,t){return Math.pow((1-n)/(1+n),t)}const of={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ne)/(Math.pow(Math.tan(.5*this.lat0+ne),this.C)*rf(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+ne),this.C)*rf(this.e*Math.sin(i),this.ratexp))-B,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,s=Math.pow(Math.tan(.5*i+ne)/this.K,1/this.C),r=20;r>0&&(i=2*Math.atan(s*rf(this.e*Math.sin(t.y),-.5*this.e))-B,!(Math.abs(i-t.y)<1e-14));--r)t.y=i;return r?(t.x=e,t.y=i,t):null},names:["gauss"]},hS={init:function(){of.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,s,r;return t.x=st(t.x-this.long0),of.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),s=Math.cos(t.x),t.x=(r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*s))*i*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*i*s),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,s,r,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Wi(t.x,t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),i=Math.cos(a),r=Math.asin(i*this.sinc0+t.y*e*this.cosc0/o),s=Math.atan2(t.x*e,o*this.cosc0*i-t.y*this.sinc0*e)}else r=this.phic0,s=0;return t.x=s,t.y=r,of.inverse.apply(this,[t]),t.x=st(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},uS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=J&&(this.k0=.5*(1+Va(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=J&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=J&&Math.abs(Math.cos(this.lat_ts))>J&&(this.k0=.5*this.cons*Sn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/cn(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Sn(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-B,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,s,r,o,a,l=t.x,h=t.y,u=Math.sin(h),c=Math.cos(h),d=st(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=J&&Math.abs(h+this.lat0)<=J?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(d)),t.x=this.a*e*c*Math.sin(d)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(d))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,u,this.e))-B,r=Math.cos(i),s=Math.sin(i),Math.abs(this.coslat0)<=J?(o=cn(this.e,h*this.con,this.con*u),t.x=this.x0+(a=2*this.a*this.k0*o/this.cons)*Math.sin(l-this.long0),t.y=this.y0-this.con*a*Math.cos(l-this.long0),t):(Math.abs(this.sinlat0)<J?(e=2*this.a*this.k0/(1+r*Math.cos(d)),t.y=e*s):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*r*Math.cos(d))),t.y=e*(this.cosX0*s-this.sinX0*r*Math.cos(d))+this.y0),t.x=e*r*Math.sin(d)+this.x0,t))},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,s,r,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,i=this.lat0,o<=J?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<J?st(this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y)):st(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=J){if(o<=J)return i=this.lat0,t.x=e=this.long0,t.y=i,t;t.x*=this.con,t.y*=this.con,i=this.con*Ba(this.e,o*this.cons/(2*this.a*this.k0)),e=this.con*st(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else s=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=J?r=this.X0:(r=Math.asin(Math.cos(s)*this.sinX0+t.y*Math.sin(s)*this.cosX0/o),e=st(this.long0+Math.atan2(t.x*Math.sin(s),o*this.cosX0*Math.cos(s)-t.y*this.sinX0*Math.sin(s)))),i=-1*Ba(this.e,Math.tan(.5*(B+r)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(B+t))*Math.pow((1-e)/(1+e),.5*i)}},cS={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,s=1/this.rf,r=2*s-Math.pow(s,2),o=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),s=2*(Math.atan(Math.exp(-this.alpha*(e+i)+this.K))-Math.PI/4),r=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(r))),a=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(r));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=(t.x-this.x0)/this.R,i=2*(Math.atan(Math.exp((t.y-this.y0)/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(e)),r=Math.atan(Math.sin(e)/(Math.cos(this.b0)*Math.cos(e)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+r/this.alpha,a=0,l=s,h=-1e3,u=0;Math.abs(l-h)>1e-7;){if(++u>20)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(a))-Math.PI/2}return t.x=o,t.y=l,t},names:["somerc"]};var mo=1e-7;const dS={init:function(){var t,e,i,s,r,o,a,l,h,u,c,d=0,p=0,f=0,g=0,m=0,y=0,_=0;this.no_off=function(w){var S=typeof w.PROJECTION=="object"?Object.keys(w.PROJECTION)[0]:w.PROJECTION;return"no_uoff"in w||"no_off"in w||["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(S)!==-1}(this),this.no_rot="no_rot"in this;var v=!1;"alpha"in this&&(v=!0);var x=!1;if("rectified_grid_angle"in this&&(x=!0),v&&(_=this.alpha),x&&(d=this.rectified_grid_angle*Je),v||x)p=this.longc;else if(f=this.long1,m=this.lat1,g=this.long2,y=this.lat2,Math.abs(m-y)<=mo||(t=Math.abs(m))<=mo||Math.abs(t-B)<=mo||Math.abs(Math.abs(this.lat0)-B)<=mo||Math.abs(Math.abs(y)-B)<=mo)throw new Error;var b=1-this.es;e=Math.sqrt(b),Math.abs(this.lat0)>J?(l=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*l*l,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*e/t,(r=(s=this.B*e/(i*Math.sqrt(t)))*s-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=s,this.E*=Math.pow(cn(this.e,this.lat0,l),this.B)):(this.B=1/e,this.A=this.k0,this.E=s=r=1),v||x?(v?(c=Math.asin(Math.sin(_)/s),x||(d=_)):(c=d,_=Math.asin(s*Math.sin(c))),this.lam0=p-Math.asin(.5*(r-1/r)*Math.tan(c))/this.B):(o=Math.pow(cn(this.e,m,Math.sin(m)),this.B),a=Math.pow(cn(this.e,y,Math.sin(y)),this.B),r=this.E/o,h=(a-o)/(a+o),u=((u=this.E*this.E)-a*o)/(u+a*o),(t=f-g)<-Math.pi?g-=Ga:t>Math.pi&&(g+=Ga),this.lam0=st(.5*(f+g)-Math.atan(u*Math.tan(.5*this.B*(f-g))/h)/this.B),c=Math.atan(2*Math.sin(this.B*st(f-this.lam0))/(r-1/r)),d=_=Math.asin(s*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(s*s-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(ne-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(ne+r))},forward:function(t){var e,i,s,r,o,a,l,h,u={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-B)>J){if(e=.5*((o=this.E/Math.pow(cn(this.e,t.y,Math.sin(t.y)),this.B))-(a=1/o)),i=.5*(o+a),r=Math.sin(this.B*t.x),s=(e*this.singam-r*this.cosgam)/i,Math.abs(Math.abs(s)-1)<J)throw new Error;h=.5*this.ArB*Math.log((1-s)/(1+s)),a=Math.cos(this.B*t.x),l=Math.abs(a)<mo?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,a)}else h=t.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*t.y;return this.no_rot?(u.x=l,u.y=h):(u.x=h*this.cosrot+(l-=this.u_0)*this.sinrot,u.y=l*this.cosrot-h*this.sinrot),u.x=this.a*u.x+this.x0,u.y=this.a*u.y+this.y0,u},inverse:function(t){var e,i,s,r,o,a,l,h={};if(t.x=1/this.a*(t.x-this.x0),t.y=1/this.a*(t.y-this.y0),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((s=Math.exp(-this.BrA*i))-1/s),o=.5*(s+1/s),l=((a=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/o,Math.abs(Math.abs(l)-1)<J)h.x=0,h.y=l<0?-B:B;else{if(h.y=this.E/Math.sqrt((1+l)/(1-l)),h.y=Ba(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(r*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},pS={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<J)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),s=Sn(this.e,e,i),r=cn(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),l=Sn(this.e,o,a),h=cn(this.e,this.lat2,o),u=cn(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>J?Math.log(s/l)/Math.log(r/h):e,isNaN(this.ns)&&(this.ns=e),this.f0=s/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=J&&(i=Va(i)*(B-2*J));var s,r,o=Math.abs(Math.abs(i)-B);if(o>J)s=cn(this.e,i,Math.sin(i)),r=this.a*this.f0*Math.pow(s,this.ns);else{if((o=i*this.ns)<=0)return null;r=0}var a=this.ns*st(e-this.long0);return t.x=this.k0*(r*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(a))+this.y0,t},inverse:function(t){var e,i,s,r,o,a=(t.x-this.x0)/this.k0,l=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+l*l),i=1):(e=-Math.sqrt(a*a+l*l),i=-1);var h=0;if(e!==0&&(h=Math.atan2(i*a,i*l)),e!==0||this.ns>0){if(i=1/this.ns,s=Math.pow(e/(this.a*this.f0),i),(r=Ba(this.e,s))===-9999)return null}else r=-B;return o=st(h/this.ns+this.long0),t.x=o,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},fS={init:function(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,s,r,o,a,l,h=t.y,u=st(t.x-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),s=-u*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(s)),o=Math.asin(Math.cos(i)*Math.sin(s)/Math.cos(r)),a=this.n*o,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=l*Math.cos(a)/1,t.x=l*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,s,r,o,a,l,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),s=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(r)),i=Math.asin(Math.cos(s)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,a=e,l=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1;while(l===0&&u<15);return u>=15?null:t},names:["Krovak","krovak"]};function hi(n,t,e,i,s){return n*s-t*Math.sin(2*s)+e*Math.sin(4*s)-i*Math.sin(6*s)}function Za(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Ya(n){return .375*n*(1+.25*n*(1+.46875*n))}function $a(n){return .05859375*n*n*(1+.75*n)}function Ka(n){return n*n*n*(35/3072)}function yo(n,t,e){var i=t*e;return n/Math.sqrt(1-i*i)}function _o(n){return Math.abs(n)<B?n:n-Va(n)*Math.PI}function nu(n,t,e,i,s){var r,o;r=n/t;for(var a=0;a<15;a++)if(r+=o=(n-(t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-s*Math.sin(6*r)))/(t-2*e*Math.cos(2*r)+4*i*Math.cos(4*r)-6*s*Math.cos(6*r)),Math.abs(o)<=1e-10)return r;return NaN}const gS={init:function(){this.sphere||(this.e0=Za(this.es),this.e1=Ya(this.es),this.e2=$a(this.es),this.e3=Ka(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,s=t.x,r=t.y;if(s=st(s-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(s)),i=this.a*(Math.atan2(Math.tan(r),Math.cos(s))-this.lat0);else{var o=Math.sin(r),a=Math.cos(r),l=yo(this.a,this.e,o),h=Math.tan(r)*Math.tan(r),u=s*Math.cos(r),c=u*u,d=this.es*a*a/(1-this.es);e=l*u*(1-c*h*(1/6-(8-h+8*d)*c/120)),i=this.a*hi(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+l*o/a*c*(.5+(5-h+6*d)*c/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,s=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(s)),i=Math.atan2(Math.tan(s),Math.cos(o))}else{var a=nu(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-B)<=J)return t.x=this.long0,t.y=B,r<0&&(t.y*=-1),t;var l=yo(this.a,this.e,Math.sin(a)),h=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),c=s*this.a/l,d=c*c;e=a-l*Math.tan(a)/h*c*c*(.5-(1+3*u)*c*c/24),i=c*(1-d*(u/3+(1+3*u)*u*d/15))/Math.cos(a)}return t.x=st(i+this.long0),t.y=_o(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Ts(n,t){var e;return n>1e-7?(1-n*n)*(t/(1-(e=n*t)*e)-.5/n*Math.log((1-e)/(1+e))):2*t}const mS={init:function(){var t,e=Math.abs(this.lat0);if(this.mode=Math.abs(e-B)<J?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<J?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=Ts(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(s){var r,o=[];return o[0]=.3333333333333333*s,o[0]+=.17222222222222222*(r=s*s),o[1]=.06388888888888888*r,o[0]+=.10257936507936508*(r*=s),o[1]+=.0664021164021164*r,o[2]=.016415012942191543*r,o}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Ts(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,s,r,o,a,l,h,u,c,d=t.x,p=t.y;if(d=st(d-this.long0),this.sphere){if(o=Math.sin(p),c=Math.cos(p),s=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+c*s:1+this.sinph0*o+this.cosph0*c*s)<=J)return null;e=(i=Math.sqrt(2/i))*c*Math.sin(d),i*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*s}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),Math.abs(p+this.lat0)<J)return null;i=ne-.5*p,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(d),i*=s}}else{switch(l=0,h=0,u=0,s=Math.cos(d),r=Math.sin(d),o=Math.sin(p),a=Ts(this.e,o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=a/this.qp,h=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:u=1+this.sinb1*l+this.cosb1*h*s;break;case this.EQUIT:u=1+h*s;break;case this.N_POLE:u=B+p,a=this.qp-a;break;case this.S_POLE:u=p-B,a=this.qp+a}if(Math.abs(u)<J)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),i=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*l-this.sinb1*h*s):(u=Math.sqrt(2/(1+h*s)))*l*this.ymf,e=this.xmf*u*h*r;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*r,i=s*(this.mode===this.S_POLE?u:-u)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,s,r,o,a,l,h=t.x/this.a,u=t.y/this.a;if(this.sphere){var c,d=0,p=0;if((i=.5*(c=Math.sqrt(h*h+u*u)))>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(i),d=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(c)<=J?0:Math.asin(u*p/c),h*=p,u=d*c;break;case this.OBLIQ:i=Math.abs(c)<=J?this.lat0:Math.asin(d*this.sinph0+u*p*this.cosph0/c),h*=p*this.cosph0,u=(d-Math.sin(i)*this.sinph0)*c;break;case this.N_POLE:u=-u,i=B-i;break;case this.S_POLE:i-=B}e=u!==0||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(h,u):0}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h/=this.dd,u*=this.dd,(a=Math.sqrt(h*h+u*u))<J)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*a/this.rq),s=Math.cos(r),h*=r=Math.sin(r),this.mode===this.OBLIQ?(o=this.qp*(l=s*this.sinb1+u*r*this.cosb1/a),u=a*this.cosb1*s-u*this.sinb1*r):(o=this.qp*(l=u*r/a),u=a*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),!(o=h*h+u*u))return t.x=this.long0,t.y=this.lat0,t;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}e=Math.atan2(h,u),i=function(g,m){var y=g+g;return g+m[0]*Math.sin(y)+m[1]*Math.sin(y+y)+m[2]*Math.sin(y+y+y)}(Math.asin(l),this.apa)}return t.x=st(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Is(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}const yS={init:function(){Math.abs(this.lat1+this.lat2)<J||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Sn(this.e3,this.sin_po,this.cos_po),this.qs1=Ts(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Sn(this.e3,this.sin_po,this.cos_po),this.qs2=Ts(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ts(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>J?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var s=Ts(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*s)/this.ns0,o=this.ns0*st(e-this.long0),a=r*Math.sin(o)+this.x0,l=this.rh-r*Math.cos(o)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i,s,r,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),s=0,e!==0&&(s=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,o=this.sphere?Math.asin((this.c-i*i)/(2*this.ns0)):this.phi1z(this.e3,(this.c-i*i)/this.ns0),r=st(s/this.ns0+this.long0),t.x=r,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,s,r,o,a=Is(.5*e);if(t<J)return a;for(var l=t*t,h=1;h<=25;h++)if(a+=o=.5*(r=1-(s=t*(i=Math.sin(a)))*s)*r/Math.cos(a)*(e/(1-l)-i/r+.5/t*Math.log((1-s)/(1+s))),Math.abs(o)<=1e-7)return a;return null}},_S={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,s,r,o,a,l,h=t.y;return s=st(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(s),(o=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(o)<=J?(a=this.x0+1*this.a*i*Math.sin(s)/o,l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)/o):(a=this.x0+this.infinity_dist*i*Math.sin(s),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*r)),t.x=a,t.y=l,t},inverse:function(t){var e,i,s,r,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),i=Math.sin(r),a=Is((s=Math.cos(r))*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.atan2(t.x*i,e*this.cos_p14*s-t.y*this.sin_p14*i),o=st(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t},names:["gnom"]},vS={init:function(){this.sphere||(this.k0=Sn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,s=t.y,r=st(t.x-this.long0);if(this.sphere)e=this.x0+this.a*r*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var o=Ts(this.e,Math.sin(s));e=this.x0+this.a*this.k0*r,i=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=st(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(r,o){var a=1-(1-r*r)/(2*r)*Math.log((1-r)/(1+r));if(Math.abs(Math.abs(o)-a)<1e-6)return o<0?-1*B:B;for(var l,h,u,c,d=Math.asin(.5*o),p=0;p<30;p++)if(h=Math.sin(d),u=Math.cos(d),c=r*h,d+=l=Math.pow(1-c*c,2)/(2*u)*(o/(1-r*r)-h/(1-c*c)+.5/r*Math.log((1-c)/(1+c))),Math.abs(l)<=1e-10)return d;return NaN}(this.e,2*t.y*this.k0/this.a),e=st(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},xS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.y,i=st(t.x-this.long0),s=_o(e-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*s,t},inverse:function(t){var e=t.y;return t.x=st(this.long0+(t.x-this.x0)/(this.a*this.rc)),t.y=_o(this.lat0+(e-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},bS={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Za(this.es),this.e1=Ya(this.es),this.e2=$a(this.es),this.e3=Ka(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,s,r=t.y,o=st(t.x-this.long0);if(s=o*Math.sin(r),this.sphere)Math.abs(r)<=J?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(s)/Math.tan(r),i=this.a*(_o(r-this.lat0)+(1-Math.cos(s))/Math.tan(r)));else if(Math.abs(r)<=J)e=this.a*o,i=-1*this.ml0;else{var a=yo(this.a,this.e,Math.sin(r))/Math.tan(r);e=a*Math.sin(s),i=this.a*hi(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*(1-Math.cos(s))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,s,r,o,a,l,h,u;if(s=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=J)e=st(s/this.a+this.long0),i=0;else{var c;for(l=s*s/this.a/this.a+(a=this.lat0+r/this.a)*a,h=a,o=20;o;--o)if(h+=u=-1*(a*(h*(c=Math.tan(h))+1)-h-.5*(h*h+l)*c)/((h-a)/c-1),Math.abs(u)<=J){i=h;break}e=st(this.long0+Math.asin(s*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(r+this.ml0)<=J)i=0,e=st(this.long0+s/this.a);else{var d,p,f,g,m;for(l=s*s/this.a/this.a+(a=(this.ml0+r)/this.a)*a,h=a,o=20;o;--o)if(m=this.e*Math.sin(h),d=Math.sqrt(1-m*m)*Math.tan(h),p=this.a*hi(this.e0,this.e1,this.e2,this.e3,h),f=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=u=(a*(d*(g=p/this.a)+1)-g-.5*d*(g*g+l))/(this.es*Math.sin(2*h)*(g*g+l-2*a*g)/(4*d)+(a-g)*(d*f-2/Math.sin(2*h))-f),Math.abs(u)<=J){i=h;break}d=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=st(this.long0+Math.asin(s*d/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},wS={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=(t.y-this.lat0)/ja*1e-5,s=t.x-this.long0,r=1,o=0;for(e=1;e<=10;e++)o+=this.A[e]*(r*=i);var a,l=o,h=s,u=1,c=0,d=0,p=0;for(e=1;e<=6;e++)a=c*l+u*h,d=d+this.B_re[e]*(u=u*l-c*h)-this.B_im[e]*(c=a),p=p+this.B_im[e]*u+this.B_re[e]*c;return t.x=p*this.a+this.x0,t.y=d*this.a+this.y0,t},inverse:function(t){var e,i,s=(t.y-this.y0)/this.a,r=(t.x-this.x0)/this.a,o=1,a=0,l=0,h=0;for(e=1;e<=6;e++)i=a*s+o*r,l=l+this.C_re[e]*(o=o*s-a*r)-this.C_im[e]*(a=i),h=h+this.C_im[e]*o+this.C_re[e]*a;for(var u=0;u<this.iterations;u++){var c,d=l,p=h,f=s,g=r;for(e=2;e<=6;e++)c=p*l+d*h,f+=(e-1)*(this.B_re[e]*(d=d*l-p*h)-this.B_im[e]*(p=c)),g+=(e-1)*(this.B_im[e]*d+this.B_re[e]*p);d=1,p=0;var m=this.B_re[1],y=this.B_im[1];for(e=2;e<=6;e++)c=p*l+d*h,m+=e*(this.B_re[e]*(d=d*l-p*h)-this.B_im[e]*(p=c)),y+=e*(this.B_im[e]*d+this.B_re[e]*p);var _=m*m+y*y;l=(f*m+g*y)/_,h=(g*m-f*y)/_}var v=l,x=h,b=1,M=0;for(e=1;e<=9;e++)M+=this.D[e]*(b*=v);var w=this.lat0+M*ja*1e5;return t.x=this.long0+x,t.y=w,t},names:["New_Zealand_Map_Grid","nzmg"]},CS={init:function(){},forward:function(t){var e=t.y,i=st(t.x-this.long0),s=this.x0+this.a*i,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return t.x=s,t.y=r,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=st(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},MS={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=wv(this.es)},forward:function(t){var e,i,s=t.x,r=t.y;if(s=st(s-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(r),a=20;a;--a){var l=(this.m*r+Math.sin(r)-o)/(this.m+Math.cos(r));if(r-=l,Math.abs(l)<J)break}else r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*s*(this.m+Math.cos(r)),i=this.a*this.C_y*r}else{var h=Math.sin(r),u=Math.cos(r);i=this.a*tu(r,h,u,this.en),e=this.a*s*u/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,s;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Is((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Is(Math.sin(e)/this.n)),i=st(i+this.long0),e=_o(e)):(e=Cv(t.y/this.a,this.es,this.en),(s=Math.abs(e))<B?(s=Math.sin(e),i=st(this.long0+t.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(e)))):s-J<B&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},SS={init:function(){},forward:function(t){for(var e=t.y,i=st(t.x-this.long0),s=e,r=Math.PI*Math.sin(e);;){var o=-(s+Math.sin(s)-r)/(1+Math.cos(s));if(s+=o,Math.abs(o)<J)break}s/=2,Math.PI/2-Math.abs(e)<J&&(i=0);var a=.900316316158*this.a*i*Math.cos(s)+this.x0,l=1.4142135623731*this.a*Math.sin(s)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var s=st(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));s<-Math.PI&&(s=-Math.PI),s>Math.PI&&(s=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var r=Math.asin(i);return t.x=s,t.y=r,t},names:["Mollweide","moll"]},ES={init:function(){Math.abs(this.lat1+this.lat2)<J||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Za(this.es),this.e1=Ya(this.es),this.e2=$a(this.es),this.e3=Ka(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Sn(this.e,this.sinphi,this.cosphi),this.ml1=hi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<J?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Sn(this.e,this.sinphi,this.cosphi),this.ml2=hi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=hi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,s=t.y;if(this.sphere)e=this.a*(this.g-s);else{var r=hi(this.e0,this.e1,this.e2,this.e3,s);e=this.a*(this.g-r)}var o=this.ns*st(i-this.long0),a=this.x0+e*Math.sin(o),l=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=l,t},inverse:function(t){var e,i,s,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;return i!==0&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=st(this.long0+o/this.ns),s=_o(this.g-i/this.a),t.x=r,t.y=s,t):(s=nu(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),r=st(this.long0+o/this.ns),t.x=r,t.y=s,t)},names:["Equidistant_Conic","eqdc"]},TS={init:function(){this.R=this.a},forward:function(t){var e,i,s=t.y,r=st(t.x-this.long0);Math.abs(s)<=J&&(e=this.x0+this.R*r,i=this.y0);var o=Is(2*Math.abs(s/Math.PI));(Math.abs(r)<=J||Math.abs(Math.abs(s)-B)<=J)&&(e=this.x0,i=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),l=a*a,h=Math.sin(o),u=Math.cos(o),c=u/(h+u-1),d=c*(2/h-1),p=d*d,f=Math.PI*this.R*(a*(c-p)+Math.sqrt(l*(c-p)*(c-p)-(p+l)*(c*c-p)))/(p+l);r<0&&(f=-f),e=this.x0+f;var g=l+c;return f=Math.PI*this.R*(d*g-a*Math.sqrt((p+l)*(l+1)-g*g))/(p+l),i=s>=0?this.y0+f:this.y0-f,t.x=e,t.y=i,t},inverse:function(t){var e,i,s,r,o,a,l,h,u,c,d,p;return t.x-=this.x0,t.y-=this.y0,d=Math.PI*this.R,o=(s=t.x/d)*s+(r=t.y/d)*r,d=3*(r*r/(h=-2*(a=-Math.abs(r)*(1+o))+1+2*r*r+o*o)+(2*(l=a-2*r*r+s*s)*l*l/h/h/h-9*a*l/h/h)/27)/(u=(a-l*l/3/h)/h)/(c=2*Math.sqrt(-u/3)),Math.abs(d)>1&&(d=d>=0?1:-1),p=Math.acos(d)/3,i=t.y>=0?(-c*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI:-(-c*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI,e=Math.abs(s)<J?this.long0:st(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(s*s-r*r)+o*o))/2/s),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},IS={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,s,r,o,a,l,h,u,c,d,p,f,g,m,y,_,v,x,b,M,w,S=t.x,k=t.y,I=Math.sin(t.y),R=Math.cos(t.y),E=st(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=J?(t.x=this.x0+this.a*(B-k)*Math.sin(E),t.y=this.y0-this.a*(B-k)*Math.cos(E),t):Math.abs(this.sin_p12+1)<=J?(t.x=this.x0+this.a*(B+k)*Math.sin(E),t.y=this.y0+this.a*(B+k)*Math.cos(E),t):(v=this.sin_p12*I+this.cos_p12*R*Math.cos(E),_=(y=Math.acos(v))?y/Math.sin(y):1,t.x=this.x0+this.a*_*R*Math.sin(E),t.y=this.y0+this.a*_*(this.cos_p12*I-this.sin_p12*R*Math.cos(E)),t):(e=Za(this.es),i=Ya(this.es),s=$a(this.es),r=Ka(this.es),Math.abs(this.sin_p12-1)<=J?(o=this.a*hi(e,i,s,r,B),a=this.a*hi(e,i,s,r,k),t.x=this.x0+(o-a)*Math.sin(E),t.y=this.y0-(o-a)*Math.cos(E),t):Math.abs(this.sin_p12+1)<=J?(o=this.a*hi(e,i,s,r,B),a=this.a*hi(e,i,s,r,k),t.x=this.x0+(o+a)*Math.sin(E),t.y=this.y0+(o+a)*Math.cos(E),t):(l=I/R,h=yo(this.a,this.e,this.sin_p12),u=yo(this.a,this.e,I),c=Math.atan((1-this.es)*l+this.es*h*this.sin_p12/(u*R)),x=(d=Math.atan2(Math.sin(E),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(E)))===0?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(d)-Math.PI)<=J?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(E)*Math.cos(c)/Math.sin(d)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),f=this.e*this.cos_p12*Math.cos(d)/Math.sqrt(1-this.es),t.x=this.x0+(y=h*x*(1-(b=x*x)*(m=f*f)*(1-m)/6+(M=b*x)/8*(g=p*f)*(1-2*m)+(w=M*x)/120*(m*(4-7*m)-3*p*p*(1-7*m))-w*x/48*g))*Math.sin(d),t.y=this.y0+y*Math.cos(d),t))},inverse:function(t){var e,i,s,r,o,a,l,h,u,c,d,p,f,g,m,y,_,v,x,b,M,w,S;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y))>2*B*this.a?void 0:(i=e/this.a,s=Math.sin(i),r=Math.cos(i),o=this.long0,Math.abs(e)<=J?a=this.lat0:(a=Is(r*this.sin_p12+t.y*s*this.cos_p12/e),l=Math.abs(this.lat0)-B,o=Math.abs(l)<=J?st(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)):st(this.long0+Math.atan2(t.x*s,e*this.cos_p12*r-t.y*this.sin_p12*s))),t.x=o,t.y=a,t):(h=Za(this.es),u=Ya(this.es),c=$a(this.es),d=Ka(this.es),Math.abs(this.sin_p12-1)<=J?(a=nu(((p=this.a*hi(h,u,c,d,B))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,u,c,d),o=st(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=J?(p=this.a*hi(h,u,c,d,B),a=nu(((e=Math.sqrt(t.x*t.x+t.y*t.y))-p)/this.a,h,u,c,d),o=st(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),f=yo(this.a,this.e,this.sin_p12),y=Math.cos(m),x=3*this.es*(1-(v=-(_=this.e*this.cos_p12*y)*_/(1-this.es)))*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-v*(M=(b=e/f)-v*(1+v)*Math.pow(b,3)/6-x*(1+3*v)*Math.pow(b,4)/24)*M/2-b*M*M*M/6,g=Math.asin(this.sin_p12*Math.cos(M)+this.cos_p12*Math.sin(M)*y),o=st(this.long0+Math.asin(Math.sin(m)*Math.sin(M)/Math.cos(g))),S=Math.sin(g),a=Math.atan2((S-this.es*w*this.sin_p12)*Math.tan(g),S*(1-this.es)),t.x=o,t.y=a,t))},names:["Azimuthal_Equidistant","aeqd"]},kS={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,s,r,o,a,l,h=t.y;return s=st(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(s),((o=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(o)<=J)&&(a=1*this.a*i*Math.sin(s),l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)),t.x=a,t.y=l,t},inverse:function(t){var e,i,s,r,o,a,l;return t.x-=this.x0,t.y-=this.y0,i=Is((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),s=Math.sin(i),r=Math.cos(i),a=this.long0,Math.abs(e)<=J?(l=this.lat0,t.x=a,t.y=l,t):(l=Is(r*this.sin_p14+t.y*s*this.cos_p14/e),o=Math.abs(this.lat0)-B,Math.abs(o)<=J?(a=st(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=l,t):(a=st(this.long0+Math.atan2(t.x*s,e*this.cos_p14*r-t.y*this.sin_p14*s)),t.x=a,t.y=l,t))},names:["ortho"]};var ks=1,Ps=2,Rs=3,vo=4;function su(n,t,e,i){var s;return n<J?(i.value=ks,s=0):(s=Math.atan2(t,e),Math.abs(s)<=ne?i.value=ks:s>ne&&s<=B+ne?(i.value=Ps,s-=B):s>B+ne||s<=-(B+ne)?(i.value=Rs,s=s>=0?s-De:s+De):(i.value=vo,s+=B)),s}function xo(n,t){var e=n+t;return e<-De?e+=Ga:e>+De&&(e-=Ga),e}const PS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=B-ne/2?5:this.lat0<=-(B-ne/2)?6:Math.abs(this.long0)<=ne?1:Math.abs(this.long0)<=B+ne?this.long0>0?2:4:3,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,s,r,o,a,l={x:0,y:0},h={value:0};if(t.x-=this.long0,e=this.es!==0?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===5)r=B-e,i>=ne&&i<=B+ne?(h.value=ks,s=i-B):i>B+ne||i<=-(B+ne)?(h.value=Ps,s=i>0?i-De:i+De):i>-(B+ne)&&i<=-ne?(h.value=Rs,s=i+B):(h.value=vo,s=i);else if(this.face===6)r=B+e,i>=ne&&i<=B+ne?(h.value=ks,s=-i+B):i<ne&&i>=-ne?(h.value=Ps,s=-i):i<-ne&&i>=-(B+ne)?(h.value=Rs,s=-i-B):(h.value=vo,s=i>0?-i+De:-i-De);else{var u,c,d,p,f,g;this.face===2?i=xo(i,+B):this.face===3?i=xo(i,+De):this.face===4&&(i=xo(i,-B)),p=Math.sin(e),f=Math.cos(e),g=Math.sin(i),u=f*Math.cos(i),c=f*g,d=p,this.face===1?s=su(r=Math.acos(u),d,c,h):this.face===2?s=su(r=Math.acos(c),d,-u,h):this.face===3?s=su(r=Math.acos(-u),d,-c,h):this.face===4?s=su(r=Math.acos(-c),d,u,h):(r=s=0,h.value=ks)}return a=Math.atan(12/De*(s+Math.acos(Math.sin(s)*Math.cos(ne))-B)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(s))))),h.value===Ps?a+=B:h.value===Rs?a+=De:h.value===vo&&(a+=1.5*De),l.x=o*Math.cos(a),l.y=o*Math.sin(a),l.x=l.x*this.a+this.x0,l.y=l.y*this.a+this.y0,t.x=l.x,t.y=l.y,t},inverse:function(t){var e,i,s,r,o,a,l,h,u,c,d,p,f={lam:0,phi:0},g={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?g.value=ks:t.y>=0&&t.y>=Math.abs(t.x)?(g.value=Ps,e-=B):t.x<0&&-t.x>=Math.abs(t.y)?(g.value=Rs,e=e<0?e+De:e-De):(g.value=vo,e+=B),u=De/12*Math.tan(e),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),(l=1-(s=Math.cos(e))*s*(r=Math.tan(i))*r*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?l=-1:l>1&&(l=1),this.face===5)h=Math.acos(l),f.phi=B-h,f.lam=g.value===ks?a+B:g.value===Ps?a<0?a+De:a-De:g.value===Rs?a-B:a;else if(this.face===6)h=Math.acos(l),f.phi=h-B,f.lam=g.value===ks?-a+B:g.value===Ps?-a:g.value===Rs?-a-B:a<0?-a-De:-a+De;else{var m,y,_;u=(m=l)*m,y=(u+=(_=u>=1?0:Math.sqrt(1-u)*Math.sin(a))*_)>=1?0:Math.sqrt(1-u),g.value===Ps?(u=y,y=-_,_=u):g.value===Rs?(y=-y,_=-_):g.value===vo&&(u=y,y=_,_=-u),this.face===2?(u=m,m=-y,y=u):this.face===3?(m=-m,y=-y):this.face===4&&(u=m,m=y,y=-u),f.phi=Math.acos(-_)-B,f.lam=Math.atan2(y,m),this.face===2?f.lam=xo(f.lam,-B):this.face===3?f.lam=xo(f.lam,-De):this.face===4&&(f.lam=xo(f.lam,+B))}return this.es!==0&&(c=f.phi<0?1:0,d=Math.tan(f.phi),p=this.b/Math.sqrt(d*d+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),c&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var af=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Ja=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ev=wn/5,RS=1/Ev,ru=function(n,t){return n[0]+t*(n[1]+t*(n[2]+t*n[3]))};const FS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=st(t.x-this.long0),i=Math.abs(t.y),s=Math.floor(i*Ev);s<0?s=0:s>=18&&(s=17);var r={x:ru(af[s],i=wn*(i-RS*s))*e,y:ru(Ja[s],i)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*.8487+this.x0,r.y=r.y*this.a*1.3523+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(e.y>=1)e.x/=af[18][0],e.y=t.y<0?-B:B;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(Ja[i][0]>e.y)--i;else{if(!(Ja[i+1][0]<=e.y))break;++i}var s=Ja[i],r=5*(e.y-s[0])/(Ja[i+1][0]-s[0]);r=function(a,l,h,u){for(var c=l;u;--u){var d=a(c);if(c-=d,Math.abs(d)<h)break}return c}(function(o){return(ru(s,o)-e.y)/function(a,l){return a[1]+l*(2*a[2]+3*l*a[3])}(s,o)},r,J,100),e.x/=ru(af[i],r),e.y=(5*i+r)*Je,t.y<0&&(e.y=-e.y)}return e.x=st(e.x+this.long0),e},names:["Robinson","robin"]},OS={init:function(){this.name="geocent"},forward:function(t){return nv(t,this.es,this.a)},inverse:function(t){return sv(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var Qa={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const AS={init:function(){if(Object.keys(Qa).forEach((function(i){if(typeof this[i]>"u")this[i]=Qa[i].def;else{if(Qa[i].num&&isNaN(this[i]))throw new Error("Invalid parameter value, must be numeric "+i+" = "+this[i]);Qa[i].num&&(this[i]=parseFloat(this[i]))}Qa[i].degrees&&(this[i]=this[i]*Je)}).bind(this)),Math.abs(Math.abs(this.lat0)-B)<J?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<J?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,s,r,o=Math.sin(t.y),a=Math.cos(t.y),l=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*o+this.cosph0*a*l;break;case 2:i=a*l;break;case 1:i=-o;break;case 0:i=o}switch(e=(i=this.pn1/(this.p-i))*a*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*o-this.sinph0*a*l;break;case 2:i*=o;break;case 0:i*=-a*l;break;case 1:i*=a*l}return e=(e*this.cg-i*this.sg)*this.cw*(r=1/((s=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw)),i=s*r,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,s,r={x:t.x,y:t.y};t.x=(e=this.pn1*t.x*(s=1/(this.pn1-t.y*this.sw)))*this.cg+(i=this.pn1*t.y*this.cw*s)*this.sg,t.y=i*this.cg-e*this.sg;var o=Wi(t.x,t.y);if(Math.abs(o)<J)r.x=0,r.y=t.y;else{var a,l;switch(l=1-o*o*this.pfact,l=(this.p-Math.sqrt(l))/(this.pn1/o+o/this.pn1),a=Math.sqrt(1-l*l),this.mode){case 3:r.y=Math.asin(a*this.sinph0+t.y*l*this.cosph0/o),t.y=(a-this.sinph0*Math.sin(r.y))*o,t.x*=l*this.cosph0;break;case 2:r.y=Math.asin(t.y*l/o),t.y=a*o,t.x*=l;break;case 0:r.y=Math.asin(a),t.y=-t.y;break;case 1:r.y=-Math.asin(a)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]},LS={init:function(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,s,r,o=t.x,a=t.y;if(o-=this.long0,this.shape==="ellipse"){a=Math.atan(this.radius_p2*Math.tan(a));var l=this.radius_p/Wi(this.radius_p*Math.cos(a),Math.sin(a));if(i=l*Math.cos(o)*Math.cos(a),s=l*Math.sin(o)*Math.cos(a),r=l*Math.sin(a),(this.radius_g-i)*i-s*s-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/Wi(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(s/e),t.y=this.radius_g_1*Math.atan(r/Wi(s,e)))}else this.shape==="sphere"&&(e=Math.cos(a),i=Math.cos(o)*e,s=Math.sin(o)*e,r=Math.sin(a),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/Wi(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(s/e),t.y=this.radius_g_1*Math.atan(r/Wi(s,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,s,r,o=-1,a=0,l=0;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(l=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*Wi(1,l)):(a=Math.tan(t.x/this.radius_g_1),l=Math.tan(t.y/this.radius_g_1)*Wi(1,a));var h=l/this.radius_p;if((s=(i=2*this.radius_g*o)*i-4*(e=a*a+h*h+o*o)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(s))/(2*e),o=this.radius_g+r*o,a*=r,l*=r,t.x=Math.atan2(a,o),t.y=Math.atan(l*Math.cos(t.x)/o),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(l=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+l*l)):(a=Math.tan(t.x/this.radius_g_1),l=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+a*a)),(s=(i=2*this.radius_g*o)*i-4*(e=a*a+l*l+o*o)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(s))/(2*e),o=this.radius_g+r*o,a*=r,l*=r,t.x=Math.atan2(a,o),t.y=Math.atan(l*Math.cos(t.x)/o)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};Pi.defaultDatum="WGS84",Pi.Proj=Ua,Pi.WGS84=new Pi.Proj("WGS84"),Pi.Point=aS,Pi.toPoint=lv,Pi.defs=Yh,Pi.nadgrid=function(t,e){var i=new DataView(e),s=function(h){var u=h.getInt32(8,!1);return u!==11&&((u=h.getInt32(8,!0))!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),r=function(h,u){return{nFields:h.getInt32(8,u),nSubgridFields:h.getInt32(24,u),nSubgrids:h.getInt32(40,u),shiftType:Qp(h,56,64).trim(),fromSemiMajorAxis:h.getFloat64(120,u),fromSemiMinorAxis:h.getFloat64(136,u),toSemiMajorAxis:h.getFloat64(152,u),toSemiMinorAxis:h.getFloat64(168,u)}}(i,s),o=function(h,u,c){for(var d=176,p=[],f=0;f<u.nSubgrids;f++){var g=eS(h,d,c),m=iS(h,d,g,c),y=Math.round(1+(g.upperLongitude-g.lowerLongitude)/g.longitudeInterval),_=Math.round(1+(g.upperLatitude-g.lowerLatitude)/g.latitudeInterval);p.push({ll:[po(g.lowerLongitude),po(g.lowerLatitude)],del:[po(g.longitudeInterval),po(g.latitudeInterval)],lim:[y,_],count:g.gridNodeCount,cvs:tS(m)}),d+=176+16*g.gridNodeCount}return p}(i,r,s),a={header:r,subgrids:o};return iv[t]=a,a},Pi.transform=Qh,Pi.mgrs=sS,Pi.version="__VERSION__",function(t){t.Proj.projections.add(eu),t.Proj.projections.add(iu),t.Proj.projections.add(lS),t.Proj.projections.add(hS),t.Proj.projections.add(uS),t.Proj.projections.add(cS),t.Proj.projections.add(dS),t.Proj.projections.add(pS),t.Proj.projections.add(fS),t.Proj.projections.add(gS),t.Proj.projections.add(mS),t.Proj.projections.add(yS),t.Proj.projections.add(_S),t.Proj.projections.add(vS),t.Proj.projections.add(xS),t.Proj.projections.add(bS),t.Proj.projections.add(wS),t.Proj.projections.add(CS),t.Proj.projections.add(MS),t.Proj.projections.add(SS),t.Proj.projections.add(ES),t.Proj.projections.add(TS),t.Proj.projections.add(IS),t.Proj.projections.add(kS),t.Proj.projections.add(PS),t.Proj.projections.add(FS),t.Proj.projections.add(OS),t.Proj.projections.add(AS),t.Proj.projections.add(LS)}(Pi);const ou=Pi,lf="NetherlandsRDNewQuad",Tv="EuropeanETRS89_LAEAQuad";function Iv(){ou.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs"),ou.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs"),ou.defs("EPSG:4258","+proj=longlat +ellps=GRS80 +no_defs +type=crs"),function(t){zM=t;const e=Object.keys(t.defs),i=e.length;let s,r;for(s=0;s<i;++s){const o=e[s];if(!Bt(o)){const a=t.defs(o);let l=a.units;!l&&a.projName==="longlat"&&(l="degrees"),z1(new Un({code:o,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:l}))}}for(s=0;s<i;++s){const o=e[s],a=Bt(o);for(r=0;r<i;++r){const l=e[r],h=Bt(l);if(!k1(o,l))if(t.defs[o]===t.defs[l])lp([a,h]);else{const u=t(o,l);XC(a,h,B1(a,h,u.forward),B1(h,a,u.inverse))}}}}(ou)}class kv{constructor(t){Iv(),this._tileUrl=t}get Projection(){const t=new Un({code:"EPSG:28992",units:"m",extent:[-285401.92,22598.08,595401.92,903401.92],axisOrientation:"enu",global:!1}),e=new Un({code:"EPSG:3857",units:"m",extent:[-20037508342789244e-9,-20037508342789244e-9,20037508342789244e-9,20037508342789244e-9],worldExtent:[-180,-85,180,85],axisOrientation:"enu",global:!0}),i=new Un({axisOrientation:"neu",code:"EPSG:3035",units:"m",extent:[2e6,2.1649406031185603e6,5394791161618613e-9,55e5]});return this._tileUrl.includes(lf)?t:this._tileUrl.includes(Tv)?i:e}}class hf{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ni(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new hf({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return gt()}getImage(t){return gt()}getHitDetectionImage(){return gt()}getPixelRatio(t){return 1}getImageState(){return gt()}getImageSize(){return gt()}getOrigin(){return gt()}getSize(){return gt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ni(t)}listenImageChange(t){gt()}load(){gt()}unlistenImageChange(t){gt()}}const Pv=hf;function En(n){return Array.isArray(n)?w1(n):n}class uf extends Pv{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0&&t.rotateWithView,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius!==void 0?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.render()}clone(){const t=this.getScale(),e=new uf({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,s=Ke(i.size*t,i.size*t);this.draw_(i,s,t),e=s.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return 2}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius_,r=this.radius2_===void 0?s:this.radius2_;if(s<r){const y=s;s=r,r=y}const o=2*Math.PI/(this.radius2_===void 0?this.points_:2*this.points_),a=r*Math.sin(o),l=s-Math.sqrt(r*r-a*a),h=Math.sqrt(a*a+l*l),u=h/a;if(t==="miter"&&u<=i)return u*e;const c=e/2/u,d=e/2*(l/h),p=Math.sqrt((s+c)*(s+c)+d*d)-s;if(this.radius2_===void 0||t==="bevel")return 2*p;const f=s*Math.sin(o),g=r-Math.sqrt(s*s-f*f),m=Math.sqrt(f*f+g*g)/f;return m<=i?2*Math.max(p,m*e/2-r-s):2*p}createRenderOptions(){let t,e=to,i=eo,s=0,r=null,o=0,a=0;this.stroke_&&(t=En(this.stroke_.getColor()??Oa),a=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??eo,e=this.stroke_.getLineCap()??to,s=this.stroke_.getMiterLimit()??10);const l=this.calculateLineJoinSize_(i,a,s),h=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:a,size:Math.ceil(2*h+l),lineCap:e,lineDash:r,lineDashOffset:o,lineJoin:i,miterLimit:s}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=yi),e.fillStyle=En(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),s=0;typeof i=="string"&&(i=Eh(i)),i===null?s=1:Array.isArray(i)&&(s=i.length===4?i[3]:1),s===0&&(e=Ke(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const s=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=r+a*o,h=a%2==0?i:s;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=yi,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const Rv=uf;class cf extends Rv{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0&&t.rotateWithView,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new cf({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const tl=cf;class df{constructor(t){this.color_=(t=t||{}).color!==void 0?t.color:null}clone(){const t=this.getColor();return new df({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const Ui=df;let el=null;class DS extends yh{constructor(t,e,i,s,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=s===void 0?0:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===2){el||(el=Ke(1,1,void 0,{willReadFrequently:!0})),el.drawImage(this.image_,0,0);try{el.getImageData(0,0,1,1),this.tainted_=!1}catch{el=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent("change")}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Ke(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===0){this.image_||this.initializeImage_(),this.imageState_=1;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&function(e,i){return i&&(e.src=i),e.src&&s1?new Promise((s,r)=>e.decode().then(()=>s(e)).catch(o=>e.complete&&e.width?s(e):r(o))):function(r,o){return new Promise((a,l)=>{function h(){c(),a(r)}function u(){c(),l(new Error("Image load error"))}function c(){r.removeEventListener("load",h),r.removeEventListener("error",u)}r.addEventListener("load",h),r.addEventListener("error",u),o&&(r.src=o)})}(e)}(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==2)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const s=i.getContext("2d");s.scale(t,t),s.drawImage(e,0,0),s.globalCompositeOperation="multiply",s.fillStyle=v1(this.color_),s.fillRect(0,0,i.width/t,i.height/t),s.globalCompositeOperation="destination-in",s.drawImage(e,0,0),this.canvas_[t]=i}}function Fv(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}class pf extends Pv{constructor(t){super({opacity:(t=t||{}).opacity!==void 0?t.opacity:1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:t.rotateWithView!==void 0&&t.rotateWithView,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const e=t.img!==void 0?t.img:null;let i,s=t.src;if(Vt(!(s!==void 0&&e),"`image` and `src` cannot be provided at the same time"),(s===void 0||s.length===0)&&e&&(s=e.src||wt(e)),Vt(s!==void 0&&s.length>0,"A defined and non-empty `src` or `image` must be provided"),Vt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`"),t.src!==void 0?i=0:e!==void 0&&(i=e instanceof HTMLImageElement?e.complete?e.src?2:0:1:2),this.color_=t.color!==void 0?Eh(t.color):null,this.iconImage_=function(o,a,l,h,u){let c=a===void 0?void 0:Th.get(a,l,u);return c||(c=new DS(o,o instanceof HTMLImageElement?o.src||void 0:a,l,h,u),Th.set(a,l,u,c)),c}(e,s,this.crossOrigin_,i,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let r,o;if(t.size)[r,o]=t.size;else{const a=this.getImage(1);if(a.width&&a.height)r=a.width,o=a.height;else if(a instanceof HTMLImageElement){this.initialOptions_=t;const l=()=>{if(this.unlistenImageChange(l),!this.initialOptions_)return;const h=this.iconImage_.getSize();this.setScale(Fv(h[0],h[1],t.width,t.height))};return void this.listenImageChange(l)}}r!==void 0&&this.setScale(Fv(r,o,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new pf({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==2?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==2?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener("change",t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener("change",t)}}const au=pf;function lu(n,t,e,i,s,r,o){let a,l;const h=(e-t)/i;if(h===1)a=t;else if(h===2)a=t,l=s;else if(h!==0){let u=n[t],c=n[t+1],d=0;const p=[0];for(let m=t+i;m<e;m+=i){const y=n[m],_=n[m+1];d+=Math.sqrt((y-u)*(y-u)+(_-c)*(_-c)),p.push(d),u=y,c=_}const f=s*d,g=function(y,_,v){let x,b;v=v||ps;let M=0,w=y.length,S=!1;for(;M<w;)x=M+(w-M>>1),b=+v(y[x],_),b<0?M=x+1:(w=x,S=!b);return S?M:~M}(p,f);g<0?(l=(f-p[-g-2])/(p[-g-1]-p[-g-2]),a=t+(-g-2)*i):a=t+g*i}o=o>1?o:2,r=r||new Array(o);for(let u=0;u<o;++u)r[u]=a===void 0?NaN:l===void 0?n[a+u]:Ii(n[a+u],n[a+i+u],l);return r}function ff(n,t,e,i,s,r){if(e==t)return null;let o;if(s<n[t+i-1])return r?(o=n.slice(t,t+i),o[i-1]=s,o):null;if(n[e-1]<s)return r?(o=n.slice(e-i,e),o[i-1]=s,o):null;if(s==n[t+i-1])return n.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const c=a+l>>1;s<n[(c+1)*i-1]?l=c:a=c+1}const h=n[a*i-1];if(s==h)return n.slice((a-1)*i,(a-1)*i+i);const u=(s-h)/(n[(a+1)*i-1]-h);o=[];for(let c=0;c<i-1;++c)o.push(Ii(n[(a-1)*i+c],n[a*i+c],u));return o.push(s),o}function Ov(n,t,e,i){const s=[];let r=[1/0,1/0,-1/0,-1/0];for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Xd(n,t,l[0],i),s.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=l[l.length-1]}return s}const Av=[1,0,0,1,0,0];class bo{constructor(t,e,i,s,r,o){this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r,this.stride_=s}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?c1(this.flatCoordinates_):Xd(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=ln(this.getExtent());this.flatInteriorPoints_=Mp(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=l_(this.flatCoordinates_,this.ends_),e=Ov(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=n_(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=lu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let s=0,r=i.length;s<r;++s){const o=i[s],a=lu(t,e,o,2,.5);_n(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Bt(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const s=Ti(i)/Ti(e);Bn(Av,i[0],i[3],s,-s,0,0,0),xs(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Av,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new bo(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Qy((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":i.length=Oh(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),s=[i.length];break;case"MultiLineString":s=[],i.length=Q1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,s);break;case"Polygon":s=[],i.length=xp(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,s)}return s&&(this.simplifiedGeometry_=new bo(this.type_,i,s,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}bo.prototype.getFlatCoordinates=bo.prototype.getOrientedFlatCoordinates;const Hi=bo;class gf{constructor(t){this.color_=(t=t||{}).color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new gf({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Xi=gf;class Fs{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Lv,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Fs({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Lv,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let mf=null;function NS(n,t){if(!mf){const e=new Ui({color:"rgba(255,255,255,0.4)"}),i=new Xi({color:"#3399CC",width:1.25});mf=[new Fs({image:new tl({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return mf}function Lv(n){return n.getGeometry()}const Ri=Fs;class yf{constructor(t){this.font_=(t=t||{}).font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=ni(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new Ui({color:"#333"}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}clone(){const t=this.getScale();return new yf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ni(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Dv=yf;class _f extends an{constructor(t){super(),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t&&(typeof t.getSimplifiedGeometry=="function"?this.setGeometry(t):this.setProperties(t))}clone(){const t=new _f(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(me(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Dt(t,"change",this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(i){if(typeof i=="function")return i;let s;return Array.isArray(i)?s=i:(Vt(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),s=[i]),function(){return s}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Tn=_f;function Nv(n,t,e,i){let s=n[t],r=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=n[a],h=n[a+1];o+=Math.sqrt((l-s)*(l-s)+(h-r)*(h-r)),s=l,r=h}return o}class hu extends bs{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e===void 0||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){_n(this.flatCoordinates,t),this.changed()}clone(){const t=new hu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<tr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),_p(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,s))}forEachSegment(t){return s_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:ff(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e=e!==void 0&&e)}getCoordinates(){return ws(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return lu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Nv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Oh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new hu(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Lh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fh(this.flatCoordinates,0,t,this.stride),this.changed()}}const $n=hu;class vf extends bs{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){_n(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new vf(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){if(s<tr(this.getExtent(),t,e))return s;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const h=Wn(t,e,r[a],r[a+1]);if(h<s){s=h;for(let u=0;u<o;++u)i[u]=r[a+u];i.length=o}}return s}getCoordinates(){return ws(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){return t<0||this.flatCoordinates.length/this.stride<=t?null:new Hn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,s=[];for(let r=0,o=t.length;r<o;r+=i){const a=new Hn(t.slice(r,r+i),e);s.push(a)}return s}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let s=0,r=e.length;s<r;s+=i)if(Ud(t,e[s],e[s+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fh(this.flatCoordinates,0,t,this.stride),this.changed()}}const uu=vf;class cu extends bs{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const s=t,r=[],o=[];for(let l=0,h=s.length;l<h;++l)_n(r,s[l].getFlatCoordinates()),o.push(r.length);const a=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){_n(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new cu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<tr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yp(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vp(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,s))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:function(r,o,a,l,h,u,c){if(c)return ff(r,o,a[a.length-1],l,h,u);let d;if(h<r[l-1])return u?(d=r.slice(0,l),d[l-1]=h,d):null;if(r[r.length-1]<h)return u?(d=r.slice(r.length-l),d[l-1]=h,d):null;for(let p=0,f=a.length;p<f;++p){const g=a[p];if(o!=g){if(h<r[o+l-1])return null;if(h<=r[g-1])return ff(r,o,g,l,h,!1);o=g}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e=e!==void 0&&e,i=i!==void 0&&i)}getCoordinates(){return ka(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new $n(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,s=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new $n(t.slice(r,l),i);s.push(h),r=l}return s}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const s=this.ends_,r=this.stride;for(let o=0,a=s.length;o<a;++o){const l=s[o];_n(t,lu(e,i,l,r,.5)),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Q1(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new cu(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(i,s,r,o,a){for(let l=0,h=r.length;l<h;++l){if(Lh(i,s,r[l],o,a))return!0;s=r[l]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ia(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const du=cu;class pu extends bs{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const s=t,r=[],o=[];for(let a=0,l=s.length;a<l;++a){const h=s[a],u=r.length,c=h.getEnds();for(let d=0,p=c.length;d<p;++d)c[d]+=u;_n(r,h.getFlatCoordinates()),o.push(c)}e=s.length===0?this.getLayout():s[0].getLayout(),t=r,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;_n(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let s=0,r=e.length;s<r;++s)e[s]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let s=0;s<t;++s)e[s]=this.endss_[s].slice();const i=new pu(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,s){return s<tr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(o,a,l,h,u){for(let c=0,d=l.length;c<d;++c){const p=l[c];u=yp(o,a,p,h,u),a=p[p.length-1]}return u}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(o,a,l,h,u,c,d,p,f,g,m){m=m||[NaN,NaN];for(let y=0,_=l.length;y<_;++y){const v=l[y];g=vp(o,a,v,h,u,c,d,p,f,g,m),a=v[v.length-1]}return g}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,s))}containsXY(t,e){return function(s,r,o,a,l,h){if(o.length===0)return!1;for(let u=0,c=o.length;u<c;++u){const d=o[u];if(Cp(s,r,d,a,l,h))return!0;r=d[d.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(e,i,s,r){let o=0;for(let a=0,l=s.length;a<l;++a){const h=s[a];o+=e_(e,i,h,r),i=h[h.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Tp(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,bp(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Ov(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=n_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new uu(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;a_(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Tp(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(r,o,a,l,h,u,c,d){for(let p=0,f=a.length;p<f;++p){const g=a[p],m=[];c=xp(r,o,g,l,h,u,c,m),d.push(m),o=g[g.length-1]}return c}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new pu(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),s=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new Cs(this.flatCoordinates.slice(e,s),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,s=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(r!==0)for(let c=0,d=l.length;c<d;++c)l[c]-=r;const u=new Cs(e.slice(r,h),t,l);s.push(u),r=h}return s}getType(){return"MultiPolygon"}intersectsExtent(t){return function(i,s,r,o,a){for(let l=0,h=r.length;l<h;++l){const u=r[l];if(o_(i,s,u,o,a))return!0;s=u[u.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=J1(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const s=i[i.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}const fu=pu;class gu extends Y1{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(me),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(Dt(this.geometries_[t],"change",this.changed,this))}clone(){const t=new gu(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,s){if(s<tr(this.getExtent(),t,e))return s;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)s=r[o].closestPointXY(t,e,i,s);return s}containsXY(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)if(i[s].containsXY(t,e))return!0;return!1}computeExtent(t){Vr(t);const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)d1(t,e[i].getExtent());return t}getGeometries(){return zv(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let s=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(s=!0)}if(s){const r=new gu(null);return r.setGeometriesArray(e),r}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].rotate(t,e);this.changed()}scale(t,e,i){i||(i=ln(this.getExtent()));const s=this.geometries_;for(let r=0,o=s.length;r<o;++r)s[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(zv(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function zv(n){const t=[];for(let e=0,i=n.length;e<i;++e)t.push(n[e].clone());return t}const jv=gu,Gv=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Tn,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Bt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Bt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return gt()}readFeature(t,e){return gt()}readFeatures(t,e){return gt()}readGeometry(t,e){return gt()}readProjection(t){return gt()}writeFeature(t,e){return gt()}writeFeatures(t,e){return gt()}writeGeometry(t,e){return gt()}};function mu(n,t,e){const i=e?Bt(e.featureProjection):null,s=e?Bt(e.dataProjection):null;let r=n;if(i&&s&&!vs(i,s)){t&&(r=n.clone());const o=t?i:s,a=t?s:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(Jr(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,u=l.length;h<u;++h)l[h]=Math.round(l[h]*o)/o;return l};r===n&&(r=n.clone()),r.applyTransform(a)}return r}const zS={Point:Hn,LineString:$n,Polygon:Cs,MultiPoint:uu,MultiLineString:du,MultiPolygon:fu};function qv(n,t){const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(r=>qv({...n,geometry:r})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const s=e.layout.length;return mu(new Hi(i,i==="Polygon"?function(o,a,l){return Array.isArray(a[0])?(a_(o,0,a,l)||Tp(o=o.slice(),0,a,l),o):(Ep(o,0,a,l)||Dh(o=o.slice(),0,a,l),o)}(e.flatCoordinates,e.ends,s):e.flatCoordinates,e.ends?.flat(),s,n.properties||{},n.id).enableSimplifyTransformed(),!1,t)}function xf(n,t){if(!n)return null;if(Array.isArray(n)){const e=n.map(i=>xf(i,t));return new jv(e)}return mu(new zS[n.type](n.flatCoordinates,n.layout,n.ends),!1,t)}function yu(n){return typeof n=="string"?JSON.parse(n)||null:n!==null?n:null}const jS=class extends Gv{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(yu(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(yu(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return gt()}readFeaturesFromObject(t,e){return gt()}readGeometry(t,e){return this.readGeometryFromObject(yu(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return gt()}readProjection(t){return this.readProjectionFromObject(yu(t))}readProjectionFromObject(t){return gt()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return gt()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return gt()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return gt()}};function bf(n,t){if(!n)return null;let e;switch(n.type){case"Point":e=function(s){const r=s.coordinates;return{type:"Point",flatCoordinates:r,layout:sr(r.length)}}(n);break;case"LineString":e=function(s){const r=s.coordinates,o=r.flat();return{type:"LineString",flatCoordinates:o,ends:[o.length],layout:sr(r[0].length)}}(n);break;case"Polygon":e=function(s){const r=s.coordinates,o=[],a=r[0][0].length;return{type:"Polygon",flatCoordinates:o,ends:Ia(o,0,r,a),layout:sr(a)}}(n);break;case"MultiPoint":e=function(s){const r=s.coordinates;return{type:"MultiPoint",flatCoordinates:r.flat(),layout:sr(r[0].length)}}(n);break;case"MultiLineString":e=function(s){const r=s.coordinates,o=r[0][0].length,a=[];return{type:"MultiLineString",flatCoordinates:a,ends:Ia(a,0,r,o),layout:sr(o)}}(n);break;case"MultiPolygon":e=function(s){const r=s.coordinates,o=[],a=r[0][0][0].length;return{type:"MultiPolygon",flatCoordinates:o,ends:J1(o,0,r,a),layout:sr(a)}}(n);break;case"GeometryCollection":e=function(s,r){return s.geometries.map(function(o){return bf(o)})}(n);break;default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function wf(n,t){const e=(n=mu(n,!0,t)).getType();let i;switch(e){case"Point":i=function(r,o){return{type:"Point",coordinates:r.getCoordinates()}}(n);break;case"LineString":i=function(r,o){return{type:"LineString",coordinates:r.getCoordinates()}}(n);break;case"Polygon":i=function(r,o){let a;return o&&(a=o.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(a)}}(n,t);break;case"MultiPoint":i=function(r,o){return{type:"MultiPoint",coordinates:r.getCoordinates()}}(n);break;case"MultiLineString":i=function(r,o){return{type:"MultiLineString",coordinates:r.getCoordinates()}}(n);break;case"MultiPolygon":i=function(r,o){let a;return o&&(a=o.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(a)}}(n,t);break;case"GeometryCollection":i=function(r,o){return delete(o=Object.assign({},o)).featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(a){return wf(a,o)})}}(n,t);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e)}return i}const Cf=class extends jS{constructor(t){t=t||{},super(),this.dataProjection=Bt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Bt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i=t.type==="Feature"?t:{type:"Feature",geometry:t,properties:null};const s=bf(i.geometry);if(this.featureClass===Hi)return qv({geometry:s,id:i.id,properties:i.properties},e);const r=new Tn;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&r.setGeometryName(i.geometry_name),r.setGeometry(xf(s,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){let i=null;if(t.type==="FeatureCollection"){i=[];const s=t.features;for(let r=0,o=s.length;r<o;++r){const a=this.readFeatureFromObject(s[r],e);a&&i.push(a)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(s,r){return xf(bf(s),r)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=Bt(e.properties.name);else{if(e.type!=="EPSG")throw new Error("Unknown SRS type");i=Bt("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},s=t.getId();if(s!==void 0&&(i.id=s),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=wf(o,e),delete r[t.getGeometryName()]),gs(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let s=0,r=t.length;s<r;++s)i.push(this.writeFeatureObject(t[s],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return wf(t,this.adaptOptions(e))}};var GS=ke(496);function qS(n,t,e){if(n===3){const i={keys:[],values:[],features:[]},s=e.readVarint()+e.pos;e.readFields(VS,i,s),i.length=i.features.length,i.length&&(t[i.name]=i)}}function VS(n,t,e){if(n===15)t.version=e.readVarint();else if(n===1)t.name=e.readString();else if(n===5)t.extent=e.readVarint();else if(n===2)t.features.push(e.pos);else if(n===3)t.keys.push(e.readString());else if(n===4){let i=null;const s=e.readVarint()+e.pos;for(;e.pos<s;)i=(n=e.readVarint()>>3)==1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null;t.values.push(i)}}function BS(n,t,e){if(n==1)t.id=e.readVarint();else if(n==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const s=t.layer.keys[e.readVarint()],r=t.layer.values[e.readVarint()];t.properties[s]=r}}else n==3?t.type=e.readVarint():n==4&&(t.geometry=e.pos)}function WS(n,t,e){n.pos=t.features[e];const i=n.readVarint()+n.pos,s={layer:t,type:0,properties:{}};return n.readFields(BS,s,i),s}const Mf=class extends Gv{constructor(t){super(),t=t||{},this.dataProjection=new Un({code:"",units:"tile-pixels"}),this.featureClass_=t.featureClass?t.featureClass:Hi,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,s){t.pos=e.geometry;const r=t.readVarint()+t.pos;let o=1,a=0,l=0,h=0,u=0,c=0;for(;t.pos<r;){if(!a){const d=t.readVarint();o=7&d,a=d>>3}if(a--,o===1||o===2)l+=t.readSVarint(),h+=t.readSVarint(),o===1&&u>c&&(s.push(u),c=u),i.push(l,h),u+=2;else{if(o!==7)throw new Error("Invalid command found in the PBF");u>c&&(i.push(i[c],i[c+1]),u+=2)}}u>c&&(s.push(u),c=u)}createFeature_(t,e,i){const s=e.type;if(s===0)return null;let r;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],h=[];this.readRawGeometry_(t,e,l,h);const u=function(d,p){let f;return d===1?f=p===1?"Point":"MultiPoint":d===2?f=p===1?"LineString":"MultiLineString":d===3&&(f="Polygon"),f}(s,h.length);if(this.featureClass_===Hi)r=new this.featureClass_(u,l,h,2,o,a),r.transform(i.dataProjection);else{let c;if(u=="Polygon"){const p=l_(l,h);c=p.length>1?new fu(l,"XY",p):new Cs(l,"XY",h)}else c=u==="Point"?new Hn(l,"XY"):u==="LineString"?new $n(l,"XY"):u==="MultiPoint"?new uu(l,"XY"):u==="MultiLineString"?new du(l,"XY",h):null;r=new this.featureClass_,this.geometryName_&&r.setGeometryName(this.geometryName_);const d=mu(c,!1,i);r.setGeometry(d),a!==void 0&&r.setId(a),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_,s=Bt((e=this.adaptOptions(e)).dataProjection);s.setWorldExtent(e.extent),e.dataProjection=s;const r=new GS(t),o=r.readFields(qS,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const h=o[l];s.setExtent(h?[0,0,h.extent,h.extent]:null);for(let u=0,c=h.length;u<c;++u){const d=WS(r,h,u),p=this.createFeature_(r,d,e);p!==null&&a.push(p)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}},US=class extends Zp{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:Bt("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)(function(i,s,r,o){const a=document.createElement("script"),l="olc_"+wt(s);function h(){delete window[l],a.parentNode.removeChild(a)}a.async=!0,a.src=i+(i.includes("?")?"&":"?")+(o||"callback")+"="+l;const u=setTimeout(function(){h(),r&&r()},1e4);window[l]=function(c){clearTimeout(u),h(),s(c)},document.head.appendChild(a)})(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else{if(!t.tileJSON)throw new Error("Either `url` or `tileJSON` options must be provided");this.handleTileJSONResponse(t.tileJSON)}}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let i;try{i=JSON.parse(e.responseText)}catch{return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=Bt("EPSG:4326"),i=this.getProjection();let s;if(t.bounds!==void 0){const a=Ea(e,i);s=f1(t.bounds,a)}const r=za(i),o=Xh({extent:r,maxZoom:t.maxzoom||22,minZoom:t.minzoom||0,tileSize:this.tileSize_});if(this.tileGrid=o,this.tileUrlFunction=j_(t.tiles,o),t.attribution&&!this.getAttributions()){const a=s!==void 0?s:r;this.setAttributions(function(l){return Fe(a,l.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}};var Vv=ke(218);let il=0;const wo=0,Ne=1<<il++,ht=1<<il++,dn=1<<il++,si=1<<il++,Os=1<<il++,vi=Math.pow(2,5)-1,Bv={[Ne]:"boolean",[ht]:"number",[dn]:"string",[si]:"color",[Os]:"number[]"},HS=Object.keys(Bv).map(Number).sort(ps);function ri(n){const t=[];for(const e of HS)XS(n,e)&&t.push(Bv[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function XS(n,t){return(n&t)===t}function In(n,t){return!!(n&t)}function _u(n,t){return n===t}class As{constructor(t,e){this.type=t,this.value=e}}class ZS{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Wv(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function se(n,t,e){switch(typeof n){case"boolean":return new As(Ne,n);case"number":return new As(ht,n);case"string":{let s=dn;return function(o){try{return ep(o),!0}catch{return!1}}(n)&&(s|=si),_u(s&e,wo)||(s&=e),new As(s,n)}}if(!Array.isArray(n))throw new Error("Expression must be an array or a primitive value");if(n.length===0)throw new Error("Empty expression");if(typeof n[0]=="string")return function(r,o,a){const l=r[0],h=YS[l];if(!h)throw new Error(`Unknown operator: ${l}`);return h(r,o,a)}(n,t,e);for(const s of n)if(typeof s!="number")throw new Error("Expected an array of numbers");let i=Os;return(n.length===3||n.length===4)&&(i|=si),e&&(i&=e),new As(i,n)}const V={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},YS={[V.Get]:Ct(([n,t])=>t!==void 0?function(i){switch(i){case"string":return dn;case"color":return si;case"number":return ht;case"boolean":return Ne;case"number[]":return Os;default:throw new Error(`Unrecognized type hint: ${i}`)}}(t.value):vi,Rt(1,2),function(t,e){const i=se(t[1],e);if(!(i instanceof As))throw new Error("Expected a literal argument for get operation");if(typeof i.value!="string")throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),t.length===3?[i,se(t[2],e)]:[i]}),[V.Var]:Ct(([n])=>n.type,Rt(1,1),function(t,e,i,s){const r=t[1];if(typeof r!="string")throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||e.style.variables[r]===void 0)return[new As(vi,r)];const o=se(e.style.variables[r],e);if(o.value=r,s&&!In(s,o.type))throw new Error(`The variable ${r} has type ${ri(o.type)} but the following type was expected: ${ri(s)}`);return[o]}),[V.Id]:Ct(ht|dn,nl,function(t,e){e.featureId=!0}),[V.Concat]:Ct(dn,Rt(2,1/0),Jt(vi)),[V.GeometryType]:Ct(dn,nl),[V.Resolution]:Ct(ht,nl),[V.Zoom]:Ct(ht,nl),[V.Time]:Ct(ht,nl),[V.Any]:Ct(Ne,Rt(2,1/0),Jt(Ne)),[V.All]:Ct(Ne,Rt(2,1/0),Jt(Ne)),[V.Not]:Ct(Ne,Rt(1,1),Jt(Ne)),[V.Equal]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.NotEqual]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.GreaterThan]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.GreaterThanOrEqualTo]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.LessThan]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.LessThanOrEqualTo]:Ct(Ne,Rt(2,2),Jt(vi),ur),[V.Multiply]:Ct(n=>{let t=ht|si;for(let e=0;e<n.length;e++)t&=n[e].type;return t},Rt(2,1/0),Jt(ht|si),ur),[V.Divide]:Ct(ht,Rt(2,2),Jt(ht)),[V.Add]:Ct(ht,Rt(2,1/0),Jt(ht)),[V.Subtract]:Ct(ht,Rt(2,2),Jt(ht)),[V.Clamp]:Ct(ht,Rt(3,3),Jt(ht)),[V.Mod]:Ct(ht,Rt(2,2),Jt(ht)),[V.Pow]:Ct(ht,Rt(2,2),Jt(ht)),[V.Abs]:Ct(ht,Rt(1,1),Jt(ht)),[V.Floor]:Ct(ht,Rt(1,1),Jt(ht)),[V.Ceil]:Ct(ht,Rt(1,1),Jt(ht)),[V.Round]:Ct(ht,Rt(1,1),Jt(ht)),[V.Sin]:Ct(ht,Rt(1,1),Jt(ht)),[V.Cos]:Ct(ht,Rt(1,1),Jt(ht)),[V.Atan]:Ct(ht,Rt(1,2),Jt(ht)),[V.Sqrt]:Ct(ht,Rt(1,1),Jt(ht)),[V.Match]:Ct(n=>{let t=vi;for(let e=2;e<n.length;e+=2)t&=n[e].type;return t&=n[n.length-1].type,t},Rt(4,1/0),Uv,function(t,e,i,s){const r=t.length-1;let o=se(t[1],e).type;const a=se(t[t.length-1],e);let l=s!==void 0?s&a.type:a.type;const h=new Array(r-2);for(let c=0;c<r-2;c+=2){const d=se(t[c+2],e),p=se(t[c+3],e);o&=d.type,l&=p.type,h[c]=d,h[c+1]=p}const u=dn|ht|Ne;if(!In(u,o))throw new Error(`Expected an input of type ${ri(u)} for the interpolate operation, got ${ri(o)} instead`);if(_u(l,wo))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let c=0;c<r-2;c+=2){const d=se(t[c+2],e,o),p=se(t[c+3],e,l);h[c]=d,h[c+1]=p}return[se(t[1],e,o),...h,se(t[t.length-1],e,l)]}),[V.Between]:Ct(Ne,Rt(3,3),Jt(ht)),[V.Interpolate]:Ct(n=>{let t=si|ht;for(let e=3;e<n.length;e+=2)t&=n[e].type;return t},Rt(6,1/0),Uv,function(t,e,i,s){const r=t[1];let o;switch(r[0]){case"linear":o=1;break;case"exponential":if(o=r[1],typeof o!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(o)} instead`);break;default:o=null}if(!o)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);o=se(o,e);let a=se(t[2],e);if(!In(ht,a.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${ri(a.type)} instead`);a=se(t[2],e,ht);const l=new Array(t.length-3);for(let h=0;h<l.length;h+=2){let u=se(t[h+3],e);if(!In(ht,u.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${ri(u.type)} at position ${h+2} instead`);let c=se(t[h+4],e);if(!In(ht|si,c.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${ri(c.type)} at position ${h+3} instead`);u=se(t[h+3],e,ht),c=se(t[h+4],e,ht|si),l[h]=u,l[h+1]=c}return[o,a,...l]}),[V.Case]:Ct(n=>{let t=vi;for(let e=1;e<n.length;e+=2)t&=n[e].type;return t&=n[n.length-1].type,t},Rt(3,1/0),function(t,e){const i=t.length-1;if(i%2==0)throw new Error(`An odd amount of arguments was expected for operation ${t[0]}, got ${JSON.stringify(i)} instead`)},function(t,e,i,s){const r=se(t[t.length-1],e);let o=s!==void 0?s&r.type:r.type;const a=new Array(t.length-1);for(let l=0;l<a.length-1;l+=2){const h=se(t[l+1],e),u=se(t[l+2],e);if(!In(Ne,h.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${ri(h.type)} at position ${l} instead`);o&=u.type,a[l]=h,a[l+1]=u}if(_u(o,wo))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let l=0;l<a.length-1;l+=2)a[l+1]=se(t[l+2],e,o);return a[a.length-1]=se(t[t.length-1],e,o),a}),[V.In]:Ct(Ne,Rt(2,2),function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let s=dn|ht;const r=new Array(i.length);for(let o=0;o<r.length;o++){const a=se(i[o],e);s&=a.type,r[o]=a}if(_u(s,wo))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[se(t[1],e,s),...r]}),[V.Number]:Ct(ht,Rt(1,1/0),Jt(vi)),[V.String]:Ct(dn,Rt(1,1/0),Jt(vi)),[V.Array]:Ct(n=>n.length===3||n.length===4?Os|si:Os,Rt(1,1/0),Jt(ht)),[V.Color]:Ct(si,Rt(3,4),Jt(ht)),[V.Band]:Ct(ht,Rt(1,3),Jt(ht)),[V.Palette]:Ct(si,Rt(2,2),function(t,e){const i=se(t[1],e,ht);if(i.type!==ht)throw new Error(`The first argument of palette must be an number, got ${ri(i.type)} instead`);const s=t[2];if(!Array.isArray(s))throw new Error("The second argument of palette must be an array");const r=new Array(s.length);for(let o=0;o<r.length;o++){const a=se(s[o],e,si);if(!(a instanceof As))throw new Error(`The palette color at index ${o} must be a literal value`);if(!In(a.type,si))throw new Error(`The palette color at index ${o} should be of type color, got ${ri(a.type)} instead`);r[o]=a}return[i,...r]})};function nl(n,t){if(n.length!==1)throw new Error(`Expected no arguments for ${n[0]} operation`);return[]}function Rt(n,t){return function(e,i){const s=e[0],r=e.length-1;if(n===t){if(r!==n)throw new Error(`Expected ${n} argument${n===1?"":"s"} for ${s}, got ${r}`)}else if(r<n||r>t)throw new Error(`Expected ${t===1/0?`${n} or more`:`${n} to ${t}`} arguments for ${s}, got ${r}`)}}function Jt(n){return function(t,e){const i=t[0],s=t.length-1,r=new Array(s);for(let o=0;o<s;++o){const a=se(t[o+1],e);if(!In(n,a.type)){const l=ri(n),h=ri(a.type);throw new Error(`Unexpected type for argument ${o} of ${i} operation, got ${l} but expected ${h}`)}a.type&=n,r[o]=a}return r}}function ur(n,t,e){const i=n[0],s=n.length-1;let r=vi;for(let a=0;a<e.length;++a)r&=e[a].type;if(r===wo)throw new Error(`No common type could be found for arguments of ${i} operation`);const o=new Array(s);for(let a=0;a<s;++a)o[a]=se(n[a+1],t,r);return o}function Uv(n,t){const e=n.length-1;if(e%2==1)throw new Error(`An even amount of arguments was expected for operation ${n[0]}, got ${JSON.stringify(e)} instead`)}function Ct(n,...t){return function(e,i,s){const r=e[0];let o=[];for(let l=0;l<t.length;l++)o=t[l](e,i,o,s)||o;let a=typeof n=="function"?n(o):n;if(s!==void 0){if(!In(a,s))throw new Error(`The following expression was expected to return ${ri(s)}, but returns ${ri(a)} instead: ${JSON.stringify(e)}`);a&=s}if(a===wo)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(e)}`);return new ZS(a,r,...o)}}function Ls(n,t,e){const i=se(n,e);if(!In(t,i.type)){const s=ri(t),r=ri(i.type);throw new Error(`Expected expression to be of type ${s}, got ${r}`)}return Kn(i,e)}function Kn(n,t){if(n instanceof As){if(n.type===si&&typeof n.value=="string"){const i=ep(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case V.Number:case V.String:return function(s,r){const o=s.operator,a=s.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Kn(s.args[h],r);switch(o){case V.Number:case V.String:return h=>{for(let u=0;u<a;++u){const c=l[u](h);if(typeof c===o)return c}throw new Error(`Expected one of the values to be a ${o}`)};default:throw new Error(`Unsupported assertion operator ${o}`)}}(n,t);case V.Get:case V.Var:return function(s,r){const o=s.args[0].value;switch(s.operator){case V.Get:return a=>a.properties[o];case V.Var:return a=>a.variables[o];default:throw new Error(`Unsupported accessor operator ${s.operator}`)}}(n);case V.Id:return i=>i.featureId;case V.Concat:{const i=n.args.map(s=>Kn(s,t));return s=>"".concat(...i.map(r=>r(s).toString()))}case V.Resolution:return i=>i.resolution;case V.Any:case V.All:case V.Not:return function(s,r){const o=s.operator,a=s.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Kn(s.args[h],r);switch(o){case V.Any:return h=>{for(let u=0;u<a;++u)if(l[u](h))return!0;return!1};case V.All:return h=>{for(let u=0;u<a;++u)if(!l[u](h))return!1;return!0};case V.Not:return h=>!l[0](h);default:throw new Error(`Unsupported logical operator ${o}`)}}(n,t);case V.Equal:case V.NotEqual:case V.LessThan:case V.LessThanOrEqualTo:case V.GreaterThan:case V.GreaterThanOrEqualTo:return function(s,r){const o=s.operator,a=Kn(s.args[0],r),l=Kn(s.args[1],r);switch(o){case V.Equal:return h=>a(h)===l(h);case V.NotEqual:return h=>a(h)!==l(h);case V.LessThan:return h=>a(h)<l(h);case V.LessThanOrEqualTo:return h=>a(h)<=l(h);case V.GreaterThan:return h=>a(h)>l(h);case V.GreaterThanOrEqualTo:return h=>a(h)>=l(h);default:throw new Error(`Unsupported comparison operator ${o}`)}}(n,t);case V.Multiply:case V.Divide:case V.Add:case V.Subtract:case V.Clamp:case V.Mod:case V.Pow:case V.Abs:case V.Floor:case V.Ceil:case V.Round:case V.Sin:case V.Cos:case V.Atan:case V.Sqrt:return function(s,r){const o=s.operator,a=s.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Kn(s.args[h],r);switch(o){case V.Multiply:return h=>{let u=1;for(let c=0;c<a;++c)u*=l[c](h);return u};case V.Divide:return h=>l[0](h)/l[1](h);case V.Add:return h=>{let u=0;for(let c=0;c<a;++c)u+=l[c](h);return u};case V.Subtract:return h=>l[0](h)-l[1](h);case V.Clamp:return h=>{const u=l[0](h),c=l[1](h);if(u<c)return c;const d=l[2](h);return u>d?d:u};case V.Mod:return h=>l[0](h)%l[1](h);case V.Pow:return h=>Math.pow(l[0](h),l[1](h));case V.Abs:return h=>Math.abs(l[0](h));case V.Floor:return h=>Math.floor(l[0](h));case V.Ceil:return h=>Math.ceil(l[0](h));case V.Round:return h=>Math.round(l[0](h));case V.Sin:return h=>Math.sin(l[0](h));case V.Cos:return h=>Math.cos(l[0](h));case V.Atan:return a===2?h=>Math.atan2(l[0](h),l[1](h)):h=>Math.atan(l[0](h));case V.Sqrt:return h=>Math.sqrt(l[0](h));default:throw new Error(`Unsupported numeric operator ${o}`)}}(n,t);case V.Match:return function(s,r){const o=s.args.length,a=new Array(o);for(let l=0;l<o;++l)a[l]=Kn(s.args[l],r);return l=>{const h=a[0](l);for(let u=1;u<o;u+=2)if(h===a[u](l))return a[u+1](l);return a[o-1](l)}}(n,t);case V.Interpolate:return function(s,r){const o=s.args.length,a=new Array(o);for(let l=0;l<o;++l)a[l]=Kn(s.args[l],r);return l=>{const h=a[0](l),u=a[1](l);let c,d;for(let p=2;p<o;p+=2){const f=a[p](l);let g=a[p+1](l);const m=Array.isArray(g);if(m&&(g=jC(g)),f>=u)return p===2?g:m?$S(h,u,c,d,f,g):sl(h,u,c,d,f,g);c=f,d=g}return d}}(n,t);default:throw new Error(`Unsupported operator ${e}`)}}function sl(n,t,e,i,s,r){const o=s-e;if(o===0)return i;const a=t-e;return i+(n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1))*(r-i)}function $S(n,t,e,i,s,r){if(s-e==0)return i;const o=x1(i),a=x1(r);let l=a[2]-o[2];return l>180?l-=360:l<-180&&(l+=360),b1(function(u){const c=hn.rgb(LC.xyz(u));return c[3]=u[3],c}([sl(n,t,e,o[0],s,a[0]),sl(n,t,e,o[1],s,a[1]),o[2]+sl(n,t,e,0,s,l),sl(n,t,e,i[3],s,r[3])]))}function KS(n){return!0}function Hv(n){const t=Wv(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=Sf(n[o],t);const s={variables:{},properties:{},resolution:NaN,featureId:null},r=new Array(e);return function(o,a){if(s.properties=o.getPropertiesInternal(),s.resolution=a,t.featureId){const h=o.getId();s.featureId=h!==void 0?h:null}let l=0;for(let h=0;h<e;++h){const u=i[h](s);u&&(r[l]=u,l+=1)}return r.length=l,r}}function Sf(n,t){const e=rl(n,"",t),i=ol(n,"",t),s=function(h,u){const c="text-",d=Ds(h,c+"value",u);if(!d)return null;const p=rl(h,c,u),f=rl(h,c+"background-",u),g=ol(h,c,u),m=ol(h,c+"background-",u),y=Ds(h,c+"font",u),_=xi(h,c+"max-angle",u),v=xi(h,c+"offset-x",u),x=xi(h,c+"offset-y",u),b=al(h,c+"overflow",u),M=Ds(h,c+"placement",u),w=xi(h,c+"repeat",u),S=xu(h,c+"scale",u),k=al(h,c+"rotate-with-view",u),I=xi(h,c+"rotation",u),R=Ds(h,c+"align",u),E=Ds(h,c+"justify",u),q=Ds(h,c+"baseline",u),O=Zv(h,c+"padding",u),P=new Dv({});return function(L){if(P.setText(d(L)),p&&P.setFill(p(L)),f&&P.setBackgroundFill(f(L)),g&&P.setStroke(g(L)),m&&P.setBackgroundStroke(m(L)),y&&P.setFont(y(L)),_&&P.setMaxAngle(_(L)),v&&P.setOffsetX(v(L)),x&&P.setOffsetY(x(L)),b&&P.setOverflow(b(L)),M){const D=M(L);if(D!=="point"&&D!=="line")throw new Error("Expected point or line for text-placement");P.setPlacement(D)}if(w&&P.setRepeat(w(L)),S&&P.setScale(S(L)),k&&P.setRotateWithView(k(L)),I&&P.setRotation(I(L)),R){const D=R(L);if(D!=="left"&&D!=="center"&&D!=="right"&&D!=="end"&&D!=="start")throw new Error("Expected left, right, center, start, or end for text-align");P.setTextAlign(D)}if(E){const D=E(L);if(D!=="left"&&D!=="right"&&D!=="center")throw new Error("Expected left, right, or center for text-justify");P.setJustify(D)}if(q){const D=q(L);if(D!=="bottom"&&D!=="top"&&D!=="middle"&&D!=="alphabetic"&&D!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");P.setTextBaseline(D)}return O&&P.setPadding(O(L)),P}}(n,t),r=function(h,u){return"icon-src"in h?function(d,p){const f="icon-",g=f+"src",m=Kv(d[g],g),y=vu(d,f+"anchor",p),_=xu(d,f+"scale",p),v=xi(d,f+"opacity",p),x=vu(d,f+"displacement",p),b=xi(d,f+"rotation",p),M=al(d,f+"rotate-with-view",p),w=Yv(d,f+"anchor-origin"),S=$v(d,f+"anchor-x-units"),k=$v(d,f+"anchor-y-units"),I=function(K,F){const N=K[F];if(N!==void 0)return Qv(N,F)}(d,f+"color"),R=function(K,F){const N=K[F];if(N!==void 0){if(typeof N!="string")throw new Error(`Expected a string for ${F}`);return N}}(d,f+"cross-origin"),E=function(K,F){const N=K[F];if(N!==void 0)return ll(N,F)}(d,f+"offset"),q=Yv(d,f+"offset-origin"),O=Co(d,f+"width"),P=Co(d,f+"height"),L=function(K,F){const N=K[F];if(N!==void 0){if(typeof N=="number")return ni(N);if(!Array.isArray(N))throw new Error(`Expected a number or size array for ${F}`);if(N.length!==2||typeof N[0]!="number"||typeof N[1]!="number")throw new Error(`Expected a number or size array for ${F}`);return N}}(d,f+"size"),D=Ef(d,f+"declutter"),G=new au({src:m,anchorOrigin:w,anchorXUnits:S,anchorYUnits:k,color:I,crossOrigin:R,offset:E,offsetOrigin:q,height:P,width:O,size:L,declutterMode:D});return function($){return v&&G.setOpacity(v($)),x&&G.setDisplacement(x($)),b&&G.setRotation(b($)),M&&G.setRotateWithView(M($)),_&&G.setScale(_($)),y&&G.setAnchor(y($)),G}}(h,u):"shape-points"in h?function(d,p){const f="shape-",g=f+"points",m=Jv(d[g],g),y=rl(d,f,p),_=ol(d,f,p),v=xu(d,f+"scale",p),x=vu(d,f+"displacement",p),b=xi(d,f+"rotation",p),M=al(d,f+"rotate-with-view",p),w=Co(d,f+"radius"),S=Co(d,f+"radius1"),k=Co(d,f+"radius2"),I=Co(d,f+"angle"),R=Ef(d,f+"declutter-mode"),E=new Rv({points:m,radius:w,radius1:S,radius2:k,angle:I,declutterMode:R});return function(q){return y&&E.setFill(y(q)),_&&E.setStroke(_(q)),x&&E.setDisplacement(x(q)),b&&E.setRotation(b(q)),M&&E.setRotateWithView(M(q)),v&&E.setScale(v(q)),E}}(h,u):"circle-radius"in h?function(d,p){const f="circle-",g=rl(d,f,p),m=ol(d,f,p),y=xi(d,f+"radius",p),_=xu(d,f+"scale",p),v=vu(d,f+"displacement",p),x=xi(d,f+"rotation",p),b=al(d,f+"rotate-with-view",p),M=Ef(d,f+"declutter-mode"),w=new tl({radius:5,declutterMode:M});return function(S){return y&&w.setRadius(y(S)),g&&w.setFill(g(S)),m&&w.setStroke(m(S)),v&&w.setDisplacement(v(S)),x&&w.setRotation(x(S)),b&&w.setRotateWithView(b(S)),_&&w.setScale(_(S)),w}}(h,u):null}(n,t),o=xi(n,"z-index",t);if(!(e||i||s||r||gs(n)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Ri;return function(l){let h=!0;if(e){const u=e(l);u&&(h=!1),a.setFill(u)}if(i){const u=i(l);u&&(h=!1),a.setStroke(u)}if(s){const u=s(l);u&&(h=!1),a.setText(u)}if(r){const u=r(l);u&&(h=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),h?null:a}}function rl(n,t,e){const i=Xv(n,t+"fill-color",e);if(!i)return null;const s=new Ui;return function(r){const o=i(r);return o==="none"?null:(s.setColor(o),s)}}function ol(n,t,e){const i=xi(n,t+"stroke-width",e),s=Xv(n,t+"stroke-color",e);if(!i&&!s)return null;const r=Ds(n,t+"stroke-line-cap",e),o=Ds(n,t+"stroke-line-join",e),a=Zv(n,t+"stroke-line-dash",e),l=xi(n,t+"stroke-line-dash-offset",e),h=xi(n,t+"stroke-miter-limit",e),u=new Xi;return function(c){if(s){const d=s(c);if(d==="none")return null;u.setColor(d)}if(i&&u.setWidth(i(c)),r){const d=r(c);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(d)}if(o){const d=o(c);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(d)}return a&&u.setLineDash(a(c)),l&&u.setLineDashOffset(l(c)),h&&u.setMiterLimit(h(c)),u}}function xi(n,t,e){if(!(t in n))return;const i=Ls(n[t],ht,e);return function(s){return Jv(i(s),t)}}function Ds(n,t,e){if(!(t in n))return null;const i=Ls(n[t],dn,e);return function(s){return Kv(i(s),t)}}function al(n,t,e){if(!(t in n))return null;const i=Ls(n[t],Ne,e);return function(s){const r=i(s);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${t}`);return r}}function Xv(n,t,e){if(!(t in n))return null;const i=Ls(n[t],si|dn,e);return function(s){return Qv(i(s),t)}}function Zv(n,t,e){if(!(t in n))return null;const i=Ls(n[t],Os,e);return function(s){return ll(i(s),t)}}function vu(n,t,e){if(!(t in n))return null;const i=Ls(n[t],Os,e);return function(s){const r=ll(i(s),t);if(r.length!==2)throw new Error(`Expected two numbers for ${t}`);return r}}function xu(n,t,e){if(!(t in n))return null;const i=Ls(n[t],Os|ht,e);return function(s){return function(o,a){if(typeof o=="number")return o;const l=ll(o,a);if(l.length!==2)throw new Error(`Expected an array of two numbers for ${a}`);return l}(i(s),t)}}function Co(n,t){const e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function Yv(n,t){const e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function $v(n,t){const e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function Ef(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function ll(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function Kv(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function Jv(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function Qv(n,t){if(typeof n=="string")return n;const e=ll(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}const tx=class extends jh{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter!==void 0&&t.declutter,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0&&t.updateWhileAnimating,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get("renderOrder")}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new Vv(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set("renderOrder",t)}setStyle(t){this.style_=function(i){if(i===void 0)return NS;if(!i)return null;if(typeof i=="function"||i instanceof Ri)return i;if(!Array.isArray(i))return Hv([i]);if(i.length===0)return[];const s=i.length,r=i[0];if(r instanceof Ri){const o=new Array(s);for(let a=0;a<s;++a){const l=i[a];if(!(l instanceof Ri))throw new Error("Expected a list of style instances");o[a]=l}return o}if("style"in r){const o=new Array(s);for(let a=0;a<s;++a){const l=i[a];if(!("style"in l))throw new Error("Expected a list of rules with a style property");o[a]=l}return function(l){const h=Wv(),u=function(p,f){const g=p.length,m=new Array(g);for(let y=0;y<g;++y){const _=p[y],v="filter"in _?Ls(_.filter,Ne,f):KS;let x;if(Array.isArray(_.style)){const b=_.style.length;x=new Array(b);for(let M=0;M<b;++M)x[M]=Sf(_.style[M],f)}else x=[Sf(_.style,f)];m[y]={filter:v,styles:x}}return function(y){const _=[];let v=!1;for(let x=0;x<g;++x)if((0,m[x].filter)(y)&&(!p[x].else||!v)){v=!0;for(const b of m[x].styles){const M=b(y);M&&_.push(M)}}return _}}(l,h),c={variables:{},properties:{},resolution:NaN,featureId:null};return function(d,p){if(c.properties=d.getPropertiesInternal(),c.resolution=p,h.featureId){const f=d.getId();c.featureId=f!==void 0?f:null}return u(c)}}(o)}return Hv(i)}(t),this.styleFunction_=t===null?void 0:function(i){let s;if(typeof i=="function")s=i;else{let r;Array.isArray(i)?r=i:(Vt(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),r=[i]),s=function(){return r}}return s}(this.style_),this.changed()}},hl={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},bu=[hl.FILL],Ns=[hl.STROKE],cr=[hl.BEGIN_PATH],ex=[hl.CLOSE_PATH],pt=hl,ix=class{drawCustom(t,e,i,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},ul=class extends ix{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=t.length;a<l;a+=e)s[0]=t[a],s[1]=t[a+1],bh(i,s)&&(r[o++]=s[0],r[o++]=s[1]);return o}appendFlatLineCoordinates(t,e,i,s,r,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=s);let u=t[e],c=t[e+1];const d=this.tmpCoordinate_;let p,f,g,m=!0;for(p=e+s;p<i;p+=s)d[0]=t[p],d[1]=t[p+1],g=Hd(h,d),g!==f?(m&&(a[l++]=u,a[l++]=c,m=!1),a[l++]=d[0],a[l++]=d[1]):g===Xe.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],m=!1):m=!0,u=d[0],c=d[1],f=g;return(r&&m||p===e+s)&&(a[l++]=u,a[l++]=c),l}drawCustomCoordinates_(t,e,i,s,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(t,e,l,s,!1,!1);r.push(h),e=l}return e}drawCustom(t,e,i,s){this.beginGeometry(t,e);const r=t.getType(),o=t.getStride(),a=this.coordinates.length;let l,h,u,c,d;switch(r){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),c=[];const p=t.getEndss();d=0;for(let f=0,g=p.length;f<g;++f){const m=[];d=this.drawCustomCoordinates_(l,d,p[f],o,m),c.push(m)}this.instructions.push([pt.CUSTOM,a,c,t,i,bp]),this.hitDetectionInstructions.push([pt.CUSTOM,a,c,t,s||i,bp]);break;case"Polygon":case"MultiLineString":u=[],l=r=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),o,u),this.instructions.push([pt.CUSTOM,a,u,t,i,ka]),this.hitDetectionInstructions.push([pt.CUSTOM,a,u,t,s||i,ka]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([pt.CUSTOM,a,h,t,i,ws]),this.hitDetectionInstructions.push([pt.CUSTOM,a,h,t,s||i,ws]);break;case"MultiPoint":l=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(l,o),h>a&&(this.instructions.push([pt.CUSTOM,a,h,t,i,ws]),this.hitDetectionInstructions.push([pt.CUSTOM,a,h,t,s||i,ws]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),h=this.coordinates.length,this.instructions.push([pt.CUSTOM,a,h,t,i]),this.hitDetectionInstructions.push([pt.CUSTOM,a,h,t,s||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[pt.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[pt.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let s,r,o=-1;for(e=0;e<i;++e)s=t[e],r=s[0],r==pt.END_GEOMETRY?o=e:r==pt.BEGIN_GEOMETRY&&(s[2]=e,kC(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const s=t.getColor();i.fillStyle=En(s||yi)}else i.fillStyle=void 0;if(e){const s=e.getColor();i.strokeStyle=En(s||Oa);const r=e.getLineCap();i.lineCap=r!==void 0?r:to;const o=e.getLineDash();i.lineDash=o?o.slice():Xn;const a=e.getLineDashOffset();i.lineDashOffset=a||0;const l=e.getLineJoin();i.lineJoin=l!==void 0?l:eo;const h=e.getWidth();i.lineWidth=h!==void 0?h:1;const u=e.getMiterLimit();i.miterLimit=u!==void 0?u:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[pt.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[pt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,s=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||r!=t.currentLineDash&&!fs(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[pt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){return!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=u1(this.maxExtent),this.maxLineWidth>0)&&ys(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_),this.bufferedMaxExtent_}},nx=class extends ul{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push(cr),this.hitDetectionInstructions.push(cr);for(let h=0;h<l;++h){const u=i[h],c=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,u,s,!0,!a),p=[pt.MOVE_TO_LINE_TO,c,d];this.instructions.push(p),this.hitDetectionInstructions.push(p),a&&(this.instructions.push(ex),this.hitDetectionInstructions.push(ex)),e=u}return o&&(this.instructions.push(bu),this.hitDetectionInstructions.push(bu)),a&&(this.instructions.push(Ns),this.hitDetectionInstructions.push(Ns)),e}drawCircle(t,e){const i=this.state;if(i.fillStyle===void 0&&i.strokeStyle===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_FILL_STYLE,yi]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xn,0]);const s=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,r,!1,!1);const a=[pt.CIRCLE,o];this.instructions.push(cr,a),this.hitDetectionInstructions.push(cr,a),i.fillStyle!==void 0&&(this.instructions.push(bu),this.hitDetectionInstructions.push(bu)),i.strokeStyle!==void 0&&(this.instructions.push(Ns),this.hitDetectionInstructions.push(Ns)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state;if(i.fillStyle===void 0&&i.strokeStyle===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_FILL_STYLE,yi]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xn,0]);const s=t.getEnds(),r=t.getOrientedFlatCoordinates(),o=t.getStride();this.drawFlatCoordinatess_(r,0,s,o),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state;if(i.fillStyle===void 0&&i.strokeStyle===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_FILL_STYLE,yi]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xn,0]);const s=t.getEndss(),r=t.getOrientedFlatCoordinates(),o=t.getStride();let a=0;for(let l=0,h=s.length;l<h;++l)a=this.drawFlatCoordinatess_(r,a,s[l],o);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=rr(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}};function JS(n,t,e,i,s){const r=[];let o=e,a=0,l=t.slice(e,2);for(;a<n&&o+s<i;){const[h,u]=l.slice(-2),c=t[o+s],d=t[o+s+1],p=Math.sqrt((c-h)*(c-h)+(d-u)*(d-u));if(a+=p,a>=n){const f=(n-a+p)/p,g=Ii(h,c,f),m=Ii(u,d,f);l.push(g,m),r.push(l),l=[g,m],a==n&&(o+=s),a=0}else if(a<n)l.push(t[o+s],t[o+s+1]),o+=s;else{const f=p-a,g=Ii(h,c,f/p),m=Ii(u,d,f/p);l.push(g,m),r.push(l),l=[g,m],a=0,o+=s}}return a>0&&r.push(l),r}function QS(n,t,e,i,s){let r,o,a,l,h,u,c,d,p,f,g=e,m=e,y=0,_=0,v=e;for(o=e;o<i;o+=s){const x=t[o],b=t[o+1];h!==void 0&&(p=x-h,f=b-u,l=Math.sqrt(p*p+f*f),c!==void 0&&(_+=a,r=Math.acos((c*p+d*f)/(a*l)),r>n&&(_>y&&(y=_,g=v,m=o),_=0,v=o-s)),a=l,c=p,d=f),h=x,u=b}return _+=l,_>y?[v,o]:[g,m]}const wu={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},tE={Circle:nx,Default:ul,Image:class extends ul{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([pt.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([pt.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([pt.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([pt.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),s=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends ul{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),a=[pt.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e){const i=this.state;if(i.strokeStyle===void 0||i.lineWidth===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xn,0],cr);const s=t.getFlatCoordinates(),r=t.getStride();this.drawFlatCoordinates_(s,0,s.length,r),this.hitDetectionInstructions.push(Ns),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state;if(i.strokeStyle===void 0||i.lineWidth===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xn,0],cr);const s=t.getEnds(),r=t.getFlatCoordinates(),o=t.getStride();let a=0;for(let l=0,h=s.length;l<h;++l)a=this.drawFlatCoordinates_(r,a,s[l],o);this.hitDetectionInstructions.push(Ns),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ns),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ns),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(cr)}},Polygon:nx,Text:class extends ul{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[yi]={fillStyle:yi},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textState_;if(this.text_===""||!i||!this.textFillState_&&!this.textStrokeState_)return;const s=this.coordinates;let r=s.length;const o=t.getType();let a=null,l=t.getStride();if(i.placement!=="line"||o!="LineString"&&o!="MultiLineString"&&o!="Polygon"&&o!="MultiPolygon"){let h=i.overflow?null:[];switch(o){case"Point":case"MultiPoint":a=t.getFlatCoordinates();break;case"LineString":a=t.getFlatMidpoint();break;case"Circle":a=t.getCenter();break;case"MultiLineString":a=t.getFlatMidpoints(),l=2;break;case"Polygon":a=t.getFlatInteriorPoint(),i.overflow||h.push(a[2]/this.resolution),l=3;break;case"MultiPolygon":const g=t.getFlatInteriorPoints();a=[];for(let m=0,y=g.length;m<y;m+=3)i.overflow||h.push(g[m+2]/this.resolution),a.push(g[m],g[m+1]);if(a.length===0)return;l=2}const u=this.appendFlatPointCoordinates(a,l);if(u===r)return;if(h&&(u-r)/2!=a.length/l){let g=r/2;h=h.filter((m,y)=>{const _=s[2*(g+y)]===a[y*l]&&s[2*(g+y)+1]===a[y*l+1];return _||--g,_})}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&this.updateFillStyle(this.state,this.createFill),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let c=i.padding;if(c!=ar&&(i.scale[0]<0||i.scale[1]<0)){let g=i.padding[0],m=i.padding[1],y=i.padding[2],_=i.padding[3];i.scale[0]<0&&(m=-m,_=-_),i.scale[1]<0&&(g=-g,y=-y),c=[g,m,y,_]}const d=this.pixelRatio;this.instructions.push([pt.DRAW_IMAGE,r,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==ar?ar:c.map(function(g){return g*d}),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);const p=1/d,f=this.state.fillStyle;i.backgroundFill&&(this.state.fillStyle=yi,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([pt.DRAW_IMAGE,r,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,void 0,this.declutterImageWithText_,c,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?yi:this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),i.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!Fe(this.getBufferedMaxExtent(),t.getExtent()))return;let h;if(a=t.getFlatCoordinates(),o=="LineString")h=[a.length];else if(o=="MultiLineString")h=t.getEnds();else if(o=="Polygon")h=t.getEnds().slice(0,1);else if(o=="MultiPolygon"){const p=t.getEndss();h=[];for(let f=0,g=p.length;f<g;++f)h.push(p[f][0])}this.beginGeometry(t,e);const u=i.repeat,c=u?void 0:i.textAlign;let d=0;for(let p=0,f=h.length;p<f;++p){let g;g=u?JS(u*this.resolution,a,d,h[p],l):[a.slice(d,h[p])];for(let m=0,y=g.length;m<y;++m){const _=g[m];let v=0,x=_.length;if(c==null){const M=QS(i.maxAngle,_,0,_.length,2);v=M[0],x=M[1]}for(let M=v;M<x;M+=l)s.push(_[M],_[M+1]);const b=s.length;d=h[p],this.drawChars_(r,b),r=b}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Aa,justify:e.justify,textBaseline:e.textBaseline||Wh,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,s=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=wu[s.textBaseline],u=this.textOffsetY_*l,c=this.text_,d=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([pt.DRAW_CHARS,t,e,h,s.overflow,a,s.maxAngle,l,u,r,d*l,c,o,1]),this.hitDetectionInstructions.push([pt.DRAW_CHARS,t,e,h,s.overflow,a&&yi,s.maxAngle,l,u,r,d*l,c,o,1/l])}setTextStyle(t,e){let i,s,r;if(t){const o=t.getFill();o?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=En(o.getColor()||yi)):(s=null,this.textFillState_=s);const a=t.getStroke();if(a){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const f=a.getLineDash(),g=a.getLineDashOffset(),m=a.getWidth(),y=a.getMiterLimit();r.lineCap=a.getLineCap()||to,r.lineDash=f?f.slice():Xn,r.lineDashOffset=g===void 0?0:g,r.lineJoin=a.getLineJoin()||eo,r.lineWidth=m===void 0?1:m,r.miterLimit=y===void 0?10:y,r.strokeStyle=En(a.getColor()||Oa)}else r=null,this.textStrokeState_=r;i=this.textState_;const l=t.getFont()||g_;m_(l);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Wh,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ar,i.scale=h===void 0?[1,1]:h;const u=t.getOffsetX(),c=t.getOffsetY(),d=t.getRotateWithView(),p=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=c===void 0?0:c,this.textRotateWithView_=d!==void 0&&d,this.textRotation_=p===void 0?0:p,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:wt(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s?typeof s.fillStyle=="string"?s.fillStyle:"|"+wt(s.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}},Cu=class{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const s in i){const r=i[s].finish();t[e][s]=r}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[i];s===void 0&&(s={},this.buildersByZIndex_[i]=s);let r=s[e];return r===void 0&&(r=new tE[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=r),r}},eE=class extends t1{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return gt()}getData(t){return null}prepareFrame(t){return gt()}renderFrame(t,e){return gt()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(s,r)=>{const o=this.loadedTileCallback.bind(this,i,s);return t.forEachLoadedTile(e,s,r,o)}}forEachFeatureAtCoordinate(t,e,i,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===2||e.getState()===3)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=2&&e!=3&&t.addEventListener("change",this.boundHandleImageChange_),e==0&&(t.load(),e=t.getState()),e==2}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}},sx=[];let Mo=null;const rx=class extends eE{constructor(t){super(t),this.container=null,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let s;Mo||function(){Mo=Ke(1,1,void 0,{willReadFrequently:!0})}(),Mo.clearRect(0,0,1,1);try{Mo.drawImage(t,e,i,1,1,0,0,1,1),s=Mo.getImageData(0,0,1,1).data}catch{return Mo=null,null}return s}getBackground(t){let e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const s=this.getLayer().getClassName();let r,o;if(t&&t.className===s&&(!i||t&&t.style.backgroundColor&&fs(Eh(t.style.backgroundColor),Eh(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=s;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=Ke();const l=o.canvas;r.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const s=Gi(i),r=ba(i),o=xa(i),a=Wr(i);Ue(e.coordinateToPixelTransform,s),Ue(e.coordinateToPixelTransform,r),Ue(e.coordinateToPixelTransform,o),Ue(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Ue(l,s),Ue(l,r),Ue(l,o),Ue(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,i){const s=this.getLayer();if(s.hasListener(t)){const r=new h_(t,this.inversePixelTransform,i,e);s.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}postRender(t,e){this.dispatchRenderEvent_("postrender",t,e)}getRenderTransform(t,e,i,s,r,o,a){const l=s/e;return Bn(this.tempTransform,r/2,o/2,l,-l,-i,-t[0]+a,-t[1])}disposeInternal(){delete this.frameState,super.disposeInternal()}};function iE(n,t,e,i,s,r,o,a,l,h,u,c){let d=n[t],p=n[t+1],f=0,g=0,m=0,y=0;function _(){f=d,g=p,d=n[t+=i],p=n[t+1],y+=m,m=Math.sqrt((d-f)*(d-f)+(p-g)*(p-g))}do _();while(t<e-i&&y+m<r);let v=m===0?0:(r-y)/m;const x=Ii(f,d,v),b=Ii(g,p,v),M=t-i,w=y,S=r+a*l(h,s,u);for(;t<e-i&&y+m<S;)_();v=m===0?0:(S-y)/m;const k=Ii(f,d,v),I=Ii(g,p,v);let R;if(c){const L=[x,b,k,I];gp(L,0,4,2,c,L,L),R=L[0]>L[2]}else R=x>k;const E=Math.PI,q=[],O=M+i===t;let P;if(m=0,y=w,d=n[t=M],p=n[t+1],O)return _(),P=Math.atan2(p-g,d-f),R&&(P+=P>0?-E:E),q[0]=[(k+x)/2,(I+b)/2,(S-r)/2,P,s],q;for(let L=0,D=(s=s.replace(/\n/g," ")).length;L<D;){_();let G=Math.atan2(p-g,d-f);if(R&&(G+=G>0?-E:E),P!==void 0){let tt=G-P;if(tt+=tt>E?-2*E:tt<-E?2*E:0,Math.abs(tt)>o)return null}P=G;const $=L;let K=0;for(;L<D;++L){const tt=a*l(h,s[R?D-L-1:L],u);if(t+i<e&&y+m<r+K+tt/2)break;K+=tt}if(L===$)continue;const F=R?s.substring(D-$,D-L):s.substring($,L);v=m===0?0:(r+K/2-y)/m;const N=Ii(f,d,v),at=Ii(g,p,v);q.push([N,at,K/2,G,F]),r+=K}return q}const So=[1/0,1/0,-1/0,-1/0],zs=[],Jn=[],Qn=[],js=[];function ox(n){return n[3].declutterBox}const ax=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function Tf(n,t){return t==="start"?t=ax.test(n)?"right":"left":t==="end"&&(t=ax.test(n)?"left":"right"),wu[t]}function nE(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}const sE=class{constructor(t,e,i,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,s){const r=t+e+i+s;if(this.labels_[r])return this.labels_[r];const o=s?this.strokeStates[s]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,u=[l.scale[0]*h,l.scale[1]*h],c=Array.isArray(t),d=l.justify?wu[l.justify]:Tf(Array.isArray(t)?t[0]:t,l.textAlign||Aa),p=s&&o.lineWidth?o.lineWidth:0,f=c?t:t.split(`
`).reduce(nE,[]),{width:g,height:m,widths:y,heights:_,lineWidths:v}=function($,K){const F=[],N=[],at=[];let tt=0,_t=0,Pt=0,Wt=0;for(let Ht=0,Qt=K.length;Ht<=Qt;Ht+=2){const ye=K[Ht];if(ye===`
`||Ht===Qt){tt=Math.max(tt,_t),at.push(_t),_t=0,Pt+=Wt;continue}const W=K[Ht+1]||$.font,we=Uh(W,ye);F.push(we),_t+=we;const ue=oM(W);N.push(ue),Wt=Math.max(Wt,ue)}return{width:tt,height:Pt,widths:F,heights:N,lineWidths:at}}(l,f),x=g+p,b=[],M=(x+2)*u[0],w=(m+p)*u[1],S={width:M<0?Math.floor(M):Math.ceil(M),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:b};(u[0]!=1||u[1]!=1)&&b.push("scale",u),s&&(b.push("strokeStyle",o.strokeStyle),b.push("lineWidth",p),b.push("lineCap",o.lineCap),b.push("lineJoin",o.lineJoin),b.push("miterLimit",o.miterLimit),b.push("setLineDash",[o.lineDash]),b.push("lineDashOffset",o.lineDashOffset)),i&&b.push("fillStyle",a.fillStyle),b.push("textBaseline","middle"),b.push("textAlign","center");const k=.5-d;let I=d*x+k*p;const R=[],E=[];let q,O=0,P=0,L=0,D=0;for(let G=0,$=f.length;G<$;G+=2){const K=f[G];if(K===`
`){P+=O,O=0,I=d*x+k*p,++D;continue}const F=f[G+1]||l.font;F!==q&&(s&&R.push("font",F),i&&E.push("font",F),q=F),O=Math.max(O,_[L]);const N=[K,I+k*y[L]+d*(y[L]-v[D]),.5*(p+O)+P];I+=y[L],s&&R.push("strokeText",N),i&&E.push("fillText",N),++L}return Array.prototype.push.apply(b,R),Array.prototype.push.apply(b,E),this.labels_[r]=S,S}replayTextBackground_(t,e,i,s,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,r,o,a,l,h,u,c,d,p,f,g,m){let y=i-(a*=d[0]),_=s-(l*=d[1]);const v=r+h>t?t-h:r,x=o+u>e?e-u:o,b=f[3]+v*d[0]+f[1],M=f[0]+x*d[1]+f[2],w=y-f[3],S=_-f[0];let k;return(g||c!==0)&&(zs[0]=w,js[0]=w,zs[1]=S,Jn[1]=S,Jn[0]=w+b,Qn[0]=Jn[0],Qn[1]=S+M,js[1]=Qn[1]),c!==0?(k=Bn([1,0,0,1,0,0],i,s,1,1,c,-i,-s),Ue(k,zs),Ue(k,Jn),Ue(k,Qn),Ue(k,js),xn(Math.min(zs[0],Jn[0],Qn[0],js[0]),Math.min(zs[1],Jn[1],Qn[1],js[1]),Math.max(zs[0],Jn[0],Qn[0],js[0]),Math.max(zs[1],Jn[1],Qn[1],js[1]),So)):xn(Math.min(w,w+b),Math.min(S,S+M),Math.max(w,w+b),Math.max(S,S+M),So),p&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:v,drawImageH:x,originX:h,originY:u,declutterBox:{minX:So[0],minY:So[1],maxX:So[2],maxY:So[3],value:m},canvasTransform:k,scale:d}}replayImageOrLabel_(t,e,i,s,r,o,a){const l=s.declutterBox,h=t.canvas,u=a?a[2]*s.scale[0]/2:0;return l.minX-u<=h.width/e&&l.maxX+u>=0&&l.minY-u<=h.height/e&&l.maxY+u>=0&&(!(!o&&!a)&&this.replayTextBackground_(t,zs,Jn,Qn,js,o,a),function(d,p,f,g,m,y,_,v,x,b,M){d.save(),f!==1&&(d.globalAlpha*=f),p&&d.transform.apply(d,p),g.contextInstructions?(d.translate(x,b),d.scale(M[0],M[1]),function(S,k){const I=S.contextInstructions;for(let R=0,E=I.length;R<E;R+=2)Array.isArray(I[R+1])?k[I[R]].apply(k,I[R+1]):k[I[R]]=I[R+1]}(g,d)):M[0]<0||M[1]<0?(d.translate(x,b),d.scale(M[0],M[1]),d.drawImage(g,m,y,_,v,0,0,_,v)):d.drawImage(g,m,y,_,v,x,b,_*M[0],v*M[1]),d.restore()}(t,s.canvasTransform,r,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){if(this.alignFill_){const e=Ue(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,s){const r=this.textStates[e],o=this.createLabel(t,e,s,i),a=this.strokeStates[i],l=this.pixelRatio,h=Tf(Array.isArray(t)?t[0]:t,r.textAlign||Aa),u=wu[r.textBaseline||Wh],c=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:h*(o.width/l-2*r.scale[0])+2*(.5-h)*c,anchorY:u*o.height/l+2*(.5-u)*c}}execute_(t,e,i,s,r,o,a,l){let h;this.pixelCoordinates_&&fs(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=xs(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),function(at,tt){at[0]=tt[0],at[1]=tt[1],at[2]=tt[2],at[3]=tt[3],at[4]=tt[4],at[5]=tt[5]}(this.renderedTransform_,i));let u=0;const c=s.length;let d,p,f,g,m,y,_,v,x,b,M,w,S=0,k=0,I=0,R=null,E=null;const q=this.coordinateCache_,O=this.viewRotation_,P=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,L={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},D=this.instructions!=s||this.overlaps?0:200;let G,$,K,F;for(;u<c;){const N=s[u];switch(N[0]){case pt.BEGIN_GEOMETRY:G=N[1],F=N[3],G.getGeometry()?a===void 0||Fe(a,F.getExtent())?++u:u=N[2]+1:u=N[2];break;case pt.BEGIN_PATH:k>D&&(this.fill_(t),k=0),I>D&&(t.stroke(),I=0),!k&&!I&&(t.beginPath(),g=NaN,m=NaN),++u;break;case pt.CIRCLE:S=N[1];const at=h[S],tt=h[S+1],_t=h[S+2]-at,Pt=h[S+3]-tt,Wt=Math.sqrt(_t*_t+Pt*Pt);t.moveTo(at+Wt,tt),t.arc(at,tt,Wt,0,2*Math.PI,!0),++u;break;case pt.CLOSE_PATH:t.closePath(),++u;break;case pt.CUSTOM:S=N[1],d=N[2];const Ht=N[4],Qt=N.length==6?N[5]:void 0;L.geometry=N[3],L.feature=G,u in q||(q[u]=[]);const ye=q[u];Qt?Qt(h,S,d,2,ye):(ye[0]=h[S],ye[1]=h[S+1],ye.length=2),Ht(ye,L),++u;break;case pt.DRAW_IMAGE:S=N[1],d=N[2],v=N[3],p=N[4],f=N[5];let W=N[6];const we=N[7],ue=N[8],ut=N[9],ae=N[10];let Ut=N[11];const At=N[12];let je=N[13];const Ze=N[14],ui=N[15];if(!v&&N.length>=20){x=N[19],b=N[20],M=N[21],w=N[22];const Zt=this.drawLabelWithPointPlacement_(x,b,M,w);v=Zt.label,N[3]=v,p=(Zt.anchorX-N[23])*this.pixelRatio,N[4]=p,f=(Zt.anchorY-N[24])*this.pixelRatio,N[5]=f,W=v.height,N[6]=W,je=v.width,N[13]=je}let ce,Ie,mt,Li;N.length>25&&(ce=N[25]),N.length>17?(Ie=N[16],mt=N[17],Li=N[18]):(Ie=ar,mt=!1,Li=!1),ae&&P?Ut+=O:!ae&&!P&&(Ut-=O);let de=0;for(;S<d;S+=2){if(ce&&ce[de++]<je/this.pixelRatio)continue;const Zt=this.calculateImageOrLabelDimensions_(v.width,v.height,h[S],h[S+1],je,W,p,f,ue,ut,Ut,At,r,Ie,mt||Li,G),wi=[t,e,v,Zt,we,mt?R:null,Li?E:null];if(l){if(Ze==="none")continue;if(Ze==="obstacle"){l.insert(Zt.declutterBox);continue}{let pi,Ws;if(ui){const rs=d-S;if(!ui[rs]){ui[rs]=wi;continue}if(pi=ui[rs],delete ui[rs],Ws=ox(pi),l.collides(Ws))continue}if(l.collides(Zt.declutterBox))continue;pi&&(l.insert(Ws),this.replayImageOrLabel_.apply(this,pi)),l.insert(Zt.declutterBox)}}this.replayImageOrLabel_.apply(this,wi)}++u;break;case pt.DRAW_CHARS:const le=N[1],Xt=N[2],te=N[3],Ft=N[4];w=N[5];const xt=N[6],re=N[7],Oe=N[8];M=N[9];const Ge=N[10];x=N[11],b=N[12];const Ye=[N[13],N[13]],ci=this.textStates[b],ti=ci.font,oe=[ci.scale[0]*re,ci.scale[1]*re];let $e;ti in this.widths_?$e=this.widths_[ti]:($e={},this.widths_[ti]=$e);const di=Nv(h,le,Xt,2),Di=Math.abs(oe[0])*__(ti,x,$e);if(Ft||Di<=di){const Zt=iE(h,le,Xt,2,x,(di-Di)*Tf(x,this.textStates[b].textAlign),xt,Math.abs(oe[0]),__,ti,$e,P?0:this.viewRotation_);t:if(Zt){const wi=[];let pi,Ws,rs,Ci,Yi;if(M)for(pi=0,Ws=Zt.length;pi<Ws;++pi){Yi=Zt[pi],rs=Yi[4],Ci=this.createLabel(rs,b,"",M),p=Yi[2]+(oe[0]<0?-Ge:Ge),f=te*Ci.height+2*(.5-te)*Ge*oe[1]/oe[0]-Oe;const os=this.calculateImageOrLabelDimensions_(Ci.width,Ci.height,Yi[0],Yi[1],Ci.width,Ci.height,p,f,0,0,Yi[3],Ye,!1,ar,!1,G);if(l&&l.collides(os.declutterBox))break t;wi.push([t,e,Ci,os,1,null,null])}if(w)for(pi=0,Ws=Zt.length;pi<Ws;++pi){Yi=Zt[pi],rs=Yi[4],Ci=this.createLabel(rs,b,w,""),p=Yi[2],f=te*Ci.height-Oe;const os=this.calculateImageOrLabelDimensions_(Ci.width,Ci.height,Yi[0],Yi[1],Ci.width,Ci.height,p,f,0,0,Yi[3],Ye,!1,ar,!1,G);if(l&&l.collides(os.declutterBox))break t;wi.push([t,e,Ci,os,1,null,null])}l&&l.load(wi.map(ox));for(let os=0,CI=wi.length;os<CI;++os)this.replayImageOrLabel_.apply(this,wi[os])}}++u;break;case pt.END_GEOMETRY:if(o!==void 0){G=N[1];const Zt=o(G,F);if(Zt)return Zt}++u;break;case pt.FILL:D?k++:this.fill_(t),++u;break;case pt.MOVE_TO_LINE_TO:for(S=N[1],d=N[2],$=h[S],K=h[S+1],y=$+.5|0,_=K+.5|0,(y!==g||_!==m)&&(t.moveTo($,K),g=y,m=_),S+=2;S<d;S+=2)$=h[S],K=h[S+1],y=$+.5|0,_=K+.5|0,(S==d-2||y!==g||_!==m)&&(t.lineTo($,K),g=y,m=_);++u;break;case pt.SET_FILL_STYLE:R=N,this.alignFill_=N[2],k&&(this.fill_(t),k=0,I&&(t.stroke(),I=0)),t.fillStyle=N[1],++u;break;case pt.SET_STROKE_STYLE:E=N,I&&(t.stroke(),I=0),this.setStrokeStyle_(t,N),++u;break;case pt.STROKE:D?I++:t.stroke(),++u;break;default:++u}}k&&this.fill_(t),I&&t.stroke()}execute(t,e,i,s,r,o){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,s,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,s,r)}},If=["Polygon","Circle","LineString","Image","Text","Default"],kf={},Mu=class{constructor(t,e,i,s,r,o){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];i===void 0&&(i={},this.executorsByZIndex_[e]=i);const s=t[e];for(const r in s)i[r]=new sE(this.resolution_,this.pixelRatio_,this.overlaps_,s[r])}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let s=0,r=t.length;s<r;++s)if(t[s]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,s,r,o){const a=2*(s=Math.round(s))+1,l=Bn(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Ke(a,a,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;let c;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):h||u.clearRect(0,0,a,a),this.renderBuffer_!==void 0&&(c=[1/0,1/0,-1/0,-1/0],va(c,t),ys(c,e*(this.renderBuffer_+s),c));const d=function(M){if(kf[M]!==void 0)return kf[M];const w=2*M+1,S=M*M,k=new Array(S+1);for(let R=0;R<=M;++R)for(let E=0;E<=M;++E){const q=R*R+E*E;if(q>S)break;let O=k[q];O||(O=[],k[q]=O),O.push(4*((M+R)*w+(M+E))+3),R>0&&O.push(4*((M-R)*w+(M+E))+3),E>0&&(O.push(4*((M+R)*w+(M-E))+3),R>0&&O.push(4*((M-R)*w+(M-E))+3))}const I=[];for(let R=0,E=k.length;R<E;++R)k[R]&&I.push(...k[R]);return kf[M]=I,I}(s);let p;function f(b,M){const w=u.getImageData(0,0,a,a).data;for(let S=0,k=d.length;S<k;S++)if(w[d[S]]>0){if(!o||p!=="Image"&&p!=="Text"||o.includes(b)){const I=(d[S]-3)/4,R=s-I%a,E=s-(I/a|0),q=r(b,M,R*R+E*E);if(q)return q}u.clearRect(0,0,a,a);break}}const g=Object.keys(this.executorsByZIndex_).map(Number);let m,y,_,v,x;for(g.sort(ps),m=g.length-1;m>=0;--m){const b=g[m].toString();for(_=this.executorsByZIndex_[b],y=If.length-1;y>=0;--y)if(p=If[y],v=_[p],v!==void 0&&(x=v.executeHitDetection(u,l,i,f,c),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],s=e[1],r=e[2],o=e[3],a=[i,s,i,o,r,o,r,s];return xs(a,0,8,2,t,a),a}isEmpty(){return gs(this.executorsByZIndex_)}execute(t,e,i,s,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);let h,u,c,d,p,f;for(l.sort(ps),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||If,a&&l.reverse(),h=0,u=l.length;h<u;++h){const g=l[h].toString();for(p=this.executorsByZIndex_[g],c=0,d=o.length;c<d;++c)f=p[o[c]],f!==void 0&&f.execute(t,e,i,s,r,a)}this.maxExtent_&&t.restore()}},rE=class extends ix{constructor(t,e,i,s,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.transformRotation_=s?Ch(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,s){if(!this.image_)return;const r=xs(t,e,i,s,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let u=0,c=r.length;u<c;u+=2){const d=r[u]-this.imageAnchorX_,p=r[u+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=d+this.imageAnchorX_,g=p+this.imageAnchorY_;Bn(a,f,g,1,1,h,-f,-g),o.save(),o.transform.apply(o,a),o.translate(f,g),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,p,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=xs(t,e,i,s,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=s){const l=r[e]+this.textOffsetX_,h=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(t,e,i,s,r){const o=this.context_,a=xs(t,e,i,s,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return r&&o.closePath(),i}drawRings_(t,e,i,s){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Fe(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(l,h,u){const c=l.getFlatCoordinates();if(!c)return null;const d=l.getStride();return xs(c,0,c.length,d,h,u)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],r=Math.sqrt(i*i+s*s),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,s=e.length;i<s;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Fe(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Fe(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,s=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)r=this.moveToLineTo_(s,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=r.length;a<l;++a)s=this.drawRings_(i,s,r[a],o);this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),fs(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:Aa;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=s&&(i.textAlign=s,e.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const i=t.getColor();this.fillState_={fillStyle:En(i||yi)}}else this.fillState_=null;if(e){const i=e.getColor(),s=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),u=r||Xn;this.strokeState_={lineCap:s!==void 0?s:to,lineDash:this.pixelRatio_===1?u:u.map(c=>c*this.pixelRatio_),lineDashOffset:(o||0)*this.pixelRatio_,lineJoin:a!==void 0?a:eo,lineWidth:(l!==void 0?l:1)*this.pixelRatio_,miterLimit:h!==void 0?h:10,strokeStyle:En(i||Oa)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*i,this.imageAnchorY_=s[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const p=e.getColor();this.textFillState_={fillStyle:En(p||yi)}}else this.textFillState_=null;const i=t.getStroke();if(i){const p=i.getColor(),f=i.getLineCap(),g=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),_=i.getWidth(),v=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:to,lineDash:g||Xn,lineDashOffset:m||0,lineJoin:y!==void 0?y:eo,lineWidth:_!==void 0?_:1,miterLimit:v!==void 0?v:10,strokeStyle:En(p||Oa)}}else this.textStrokeState_=null;const s=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),u=t.getText(),c=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:s!==void 0?s:g_,textAlign:c!==void 0?c:Aa,textBaseline:d!==void 0?d:Wh},this.text_=u!==void 0?Array.isArray(u)?u.reduce((p,f,g)=>p+(g%2?" ":f),""):u:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0&&a,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}else this.text_=""}},Fi=.5;function lx(n,t,e,i,s,r,o){const a=Ke(n[0]*Fi,n[1]*Fi);a.imageSmoothingEnabled=!1;const l=a.canvas,h=new rE(a,Fi,s,null,o),u=e.length,c=Math.floor(16777215/u),d={};for(let f=1;f<=u;++f){const g=e[f-1],m=g.getStyleFunction()||i;if(!m)continue;let y=m(g,r);if(!y)continue;Array.isArray(y)||(y=[y]);const _=(f*c).toString(16).padStart(7,"#00000");for(let v=0,x=y.length;v<x;++v){const b=y[v],M=b.getGeometryFunction()(g);if(!M||!Fe(s,M.getExtent()))continue;const w=b.clone(),S=w.getFill();S&&S.setColor(_);const k=w.getStroke();k&&(k.setColor(_),k.setLineDash(null)),w.setText(void 0);const I=b.getImage();if(I){const O=I.getImageSize();if(!O)continue;const P=Ke(O[0],O[1],void 0,{alpha:!1}),L=P.canvas;P.fillStyle=_,P.fillRect(0,0,L.width,L.height),w.setImage(new au({img:L,anchor:I.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:I.getOrigin(),opacity:1,size:I.getSize(),scale:I.getScale(),rotation:I.getRotation(),rotateWithView:I.getRotateWithView()}))}const R=w.getZIndex()||0;let E=d[R];E||(E={},d[R]=E,E.Polygon=[],E.Circle=[],E.LineString=[],E.Point=[]);const q=M.getType();if(q==="GeometryCollection"){const O=M.getGeometriesArrayRecursive();for(let P=0,L=O.length;P<L;++P){const D=O[P];E[D.getType().replace("Multi","")].push(D,w)}}else E[q.replace("Multi","")].push(M,w)}}const p=Object.keys(d).map(Number).sort(ps);for(let f=0,g=p.length;f<g;++f){const m=d[p[f]];for(const y in m){const _=m[y];for(let v=0,x=_.length;v<x;v+=2){h.setStyle(_[v+1]);for(let b=0,M=t.length;b<M;++b)h.setTransform(t[b]),h.drawGeometry(_[v])}}}return a.getImageData(0,0,l.width,l.height)}function hx(n,t,e){const i=[];if(e){const s=Math.floor(Math.round(n[0])*Fi),r=Math.floor(Math.round(n[1])*Fi),o=4*(Te(s,0,e.width-1)+Te(r,0,e.height-1)*e.width),a=e.data[o+2]+256*(e.data[o+1]+256*e.data[o]),l=Math.floor(16777215/t.length);a&&a%l==0&&i.push(t[a/l-1])}return i}const oE=.5,ux={Point:function(t,e,i,s,r){const o=i.getImage(),a=i.getText();let l;if(o){if(o.getImageState()!=2)return;let h=t;if(r){const c=o.getDeclutterMode();if(c!=="none")if(h=r,c==="obstacle"){const d=t.getBuilder(i.getZIndex(),"Image");d.setImageStyle(o,l),d.drawPoint(e,s)}else a&&a.getText()&&(l={})}const u=h.getBuilder(i.getZIndex(),"Image");u.setImageStyle(o,l),u.drawPoint(e,s)}if(a&&a.getText()){let h=t;r&&(h=r);const u=h.getBuilder(i.getZIndex(),"Text");u.setTextStyle(a,l),u.drawText(e,s)}},LineString:function(t,e,i,s,r){const o=i.getStroke();if(o){const l=t.getBuilder(i.getZIndex(),"LineString");l.setFillStrokeStyle(null,o),l.drawLineString(e,s)}const a=i.getText();if(a&&a.getText()){const l=(r||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,s)}},Polygon:function(t,e,i,s,r){const o=i.getFill(),a=i.getStroke();if(o||a){const h=t.getBuilder(i.getZIndex(),"Polygon");h.setFillStrokeStyle(o,a),h.drawPolygon(e,s)}const l=i.getText();if(l&&l.getText()){const h=(r||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,s)}},MultiPoint:function(t,e,i,s,r){const o=i.getImage(),a=i.getText();let l;if(o){if(o.getImageState()!=2)return;let h=t;if(r){const c=o.getDeclutterMode();if(c!=="none")if(h=r,c==="obstacle"){const d=t.getBuilder(i.getZIndex(),"Image");d.setImageStyle(o,l),d.drawMultiPoint(e,s)}else a&&a.getText()&&(l={})}const u=h.getBuilder(i.getZIndex(),"Image");u.setImageStyle(o,l),u.drawMultiPoint(e,s)}if(a&&a.getText()){let h=t;r&&(h=r);const u=h.getBuilder(i.getZIndex(),"Text");u.setTextStyle(a,l),u.drawText(e,s)}},MultiLineString:function(t,e,i,s,r){const o=i.getStroke();if(o){const l=t.getBuilder(i.getZIndex(),"LineString");l.setFillStrokeStyle(null,o),l.drawMultiLineString(e,s)}const a=i.getText();if(a&&a.getText()){const l=(r||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,s)}},MultiPolygon:function(t,e,i,s,r){const o=i.getFill(),a=i.getStroke();if(a||o){const h=t.getBuilder(i.getZIndex(),"Polygon");h.setFillStrokeStyle(o,a),h.drawMultiPolygon(e,s)}const l=i.getText();if(l&&l.getText()){const h=(r||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,s)}},GeometryCollection:function(t,e,i,s,r){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a)(0,ux[o[a].getType()])(t,o[a],i,s,r)},Circle:function(t,e,i,s,r){const o=i.getFill(),a=i.getStroke();if(o||a){const h=t.getBuilder(i.getZIndex(),"Circle");h.setFillStrokeStyle(o,a),h.drawCircle(e,s)}const l=i.getText();if(l&&l.getText()){const h=(r||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,s)}}};function aE(n,t){return parseInt(wt(n),10)-parseInt(wt(t),10)}function cx(n,t){const e=Pf(n,t);return e*e}function Pf(n,t){return oE*n/t}function Su(n,t,e,i,s,r,o){let a=!1;const l=e.getImage();if(l){const h=l.getImageState();h==2||h==3?l.unlistenImageChange(s):(h==0&&l.load(),l.listenImageChange(s),a=!0)}return function(u,c,d,p,f,g){const m=d.getGeometryFunction()(c);if(!m)return;const y=m.simplifyTransformed(p,f);d.getRenderer()?dx(u,y,d,c):(0,ux[y.getType()])(u,y,d,c,g)}(n,t,e,i,r,o),a}function dx(n,t,e,i){if(t.getType()!="GeometryCollection")n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer());else{const s=t.getGeometries();for(let r=0,o=s.length;r<o;++r)dx(n,s[r],e,i)}}const lE=class extends rx{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const s=e.extent,r=e.viewState,o=r.center,a=r.resolution,l=r.projection,h=r.rotation,u=l.getExtent(),c=this.getLayer().getSource(),d=e.pixelRatio,p=e.viewHints,f=!(p[0]||p[1]),g=this.compositionContext_,m=Math.round(e.size[0]*d),y=Math.round(e.size[1]*d),_=c.getWrapX()&&l.canWrapX(),v=_?ee(u):null,x=_?Math.ceil((s[2]-u[2])/v)+1:1;let b=_?Math.floor((s[0]-u[0])/v):0;do{const M=this.getRenderTransform(o,a,h,d,m,y,b*v);t.execute(g,1,M,h,f,void 0,i)}while(++b<x)}setupCompositionContext_(){if(this.opacity_!==1){const t=Ke(this.context.canvas.width,this.context.canvas.height,sx);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Fa(this.compositionContext_),sx.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,s=t.layerStatesArray[t.layerIndex];(function(y,_,v){xh(y,_,0,0,v,0,0)})(this.pixelTransform,1/i,1/i),Wd(this.inversePixelTransform,this.pixelTransform);const r=h1(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const o=this.context,a=o.canvas,l=this.replayGroup_,h=this.declutterExecutorGroup;let u=l&&!l.isEmpty()||h&&!h.isEmpty();if(!u&&!this.getLayer().hasListener("prerender")&&!this.getLayer().hasListener("postrender"))return null;const c=Math.round(t.size[0]*i),d=Math.round(t.size[1]*i);a.width!=c||a.height!=d?(a.width=c,a.height=d,a.style.transform!==r&&(a.style.transform=r)):this.containerReused||o.clearRect(0,0,c,d),this.preRender(o,t);const p=t.viewState,f=p.projection;this.opacity_=s.opacity,this.setupCompositionContext_();let g=!1;if(u&&s.extent&&this.clipping){const m=nr(s.extent,f);u=Fe(m,t.extent),g=u&&!_s(m,t.extent),g&&this.clipUnrotated(this.compositionContext_,t,m)}return u&&this.renderWorlds(l,t),g&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==p.rotation&&(this.renderedRotation_=p.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=[this.context.canvas.width,this.context.canvas.height];Ue(this.pixelTransform,i);const s=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),u=[],c=i[0]*Fi,d=i[1]*Fi;u.push(this.getRenderTransform(s,r,o,Fi,c,d,0).slice());const p=h.getSource(),f=a.getExtent();if(p.getWrapX()&&a.canWrapX()&&!_s(f,l)){let g=l[0];const m=ee(f);let y,_=0;for(;g<f[0];)--_,y=m*_,u.push(this.getRenderTransform(s,r,o,Fi,c,d,y).slice()),g+=m;for(_=0,g=l[2];g>f[2];)++_,y=m*_,u.push(this.getRenderTransform(s,r,o,Fi,c,d,y).slice()),g-=m}this.hitDetectionImageData_=lx(i,u,this.renderedFeatures_,h.getStyleFunction(),l,r,o)}e(hx(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,s,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),h={},u=function(p,f,g){const m=wt(p),y=h[m];if(y){if(y!==!0&&g<y.distanceSq){if(g===0)return h[m]=!0,r.splice(r.lastIndexOf(y),1),s(p,l,f);y.geometry=f,y.distanceSq=g}}else{if(g===0)return h[m]=!0,s(p,l,f);r.push(h[m]={feature:p,layer:l,geometry:f,distanceSq:g,callback:s})}};let c;const d=[this.replayGroup_];return this.declutterExecutorGroup&&d.push(this.declutterExecutorGroup),d.some(p=>c=p.forEachFeatureAtCoordinate(t,o,a,i,u,p===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(f=>f.value):null)),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const s=t.viewHints[0],r=t.viewHints[1],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&s||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,u=h.projection,c=h.resolution,d=t.pixelRatio,p=e.getRevision(),f=e.getRenderBuffer();let g=e.getRenderOrder();g===void 0&&(g=aE);const m=h.center.slice(),y=ys(l,f*c),_=y.slice(),v=[y.slice()],x=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!_s(x,t.extent)){const L=ee(x),D=Math.max(ee(y)/2,L);y[0]=x[0]-D,y[2]=x[2]+D,rp(m,u);const G=g1(v[0],u);G[0]<x[0]&&G[2]<x[2]?v.push([G[0]+L,G[1],G[2]+L,G[3]]):G[0]>x[0]&&G[2]>x[2]&&v.push([G[0]-L,G[1],G[2]-L,G[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==p&&this.renderedRenderOrder_==g&&_s(this.wrappedRenderedExtent_,y))return fs(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const b=new Cu(Pf(c,d),y,c,d);let M;this.getLayer().getDeclutter()&&(M=new Cu(Pf(c,d),y,c,d));const w=Ta();let S;if(w){for(let L=0,D=v.length;L<D;++L){const G=cp(v[L],u);i.loadFeatures(G,ZC(c,u),w)}S=Ea(w,u)}else for(let L=0,D=v.length;L<D;++L)i.loadFeatures(v[L],c,u);const k=cx(c,d);let I=!0;const R=L=>{let D;const G=L.getStyleFunction()||e.getStyleFunction();if(G&&(D=G(L,c)),D){const $=this.renderFeature(L,k,D,b,S,M);I=I&&!$}},E=cp(y,u),q=i.getFeaturesInExtent(E);g&&q.sort(g);for(let L=0,D=q.length;L<D;++L)R(q[L]);this.renderedFeatures_=q,this.ready=I;const O=b.finish(),P=new Mu(y,c,d,i.getOverlaps(),O,e.getRenderBuffer());return M&&(this.declutterExecutorGroup=new Mu(y,c,d,i.getOverlaps(),M.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=p,this.renderedRenderOrder_=g,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=u,this.replayGroup_=P,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,s,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,h=i.length;l<h;++l)a=Su(s,t,i[l],e,this.boundHandleStyleImageChange_,r,o)||a;else a=Su(s,t,i,e,this.boundHandleStyleImageChange_,r,o);return a}},Eu=class extends tx{constructor(t){super(t)}createRenderer(){return new lE(this)}},px=class{constructor(t){this.rbush_=new Vv(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[wt(e)]=i}load(t,e){const i=new Array(e.length);for(let s=0,r=e.length;s<r;s++){const o=t[s],a=e[s],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[s]=l,this.items_[wt(a)]=l}this.rbush_.load(i)}remove(t){const e=wt(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[wt(e)];Br([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(t){return this.rbush_.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}).map(function(e){return e.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let s=0,r=t.length;s<r;s++)if(i=e(t[s]),i)return i;return i}isEmpty(){return gs(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return xn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function hE(n,t){return[[-1/0,-1/0,1/0,1/0]]}function uE(n,t){return[n]}class Gs extends yn{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const dr=class extends A_{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX===void 0||t.wrapX}),this.loader_=qr,this.format_=t.format,this.overlaps_=t.overlaps===void 0||t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(Vt(this.format_,"`format` must be set when `url` is set"),this.loader_=U_(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:hE;const e=t.useSpatialIndex===void 0||t.useSpatialIndex;let i,s;this.featuresRtree_=e?new px:null,this.loadedExtentsRtree_=new px,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?s=t.features:t.features&&(i=t.features,s=i.getArray()),!e&&i===void 0&&(i=new vn(s)),s!==void 0&&this.addFeaturesInternal(s),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=wt(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const s=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Gs("addfeature",t))}setupChangeEvents_(t,e){e instanceof Hi||(this.featureChangeKeys_[t]=[Dt(e,"change",this.handleFeatureChange_,this),Dt(e,"propertychange",this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const s=String(e.getId());if(s in this.idIndex_)if(e instanceof Hi){const r=this.idIndex_[s];r instanceof Hi?Array.isArray(r)?r.push(e):this.idIndex_[s]=[r,e]:i=!1}else i=!1;else this.idIndex_[s]=e}return i&&(Vt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=wt(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=wt(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const u=h.getExtent();e.push(u),s.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,s),this.hasListener("addfeature"))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new Gs("addfeature",i[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener("addfeature",function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener("removefeature",function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener("add",i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener("remove",i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(me);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Gs("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){return this.forEachFeatureInExtent([t[0],t[1],t[0],t[1]],function(i){const s=i.getGeometry();if(s instanceof Hi||s.intersectsCoordinate(t))return e(i)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const s=i.getGeometry();if(s instanceof Hi||s.intersectsExtent(t)){const r=e(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),gs(this.nullGeometryFeatures_)||_n(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(r,o){if(o.canWrapX()){const a=o.getExtent();if(!isFinite(r[0])||!isFinite(r[2]))return[[a[0],r[1],a[2],r[3]]];g1(r,o);const l=ee(a);if(ee(r)>l)return[[a[0],r[1],a[2],r[3]]];if(r[0]<a[0])return[[r[0]+l,r[1],a[2],r[3]],[a[0],r[1],r[2],r[3]]];if(r[2]>a[2])return[[r[0],r[1],a[2],r[3]],[a[0],r[1],r[2]-l,r[3]]]}return[r]}(t,e);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],s=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||jr,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const u=h.getGeometry(),c=a;if(a=u instanceof Hi?0:u.closestPointXY(i,s,o,a),a<c){r=h;const d=Math.sqrt(a);l[0]=i-d,l[1]=s-d,l[2]=i+d,l[3]=s+d}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=wt(e),s=e.getGeometry();if(s){const o=s.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Gs("changefeature",e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:wt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&gs(this.nullGeometryFeatures_):!this.featuresCollection_||this.featuresCollection_.getLength()===0}loadFeatures(t,e,i){const s=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];s.forEachInExtent(l,function(h){return _s(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Gs("featuresloadstart")),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Gs("featuresloadend",void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Gs("featuresloaderror"))}),s.insert(l,{extent:l.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(s){if(Br(s.extent,t))return i=s,!0}),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=wt(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=wt(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(me),delete this.featureChangeKeys_[e];const s=t.getId();return s!==void 0&&delete this.idIndex_[s.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Gs("removefeature",t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_){const s=this.idIndex_[i];if(t instanceof Hi&&Array.isArray(s)&&s.includes(t))s.splice(s.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){Vt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(U_(t,this.format_))}},fx=class extends rx{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedProjection=null,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new D_(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),s=e.getUseInterimTilesOnError();return i==Y.LOADED||i==Y.EMPTY||i==Y.ERROR&&!s}getTile(t,e,i,s){const r=s.pixelRatio,o=s.viewState.projection,a=this.getLayer();let l=a.getSource().getTile(t,e,i,r,o);return l.getState()==Y.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(l)||(l=l.getInterimTile()),l}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=Ue(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!bh(r,s))return null;const o=e.pixelRatio,a=e.viewState.projection,l=e.viewState,h=i.getRenderSource(),u=h.getTileGridForProjection(l.projection),c=h.getTilePixelRatio(e.pixelRatio);for(let d=u.getZForResolution(l.resolution);d>=u.getMinZoom();--d){const p=u.getTileCoordForCoordAndZ(s,d),f=h.getTile(d,p[1],p[2],o,a);if(!(f instanceof T_||f instanceof Bp)||f instanceof Bp&&f.getState()===Y.EMPTY)return null;if(f.getState()!==Y.LOADED)continue;const g=u.getOrigin(d),m=ni(u.getTileSize(d)),y=u.getResolution(d),_=Math.floor(c*((s[0]-g[0])/y-p[1]*m[0])),v=Math.floor(c*((g[1]-s[1])/y-p[2]*m[1])),x=Math.round(c*h.getGutterForProjection(l.projection));return this.getImageData(f.getImage(),_+x,v+x)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],s=t.viewState,r=s.projection,o=s.resolution,a=s.center,l=s.rotation,h=t.pixelRatio,u=this.getLayer(),c=u.getSource(),d=c.getRevision(),p=c.getTileGridForProjection(r),f=p.getZForResolution(o,c.zDirection),g=p.getResolution(f);let m=t.extent;const y=t.viewState.resolution,_=c.getTilePixelRatio(h),v=Math.round(ee(m)/y*h),x=Math.round(Ti(m)/y*h),b=i.extent&&nr(i.extent,r);b&&(m=er(m,nr(i.extent,r)));const M=g*v/2/_,w=g*x/2/_,S=[a[0]-M,a[1]-w,a[0]+M,a[1]+w],k=p.getTileRangeForExtentAndZ(m,f),I={};I[f]={};const R=this.createLoadedTileFinder(c,r,I),E=this.tmpExtent,q=this.tmpTileRange_;this.newTiles_=!1;const O=l?Kd(s.center,y,l,t.size):void 0;for(let at=k.minX;at<=k.maxX;++at)for(let tt=k.minY;tt<=k.maxY;++tt){if(l&&!p.tileCoordIntersectsViewport([f,at,tt],O))continue;const _t=this.getTile(f,at,tt,t);if(this.isDrawableTile(_t)){const Ht=wt(this);if(_t.getState()==Y.LOADED){I[f][_t.tileCoord.toString()]=_t;let Qt=_t.inTransition(Ht);Qt&&i.opacity!==1&&(_t.endTransition(Ht),Qt=!1),!this.newTiles_&&(Qt||!this.renderedTiles.includes(_t))&&(this.newTiles_=!0)}if(_t.getAlpha(Ht,t.time)===1)continue}const Pt=p.getTileCoordChildTileRange(_t.tileCoord,q,E);let Wt=!1;Pt&&(Wt=R(f+1,Pt)),Wt||p.forEachTileCoordParentTileRange(_t.tileCoord,R,q,E)}const P=g/o*h/_;Bn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-v/2,-x/2);const L=h1(this.pixelTransform);this.useContainer(e,L,this.getBackground(t));const D=this.context,G=D.canvas;Wd(this.inversePixelTransform,this.pixelTransform),Bn(this.tempTransform,v/2,x/2,P,P,0,-v/2,-x/2),G.width!=v||G.height!=x?(G.width=v,G.height=x):this.containerReused||D.clearRect(0,0,v,x),b&&this.clipUnrotated(D,t,b),c.getInterpolate()||(D.imageSmoothingEnabled=!1),this.preRender(D,t),this.renderedTiles.length=0;let $,K,F,N=Object.keys(I).map(Number);N.sort(ps),i.opacity!==1||this.containerReused&&!c.getOpaque(t.viewState.projection)?($=[],K=[]):N=N.reverse();for(let at=N.length-1;at>=0;--at){const tt=N[at],_t=c.getTilePixelSize(tt,h,r),Pt=p.getResolution(tt)/g,Wt=_t[0]*Pt*P,Ht=_t[1]*Pt*P,Qt=p.getTileCoordForCoordAndZ(Gi(S),tt),ye=p.getTileCoordExtent(Qt),W=Ue(this.tempTransform,[_*(ye[0]-S[0])/g,_*(S[3]-ye[3])/g]),we=_*c.getGutterForProjection(r),ue=I[tt];for(const ut in ue){const ae=ue[ut],Ut=ae.tileCoord,At=Qt[1]-Ut[1],je=Math.round(W[0]-(At-1)*Wt),Ze=Qt[2]-Ut[2],ui=Math.round(W[1]-(Ze-1)*Ht),ce=Math.round(W[0]-At*Wt),Ie=Math.round(W[1]-Ze*Ht),mt=je-ce,Li=ui-Ie,de=f===tt,le=de&&ae.getAlpha(wt(this),t.time)!==1;let Xt=!1;if(!le)if($){F=[ce,Ie,ce+mt,Ie,ce+mt,Ie+Li,ce,Ie+Li];for(let te=0,Ft=$.length;te<Ft;++te)if(f!==tt&&tt<K[te]){const xt=$[te];Fe([ce,Ie,ce+mt,Ie+Li],[xt[0],xt[3],xt[4],xt[7]])&&(Xt||(D.save(),Xt=!0),D.beginPath(),D.moveTo(F[0],F[1]),D.lineTo(F[2],F[3]),D.lineTo(F[4],F[5]),D.lineTo(F[6],F[7]),D.moveTo(xt[6],xt[7]),D.lineTo(xt[4],xt[5]),D.lineTo(xt[2],xt[3]),D.lineTo(xt[0],xt[1]),D.clip())}$.push(F),K.push(tt)}else D.clearRect(ce,Ie,mt,Li);this.drawTileImage(ae,t,ce,Ie,mt,Li,we,de),$&&!le?(Xt&&D.restore(),this.renderedTiles.unshift(ae)):this.renderedTiles.push(ae),this.updateUsedTiles(t.usedTiles,c,ae)}}return this.renderedRevision=d,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Br(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,c,p,h,r,m,f,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(D,t),i.extent&&D.restore(),D.imageSmoothingEnabled=!0,L!==G.style.transform&&(G.style.transform=L),this.container}drawTileImage(t,e,i,s,r,o,a,l){const h=this.getTileImage(t);if(!h)return;const u=wt(this),c=e.layerStatesArray[e.layerIndex],d=c.opacity*(l?t.getAlpha(u,e.time):1),p=d!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,s,r,o),p&&this.context.restore(),d!==c.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=(function(s,r,o){const a=wt(s);a in o.usedTiles&&s.expireCache(o.viewState.projection,o.usedTiles[a])}).bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const s=wt(e);s in t||(t[s]={}),t[s][i.getKey()]=!0}manageTilePyramid(t,e,i,s,r,o,a,l,h){const u=wt(e);u in t.wantedTiles||(t.wantedTiles[u]={});const c=t.wantedTiles[u],d=t.tileQueue,p=i.getMinZoom(),f=t.viewState.rotation,g=f?Kd(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let m,y,_,v,x,b,M=0;for(b=p;b<=a;++b)for(y=i.getTileRangeForExtentAndZ(o,b,y),_=i.getResolution(b),v=y.minX;v<=y.maxX;++v)for(x=y.minY;x<=y.maxY;++x)f&&!i.tileCoordIntersectsViewport([b,v,x],g)||(a-b<=l?(++M,m=e.getTile(b,v,x,s,r),m.getState()==Y.IDLE&&(c[m.getKey()]=!0,d.isKeyQueued(m.getKey())||d.enqueue([m,u,i.getTileCoordCenter(m.tileCoord),_])),h!==void 0&&h(m)):e.useTile(b,v,x,r));e.updateCacheSize(M,r)}},cE={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},dE={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},pE=class extends fx{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedPixelToCoordinateTransform_=null,this.tmpTransform_=[1,0,0,1,0,0]}prepareTile(t,e,i){let s;const r=t.getState();return(r===Y.LOADED||r===Y.ERROR)&&(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t)&&(s=!0)),s}getTile(t,e,i,s){const r=s.pixelRatio,o=s.viewState,a=o.resolution,l=o.projection,h=this.getLayer(),u=h.getSource().getTile(t,e,i,r,l),c=s.viewHints,d=!(c[0]||c[1]);return(d||!u.wantedResolution)&&(u.wantedResolution=a),this.prepareTile(u,r,l)&&(d||Date.now()-s.time<8)&&h.getRenderMode()!=="vector"&&this.renderTileImage_(u,s),super.getTile(t,e,i,s)}isDrawableTile(t){const e=this.getLayer();return super.isDrawableTile(t)&&(e.getRenderMode()==="vector"?wt(e)in t.executorGroups:t.hasContext(e))}getTileImage(t){return t.getImage(this.getLayer())}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const s=this.getLayer(),r=s.getRevision(),o=s.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(s);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const h=s.getSource(),u=s.getDeclutter(),c=h.getTileGrid(),d=h.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),p=h.getSourceTiles(e,i,t),f=wt(s);delete t.hitDetectionImageData[f],t.executorGroups[f]=[],u&&(t.declutterExecutorGroups[f]=[]),l.dirty=!1;for(let g=0,m=p.length;g<m;++g){const y=p[g];if(y.getState()!=Y.LOADED)continue;const _=c.getTileCoordExtent(y.tileCoord),v=er(d,_),x=ys(v,s.getRenderBuffer()*a,this.tmpExtent),b=Br(_,v)?null:x,M=new Cu(0,x,a,e),w=u?new Cu(0,v,a,e):void 0,S=cx(a,e),k=function(O){let P;const L=O.getStyleFunction()||s.getStyleFunction();if(L&&(P=L(O,a)),P){const D=this.renderFeature(O,S,P,M,w);l.dirty=l.dirty||D}},I=y.getFeatures();o&&o!==l.renderedRenderOrder&&I.sort(o);for(let O=0,P=I.length;O<P;++O){const L=I[O];(!b||Fe(b,L.getGeometry().getExtent()))&&k.call(this,L)}const R=M.finish(),E=s.getRenderMode()!=="vector"&&u&&p.length===1?null:v,q=new Mu(E,a,e,h.getOverlaps(),R,s.getRenderBuffer());if(t.executorGroups[f].push(q),w){const O=new Mu(null,a,e,h.getOverlaps(),w.finish(),s.getRenderBuffer());t.declutterExecutorGroups[f].push(O)}}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,s,r){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),h=l.getSource().getTileGridForProjection(e.viewState.projection),u=_a([t]);ys(u,o*i,u);const c={},d=function(g,m,y){let _=g.getId();_===void 0&&(_=wt(g));const v=c[_];if(v){if(v!==!0&&y<v.distanceSq){if(y===0)return c[_]=!0,r.splice(r.lastIndexOf(v),1),s(g,l,m);v.geometry=m,v.distanceSq=y}}else{if(y===0)return c[_]=!0,s(g,l,m);r.push(c[_]={feature:g,layer:l,geometry:m,distanceSq:y,callback:s})}},p=this.renderedTiles;let f;for(let g=0,m=p.length;!f&&g<m;++g){const y=p[g];if(!Fe(h.getTileCoordExtent(y.wrappedTileCoord),u))continue;const _=wt(l),v=[y.executorGroups[_]],x=y.declutterExecutorGroups[_];x&&v.push(x),v.some(b=>{const M=b===x?e.declutterTree.all().map(w=>w.value):null;for(let w=0,S=b.length;w<S;++w)if(f=b[w].forEachFeatureAtCoordinate(t,o,a,i,d,M),f)return!0})}return f}getFeatures(t){return new Promise((e,i)=>{const s=this.getLayer(),r=wt(s),o=s.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,u=o.getTileGridForProjection(a),c=Ue(this.renderedPixelToCoordinateTransform_,t.slice()),d=u.getTileCoordForCoordAndResolution(c,h);let p;for(let _=0,v=this.renderedTiles.length;_<v;++_)if(d.toString()===this.renderedTiles[_].tileCoord.toString()){if(p=this.renderedTiles[_],p.getState()===Y.LOADED){const x=u.getTileCoordExtent(p.tileCoord);o.getWrapX()&&a.canWrapX()&&!_s(l,x)&&rp(c,a);break}p=void 0}if(!p||p.loadingSourceTiles>0)return void e([]);const f=Gi(u.getTileCoordExtent(p.wrappedTileCoord)),g=[(c[0]-f[0])/h,(f[1]-c[1])/h],m=p.getSourceTiles().reduce(function(_,v){return _.concat(v.getFeatures())},[]);let y=p.hitDetectionImageData[r];if(!y){const _=ni(u.getTileSize(u.getZForResolution(h,o.zDirection))),v=this.renderedRotation_;y=lx(_,[this.getRenderTransform(u.getTileCoordCenter(p.wrappedTileCoord),h,0,Fi,_[0]*Fi,_[1]*Fi,0)],m,s.getStyleFunction(),u.getTileCoordExtent(p.wrappedTileCoord),p.getReplayState(s).renderedResolution,v),p.hitDetectionImageData[r]=y}e(hx(g,m,y))})}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t){const e=this.context,i=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();const s=t.viewHints,r=!(s[0]||s[1]),o=this.renderedTiles;for(let a=0,l=o.length;a<l;++a){const h=o[a],u=h.declutterExecutorGroups[wt(this.getLayer())];if(u)for(let c=u.length-1;c>=0;--c)u[c].execute(this.context,1,this.getTileRenderTransform(h,t),t.viewState.rotation,r,void 0,t.declutterTree)}e.globalAlpha=i}getTileRenderTransform(t,e){const i=e.pixelRatio,s=e.viewState,r=s.center,o=s.resolution,a=s.rotation,l=e.size,h=Math.round(l[0]*i),u=Math.round(l[1]*i),c=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,p=c.getTileCoordExtent(t.wrappedTileCoord),f=c.getTileCoordExtent(d,this.tmpExtent)[0]-p[0];return Vd(Bd(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,o,a,i,h,u,f))}postRender(t,e){const i=e.viewHints,s=!(i[0]||i[1]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;const r=this.getLayer(),o=r.getRenderMode(),a=t.globalAlpha;t.globalAlpha=r.getOpacity();const l=dE[o],h=e.viewState,u=h.rotation,c=r.getSource(),d=c.getTileGridForProjection(h.projection).getZForResolution(h.resolution,c.zDirection),p=this.renderedTiles,f=[],g=[];let m=!0;for(let y=p.length-1;y>=0;--y){const _=p[y];m=m&&!_.getReplayState(r).dirty;const v=_.executorGroups[wt(r)].filter(S=>S.hasExecutors(l));if(v.length===0)continue;const x=this.getTileRenderTransform(_,e),b=_.tileCoord[0];let M=!1;const w=v[0].getClipCoords(x);if(w){for(let S=0,k=f.length;S<k;++S)if(d!==b&&b<g[S]){const I=f[S];Fe([w[0],w[3],w[4],w[7]],[I[0],I[3],I[4],I[7]])&&(M||(t.save(),M=!0),t.beginPath(),t.moveTo(w[0],w[1]),t.lineTo(w[2],w[3]),t.lineTo(w[4],w[5]),t.lineTo(w[6],w[7]),t.moveTo(I[6],I[7]),t.lineTo(I[4],I[5]),t.lineTo(I[2],I[3]),t.lineTo(I[0],I[1]),t.clip())}f.push(w),g.push(b)}for(let S=0,k=v.length;S<k;++S)v[S].execute(t,1,x,u,s,l);M&&t.restore()}t.globalAlpha=a,this.ready=m,super.postRender(t,e)}renderFeature(t,e,i,s,r){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,l=i.length;a<l;++a)o=Su(s,t,i[a],e,this.boundHandleStyleImageChange_,void 0,r)||o;else o=Su(s,t,i,e,this.boundHandleStyleImageChange_,void 0,r);return o}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),s=e.getRevision();return i.renderedTileResolution!==t.wantedResolution||i.renderedTileRevision!==s}renderTileImage_(t,e){const i=this.getLayer(),s=t.getReplayState(i),r=i.getRevision(),o=t.executorGroups[wt(i)];s.renderedTileRevision=r;const a=t.wrappedTileCoord,l=a[0],h=i.getSource();let u=e.pixelRatio;const c=e.viewState.projection,d=h.getTileGridForProjection(c),p=d.getResolution(t.tileCoord[0]),f=e.pixelRatio/t.wantedResolution*p,g=d.getResolution(l),m=t.getContext(i);u=Math.round(Math.max(u,f/u));const y=h.getTilePixelSize(l,u,c);m.canvas.width=y[0],m.canvas.height=y[1];const _=u/f;if(_!==1){const M=a1(this.tmpTransform_);Bd(M,_,_),m.setTransform.apply(m,M)}const v=d.getTileCoordExtent(a,this.tmpExtent),x=f/g,b=a1(this.tmpTransform_);Bd(b,x,-x),function(w,S,k){Vd(w,xh(o1,1,0,0,1,S,k))}(b,-v[0],-v[3]);for(let M=0,w=o.length;M<w;++M)o[M].execute(m,_,b,0,!0,cE[i.getRenderMode()]);s.renderedTileResolution=t.wantedResolution}},cl=class extends tx{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e);const i=t.renderMode||"hybrid";Vt(i=="hybrid"||i=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError===void 0||t.useInterimTilesOnError)}createRenderer(){return new pE(this)}getFeatures(t){return super.getFeatures(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get("preload")}getUseInterimTilesOnError(){return this.get("useInterimTilesOnError")}setPreload(t){this.set("preload",t)}setUseInterimTilesOnError(t){this.set("useInterimTilesOnError",t)}};function gx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mx,yx={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tu(n){return(n=Math.round(n))<0?0:n>255?255:n}function Rf(n){return Tu(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function Iu(n){return function(e){return e<0?0:e>1?1:e}(n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))}function Ff(n,t,e){return e<0?e+=1:e>1&&(e-=1),6*e<1?n+(t-n)*e*6:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n}try{mx={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in yx)return yx[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=i.indexOf("("),r=i.indexOf(")");if(s!==-1&&r+1===i.length){var o=i.substr(0,s),a=i.substr(s+1,r-(s+1)).split(","),l=1;switch(o){case"rgba":if(a.length!==4)return null;l=Iu(a.pop());case"rgb":return a.length!==3?null:[Rf(a[0]),Rf(a[1]),Rf(a[2]),l];case"hsla":if(a.length!==4)return null;l=Iu(a.pop());case"hsl":if(a.length!==3)return null;var h=(parseFloat(a[0])%360+360)%360/360,u=Iu(a[1]),c=Iu(a[2]),d=c<=.5?c*(u+1):c+u-c*u,p=2*c-d;return[Tu(255*Ff(p,d,h+1/3)),Tu(255*Ff(p,d,h)),Tu(255*Ff(p,d,h-1/3)),l];default:return null}}return null}}catch{}class bi{constructor(t,e,i,s=1){this.r=t,this.g=e,this.b=i,this.a=s}static parse(t){if(!t)return;if(t instanceof bi)return t;if(typeof t!="string")return;const e=mx(t);return e?new bi(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,i,s]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(i)},${s})`}toArray(){const{r:t,g:e,b:i,a:s}=this;return s===0?[0,0,0,0]:[255*t/s,255*e/s,255*i/s,s]}toArray01(){const{r:t,g:e,b:i,a:s}=this;return s===0?[0,0,0,0]:[t/s,e/s,i/s,s]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:i,a:s}=this;return[t,e,i,s]}}bi.black=new bi(0,0,0,1),bi.white=new bi(1,1,1,1),bi.transparent=new bi(0,0,0,0),bi.red=new bi(1,0,0,1),bi.blue=new bi(0,0,1,1);var Oi=bi;function dl(n){return typeof n=="object"?["literal",n]:n}function Of(n){switch(n.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function _x(n,t){const e=dl(function(s,r){return s!==void 0?s:r!==void 0?r:void 0}(n.default,t.default));return e===void 0&&t.type==="resolvedImage"?"":e}function Af(n,t,e){const i=Df(n,t),s=["get",n.property];if(i==="categorical"&&typeof e[0][0]=="boolean"){const r=["case"];for(const o of e)r.push(["==",s,o[0]],o[1]);return r.push(_x(n,t)),r}if(i==="categorical"){const r=["match",s];for(const o of e)Eo(r,o[0],o[1],!1);return r.push(_x(n,t)),r}if(i==="interval"){const r=["step",["number",s]];for(const o of e)Eo(r,o[0],o[1],!0);return Lf(r),n.default===void 0?r:["case",["==",["typeof",s],"number"],r,dl(n.default)]}if(i==="exponential"){const r=n.base!==void 0?n.base:1,o=[Of(n),r===1?["linear"]:["exponential",r],["number",s]];for(const a of e)Eo(o,a[0],a[1],!1);return n.default===void 0?o:["case",["==",["typeof",s],"number"],o,dl(n.default)]}throw new Error(`Unknown property function type ${i}`)}function Lf(n){n[0]==="step"&&n.length===3&&(n.push(0),n.push(n[3]))}function Eo(n,t,e,i){n.length>3&&t===n[n.length-2]||(i&&n.length===2||n.push(t),n.push(e))}function Df(n,t){return n.type?n.type:t.expression.interpolated?"exponential":"interval"}function fE(n){const t=["concat"],e=/{([^{}]+)}/g;let i=0;for(let s=e.exec(n);s!==null;s=e.exec(n)){const r=n.slice(i,e.lastIndex-s[0].length);i=e.lastIndex,r.length>0&&t.push(r),t.push(["get",s[1]])}if(t.length===1)return n;if(i<n.length)t.push(n.slice(i));else if(t.length===2)return["to-string",t[1]];return t}class gE extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var kn=gE;class Nf{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[i,s]of e)this.bindings[i]=s}concat(t){return new Nf(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var mE=Nf;const ku={kind:"null"},H={kind:"number"},kt={kind:"string"},Mt={kind:"boolean"},ts={kind:"color"},To={kind:"object"},St={kind:"value"},Pu={kind:"collator"},Ru={kind:"formatted"},pl={kind:"resolvedImage"};function Zi(n,t){return{kind:"array",itemType:n,N:t}}function Se(n){if(n.kind==="array"){const t=Se(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const yE=[ku,H,kt,Mt,ts,Ru,To,Zi(St),pl];function fl(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!fl(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const e of yE)if(!fl(e,t))return null}}return`Expected ${Se(n)} but found ${Se(t)} instead.`}function zf(n,t){return t.some(e=>e.kind===n.kind)}function gl(n,t){return t.some(e=>e==="null"?n===null:e==="array"?Array.isArray(n):e==="object"?n&&!Array.isArray(n)&&typeof n=="object":e===typeof n)}class jf{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gf{constructor(t,e,i,s,r){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=i,this.fontStack=s,this.textColor=r}}class Pn{constructor(t){this.sections=t}static fromString(t){return new Pn([new Gf(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Pn?t:Pn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const i={};e.fontStack&&(i["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(i["font-scale"]=e.scale),e.textColor&&(i["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(i)}return t}}class qs{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new qs({name:t,available:!1}):null}serialize(){return["image",this.name]}}function vx(n,t,e,i){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255?typeof i>"u"||typeof i=="number"&&i>=0&&i<=1?null:`Invalid rgba value [${[n,t,e,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof i=="number"?[n,t,e,i]:[n,t,e]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fu(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Oi||n instanceof jf||n instanceof Pn||n instanceof qs)return!0;if(Array.isArray(n)){for(const t of n)if(!Fu(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Fu(n[t]))return!1;return!0}return!1}function He(n){if(n===null)return ku;if(typeof n=="string")return kt;if(typeof n=="boolean")return Mt;if(typeof n=="number")return H;if(n instanceof Oi)return ts;if(n instanceof jf)return Pu;if(n instanceof Pn)return Ru;if(n instanceof qs)return pl;if(Array.isArray(n)){const t=n.length;let e;for(const i of n){const s=He(i);if(e){if(e===s)continue;e=St;break}e=s}return Zi(e||St,t)}return To}function ml(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Oi||n instanceof Pn||n instanceof qs?n.toString():JSON.stringify(n)}class qf{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(t.length!==2)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Fu(t[1]))return e.error("invalid value");const i=t[1];let s=He(i);const r=e.expectedType;return s.kind==="array"&&s.N===0&&r&&r.kind==="array"&&(typeof r.N!="number"||r.N===0)&&(s=r),new qf(s,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Oi?["rgba"].concat(this.value.toArray()):this.value instanceof Pn?this.value.serialize():this.value}}var Ou=qf,Qe=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Vf={string:kt,number:H,boolean:Mt,object:To};class Bf{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,s=1;const r=t[0];if(r==="array"){let a,l;if(t.length>2){const h=t[1];if(typeof h!="string"||!(h in Vf)||h==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=Vf[h],s++}else a=St;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);l=t[2],s++}i=Zi(a,l)}else i=Vf[r];const o=[];for(;s<t.length;s++){const a=e.parse(t[s],s,St);if(!a)return null;o.push(a)}return new Bf(i,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!fl(this.type,He(i)))return i;if(e===this.args.length-1)throw new Qe(`Expected value to be of type ${Se(this.type)}, but found ${Se(He(i))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if(t.kind==="array"){const i=t.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){e.push(i.kind);const s=t.N;(typeof s=="number"||this.args.length>1)&&e.push(s)}}return e.concat(this.args.map(i=>i.serialize()))}}var es=Bf;class Au{constructor(t){this.type=Ru,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&typeof i=="object")return e.error("First argument must be an image or text section.");const s=[];let r=!1;for(let o=1;o<=t.length-1;++o){const a=t[o];if(r&&typeof a=="object"&&!Array.isArray(a)){r=!1;let l=null;if(a["font-scale"]&&(l=e.parse(a["font-scale"],1,H),!l))return null;let h=null;if(a["text-font"]&&(h=e.parse(a["text-font"],1,Zi(kt)),!h))return null;let u=null;if(a["text-color"]&&(u=e.parse(a["text-color"],1,ts),!u))return null;const c=s[s.length-1];c.scale=l,c.font=h,c.textColor=u}else{const l=e.parse(t[o],1,St);if(!l)return null;const h=l.type.kind;if(h!=="string"&&h!=="value"&&h!=="null"&&h!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,s.push({content:l,scale:null,font:null,textColor:null})}}return new Au(s)}evaluate(t){return new Pn(this.sections.map(e=>{const i=e.content.evaluate(t);return He(i)===pl?new Gf("",i,null,null,null):new Gf(ml(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const i={};e.scale&&(i["font-scale"]=e.scale.serialize()),e.font&&(i["text-font"]=e.font.serialize()),e.textColor&&(i["text-color"]=e.textColor.serialize()),t.push(i)}return t}}class Lu{constructor(t){this.type=pl,this.input=t}static parse(t,e){if(t.length!==2)return e.error("Expected two arguments.");const i=e.parse(t[1],1,kt);return i?new Lu(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=qs.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _E={"to-boolean":Mt,"to-color":ts,"to-number":H,"to-string":kt};class Wf{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if((i==="to-boolean"||i==="to-string")&&t.length!==2)return e.error("Expected one argument.");const s=_E[i],r=[];for(let o=1;o<t.length;o++){const a=e.parse(t[o],o,St);if(!a)return null;r.push(a)}return new Wf(s,r)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let e,i;for(const s of this.args){if(e=s.evaluate(t),i=null,e instanceof Oi)return e;if(typeof e=="string"){const r=t.parseColor(e);if(r)return r}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:vx(e[0],e[1],e[2],e[3]),!i))return new Oi(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Qe(i||`Could not parse color from value '${typeof e=="string"?e:String(JSON.stringify(e))}'`)}if(this.type.kind==="number"){let e=null;for(const i of this.args){if(e=i.evaluate(t),e===null)return 0;const s=Number(e);if(!isNaN(s))return s}throw new Qe(`Could not convert ${JSON.stringify(e)} to number.`)}return this.type.kind==="formatted"?Pn.fromString(ml(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?qs.fromString(ml(this.args[0].evaluate(t))):ml(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Au([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Lu(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(e=>{t.push(e.serialize())}),t}}var Io=Wf;const vE=["Unknown","Point","LineString","Polygon"];var xx=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?vE[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-t[0])+this.featureDistanceData.bearing[1]*(s*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Oi.parse(t)),e}};class ko{constructor(t,e,i,s){this.name=t,this.type=e,this._evaluate=i,this.args=s}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const i=t[0],s=ko.definitions[i];if(!s)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(s)?s[0]:s.type,o=Array.isArray(s)?[[s[1],s[2]]]:s.overloads,a=o.filter(([h])=>!Array.isArray(h)||h.length===t.length-1);let l=null;for(const[h,u]of a){l=new Ix(e.registry,e.path,null,e.scope);const c=[];let d=!1;for(let p=1;p<t.length;p++){const f=t[p],g=Array.isArray(h)?h[p-1]:h.type,m=l.parse(f,1+c.length,g);if(!m){d=!0;break}c.push(m)}if(!d){if(Array.isArray(h)&&h.length!==c.length){l.error(`Expected ${h.length} arguments, but found ${c.length} instead.`);continue}for(let p=0;p<c.length;p++){const f=Array.isArray(h)?h[p]:h.type,g=c[p];l.concat(p+1).checkSubtype(f,g.type)}if(l.errors.length===0)return new ko(i,r,u,c)}}if(a.length===1)e.errors.push(...l.errors);else{const h=(a.length?a:o).map(([c])=>function(p){return Array.isArray(p)?`(${p.map(Se).join(", ")})`:`(${Se(p.type)}...)`}(c)).join(" | "),u=[];for(let c=1;c<t.length;c++){const d=e.parse(t[c],1+u.length);if(!d)return null;u.push(Se(d.type))}e.error(`Expected arguments of type ${h}, but found (${u.join(", ")}) instead.`)}return null}static register(t,e){ko.definitions=e;for(const i in e)t[i]=ko}}var Po=ko;class Du{constructor(t,e,i){this.type=Pu,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(t.length!==2)return e.error("Expected one argument.");const i=t[1];if(typeof i!="object"||Array.isArray(i))return e.error("Collator options argument must be an object.");const s=e.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Mt);if(!s)return null;const r=e.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Mt);if(!r)return null;let o=null;return i.locale&&(o=e.parse(i.locale,1,kt),!o)?null:new Du(s,r,o)}evaluate(t){return new jf(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Vs=8192;function Uf(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Nu(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function xE(n,t){const e=function(o){return(180+o)/360}(n[0]),i=function(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}(n[1]),s=Math.pow(2,t.z);return[Math.round(e*s*Vs),Math.round(i*s*Vs)]}function bE(n,t,e){const i=n[0]-t[0],s=n[1]-t[1],r=n[0]-e[0],o=n[1]-e[1];return i*o-r*s==0&&i*r<=0&&s*o<=0}function wE(n,t,e){return t[1]>n[1]!=e[1]>n[1]&&n[0]<(e[0]-t[0])*(n[1]-t[1])/(e[1]-t[1])+t[0]}function Hf(n,t){let e=!1;for(let i=0,s=t.length;i<s;i++){const r=t[i];for(let o=0,a=r.length;o<a-1;o++){if(bE(n,r[o],r[o+1]))return!1;wE(n,r[o],r[o+1])&&(e=!e)}}return e}function CE(n,t){for(let e=0;e<t.length;e++)if(Hf(n,t[e]))return!0;return!1}function bx(n,t,e,i){const s=i[0]-e[0],r=i[1]-e[1],o=(n[0]-e[0])*r-s*(n[1]-e[1]),a=(t[0]-e[0])*r-s*(t[1]-e[1]);return o>0&&a<0||o<0&&a>0}function ME(n,t,e,i){return function(r,o){return r[0]*o[1]-r[1]*o[0]}([i[0]-e[0],i[1]-e[1]],[t[0]-n[0],t[1]-n[1]])!==0&&!(!bx(n,t,e,i)||!bx(e,i,n,t))}function SE(n,t,e){for(const i of e)for(let s=0;s<i.length-1;++s)if(ME(n,t,i[s],i[s+1]))return!0;return!1}function wx(n,t){for(let e=0;e<n.length;++e)if(!Hf(n[e],t))return!1;for(let e=0;e<n.length-1;++e)if(SE(n[e],n[e+1],t))return!1;return!0}function EE(n,t){for(let e=0;e<t.length;e++)if(wx(n,t[e]))return!0;return!1}function Xf(n,t,e){const i=[];for(let s=0;s<n.length;s++){const r=[];for(let o=0;o<n[s].length;o++){const a=xE(n[s][o],e);Uf(t,a),r.push(a)}i.push(r)}return i}function Cx(n,t,e){const i=[];for(let s=0;s<n.length;s++){const r=Xf(n[s],t,e);i.push(r)}return i}function Mx(n,t,e,i){if(n[0]<e[0]||n[0]>e[2]){const s=.5*i;let r=n[0]-e[0]>s?-i:e[0]-n[0]>s?i:0;r===0&&(r=n[0]-e[2]>s?-i:e[2]-n[0]>s?i:0),n[0]+=r}Uf(t,n)}function Sx(n,t,e,i){const s=Math.pow(2,i.z)*Vs,r=[i.x*Vs,i.y*Vs],o=[];if(!n)return o;for(const a of n)for(const l of a){const h=[l.x+r[0],l.y+r[1]];Mx(h,t,e,s),o.push(h)}return o}function Ex(n,t,e,i){const s=Math.pow(2,i.z)*Vs,r=[i.x*Vs,i.y*Vs],o=[];if(!n)return o;for(const a of n){const l=[];for(const h of a){const u=[h.x+r[0],h.y+r[1]];Uf(t,u),l.push(u)}o.push(l)}if(t[2]-t[0]<=s/2){(function(l){l[0]=l[1]=1/0,l[2]=l[3]=-1/0})(t);for(const a of o)for(const l of a)Mx(l,t,e,s)}return o}class yl{constructor(t,e){this.type=Mt,this.geojson=t,this.geometries=e}static parse(t,e){if(t.length!==2)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Fu(t[1])){const i=t[1];if(i.type==="FeatureCollection")for(let s=0;s<i.features.length;++s){const r=i.features[s].geometry.type;if(r==="Polygon"||r==="MultiPolygon")return new yl(i,i.features[s].geometry)}else if(i.type==="Feature"){const s=i.geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new yl(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new yl(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,s){const r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if(!a)return!1;if(s.type==="Polygon"){const l=Xf(s.coordinates,o,a),h=Sx(i.geometry(),r,o,a);if(!Nu(r,o))return!1;for(const u of h)if(!Hf(u,l))return!1}if(s.type==="MultiPolygon"){const l=Cx(s.coordinates,o,a),h=Sx(i.geometry(),r,o,a);if(!Nu(r,o))return!1;for(const u of h)if(!CE(u,l))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,s){const r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if(!a)return!1;if(s.type==="Polygon"){const l=Xf(s.coordinates,o,a),h=Ex(i.geometry(),r,o,a);if(!Nu(r,o))return!1;for(const u of h)if(!wx(u,l))return!1}if(s.type==="MultiPolygon"){const l=Cx(s.coordinates,o,a),h=Ex(i.geometry(),r,o,a);if(!Nu(r,o))return!1;for(const u of h)if(!EE(u,l))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Zf=yl;function zu(n){if(n instanceof Po&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Zf)return!1;let t=!0;return n.eachChild(e=>{t&&!zu(e)&&(t=!1)}),t}function Yf(n){if(n instanceof Po&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(e=>{t&&!Yf(e)&&(t=!1)}),t}function $f(n,t){if(n instanceof Po&&t.indexOf(n.name)>=0)return!1;let e=!0;return n.eachChild(i=>{e&&!$f(i,t)&&(e=!1)}),e}class Kf{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new Kf(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Tx=Kf;class Jf{constructor(t,e=[],i,s=new mE,r=[]){this.registry=t,this.path=e,this.key=e.map(o=>`[${o}]`).join(""),this.scope=s,this.errors=r,this.expectedType=i}parse(t,e,i,s,r={}){return e?this.concat(e,i,s)._parse(t,r):this._parse(t,r)}_parse(t,e){function i(s,r,o){return o==="assert"?new es(r,[s]):o==="coerce"?new Io(r,[s]):s}if((t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number")&&(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const s=t[0];if(typeof s!="string")return this.error(`Expression name must be a string, but found ${typeof s} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[s];if(r){let o=r.parse(t,this);if(!o)return null;if(this.expectedType){const a=this.expectedType,l=o.type;if(a.kind!=="string"&&a.kind!=="number"&&a.kind!=="boolean"&&a.kind!=="object"&&a.kind!=="array"||l.kind!=="value")if(a.kind!=="color"&&a.kind!=="formatted"&&a.kind!=="resolvedImage"||l.kind!=="value"&&l.kind!=="string"){if(this.checkSubtype(a,l))return null}else o=i(o,a,e.typeAnnotation||"coerce");else o=i(o,a,e.typeAnnotation||"assert")}if(!(o instanceof Ou)&&o.type.kind!=="resolvedImage"&&Qf(o)){const a=new xx;try{o=new Ou(o.type,o.evaluate(a))}catch(l){return this.error(l.message),null}}return o}return this.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(typeof t>"u"?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const s=typeof t=="number"?this.path.concat(t):this.path,r=i?this.scope.concat(i):this.scope;return new Jf(this.registry,s,e||null,r,this.errors)}error(t,...e){const i=`${this.key}${e.map(s=>`[${s}]`).join("")}`;this.errors.push(new kn(i,t))}checkSubtype(t,e){const i=fl(t,e);return i&&this.error(i),i}}var Ix=Jf;function Qf(n){if(n instanceof Tx)return Qf(n.boundExpression);if(n instanceof Po&&n.name==="error"||n instanceof Du||n instanceof Zf)return!1;const t=n instanceof Io||n instanceof es;let e=!0;return n.eachChild(i=>{e=t?e&&Qf(i):e&&i instanceof Ou}),!!e&&zu(n)&&$f(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function kx(n,t){const e=n.length-1;let i,s,r=0,o=e,a=0;for(;r<=o;)if(a=Math.floor((r+o)/2),i=n[a],s=n[a+1],i<=t){if(a===e||t<s)return a;r=a+1}else{if(!(i>t))throw new Qe("Input is not a number.");o=a-1}return 0}class tg{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[s,r]of i)this.labels.push(s),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,H);if(!i)return null;const s=[];let r=null;e.expectedType&&e.expectedType.kind!=="value"&&(r=e.expectedType);for(let o=1;o<t.length;o+=2){const a=o===1?-1/0:t[o],l=t[o+1],h=o,u=o+1;if(typeof a!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(s.length&&s[s.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',h);const c=e.parse(l,u,r);if(!c)return null;r=r||c.type,s.push([a,c])}return new tg(r,i,s)}evaluate(t){const e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);const s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);const r=e.length;return s>=e[r-1]?i[r-1].evaluate(t):i[kx(e,s)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var Px=tg,TE=Ro;function Ro(n,t,e,i){this.cx=3*n,this.bx=3*(e-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=i,this.p2x=e,this.p2y=i}Ro.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n},Ro.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n},Ro.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},Ro.prototype.solveCurveX=function(n,t){var e,i,s,r,o;for(typeof t>"u"&&(t=1e-6),s=n,o=0;o<8;o++){if(r=this.sampleCurveX(s)-n,Math.abs(r)<t)return s;var a=this.sampleCurveDerivativeX(s);if(Math.abs(a)<1e-6)break;s-=r/a}if((s=n)<(e=0))return e;if(s>(i=1))return i;for(;e<i;){if(r=this.sampleCurveX(s),Math.abs(r-n)<t)return s;n>r?e=s:i=s,s=.5*(i-e)+e}return s},Ro.prototype.solve=function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))};var IE=gx(TE);function Ai(n,t,e){return n*(1-e)+t*e}var kE=Object.freeze({__proto__:null,number:Ai,color:function(t,e,i){return new Oi(Ai(t.r,e.r,i),Ai(t.g,e.g,i),Ai(t.b,e.b,i),Ai(t.a,e.a,i))},array:function(t,e,i){return t.map((s,r)=>Ai(s,e[r],i))}});const Rx=4/29,Fo=6/29,Fx=3*Fo*Fo,PE=Fo*Fo*Fo,RE=Math.PI/180,FE=180/Math.PI;function eg(n){return n>PE?Math.pow(n,1/3):n/Fx+Rx}function ig(n){return n>Fo?n*n*n:Fx*(n-Rx)}function ng(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function sg(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Ox(n){const t=sg(n.r),e=sg(n.g),i=sg(n.b),s=eg((.4124564*t+.3575761*e+.1804375*i)/.95047),r=eg((.2126729*t+.7151522*e+.072175*i)/1);return{l:116*r-16,a:500*(s-r),b:200*(r-eg((.0193339*t+.119192*e+.9503041*i)/1.08883)),alpha:n.a}}function Ax(n){let t=(n.l+16)/116,e=isNaN(n.a)?t:t+n.a/500,i=isNaN(n.b)?t:t-n.b/200;return t=1*ig(t),e=.95047*ig(e),i=1.08883*ig(i),new Oi(ng(3.2404542*e-1.5371385*t-.4985314*i),ng(-.969266*e+1.8760108*t+.041556*i),ng(.0556434*e-.2040259*t+1.0572252*i),n.alpha)}function OE(n,t,e){const i=t-n;return n+e*(i>180||i<-180?i-360*Math.round(i/360):i)}const ju={forward:Ox,reverse:Ax,interpolate:function(t,e,i){return{l:Ai(t.l,e.l,i),a:Ai(t.a,e.a,i),b:Ai(t.b,e.b,i),alpha:Ai(t.alpha,e.alpha,i)}}},Lx=function(t){const{l:e,a:i,b:s}=Ox(t),r=Math.atan2(s,i)*FE;return{h:r<0?r+360:r,c:Math.sqrt(i*i+s*s),l:e,alpha:t.a}},AE=function(t){const e=t.h*RE,i=t.c;return Ax({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},LE=function(t,e,i){return{h:OE(t.h,e.h,i),c:Ai(t.c,e.c,i),l:Ai(t.l,e.l,i),alpha:Ai(t.alpha,e.alpha,i)}};class Gu{constructor(t,e,i,s,r){this.type=t,this.operator=e,this.interpolation=i,this.input=s,this.labels=[],this.outputs=[];for(const[o,a]of r)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(t,e,i,s){let r=0;if(t.name==="exponential")r=rg(e,t.base,i,s);else if(t.name==="linear")r=rg(e,1,i,s);else if(t.name==="cubic-bezier"){const o=t.controlPoints;r=new IE(o[0],o[1],o[2],o[3]).solve(rg(e,1,i,s))}return r}static parse(t,e){let[i,s,r,...o]=t;if(!Array.isArray(s)||s.length===0)return e.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){const h=s[1];if(typeof h!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:h}}else{if(s[0]!=="cubic-bezier")return e.error(`Unknown interpolation type ${String(s[0])}`,1,0);{const h=s.slice(1);if(h.length!==4||h.some(u=>typeof u!="number"||u<0||u>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:h}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,H),!r)return null;const a=[];let l=null;i==="interpolate-hcl"||i==="interpolate-lab"?l=ts:e.expectedType&&e.expectedType.kind!=="value"&&(l=e.expectedType);for(let h=0;h<o.length;h+=2){const u=o[h],c=o[h+1],d=h+3,p=h+4;if(typeof u!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(a.length&&a[a.length-1][0]>=u)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);const f=e.parse(c,p,l);if(!f)return null;l=l||f.type,a.push([u,f])}return l.kind==="number"||l.kind==="color"||l.kind==="array"&&l.itemType.kind==="number"&&typeof l.N=="number"?new Gu(l,i,s,r,a):e.error(`Type ${Se(l)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);const s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);const r=e.length;if(s>=e[r-1])return i[r-1].evaluate(t);const o=kx(e,s),a=Gu.interpolationFactor(this.interpolation,s,e[o],e[o+1]),l=i[o].evaluate(t),h=i[o+1].evaluate(t);return this.operator==="interpolate"?kE[this.type.kind.toLowerCase()](l,h,a):this.operator==="interpolate-hcl"?AE(LE(Lx(l),Lx(h),a)):ju.reverse(ju.interpolate(ju.forward(l),ju.forward(h),a))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e}}function rg(n,t,e,i){const s=i-e,r=n-e;return s===0?0:t===1?r/s:(Math.pow(t,r)-1)/(Math.pow(t,s)-1)}var pr=Gu;class qu{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const s=e.expectedType;s&&s.kind!=="value"&&(i=s);const r=[];for(const o of t.slice(1)){const a=e.parse(o,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!a)return null;i=i||a.type,r.push(a)}return s&&r.some(o=>fl(s,o.type))?new qu(St,r):new qu(i,r)}evaluate(t){let e,i=null,s=0;for(const r of this.args){if(s++,i=r.evaluate(t),i&&i instanceof qs&&!i.available&&(e||(e=i),i=null,s===this.args.length))return e;if(i!==null)break}return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var Dx=qu;class og{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let r=1;r<t.length-1;r+=2){const o=t[r];if(typeof o!="string")return e.error(`Expected string, but found ${typeof o} instead.`,r);if(/[^a-zA-Z0-9_]/.test(o))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=e.parse(t[r+1],r+1);if(!a)return null;i.push([o,a])}const s=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return s?new og(i,s):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,i]of this.bindings)t.push(e,i.serialize());return t.push(this.result.serialize()),t}}var Nx=og;class ag{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(t.length!==3)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,H),s=e.parse(t[2],2,Zi(e.expectedType||St));return i&&s?new ag(s.type.itemType,i,s):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Qe(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new Qe(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new Qe(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var DE=ag;class lg{constructor(t,e){this.type=Mt,this.needle=t,this.haystack=e}static parse(t,e){if(t.length!==3)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,St),s=e.parse(t[2],2,St);return i&&s?zf(i.type,[Mt,kt,H,ku,St])?new lg(i,s):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Se(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(i==null)return!1;if(!gl(e,["boolean","string","number","null"]))throw new Qe(`Expected first argument to be of type boolean, string, number or null, but found ${Se(He(e))} instead.`);if(!gl(i,["string","array"]))throw new Qe(`Expected second argument to be of type array or string, but found ${Se(He(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var NE=lg;class Vu{constructor(t,e,i){this.type=H,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,St),s=e.parse(t[2],2,St);if(!i||!s)return null;if(!zf(i.type,[Mt,kt,H,ku,St]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Se(i.type)} instead`);if(t.length===4){const r=e.parse(t[3],3,H);return r?new Vu(i,s,r):null}return new Vu(i,s)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!gl(e,["boolean","string","number","null"]))throw new Qe(`Expected first argument to be of type boolean, string, number or null, but found ${Se(He(e))} instead.`);if(!gl(i,["string","array"]))throw new Qe(`Expected second argument to be of type array or string, but found ${Se(He(i))} instead.`);if(this.fromIndex){const s=this.fromIndex.evaluate(t);return i.indexOf(e,s)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var zE=Vu;class hg{constructor(t,e,i,s,r,o){this.inputType=t,this.type=e,this.input=i,this.cases=s,this.outputs=r,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,s;e.expectedType&&e.expectedType.kind!=="value"&&(s=e.expectedType);const r={},o=[];for(let h=2;h<t.length-1;h+=2){let u=t[h];const c=t[h+1];Array.isArray(u)||(u=[u]);const d=e.concat(h);if(u.length===0)return d.error("Expected at least one branch label.");for(const f of u){if(typeof f!="number"&&typeof f!="string")return d.error("Branch labels must be numbers or strings.");if(typeof f=="number"&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return d.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof f=="number"&&Math.floor(f)!==f)return d.error("Numeric branch labels must be integer values.");if(i){if(d.checkSubtype(i,He(f)))return null}else i=He(f);if(typeof r[String(f)]<"u")return d.error("Branch labels must be unique.");r[String(f)]=o.length}const p=e.parse(c,h,s);if(!p)return null;s=s||p.type,o.push(p)}const a=e.parse(t[1],1,St);if(!a)return null;const l=e.parse(t[t.length-1],t.length-1,s);return!l||a.type.kind!=="value"&&e.concat(1).checkSubtype(i,a.type)?null:new hg(i,s,a,r,o,l)}evaluate(t){const e=this.input.evaluate(t);return(He(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),i=[],s={};for(const o of e){const a=s[this.cases[o]];a===void 0?(s[this.cases[o]]=i.length,i.push([this.cases[o],[o]])):i[a][1].push(o)}const r=o=>this.inputType.kind==="number"?Number(o):o;for(const[o,a]of i)t.push(a.length===1?r(a[0]):a.map(r)),t.push(this.outputs[o].serialize());return t.push(this.otherwise.serialize()),t}}var jE=hg;class ug{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&e.expectedType.kind!=="value"&&(i=e.expectedType);const s=[];for(let o=1;o<t.length-1;o+=2){const a=e.parse(t[o],o,Mt);if(!a)return null;const l=e.parse(t[o+1],o+1,i);if(!l)return null;s.push([a,l]),i=i||l.type}const r=e.parse(t[t.length-1],t.length-1,i);return r?new ug(i,s,r):null}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var GE=ug;class Bu{constructor(t,e,i,s){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=s}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,St),s=e.parse(t[2],2,H);if(!i||!s)return null;if(!zf(i.type,[Zi(St),kt,St]))return e.error(`Expected first argument to be of type array or string, but found ${Se(i.type)} instead`);if(t.length===4){const r=e.parse(t[3],3,H);return r?new Bu(i.type,i,s,r):null}return new Bu(i.type,i,s)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!gl(e,["string","array"]))throw new Qe(`Expected first argument to be of type array or string, but found ${Se(He(e))} instead.`);if(this.endIndex){const s=this.endIndex.evaluate(t);return e.slice(i,s)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var qE=Bu;function zx(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function jx(n,t,e,i){return i.compare(t,e)===0}function Oo(n,t,e){const i=n!=="=="&&n!=="!=";return class l2{constructor(r,o,a){this.type=Mt,this.lhs=r,this.rhs=o,this.collator=a,this.hasUntypedArgument=r.type.kind==="value"||o.type.kind==="value"}static parse(r,o){if(r.length!==3&&r.length!==4)return o.error("Expected two or three arguments.");const a=r[0];let l=o.parse(r[1],1,St);if(!l)return null;if(!zx(a,l.type))return o.concat(1).error(`"${a}" comparisons are not supported for type '${Se(l.type)}'.`);let h=o.parse(r[2],2,St);if(!h)return null;if(!zx(a,h.type))return o.concat(2).error(`"${a}" comparisons are not supported for type '${Se(h.type)}'.`);if(l.type.kind!==h.type.kind&&l.type.kind!=="value"&&h.type.kind!=="value")return o.error(`Cannot compare types '${Se(l.type)}' and '${Se(h.type)}'.`);i&&(l.type.kind==="value"&&h.type.kind!=="value"?l=new es(h.type,[l]):l.type.kind!=="value"&&h.type.kind==="value"&&(h=new es(l.type,[h])));let u=null;if(r.length===4){if(l.type.kind!=="string"&&h.type.kind!=="string"&&l.type.kind!=="value"&&h.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(u=o.parse(r[3],3,Pu),!u)return null}return new l2(l,h,u)}evaluate(r){const o=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const l=He(o),h=He(a);if(l.kind!==h.kind||l.kind!=="string"&&l.kind!=="number")throw new Qe(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${l.kind}, ${h.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const l=He(o),h=He(a);if(l.kind!=="string"||h.kind!=="string")return t(r,o,a)}return this.collator?e(r,o,a,this.collator.evaluate(r)):t(r,o,a)}eachChild(r){r(this.lhs),r(this.rhs),this.collator&&r(this.collator)}outputDefined(){return!0}serialize(){const r=[n];return this.eachChild(o=>{r.push(o.serialize())}),r}}}const VE=Oo("==",function(t,e,i){return e===i},jx),BE=Oo("!=",function(t,e,i){return e!==i},function(t,e,i,s){return!jx(0,e,i,s)}),WE=Oo("<",function(t,e,i){return e<i},function(t,e,i,s){return s.compare(e,i)<0}),UE=Oo(">",function(t,e,i){return e>i},function(t,e,i,s){return s.compare(e,i)>0}),HE=Oo("<=",function(t,e,i){return e<=i},function(t,e,i,s){return s.compare(e,i)<=0}),XE=Oo(">=",function(t,e,i){return e>=i},function(t,e,i,s){return s.compare(e,i)>=0});class cg{constructor(t,e,i,s,r,o){this.type=kt,this.number=t,this.locale=e,this.currency=i,this.unit=s,this.minFractionDigits=r,this.maxFractionDigits=o}static parse(t,e){if(t.length!==3)return e.error("Expected two arguments.");const i=e.parse(t[1],1,H);if(!i)return null;const s=t[2];if(typeof s!="object"||Array.isArray(s))return e.error("NumberFormat options argument must be an object.");let r=null;if(s.locale&&(r=e.parse(s.locale,1,kt),!r))return null;let o=null;if(s.currency&&(o=e.parse(s.currency,1,kt),!o))return null;let a=null;if(s.unit&&(a=e.parse(s.unit,1,kt),!a))return null;let l=null;if(s["min-fraction-digits"]&&(l=e.parse(s["min-fraction-digits"],1,H),!l))return null;let h=null;return s["max-fraction-digits"]&&(h=e.parse(s["max-fraction-digits"],1,H),!h)?null:new cg(i,r,o,a,l,h)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class dg{constructor(t){this.type=H,this.input=t}static parse(t,e){if(t.length!==2)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?e.error(`Expected argument of type string or array, but found ${Se(i.type)} instead.`):new dg(i):null}evaluate(t){const e=this.input.evaluate(t);if(typeof e=="string"||Array.isArray(e))return e.length;throw new Qe(`Expected value to be of type string or array, but found ${Se(He(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Gx={"==":VE,"!=":BE,">":UE,"<":WE,">=":XE,"<=":HE,array:es,at:DE,boolean:es,case:GE,coalesce:Dx,collator:Du,format:Au,image:Lu,in:NE,"index-of":zE,interpolate:pr,"interpolate-hcl":pr,"interpolate-lab":pr,length:dg,let:Nx,literal:Ou,match:jE,number:es,"number-format":cg,object:es,slice:qE,step:Px,string:es,"to-boolean":Io,"to-color":Io,"to-number":Io,"to-string":Io,var:Tx,within:Zf};function qx(n,[t,e,i,s]){t=t.evaluate(n),e=e.evaluate(n),i=i.evaluate(n);const r=s?s.evaluate(n):1,o=vx(t,e,i,r);if(o)throw new Qe(o);return new Oi(t/255*r,e/255*r,i/255*r,r)}function Vx(n,t){return n in t}function pg(n,t){const e=t[n];return typeof e>"u"?null:e}function fr(n){return{type:n}}Po.register(Gx,{error:[{kind:"error"},[kt],(n,[t])=>{throw new Qe(t.evaluate(n))}],typeof:[kt,[St],(n,[t])=>Se(He(t.evaluate(n)))],"to-rgba":[Zi(H,4),[ts],(n,[t])=>t.evaluate(n).toArray()],rgb:[ts,[H,H,H],qx],rgba:[ts,[H,H,H,H],qx],has:{type:Mt,overloads:[[[kt],(n,[t])=>Vx(t.evaluate(n),n.properties())],[[kt,To],(n,[t,e])=>Vx(t.evaluate(n),e.evaluate(n))]]},get:{type:St,overloads:[[[kt],(n,[t])=>pg(t.evaluate(n),n.properties())],[[kt,To],(n,[t,e])=>pg(t.evaluate(n),e.evaluate(n))]]},"feature-state":[St,[kt],(n,[t])=>pg(t.evaluate(n),n.featureState||{})],properties:[To,[],n=>n.properties()],"geometry-type":[kt,[],n=>n.geometryType()],id:[St,[],n=>n.id()],zoom:[H,[],n=>n.globals.zoom],pitch:[H,[],n=>n.globals.pitch||0],"distance-from-center":[H,[],n=>n.distanceFromCenter()],"heatmap-density":[H,[],n=>n.globals.heatmapDensity||0],"line-progress":[H,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[H,[],n=>n.globals.skyRadialProgress||0],accumulated:[St,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[H,fr(H),(n,t)=>{let e=0;for(const i of t)e+=i.evaluate(n);return e}],"*":[H,fr(H),(n,t)=>{let e=1;for(const i of t)e*=i.evaluate(n);return e}],"-":{type:H,overloads:[[[H,H],(n,[t,e])=>t.evaluate(n)-e.evaluate(n)],[[H],(n,[t])=>-t.evaluate(n)]]},"/":[H,[H,H],(n,[t,e])=>t.evaluate(n)/e.evaluate(n)],"%":[H,[H,H],(n,[t,e])=>t.evaluate(n)%e.evaluate(n)],ln2:[H,[],()=>Math.LN2],pi:[H,[],()=>Math.PI],e:[H,[],()=>Math.E],"^":[H,[H,H],(n,[t,e])=>Math.pow(t.evaluate(n),e.evaluate(n))],sqrt:[H,[H],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[H,[H],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[H,[H],(n,[t])=>Math.log(t.evaluate(n))],log2:[H,[H],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[H,[H],(n,[t])=>Math.sin(t.evaluate(n))],cos:[H,[H],(n,[t])=>Math.cos(t.evaluate(n))],tan:[H,[H],(n,[t])=>Math.tan(t.evaluate(n))],asin:[H,[H],(n,[t])=>Math.asin(t.evaluate(n))],acos:[H,[H],(n,[t])=>Math.acos(t.evaluate(n))],atan:[H,[H],(n,[t])=>Math.atan(t.evaluate(n))],min:[H,fr(H),(n,t)=>Math.min(...t.map(e=>e.evaluate(n)))],max:[H,fr(H),(n,t)=>Math.max(...t.map(e=>e.evaluate(n)))],abs:[H,[H],(n,[t])=>Math.abs(t.evaluate(n))],round:[H,[H],(n,[t])=>{const e=t.evaluate(n);return e<0?-Math.round(-e):Math.round(e)}],floor:[H,[H],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[H,[H],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[Mt,[kt,St],(n,[t,e])=>n.properties()[t.value]===e.value],"filter-id-==":[Mt,[St],(n,[t])=>n.id()===t.value],"filter-type-==":[Mt,[kt],(n,[t])=>n.geometryType()===t.value],"filter-<":[Mt,[kt,St],(n,[t,e])=>{const i=n.properties()[t.value],s=e.value;return typeof i==typeof s&&i<s}],"filter-id-<":[Mt,[St],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e<i}],"filter->":[Mt,[kt,St],(n,[t,e])=>{const i=n.properties()[t.value],s=e.value;return typeof i==typeof s&&i>s}],"filter-id->":[Mt,[St],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e>i}],"filter-<=":[Mt,[kt,St],(n,[t,e])=>{const i=n.properties()[t.value],s=e.value;return typeof i==typeof s&&i<=s}],"filter-id-<=":[Mt,[St],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e<=i}],"filter->=":[Mt,[kt,St],(n,[t,e])=>{const i=n.properties()[t.value],s=e.value;return typeof i==typeof s&&i>=s}],"filter-id->=":[Mt,[St],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e>=i}],"filter-has":[Mt,[St],(n,[t])=>t.value in n.properties()],"filter-has-id":[Mt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Mt,[Zi(kt)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[Mt,[Zi(St)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[Mt,[kt,Zi(St)],(n,[t,e])=>e.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[Mt,[kt,Zi(St)],(n,[t,e])=>function(s,r,o,a){for(;o<=a;){const l=o+a>>1;if(r[l]===s)return!0;r[l]>s?a=l-1:o=l+1}return!1}(n.properties()[t.value],e.value,0,e.value.length-1)],all:{type:Mt,overloads:[[[Mt,Mt],(n,[t,e])=>t.evaluate(n)&&e.evaluate(n)],[fr(Mt),(n,t)=>{for(const e of t)if(!e.evaluate(n))return!1;return!0}]]},any:{type:Mt,overloads:[[[Mt,Mt],(n,[t,e])=>t.evaluate(n)||e.evaluate(n)],[fr(Mt),(n,t)=>{for(const e of t)if(e.evaluate(n))return!0;return!1}]]},"!":[Mt,[Mt],(n,[t])=>!t.evaluate(n)],"is-supported-script":[Mt,[kt],(n,[t])=>{const e=n.globals&&n.globals.isSupportedScript;return!e||e(t.evaluate(n))}],upcase:[kt,[kt],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[kt,[kt],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[kt,fr(St),(n,t)=>t.map(e=>ml(e.evaluate(n))).join("")],"resolved-locale":[kt,[Pu],(n,[t])=>t.evaluate(n).resolvedLocale()]});var Bx=Gx;function fg(n){return{result:"success",value:n}}function Ao(n){return{result:"error",value:n}}function Wx(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}class ZE{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new xx,this._defaultValue=e?function(s){return s.type==="color"&&(Wx(s.default)||Array.isArray(s.default))?new Oi(0,0,0,0):s.type==="color"?Oi.parse(s.default)||null:s.default===void 0?null:s.default}(e):null,this._enumValues=e&&e.type==="enum"?e.values:null}evaluateWithoutErrorHandling(t,e,i,s,r,o,a,l){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=s||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,s,r,o,a,l){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=s||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!=h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new Qe(`Expected value to be one of ${Object.keys(this._enumValues).map(u=>JSON.stringify(u)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function gg(n,t){const e=new Ix(Bx,[],t?function(r){const o={color:ts,string:kt,number:H,enum:kt,boolean:Mt,formatted:Ru,resolvedImage:pl};return r.type==="array"?Zi(o[r.value]||St,r.length):o[r.type]}(t):void 0),i=e.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return i?fg(new ZE(i,t)):Ao(e.errors)}class YE{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!Yf(e.expression)}evaluateWithoutErrorHandling(t,e,i,s,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,r,o)}evaluate(t,e,i,s,r,o){return this._styleExpression.evaluate(t,e,i,s,r,o)}}class $E{constructor(t,e,i,s){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!Yf(e.expression),this.interpolationType=s}evaluateWithoutErrorHandling(t,e,i,s,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,r,o)}evaluate(t,e,i,s,r,o){return this._styleExpression.evaluate(t,e,i,s,r,o)}interpolationFactor(t,e,i){return this.interpolationType?pr.interpolationFactor(this.interpolationType,t,e,i):0}}function KE(n,t){if((n=gg(n,t)).result==="error")return n;const e=n.value.expression,i=zu(e);if(!i&&!function(a){return a["property-type"]==="data-driven"}(t))return Ao([new kn("","data expressions not supported")]);const s=$f(e,["zoom","pitch","distance-from-center"]);if(!s&&!function(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}(t))return Ao([new kn("","zoom expressions not supported")]);const r=Wu(e);return!r&&!s?Ao([new kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]):r instanceof kn?Ao([r]):r instanceof pr&&!function(a){return!!a.expression&&a.expression.interpolated}(t)?Ao([new kn("",'"interpolate" expressions cannot be used with this property')]):fg(r?new $E(i?"camera":"composite",n.value,r.labels,r instanceof pr?r.interpolation:void 0):new YE(i?"constant":"source",n.value))}function Wu(n){let t=null;if(n instanceof Nx)t=Wu(n.result);else if(n instanceof Dx){for(const e of n.args)if(t=Wu(e),t)break}else(n instanceof Px||n instanceof pr)&&n.input instanceof Po&&n.input.name==="zoom"&&(t=n);return t instanceof kn||n.eachChild(e=>{const i=Wu(e);i instanceof kn?t=i:!t&&i?t=new kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new kn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function mg(n){if(Array.isArray(n))return n.map(mg);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const e in n)t[e]=mg(n[e]);return t}return function(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}(n)}var Ux={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["fill-extrusion-edge-radius"]}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function Hx(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!Hx(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function JE(n,t="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Hx(n)||(n=Uu(n));const e=n;let i=!0;try{i=function(u){if(!Lo(u))return u;let c=mg(u);return Zx(c),c=Xx(c),c}(e)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(e,null,2)}
        `)}const s=Ux[`filter_${t}`],r=gg(i,s);let o=null;if(r.result==="error")throw new Error(r.value.map(h=>`${h.key}: ${h.message}`).join(", "));o=(h,u,c)=>r.value.evaluate(h,u,{},c);let a=null,l=null;if(i!==e){const h=gg(e,s);if(h.result==="error")throw new Error(h.value.map(u=>`${u.key}: ${u.message}`).join(", "));a=(u,c,d,p,f)=>h.value.evaluate(u,c,{},d,void 0,void 0,p,f),l=!zu(h.value.expression)}return{filter:o,dynamicFilter:a||void 0,needGeometry:Yx(i),needFeature:!!l}}function Xx(n){if(!Array.isArray(n))return n;const t=function(i){if(QE.has(i[0])){for(let s=1;s<i.length;s++)if(Lo(i[s]))return!0}return i}(n);return t===!0?t:t.map(e=>Xx(e))}function Zx(n){let t=!1;const e=[];if(n[0]==="case"){for(let i=1;i<n.length-1;i+=2)t=t||Lo(n[i]),e.push(n[i+1]);e.push(n[n.length-1])}else if(n[0]==="match"){t=t||Lo(n[1]);for(let i=2;i<n.length-1;i+=2)e.push(n[i+1]);e.push(n[n.length-1])}else if(n[0]==="step"){t=t||Lo(n[1]);for(let i=1;i<n.length-1;i+=2)e.push(n[i+1])}t&&(n.length=0,n.push("any",...e));for(let i=1;i<n.length;i++)Zx(n[i])}function Lo(n){if(!Array.isArray(n))return!1;if(function(e){return e==="pitch"||e==="distance-from-center"}(n[0]))return!0;for(let t=1;t<n.length;t++)if(Lo(n[t]))return!0;return!1}const QE=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function tT(n,t){return n<t?-1:n>t?1:0}function Yx(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let t=1;t<n.length;t++)if(Yx(n[t]))return!0;return!1}function Uu(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?yg(n[1],n[2],"=="):t==="!="?Hu(yg(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?yg(n[1],n[2],t):t==="any"?function(i){return["any"].concat(i.map(Uu))}(n.slice(1)):t==="all"?["all"].concat(n.slice(1).map(Uu)):t==="none"?["all"].concat(n.slice(1).map(Uu).map(Hu)):t==="in"?$x(n[1],n.slice(2)):t==="!in"?Hu($x(n[1],n.slice(2))):t==="has"?Kx(n[1]):t==="!has"?Hu(Kx(n[1])):t!=="within"||n}function yg(n,t,e){switch(n){case"$type":return[`filter-type-${e}`,t];case"$id":return[`filter-id-${e}`,t];default:return[`filter-${e}`,n,t]}}function $x(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",n,["literal",t.sort(tT)]]:["filter-in-small",n,["literal",t]]}}function Kx(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Hu(n){return["!",n]}var eT=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function iT(n,t){const e={};for(const i in n)i!=="ref"&&(e[i]=n[i]);return eT.forEach(i=>{i in t&&(e[i]=t[i])}),e}var Jx={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},Qx=/(italic|oblique)$/i,tb={},_g=gx(function(n,t,e){var i=tb[n];if(!i){Array.isArray(n)||(n=[n]);for(var s,r,o=400,a="normal",l=[],h=0,u=n.length;h<u;++h){var c=n[h].split(" "),d=c[c.length-1].toLowerCase();for(var p in d=="normal"||d=="italic"||d=="oblique"?(a=r?a:d,r=!0,c.pop(),d=c[c.length-1].toLowerCase()):Qx.test(d)&&(d=d.replace(Qx,""),a=r?a:c[c.length-1].replace(d,""),r=!0),Jx){var f=c.length>1?c[c.length-2].toLowerCase():"";if(d==p||d==p.replace("-","")||f+"-"+d==p){o=s?o:Jx[p],c.pop(),f&&p.startsWith(f)&&c.pop();break}}!s&&typeof d=="number"&&(o=d,s=!0);var g=c.join(" ").replace("Klokantech Noto Sans","Noto Sans");g.indexOf(" ")!==-1&&(g='"'+g+'"'),l.push(g)}i=tb[n]=[a,o,l]}return i[0]+" "+i[1]+" "+t+"px"+(e?"/"+e:"")+" "+i[2]});const eb="https://api.mapbox.com";function vg(n){return n.indexOf("mapbox://")!==0?"":n.slice(9)}function ib(n,t){const e=vg(n);if(!e)return decodeURI(new URL(n,location.href).href);if(e.indexOf("styles/")!==0)throw new Error(`unexpected style url: ${n}`);const i=e.slice(7);return`${eb}/styles/v1/${i}?&access_token=${t}`}function Xu(n,t,e,i){const s=new URL(n,i),r=vg(n);return r?r==="mapbox.satellite"?`https://api.mapbox.com/v4/${r}/{z}/{x}/{y}${window.devicePixelRatio>=1.5?"@2x":""}.webp?access_token=${t}`:`https://{a-d}.tiles.mapbox.com/v4/${r}/{z}/{x}/{y}.vector.pbf?access_token=${t}`:(t&&(s.searchParams.has(e)||s.searchParams.set(e,t)),decodeURI(s.href))}const nb={},sb={};let nT=0;function xg(n){return n.id||(n.id=nT++),n.id}function bg(n){return n*Math.PI/180}const Zu=function(){const n=[];for(let t=78271.51696402048;n.length<=24;t/=2)n.push(t);return n}();function rb(n,t){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(n,t);const e=document.createElement("canvas");return e.width=n,e.height=t,e}new Ss({extent:Bt("EPSG:3857").getExtent(),resolutions:Zu});const Do={};function No(n,t,e={},i){if(t in Do)return i&&(i.request=Do[t][0]),Do[t][1];const s=e.transformRequest&&e.transformRequest(t,n)||t,r=mh(()=>s).then(o=>(o instanceof Request||(o=new Request(o)),o.headers.get("Accept")||o.headers.set("Accept","application/json"),i&&(i.request=o),fetch(o).then(function(a){return delete Do[t],a.ok?a.json():Promise.reject(new Error("Error fetching source "+t))}).catch(function(a){return delete Do[t],Promise.reject(new Error("Error fetching source "+t))})));return Do[t]=[s,r],r}const ob={};function ab(n,t,e,i){const s=document.createElement("canvas"),r=[2*e*t.pixelRatio+t.width,2*e*t.pixelRatio+t.height];s.width=r[0],s.height=r[1];const o=s.getContext("2d");o.drawImage(n,t.x,t.y,t.width,t.height,e*t.pixelRatio,e*t.pixelRatio,t.width,t.height);const a=o.getImageData(0,0,r[0],r[1]);o.globalCompositeOperation="destination-over",o.fillStyle=`rgba(${255*i.r},${255*i.g},${255*i.b},${i.a})`;const l=a.data;for(let h=0,u=a.width;h<u;++h)for(let c=0,d=a.height;c<d;++c)l[4*(c*u+h)+3]>0&&o.arc(h,c,e*t.pixelRatio,0,2*Math.PI);return o.fill(),s}function sT(n,t,e){const i=Math.max(0,Math.min(1,(e-n)/(t-n)));return i*i*(3-2*i)}function lb(n,t,e){const i=document.createElement("canvas");i.width=t.width,i.height=t.height;const s=i.getContext("2d");s.drawImage(n,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const r=s.getImageData(0,0,t.width,t.height),o=r.data;for(let a=0,l=r.width;a<l;++a)for(let h=0,u=r.height;h<u;++h){const c=4*(h*l+a),d=.75,p=.1,f=sT(d-p,d+p,o[c+3]/255);f>0?(o[c+0]=Math.round(255*e.r*f),o[c+1]=Math.round(255*e.g*f),o[c+2]=Math.round(255*e.b*f),o[c+3]=Math.round(255*f)):o[c+3]=0}return s.putImageData(r,0,0),i}const rT=Array(256).join("\u200A");function wg(n,t){if(t>=.05){let e="";const i=n.split(`
`),s=rT.slice(0,Math.round(t/.1));for(let r=0,o=i.length;r<o;++r)r>0&&(e+=`
`),e+=i[r].split("").join(s);return e}return n}let Cg;function hb(){return Cg||(Cg=rb(1,1).getContext("2d")),Cg}function gr(n,t){return hb().measureText(n).width+(n.length-1)*t}const ub={};function Mg(n,t,e,i){if(n.indexOf(`
`)!==-1){const o=n.split(`
`),a=[];for(let l=0,h=o.length;l<h;++l)a.push(Mg(o[l],t,e,i));return a.join(`
`)}const s=e+","+t+","+n+","+i;let r=ub[s];if(!r){const o=n.split(" ");if(o.length>1){const a=hb();a.font=t;const l=a.measureText("M").width*e;let h="";const u=[];for(let c=0,d=o.length;c<d;++c){const p=o[c],f=h+(h?" ":"")+p;gr(f,i)<=l?h=f:(h&&u.push(h),h=p)}h&&u.push(h);for(let c=0,d=u.length;c<d&&d>1;++c){const p=u[c];if(gr(p,i)<.35*l){const f=c>0?gr(u[c-1],i):1/0,g=c<d-1?gr(u[c+1],i):1/0;u.splice(c,1),d-=1,f<g?(u[c-1]+=" "+p,c-=1):u[c]=p+" "+u[c]}}for(let c=0,d=u.length-1;c<d;++c){const p=u[c],f=u[c+1];if(gr(p,i)>.7*l&&gr(f,i)<.6*l){const g=p.split(" "),m=g.pop();gr(m,i)<.2*l&&(u[c]=g.join(" "),u[c+1]=m+" "+f),d-=1}}r=u.join(`
`)}else r=n;r=wg(r,i),ub[s]=r}return r}const oT=/font-family: ?([^;]*);/,aT=/("|')/g;let Yu;function lT(n){if(!Yu){Yu={};const t=document.styleSheets;for(let e=0,i=t.length;e<i;++e){const s=t[e];try{const r=s.rules||s.cssRules;if(r)for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.type==5){const h=l.cssText.match(oT);Yu[h[1].replace(aT,"")]=!0}}}catch{}}}return n in Yu}const Sg={};function hT(n,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const e=n.toString();if(e in Sg)return Sg[e];const i=[];for(let s=0,r=n.length;s<r;++s){n[s]=n[s].replace("Arial Unicode MS","Arial");const o=_g(n[s],1);m_(o);const a=o.split(" ");i.push([a.slice(3).join(" ").replace(/"/g,""),a[1],a[0]])}for(let s=0,r=i.length;s<r;++s){const o=i[s],a=o[0];if(!lT(a)&&bn.get(`${o[2]}
${o[1]} 
${a}`)!==100){const l=t.replace("{font-family}",a.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",a.replace(/ /g,"+")).replace("{fontweight}",o[1]).replace("{-fontstyle}",o[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",o[2]);if(!document.querySelector('link[href="'+l+'"]')){const h=document.createElement("link");h.href=l,h.rel="stylesheet",document.head.appendChild(h)}}}return Sg[e]=n,n}const uT={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},cT={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},dT=function(n,t){const e=KE(n,t);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return e.value},Eg={},$u={zoom:0};let Ku,Tg;function ct(n,t,e,i,s,r,o){const a=n.id;r||(r={},console.warn("No functionCache provided to getValue()")),r[a]||(r[a]={});const l=r[a];if(!l[e]){let h=(n[t]||Eg)[e];const u=Ux[`${t}_${n.type}`][e];h===void 0&&(h=u.default);let c=function(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in Bx}(h);if(!c&&Wx(h)&&(h=function(p,f){let g=p.stops;if(!g)return function(x,b){const M=["get",x.property];if(x.default===void 0)return b.type==="string"?["string",M]:M;if(b.type==="enum")return["match",M,Object.keys(b.values),M,x.default];{const w=[b.type==="color"?"to-color":b.type,M,dl(x.default)];return b.type==="array"&&w.splice(1,0,b.value,b.length||null),w}}(p,f);const m=g&&typeof g[0][0]=="object",y=m||p.property!==void 0,_=m||!y;return g=g.map(v=>!y&&f.tokens&&typeof v[1]=="string"?[v[0],fE(v[1])]:[v[0],dl(v[1])]),m?function(x,b,M){const w={},S={},k=[];for(let I=0;I<M.length;I++){const R=M[I],E=R[0].zoom;w[E]===void 0&&(w[E]={zoom:E,type:x.type,property:x.property,default:x.default},S[E]=[],k.push(E)),S[E].push([R[0].value,R[1]])}if(Df({},b)==="exponential"){const I=[Of(x),["linear"],["zoom"]];for(const R of k)Eo(I,R,Af(w[R],b,S[R]),!1);return I}{const I=["step",["zoom"]];for(const R of k)Eo(I,R,Af(w[R],b,S[R]),!0);return Lf(I),I}}(p,f,g):_?function(x,b,M,w=["zoom"]){const S=Df(x,b);let k,I=!1;if(S==="interval")k=["step",w],I=!0;else{if(S!=="exponential")throw new Error(`Unknown zoom function type "${S}"`);{const R=x.base!==void 0?x.base:1;k=[Of(x),R===1?["linear"]:["exponential",R],w]}}for(const R of M)Eo(k,R[0],R[1],I);return Lf(k),k}(p,f,g):Af(p,f,g)}(h,u),c=!0),c){const d=dT(h,u);l[e]=d.evaluate.bind(d)}else u.type=="color"&&(h=Oi.parse(h)),l[e]=function(){return h}}return $u.zoom=i,l[e]($u,s,o)}function cb(n,t,e,i,s){return ct(n,"layout",`${i}-allow-overlap`,t,e,s)?ct(n,"layout",`${i}-ignore-placement`,t,e,s)?"none":"obstacle":"declutter"}function pT(n,t,e,i,s){return s||console.warn("No filterCache provided to evaluateFilter()"),n in s||(s[n]=JE(t).filter),$u.zoom=i,s[n]($u,e)}let fT=!1;function mr(n,t){if(n){if(!fT&&(n.a===0||t===0))return;const e=n.a;return t=t===void 0?1:t,e===0?"transparent":"rgba("+Math.round(255*n.r/e)+","+Math.round(255*n.g/e)+","+Math.round(255*n.b/e)+","+e*t+")"}return n}const gT=/\{[^{}}]*\}/g;function Ig(n,t){return n.replace(gT,function(e){return t[e.slice(1,-1)]||""})}let db=!1;const mT={};function yT(n,t,e,i=Zu,s=void 0,r=void 0,o=void 0,a=void 0){if(typeof t=="string"&&(t=JSON.parse(t)),t.version!=8)throw new Error("glStyle version 8 required.");let l,h,u;if(mT[function(S,k){return xg(S)+"."+wt(k)}(t,n)]=Array.from(arguments),r){if(typeof Image<"u"){const w=new Image;let S;mh(()=>r).then(k=>{k instanceof Request?fetch(k).then(I=>I.blob()).then(I=>{S=URL.createObjectURL(I),w.src=S}).catch(()=>{}):(w.crossOrigin="anonymous",w.src=k,S&&URL.revokeObjectURL(S))}),w.onload=function(){l=w,h=[w.width,w.height],n.changed(),w.onload=null}}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){const w=self;w.postMessage({action:"loadImage",src:r}),w.addEventListener("message",function(S){S.data.action==="imageLoaded"&&S.data.src===r&&(l=S.data.image,h=[l.width,l.height])})}}const c=function(S){S=S.slice();const k=Object.create(null);for(let I=0;I<S.length;I++)k[S[I].id]=S[I];for(let I=0;I<S.length;I++)"ref"in S[I]&&(S[I]=iT(S[I],k[S[I].ref]));return S}(t.layers),d={},p=[],f={},g={},m=function(S){let k=nb[S.id];return k||(k={},nb[xg(S)]=k),k}(t),y=function(S){let k=sb[S.id];return k||(k={},sb[xg(S)]=k),k}(t);let _;for(let w=0,S=c.length;w<S;++w){const k=c[w],I=k.id;if(typeof e=="string"&&k.source==e||Array.isArray(e)&&e.indexOf(I)!==-1){const R=k["source-layer"];if(_){if(k.source!==_)throw new Error(`Layer "${I}" does not use source "${_}`)}else{_=k.source;const q=t.sources[_];if(!q)throw new Error(`Source "${_}" is not defined`);const O=q.type;if(O!=="vector"&&O!=="geojson")throw new Error(`Source "${_}" is not of type "vector" or "geojson", but "${O}"`)}let E=d[R];E||(E=[],d[R]=E),E.push({layer:k,index:w}),p.push(I)}}const v=new Xi,x=new Ui,b=[],M=function(w,S,k){const I=w.getProperties(),R=d[I.layer];if(!R)return;let E=i.indexOf(S);E==-1&&(E=function($,K){let F=0;const N=K.length;for(;F<N;++F)if(K[F]<$&&F+1<N){const at=K[F]/K[F+1];return F+Math.log(K[F]/$)/Math.log(at)}return N-1}(S,i));const q=uT[w.getGeometry().getType()],O={id:w.getId(),properties:I,type:q},P=n.get("mapbox-featurestate")[w.getId()];let L,D=-1;for(let G=0,$=R.length;G<$;++G){const K=R[G],F=K.layer,N=F.id;if(k!==void 0&&k!==N)continue;const at=F.layout||Eg,tt=F.paint||Eg;if(at.visibility==="none"||"minzoom"in F&&E<F.minzoom||"maxzoom"in F&&E>=F.maxzoom)continue;const _t=F.filter;if(!_t||pT(N,_t,O,E,y)){let Pt,Wt,Ht,Qt,ye,W;L=F;const we=K.index;if(q==3&&(F.type=="fill"||F.type=="fill-extrusion"))if(Wt=ct(F,"paint",F.type+"-opacity",E,O,m,P),F.type+"-pattern"in tt){const de=ct(F,"paint",F.type+"-pattern",E,O,m,P);if(de){const le=typeof de=="string"?Ig(de,I):de.toString();if(l&&s&&s[le]){++D,W=b[D],(!W||!W.getFill()||W.getStroke()||W.getText())&&(W=new Ri({fill:new Ui}),b[D]=W),Ht=W.getFill(),W.setZIndex(we);const Xt=le+"."+Wt;let te=g[Xt];if(!te){const Ft=s[le],xt=rb(Ft.width,Ft.height),re=xt.getContext("2d");re.globalAlpha=Wt,re.drawImage(l,Ft.x,Ft.y,Ft.width,Ft.height,0,0,Ft.width,Ft.height),te=re.createPattern(xt,"repeat"),g[Xt]=te}Ht.setColor(te)}}}else Pt=mr(ct(F,"paint",F.type+"-color",E,O,m,P),Wt),F.type+"-outline-color"in tt&&(ye=mr(ct(F,"paint",F.type+"-outline-color",E,O,m,P),Wt)),ye||(ye=Pt),(Pt||ye)&&(++D,W=b[D],(!W||Pt&&!W.getFill()||!Pt&&W.getFill()||ye&&!W.getStroke()||!ye&&W.getStroke()||W.getText())&&(W=new Ri({fill:Pt?new Ui:void 0,stroke:ye?new Xi:void 0}),b[D]=W),Pt&&(Ht=W.getFill(),Ht.setColor(Pt)),ye&&(Qt=W.getStroke(),Qt.setColor(ye),Qt.setWidth(.5)),W.setZIndex(we));if(q!=1&&F.type=="line"){Pt="line-pattern"in tt?void 0:mr(ct(F,"paint","line-color",E,O,m,P),ct(F,"paint","line-opacity",E,O,m,P));const de=ct(F,"paint","line-width",E,O,m,P);Pt&&de>0&&(++D,W=b[D],(!W||!W.getStroke()||W.getFill()||W.getText())&&(W=new Ri({stroke:new Xi}),b[D]=W),Qt=W.getStroke(),Qt.setLineCap(ct(F,"layout","line-cap",E,O,m,P)),Qt.setLineJoin(ct(F,"layout","line-join",E,O,m,P)),Qt.setMiterLimit(ct(F,"layout","line-miter-limit",E,O,m,P)),Qt.setColor(Pt),Qt.setWidth(de),Qt.setLineDash(tt["line-dasharray"]?ct(F,"paint","line-dasharray",E,O,m,P).map(function(le){return le*de}):null),W.setZIndex(we))}let ue,ut,ae,Ut,At,je,Ze,ui,ce,Ie=!1,mt=null,Li=0;if((q==1||q==2)&&"icon-image"in at){const de=ct(F,"layout","icon-image",E,O,m,P);if(de){let le;ue=typeof de=="string"?Ig(de,I):de.toString();const Xt=a?a(n,ue):void 0;if(l&&s&&s[ue]||Xt){const te=ct(F,"layout","icon-rotation-alignment",E,O,m,P);if(q==2){const Ft=w.getGeometry();if(Ft.getFlatMidpoint||Ft.getFlatMidpoints){const xt=Ft.getExtent();if(Math.sqrt(Math.max(Math.pow((xt[2]-xt[0])/S,2),Math.pow((xt[3]-xt[1])/S,2)))>150){const re=Ft.getType()==="MultiLineString"?Ft.getFlatMidpoints():Ft.getFlatMidpoint();if(Tg||(Ku=[NaN,NaN],Tg=new Hi("Point",Ku,[],2,{},void 0)),le=Tg,Ku[0]=re[0],Ku[1]=re[1],ct(F,"layout","symbol-placement",E,O,m,P)==="line"&&te==="map"){const Oe=Ft.getStride(),Ge=Ft.getFlatCoordinates();for(let Ye=0,ci=Ge.length-Oe;Ye<ci;Ye+=Oe){const ti=Ge[Ye],oe=Ge[Ye+1],$e=Ge[Ye+Oe],di=Ge[Ye+Oe+1],Di=Math.min(ti,$e),Zt=Math.min(oe,di),wi=Math.max(ti,$e),pi=Math.max(oe,di);if(re[0]>=Di&&re[0]<=wi&&re[1]>=Zt&&re[1]<=pi){Li=Math.atan2(oe-di,$e-ti);break}}}}}}if(q!==2||le){const Ft=ct(F,"layout","icon-size",E,O,m,P),xt=tt["icon-color"]!==void 0?ct(F,"paint","icon-color",E,O,m,P):null;if(!xt||xt.a!==0){const re=ct(F,"paint","icon-halo-color",E,O,m,P),Oe=ct(F,"paint","icon-halo-width",E,O,m,P);let Ge=`${ue}.${Ft}.${Oe}.${re}`;if(xt!==null&&(Ge+=`.${xt}`),ut=f[Ge],!ut){const Ye=cb(F,E,O,"icon",m);let ci;"icon-offset"in at&&(ci=ct(F,"layout","icon-offset",E,O,m,P).slice(0),ci[0]*=Ft,ci[1]*=-Ft);let ti=xt?[255*xt.r,255*xt.g,255*xt.b,xt.a]:void 0;if(Xt){const oe={color:ti,rotateWithView:te==="map",displacement:ci,declutterMode:Ye,scale:Ft};typeof Xt=="string"?oe.src=Xt:(oe.img=Xt,oe.imgSize=[Xt.width,Xt.height]),ut=new au(oe)}else{const oe=s[ue];let $e,di,Di;Oe?oe.sdf?($e=ab(lb(l,oe,xt||[0,0,0,1]),{x:0,y:0,width:oe.width,height:oe.height,pixelRatio:oe.pixelRatio},Oe,re),ti=void 0):$e=ab(l,oe,Oe,re):(oe.sdf?(u||(u=lb(l,{x:0,y:0,width:h[0],height:h[1]},{r:1,g:1,b:1,a:1})),$e=u):$e=l,di=[oe.width,oe.height],Di=[oe.x,oe.y]),ut=new au({color:ti,img:$e,imgSize:h,size:di,offset:Di,rotateWithView:te==="map",scale:Ft/oe.pixelRatio,displacement:ci,declutterMode:Ye})}f[Ge]=ut}}ut&&(++D,W=b[D],(!W||!W.getImage()||W.getFill()||W.getStroke())&&(W=new Ri,b[D]=W),W.setGeometry(le),ut.setRotation(Li+bg(ct(F,"layout","icon-rotate",E,O,m,P))),ut.setOpacity(ct(F,"paint","icon-opacity",E,O,m,P)),ut.setAnchor(cT[ct(F,"layout","icon-anchor",E,O,m,P)]),W.setImage(ut),mt=W.getText(),W.setText(void 0),W.setZIndex(we),Ie=!0,ae=!1)}else ae=!0}}}if(q==1&&F.type==="circle"){++D,W=b[D],(!W||!W.getImage()||W.getFill()||W.getStroke())&&(W=new Ri,b[D]=W);const de="circle-radius"in tt?ct(F,"paint","circle-radius",E,O,m,P):5,le=mr(ct(F,"paint","circle-stroke-color",E,O,m,P),ct(F,"paint","circle-stroke-opacity",E,O,m,P)),Xt=ct(F,"paint","circle-translate",E,O,m,P),te=mr(ct(F,"paint","circle-color",E,O,m,P),ct(F,"paint","circle-opacity",E,O,m,P)),Ft=ct(F,"paint","circle-stroke-width",E,O,m,P),xt=de+"."+le+"."+te+"."+Ft+"."+Xt[0]+"."+Xt[1];ut=f[xt],ut||(ut=new tl({radius:de,displacement:[Xt[0],-Xt[1]],stroke:le&&Ft>0?new Xi({width:Ft,color:le}):void 0,fill:te?new Ui({color:te}):void 0,declutterMode:"none"}),f[xt]=ut),W.setImage(ut),mt=W.getText(),W.setText(void 0),W.setGeometry(void 0),W.setZIndex(we),Ie=!0}if("text-field"in at){Ze=Math.round(ct(F,"layout","text-size",E,O,m,P));const de=ct(F,"layout","text-font",E,O,m,P);je=ct(F,"layout","text-line-height",E,O,m,P),At=_g(o?o(de,t.metadata?t.metadata["ol:webfonts"]:void 0):de,Ze,je),At.includes("sans-serif")||(At+=",sans-serif"),ui=ct(F,"layout","text-letter-spacing",E,O,m,P),ce=ct(F,"layout","text-max-width",E,O,m,P);const le=ct(F,"layout","text-field",E,O,m,P);Ut=typeof le=="object"&&le.sections?le.sections.length===1?le.toString():le.sections.reduce((Xt,te,Ft)=>{const xt=te.fontStack?te.fontStack.split(","):de,re=_g(o?o(xt):xt,Ze*(te.scale||1),je);let Oe=te.text;if(Oe===`
`)return Xt.push(`
`,""),Xt;if(q!=2){Oe=Mg(Oe,re,ce,ui).split(`
`);for(let Ge=0,Ye=Oe.length;Ge<Ye;++Ge)Ge>0&&Xt.push(`
`,""),Xt.push(Oe[Ge],re);return Xt}Xt.push(wg(Oe,ui),re)},[]):Ig(le,I).trim(),Wt=ct(F,"paint","text-opacity",E,O,m,P)}if(Ut&&Wt&&!ae){Ie||(++D,W=b[D],(!W||!W.getText()||W.getFill()||W.getStroke())&&(W=new Ri,b[D]=W),W.setImage(void 0),W.setGeometry(void 0));const de=cb(F,E,O,"text",m);W.getText()||W.setText(mt),mt=W.getText(),(!mt||"getDeclutterMode"in mt&&mt.getDeclutterMode()!==de)&&(mt=new Dv({padding:[2,2,2,2],declutterMode:de}),W.setText(mt));const le=ct(F,"layout","text-transform",E,O,m,P);le=="uppercase"?Ut=Array.isArray(Ut)?Ut.map((Zt,wi)=>wi%2?Zt:Zt.toUpperCase()):Ut.toUpperCase():le=="lowercase"&&(Ut=Array.isArray(Ut)?Ut.map((Zt,wi)=>wi%2?Zt:Zt.toLowerCase()):Ut.toLowerCase());const Xt=Array.isArray(Ut)?Ut:q==2?wg(Ut,ui):Mg(Ut,At,ce,ui);mt.setText(Xt),mt.setFont(At),mt.setRotation(bg(ct(F,"layout","text-rotate",E,O,m,P)));const te=ct(F,"layout","text-anchor",E,O,m,P),Ft=Ie||q==1?"point":ct(F,"layout","symbol-placement",E,O,m,P);let xt;if(Ft==="line-center"?(mt.setPlacement("line"),xt="center"):mt.setPlacement(Ft),Ft==="line"&&typeof mt.setRepeat=="function"){const Zt=ct(F,"layout","symbol-spacing",E,O,m,P);mt.setRepeat(2*Zt)}mt.setOverflow(Ft==="point");let re=ct(F,"paint","text-halo-width",E,O,m,P);const Oe=ct(F,"layout","text-offset",E,O,m,P),Ge=ct(F,"paint","text-translate",E,O,m,P);let Ye=0,ci=0;if(Ft=="point"){xt="center",te.indexOf("left")!==-1?(xt="left",ci=re):te.indexOf("right")!==-1&&(xt="right",ci=-re);const Zt=ct(F,"layout","text-rotation-alignment",E,O,m,P);mt.setRotateWithView(Zt=="map")}else mt.setMaxAngle(bg(ct(F,"layout","text-max-angle",E,O,m,P))*Ut.length/Xt.length),mt.setRotateWithView(!1);mt.setTextAlign(xt);let ti="middle";te.indexOf("bottom")==0?(ti="bottom",Ye=-re-.5*(je-1)*Ze):te.indexOf("top")==0&&(ti="top",Ye=re+.5*(je-1)*Ze),mt.setTextBaseline(ti);const oe=ct(F,"layout","text-justify",E,O,m,P);mt.setJustify(oe==="auto"?void 0:oe),mt.setOffsetX(Oe[0]*Ze+ci+Ge[0]),mt.setOffsetY(Oe[1]*Ze+Ye+Ge[1]),x.setColor(mr(ct(F,"paint","text-color",E,O,m,P),Wt)),mt.setFill(x);const $e=mr(ct(F,"paint","text-halo-color",E,O,m,P),Wt);if($e&&re>0){v.setColor($e),re*=2;const Zt=.5*Ze;v.setWidth(re<=Zt?re:Zt),mt.setStroke(v)}else mt.setStroke(void 0);const di=ct(F,"layout","text-padding",E,O,m,P),Di=mt.getPadding();di!==Di[0]&&(Di[0]=di,Di[1]=di,Di[2]=di,Di[3]=di),W.setZIndex(we)}}}return D>-1?(b.length=D+1,db&&("set"in w?w.set("mapbox-layer",L):w.getProperties()["mapbox-layer"]=L),b):void 0};return n.setStyle(M),n.set("mapbox-source",_),n.set("mapbox-layers",p),n.set("mapbox-featurestate",n.get("mapbox-featurestate")||{}),M}function _T(n,t=512){return n.getExtent()?Xh({extent:n.getExtent(),tileSize:t,maxZoom:22}).getResolutions():Zu}function pb(n,t,e="",i={},s=void 0){let r,o,a,l,h=!0;return typeof e=="string"||Array.isArray(e)?l=e:(a=e,l=a.source||a.layers,i=a),typeof i=="string"?(r=i,a={}):(r=i.styleUrl,a=i),a.updateSource===!1&&(h=!1),s||(s=a.resolutions),!r&&typeof t=="string"&&!t.trim().startsWith("{")&&(r=t),r&&(r=r.startsWith("data:")?location.href:ib(r,a.accessToken),a=function(c,d){return d.accessToken||(d=Object.assign({},d),new URL(c).searchParams.forEach((p,f)=>{d.accessToken=p,d.accessTokenParam=f})),d}(r,a)),new Promise(function(u,c){(function(p,f){if(typeof p!="string")return Promise.resolve(p);if(!p.trim().startsWith("{"))return No("Style",p=ib(p,f.accessToken),f);try{const g=JSON.parse(p);return Promise.resolve(g)}catch(g){return Promise.reject(g)}})(t,a).then(function(d){if(d.version!=8)return c(new Error("glStyle version 8 required."));if(!(n instanceof Eu||n instanceof cl))return c(new Error("Can only apply to VectorLayer or VectorTileLayer"));const p=n instanceof cl?"vector":"geojson";if(l?o=Array.isArray(l)?d.layers.find(function(x){return x.id===l[0]}).source:l:(o=Object.keys(d.sources).find(function(x){return d.sources[x].type===p}),l=o),!o)return c(new Error(`No ${p} source found in the glStyle.`));function f(){if(!h)return Promise.resolve();if(n instanceof cl)return function(S,k,I){return new Promise(function(R,E){(function(O,P,L={}){const D=[P,JSON.stringify(O)].toString();let G=ob[D];if(!G||L.transformRequest){let $;L.transformRequest&&($=(F,N)=>{const at=L.transformRequest&&L.transformRequest(N,"Tiles")||N;if(F instanceof V_)F.setLoader((tt,_t,Pt)=>{mh(()=>at).then(Wt=>{fetch(Wt).then(Ht=>Ht.arrayBuffer()).then(Ht=>{const Qt=F.getFormat().readFeatures(Ht,{extent:tt,featureProjection:Pt});F.setFeatures(Qt)}).catch(Ht=>F.setState(Y.ERROR))})});else{const tt=F.getImage();mh(()=>at).then(_t=>{_t instanceof Request?fetch(_t).then(Pt=>Pt.blob()).then(Pt=>{const Wt=URL.createObjectURL(Pt);tt.addEventListener("load",()=>URL.revokeObjectURL(Wt)),tt.addEventListener("error",()=>URL.revokeObjectURL(Wt)),tt.src=Wt}).catch(Pt=>F.setState(Y.ERROR)):tt.src=_t})}});const K=O.url;if(K&&!O.tiles){const F=Xu(K,L.accessToken,L.accessTokenParam||"access_token",P||location.href);if(K.startsWith("mapbox://"))G=Promise.resolve({tileJson:Object.assign({},O,{url:void 0,tiles:Hp(F)}),tileLoadFunction:$});else{const N={};G=No("Source",F,L,N).then(function(at){return at.tiles=at.tiles.map(function(tt){return at.scheme==="tms"&&(tt=tt.replace("{y}","{-y}")),Xu(tt,L.accessToken,L.accessTokenParam||"access_token",N.request.url)}),Promise.resolve({tileJson:at,tileLoadFunction:$})})}}else O=Object.assign({},O,{tiles:O.tiles.map(function(F){return O.scheme==="tms"&&(F=F.replace("{y}","{-y}")),Xu(F,L.accessToken,L.accessTokenParam||"access_token",P||location.href)})}),G=Promise.resolve({tileJson:Object.assign({},O),tileLoadFunction:$});ob[D]=G}return G})(S,k,I).then(function({tileJson:q,tileLoadFunction:O}){const P=function(D,G,$){const K=new US({tileJSON:G,tileSize:D.tileSize||G.tileSize||512}),F=K.getTileJSON(),N=K.getTileGrid(),at=Bt($.projection||"EPSG:3857"),tt=function(ye,W){const we=ye.bounds;if(we){const ue=q1([we[0],we[1]],W),ut=q1([we[2],we[3]],W);return[ue[0],ue[1],ut[0],ut[1]]}return Bt(W).getExtent()}(F,at),_t=at.getExtent(),Pt=F.minzoom||0,Wt=F.maxzoom||22,Ht={attributions:K.getAttributions(),projection:at,tileGrid:new Ss({origin:_t?Gi(_t):N.getOrigin(0),extent:tt||N.getExtent(),minZoom:Pt,resolutions:_T(at,G.tileSize).slice(0,Wt+1),tileSize:N.getTileSize(0)})};return Array.isArray(F.tiles)?Ht.urls=F.tiles:Ht.url=F.tiles,Ht}(S,q,I);P.tileLoadFunction=O,P.format=new Mf,R(new Yp(P))}).catch(E)})}(d.sources[o],r,a).then(function(w){const S=n.getSource();if(S?w!==S&&(S.setTileUrlFunction(w.getTileUrlFunction()),typeof S.setUrls=="function"&&typeof w.getUrls=="function"&&S.setUrls(w.getUrls()),S.format_||(S.format_=w.format_),S.getAttributions()||S.setAttributions(w.getAttributions()),S.getTileLoadFunction()===H_&&S.setTileLoadFunction(w.getTileLoadFunction()),vs(S.getProjection(),w.getProjection())&&(S.tileGrid=w.getTileGrid())):n.setSource(w),!isFinite(n.getMaxResolution())&&!isFinite(n.getMinZoom())){const k=n.getSource().getTileGrid();n.setMaxResolution(k.getResolution(k.getMinZoom()))}});const x=d.sources[o];let b=n.getSource();(!b||b.get("mapbox-source")!==x)&&(b=function(S,k,I){const R=I.projection?new Cf({dataProjection:I.projection}):new Cf,E=S.data,q={};if(typeof E=="string"){const P=Xu(E,I.accessToken,I.accessTokenParam||"access_token",k||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(P)){const D=($,K,F)=>{const N=function(tt){return`{bbox-${(tt?tt.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}(F);return P.replace(N,`${$.join(",")}`)},G=new dr({attributions:S.attribution,format:R,loader:($,K,F,N,at)=>{No("GeoJSON",typeof D=="function"?D($,K,F):D,I).then(tt=>{const _t=G.getFormat().readFeatures(tt,{featureProjection:F});G.addFeatures(_t),N(_t)}).catch(tt=>{G.removeLoadedExtent($),at()})},strategy:uE});return G.set("mapbox-source",S),G}const L=new dr({attributions:S.attribution,format:R,url:P,loader:(D,G,$,K,F)=>{No("GeoJSON",P,I).then(N=>{const at=L.getFormat().readFeatures(N,{featureProjection:$});L.addFeatures(at),K(at)}).catch(N=>{L.removeLoadedExtent(D),F()})}});return L}q.features=R.readFeatures(E,{featureProjection:Ta()||"EPSG:3857"});const O=new dr(Object.assign({attributions:S.attribution,format:R},q));return O.set("mapbox-source",S),O}(x,r,a));const M=n.getSource();return M?b!==M&&(M.getAttributions()||M.setAttributions(b.getAttributions()),M.format_||(M.format_=b.getFormat()),M.url_=b.getUrl()):n.setSource(b),Promise.resolve()}let g,m,y,_;function v(){if(_||d.sprite&&!m)_?(n.setStyle(_),f().then(u).catch(c)):c(new Error("Something went wrong trying to apply style."));else{if(a.projection&&!s){const x=Bt(a.projection).getUnits();x!=="m"&&(s=Zu.map(b=>b/Xr[x]))}_=yT(n,d,l,s,m,y,hT,a.getImage),n.getStyle()?f().then(u).catch(c):c(new Error(`Nothing to show for source [${o}]`))}}if(d.sprite){const x=new URL(function(S,k,I){const R=vg(S);if(!R)return decodeURI(new URL(S,I).href);if(R.indexOf("sprites/")!==0)throw new Error(`unexpected sprites url: ${S}`);const E=R.slice(8);return`${eb}/styles/v1/${E}/sprite?access_token=${k}`}(d.sprite,a.accessToken,r||location.href));g=window.devicePixelRatio>=1.5?.5:1;const b=g==.5?"@2x":"";let M=x.origin+x.pathname+b+".json"+x.search;new Promise(function(w,S){No("Sprite",M,a).then(w).catch(function(k){M=x.origin+x.pathname+".json"+x.search,No("Sprite",M,a).then(w).catch(S)})}).then(function(w){if(w===void 0&&c(new Error("No sprites found.")),m=w,y=x.origin+x.pathname+b+".png"+x.search,a.transformRequest){const S=a.transformRequest(y,"SpriteImage")||y;(S instanceof Request||S instanceof Promise)&&(y=S)}v()}).catch(function(w){c(new Error(`Sprites cannot be loaded: ${M}: ${w.message}`))})}else v()}).catch(c)})}const fb=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"];function gb(n){const t=n.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&n.fullscreenEnabled)}function mb(n){return!(!n.webkitIsFullScreen&&!n.fullscreenElement)}function yb(n){n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}const vT=class extends Da{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target}),this.keys_=t.keys!==void 0&&t.keys,this.source_=t.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=t.className!==void 0?t.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=t.activeClassName!==void 0?t.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=t.inactiveClassName!==void 0?t.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const e=t.label!==void 0?t.label:"\u2922";this.labelNode_=typeof e=="string"?document.createTextNode(e):e;const i=t.labelActive!==void 0?t.labelActive:"\xD7";this.labelActiveNode_=typeof i=="string"?document.createTextNode(i):i;const s=t.tipLabel?t.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=s,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener("click",this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${Ra} ${qh}`,this.element.appendChild(this.button_)}handleClick_(t){t.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const t=this.getMap();if(!t)return;const e=t.getOwnerDocument();if(gb(e))if(mb(e))(function(s){s.exitFullscreen?s.exitFullscreen():s.webkitExitFullscreen&&s.webkitExitFullscreen()})(e);else{let i;i=this.source_?typeof this.source_=="string"?e.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?function(r){r.webkitRequestFullscreen?r.webkitRequestFullscreen():yb(r)}(i):yb(i)}}handleFullScreenChange_(){const t=this.getMap();if(!t)return;const e=this.isInFullscreen_;this.isInFullscreen_=mb(t.getOwnerDocument()),e!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Vh(this.labelActiveNode_,this.labelNode_),this.dispatchEvent("enterfullscreen")):(Vh(this.labelNode_,this.labelActiveNode_),this.dispatchEvent("leavefullscreen")),t.updateSize())}setClassName_(t,e){e?(t.classList.remove(...this.inactiveClassName_),t.classList.add(...this.activeClassName_)):(t.classList.remove(...this.activeClassName_),t.classList.add(...this.inactiveClassName_))}setMap(t){const e=this.getMap();e&&e.removeChangeListener("target",this.boundHandleMapTargetChange_),super.setMap(t),this.handleMapTargetChange_(),t&&t.addChangeListener("target",this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const t=this.documentListeners_;for(let i=0,s=t.length;i<s;++i)me(t[i]);t.length=0;const e=this.getMap();if(e){const i=e.getOwnerDocument();gb(i)?this.element.classList.remove(u_):this.element.classList.add(u_);for(let s=0,r=fb.length;s<r;++s)t.push(Dt(i,fb[s],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}},xT=class extends jh{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError===void 0||t.useInterimTilesOnError)}getPreload(){return this.get("preload")}setPreload(t){this.set("preload",t)}getUseInterimTilesOnError(){return this.get("useInterimTilesOnError")}setUseInterimTilesOnError(t){this.set("useInterimTilesOnError",t)}getData(t){return super.getData(t)}},kg=class extends xT{constructor(t){super(t)}createRenderer(){return new fx(this)}};function _b(n){return n&&rt(n.schedule)}function vb(n){return n[n.length-1]}function xb(n){return _b(vb(n))?n.pop():void 0}function zo(n){return this instanceof zo?(this.v=n,this):new zo(n)}function bT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function(r){var o=typeof Symbol=="function"&&Symbol.iterator,a=o&&r[o],l=0;if(a)return a.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&l>=r.length&&(r=void 0),{value:r&&r[l++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(r){return new Promise(function(o,a){(function(h,u,c,d){Promise.resolve(d).then(function(p){h({value:p,done:c})},u)})(o,a,(r=n[s](r)).done,r.value)})}}}typeof SuppressedError=="function"&&SuppressedError;const bb=n=>n&&typeof n.length=="number"&&typeof n!="function";function wb(n){return rt(n?.then)}function Cb(n){return rt(n[Bo])}function Mb(n){return Symbol.asyncIterator&&rt(n?.[Symbol.asyncIterator])}function Sb(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Eb=function(){return typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Tb(n){return rt(n?.[Eb])}function Ib(n){return function(e,i,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=s.apply(e,i||[]),a=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(p){o[p]&&(r[p]=function(f){return new Promise(function(g,m){a.push([p,f,g,m])>1||h(p,f)})})}function h(p,f){try{(function(m){m.value instanceof zo?Promise.resolve(m.value.v).then(u,c):d(a[0][2],m)})(o[p](f))}catch(g){d(a[0][3],g)}}function u(p){h("next",p)}function c(p){h("throw",p)}function d(p,f){p(f),a.shift(),a.length&&h(a[0][0],a[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:e,done:i}=yield zo(t.read());if(i)return yield zo(void 0);yield yield zo(e)}}finally{t.releaseLock()}})}function kb(n){return rt(n?.getReader)}function pn(n){if(n instanceof ei)return n;if(n!=null){if(Cb(n))return function(e){return new ei(i=>{const s=e[Bo]();if(rt(s.subscribe))return s.subscribe(i);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(bb(n))return function(e){return new ei(i=>{for(let s=0;s<e.length&&!i.closed;s++)i.next(e[s]);i.complete()})}(n);if(wb(n))return function(e){return new ei(i=>{e.then(s=>{i.closed||(i.next(s),i.complete())},s=>i.error(s)).then(null,C)})}(n);if(Mb(n))return Pb(n);if(Tb(n))return function(e){return new ei(i=>{for(const s of e)if(i.next(s),i.closed)return;i.complete()})}(n);if(kb(n))return function(e){return Pb(Ib(e))}(n)}throw Sb(n)}function Pb(n){return new ei(t=>{(function(i,s){var r,o,a,l;return function(u,c,d,p){return new(d||(d=Promise))(function(f,g){function m(v){try{_(p.next(v))}catch(x){g(x)}}function y(v){try{_(p.throw(v))}catch(x){g(x)}}function _(v){v.done?f(v.value):function(b){return b instanceof d?b:new d(function(M){M(b)})}(v.value).then(m,y)}_((p=p.apply(u,c||[])).next())})}(this,void 0,void 0,function*(){try{for(r=bT(i);!(o=yield r.next()).done;)if(s.next(o.value),s.closed)return}catch(h){a={error:h}}finally{try{o&&!o.done&&(l=r.return)&&(yield l.call(r))}finally{if(a)throw a.error}}s.complete()})})(n,t).catch(e=>t.error(e))})}function Bs(n,t,e,i=0,s=!1){const r=t.schedule(function(){e(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(r),!s)return r}function Rb(n,t=0){return $i((e,i)=>{e.subscribe(Ki(i,s=>Bs(i,n,()=>i.next(s),t),()=>Bs(i,n,()=>i.complete(),t),s=>Bs(i,n,()=>i.error(s),t)))})}function Fb(n,t=0){return $i((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function Ob(n,t){if(!n)throw new Error("Iterable cannot be null");return new ei(e=>{Bs(e,t,()=>{const i=n[Symbol.asyncIterator]();Bs(e,t,()=>{i.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function Pg(n,t){return t?function(i,s){if(i!=null){if(Cb(i))return function(o,a){return pn(o).pipe(Fb(a),Rb(a))}(i,s);if(bb(i))return function(o,a){return new ei(l=>{let h=0;return a.schedule(function(){h===o.length?l.complete():(l.next(o[h++]),l.closed||this.schedule())})})}(i,s);if(wb(i))return function(o,a){return pn(o).pipe(Fb(a),Rb(a))}(i,s);if(Mb(i))return Ob(i,s);if(Tb(i))return function(o,a){return new ei(l=>{let h;return Bs(l,a,()=>{h=o[Eb](),Bs(l,a,()=>{let u,c;try{({value:u,done:c}=h.next())}catch(d){return void l.error(d)}c?l.complete():l.next(u)},0,!0)}),()=>rt(h?.return)&&h.return()})}(i,s);if(kb(i))return function(o,a){return Ob(Ib(o),a)}(i,s)}throw Sb(i)}(n,t):pn(n)}function is(...n){return Pg(n,xb(n))}function Ju(n,t,e=1/0){return rt(t)?Ju((i,s)=>Ji((r,o)=>t(i,r,s,o))(pn(n(i,s))),e):(typeof t=="number"&&(e=t),$i((i,s)=>function(o,a,l,h,u,c,d,p){const f=[];let g=0,m=0,y=!1;const _=()=>{y&&!f.length&&!g&&a.complete()},v=b=>g<h?x(b):f.push(b),x=b=>{c&&a.next(b),g++;let M=!1;pn(l(b,m++)).subscribe(Ki(a,w=>{u?.(w),c?v(w):a.next(w)},()=>{M=!0},void 0,()=>{if(M)try{for(g--;f.length&&g<h;){const w=f.shift();d?Bs(a,d,()=>x(w)):x(w)}_()}catch(w){a.error(w)}}))};return o.subscribe(Ki(a,v,()=>{y=!0,_()})),()=>{p?.()}}(i,s,n,e)))}function Ab(n,t){return rt(t)?Ju(n,t,1):Ju(n,1)}function Qu(n,t){return $i((e,i)=>{let s=0;e.subscribe(Ki(i,r=>n.call(t,r,s++)&&i.next(r)))})}function Lb(n){return $i((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}function Db(n,t){return $i((e,i)=>{let s=null,r=0,o=!1;const a=()=>o&&!s&&i.complete();e.subscribe(Ki(i,l=>{s?.unsubscribe();let h=0;const u=r++;pn(n(l,u)).subscribe(s=Ki(i,c=>i.next(t?t(l,c,u,h++):c),()=>{s=null,a()}))},()=>{o=!0,a()}))})}class Rg{}class tc{}class Rn{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{const i=e.indexOf(":");if(i>0){const s=e.slice(0,i),r=s.toLowerCase(),o=e.slice(i+1).trim();this.maybeSetNormalizedName(s,r),this.headers.has(r)?this.headers.get(r).push(o):this.headers.set(r,[o])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.setHeaderEntries(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Rn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Rn;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Rn?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(t.name,e);const s=(t.op==="a"?this.headers.get(e):void 0)||[];s.push(...i),this.headers.set(e,s);break;case"d":const r=t.value;if(r){let o=this.headers.get(e);if(!o)return;o=o.filter(a=>r.indexOf(a)===-1),o.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const i=(Array.isArray(e)?e:[e]).map(r=>r.toString()),s=t.toLowerCase();this.headers.set(s,i),this.maybeSetNormalizedName(t,s)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class wT{encodeKey(t){return Nb(t)}encodeValue(t){return Nb(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const CT=/%(\d[a-f0-9])/gi,MT={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Nb(n){return encodeURIComponent(n).replace(CT,(t,e)=>MT[e]??t)}function ec(n){return`${n}`}class ns{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new wT,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(i,s){const r=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(o=>{const a=o.indexOf("="),[l,h]=a==-1?[s.decodeKey(o),""]:[s.decodeKey(o.slice(0,a)),s.decodeValue(o.slice(a+1))],u=r.get(l)||[];u.push(h),r.set(l,u)}),r}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],s=Array.isArray(i)?i.map(ec):[ec(i)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const s=t[i];Array.isArray(s)?s.forEach(r=>{e.push({param:i,value:r,op:"a"})}):e.push({param:i,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>t!=="").join("&")}clone(t){const e=new ns({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(ec(t.value)),this.map.set(t.param,e);break;case"d":if(t.value===void 0){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const s=i.indexOf(ec(t.value));s!==-1&&i.splice(s,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class ST{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function zb(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function jb(n){return typeof Blob<"u"&&n instanceof Blob}function Gb(n){return typeof FormData<"u"&&n instanceof FormData}class yr{constructor(t,e,i,s){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(a){switch(a){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=i!==void 0?i:null,r=s):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params),this.transferCache=r.transferCache),this.headers||(this.headers=new Rn),this.context||(this.context=new ST),this.params){const o=this.params.toString();if(o.length===0)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(a===-1?"?":a<e.length-1?"&":"")+o}}else this.params=new ns,this.urlWithParams=e}serializeBody(){return this.body===null?null:zb(this.body)||jb(this.body)||Gb(this.body)||function(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||typeof this.body=="string"?this.body:this.body instanceof ns?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Gb(this.body)?null:jb(this.body)?this.body.type||null:zb(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ns?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,s=t.responseType||this.responseType,r=t.body!==void 0?t.body:this.body,o=t.withCredentials!==void 0?t.withCredentials:this.withCredentials,a=t.reportProgress!==void 0?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,h=t.params||this.params;const u=t.context??this.context;return t.setHeaders!==void 0&&(l=Object.keys(t.setHeaders).reduce((c,d)=>c.set(d,t.setHeaders[d]),l)),t.setParams&&(h=Object.keys(t.setParams).reduce((c,d)=>c.set(d,t.setParams[d]),h)),new yr(e,i,r,{params:h,headers:l,context:u,reportProgress:a,responseType:s,withCredentials:o})}}var jo=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(jo||{});class Fg{constructor(t,e=200,i="OK"){this.headers=t.headers||new Rn,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Og extends Fg{constructor(t={}){super(t),this.type=jo.ResponseHeader}clone(t={}){return new Og({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Go extends Fg{constructor(t={}){super(t),this.type=jo.Response,this.body=t.body!==void 0?t.body:null}clone(t={}){return new Go({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class qb extends Fg{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Ag(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let ic=(()=>{class n{constructor(e){this.handler=e}request(e,i,s={}){let r;if(e instanceof yr)r=e;else{let l,h;l=s.headers instanceof Rn?s.headers:new Rn(s.headers),s.params&&(h=s.params instanceof ns?s.params:new ns({fromObject:s.params})),r=new yr(e,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}const o=is(r).pipe(Ab(l=>this.handler.handle(l)));if(e instanceof yr||s.observe==="events")return o;const a=o.pipe(Qu(l=>l instanceof Go));switch(s.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return a.pipe(Ji(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Ji(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Ji(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Ji(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:new ns().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,s={}){return this.request("PATCH",e,Ag(s,i))}post(e,i,s={}){return this.request("POST",e,Ag(s,i))}put(e,i,s={}){return this.request("PUT",e,Ag(s,i))}static#t=this.\u0275fac=function(e){return new(e||n)(ot(Rg))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();function Vb(n,t){return t(n)}function ET(n,t){return(e,i)=>t.intercept(e,{handle:s=>n(s,i)})}const TT=new jt(""),Lg=new jt(""),IT=new jt(""),kT=new jt("");function PT(){let n=null;return(t,e)=>{n===null&&(n=(Re(TT,{optional:!0})??[]).reduceRight(ET,Vb));const i=Re(nh),s=i.add();return n(t,e).pipe(Lb(()=>i.remove(s)))}}let Bb=(()=>{class n extends Rg{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null,this.pendingTasks=Re(nh);const s=Re(kT,{optional:!0});this.backend=s??e}handle(e){if(this.chain===null){const s=Array.from(new Set([...this.injector.get(Lg),...this.injector.get(IT,[])]));this.chain=s.reduceRight((r,o)=>function(l,h,u){return(c,d)=>function(f,g){f instanceof Vc&&f.assertNotDestroyed();const m=as(f),y=Ni(void 0);try{return g()}finally{as(m),Ni(y)}}(u,()=>h(c,p=>l(p,d)))}(r,o,this.injector),Vb)}const i=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(Lb(()=>this.pendingTasks.remove(i)))}static#t=this.\u0275fac=function(e){return new(e||n)(ot(tc),ot(Ys))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const RT=/^\)\]\}',?\n/;let Wb=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new Nt(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Pg(i.\u0275loadImpl()):is(null)).pipe(Db(()=>new ei(s=>{const r=i.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((f,g)=>r.setRequestHeader(f,g.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const f=e.detectContentTypeHeader();f!==null&&r.setRequestHeader("Content-Type",f)}if(e.responseType){const f=e.responseType.toLowerCase();r.responseType=f!=="json"?f:"text"}const o=e.serializeBody();let a=null;const l=()=>{if(a!==null)return a;const f=r.statusText||"OK",g=new Rn(r.getAllResponseHeaders()),m=function(_){return"responseURL"in _&&_.responseURL?_.responseURL:/^X-Request-URL:/m.test(_.getAllResponseHeaders())?_.getResponseHeader("X-Request-URL"):null}(r)||e.url;return a=new Og({headers:g,status:r.status,statusText:f,url:m}),a},h=()=>{let{headers:f,status:g,statusText:m,url:y}=l(),_=null;g!==204&&(_=typeof r.response>"u"?r.responseText:r.response),g===0&&(g=_?200:0);let v=g>=200&&g<300;if(e.responseType==="json"&&typeof _=="string"){const x=_;_=_.replace(RT,"");try{_=_!==""?JSON.parse(_):null}catch(b){_=x,v&&(v=!1,_={error:b,text:_})}}v?(s.next(new Go({body:_,headers:f,status:g,statusText:m,url:y||void 0})),s.complete()):s.error(new qb({error:_,headers:f,status:g,statusText:m,url:y||void 0}))},u=f=>{const{url:g}=l(),m=new qb({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:g||void 0});s.error(m)};let c=!1;const d=f=>{c||(s.next(l()),c=!0);let g={type:jo.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(g.total=f.total),e.responseType==="text"&&r.responseText&&(g.partialText=r.responseText),s.next(g)},p=f=>{let g={type:jo.UploadProgress,loaded:f.loaded};f.lengthComputable&&(g.total=f.total),s.next(g)};return r.addEventListener("load",h),r.addEventListener("error",u),r.addEventListener("timeout",u),r.addEventListener("abort",u),e.reportProgress&&(r.addEventListener("progress",d),o!==null&&r.upload&&r.upload.addEventListener("progress",p)),r.send(o),s.next({type:jo.Sent}),()=>{r.removeEventListener("error",u),r.removeEventListener("abort",u),r.removeEventListener("load",h),r.removeEventListener("timeout",u),e.reportProgress&&(r.removeEventListener("progress",d),o!==null&&r.upload&&r.upload.removeEventListener("progress",p)),r.readyState!==r.DONE&&r.abort()}})))}static#t=this.\u0275fac=function(e){return new(e||n)(ot(Wy))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();const Ub=new jt("XSRF_ENABLED"),FT=new jt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),OT=new jt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Hb{}let AT=(()=>{class n{constructor(e,i,s){this.doc=e,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=zy(e,this.cookieName),this.lastCookieString=e),this.lastToken}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ds),ot(Pr),ot(FT))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac})}return n})();function LT(n,t){const e=n.url.toLowerCase();if(!Re(Ub)||n.method==="GET"||n.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=Re(Hb).getToken(),s=Re(OT);return i!=null&&!n.headers.has(s)&&(n=n.clone({headers:n.headers.set(s,i)})),t(n)}var Xb=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Xb||{});function DT(...n){const t=[ic,Wb,Bb,{provide:Rg,useExisting:Bb},{provide:tc,useExisting:Wb},{provide:Lg,useValue:LT,multi:!0},{provide:Ub,useValue:!0},{provide:Hb,useClass:AT}];for(const e of n)t.push(...e.\u0275providers);return function(i){return{\u0275providers:i}}(t)}const Zb=new jt("LEGACY_INTERCEPTOR_FN");function NT(){return function(t,e){return{\u0275kind:t,\u0275providers:e}}(Xb.LegacyInterceptors,[{provide:Zb,useFactory:PT},{provide:Lg,useExisting:Zb,multi:!0}])}let zT=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275mod=xr({type:n});static#i=this.\u0275inj=vr({providers:[DT(NT())]})}return n})();class jT extends be{constructor(t,e){super()}schedule(t,e=0){return this}}const nc={setInterval(n,t,...e){const{delegate:i}=nc;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=nc;return(t?.clearInterval||clearInterval)(n)},delegate:void 0},Dg={now:()=>(Dg.delegate||Date).now(),delegate:void 0};class _l{constructor(t,e=_l.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}_l.now=Dg.now;const GT=new class extends _l{constructor(t,e=_l.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}(class extends jT{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const s=this.id,r=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(r,s,e)),this.pending=!0,this.delay=e,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,i=0){return nc.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return e;e!=null&&nc.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i,s=!1;try{this.work(t)}catch(r){s=!0,i=r||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,_e(i,this),t!=null&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}});function Yb(n=0,t,e=GT){let i=-1;return t!=null&&(_b(t)?e=t:i=t),new ei(s=>{let r=function(l){return l instanceof Date&&!isNaN(l)}(n)?+n-e.now():n;r<0&&(r=0);let o=0;return e.schedule(function(){s.closed||(s.next(o++),0<=i?this.schedule(void 0,i):s.complete())},r)})}class $b extends Wo{constructor(t=1/0,e=1/0,i=Dg){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:i,_infiniteTimeWindow:s,_timestampProvider:r,_windowTime:o}=this;e||(i.push(t),!s&&i.push(r.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:i,_buffer:s}=this,r=s.slice();for(let o=0;o<r.length&&!t.closed;o+=i?1:2)t.next(r[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:i,_infiniteTimeWindow:s}=this,r=(s?1:2)*t;if(t<1/0&&r<i.length&&i.splice(0,i.length-r),!s){const o=e.now();let a=0;for(let l=1;l<i.length&&i[l]<=o;l+=2)a=l;a&&i.splice(0,a+1)}}}function Ng(n,t,...e){if(t===!0)return void n();if(t===!1)return;const i=new Ee({next:()=>{i.unsubscribe(),n()}});return pn(t(...e)).subscribe(i)}function Kb(n,t,e){let i,s=!1;return n&&typeof n=="object"?{bufferSize:i=1/0,windowTime:t=1/0,refCount:s=!1,scheduler:e}=n:i=n??1/0,function(o={}){const{connector:a=()=>new Wo,resetOnError:l=!0,resetOnComplete:h=!0,resetOnRefCountZero:u=!0}=o;return c=>{let d,p,f,g=0,m=!1,y=!1;const _=()=>{p?.unsubscribe(),p=void 0},v=()=>{_(),d=f=void 0,m=y=!1},x=()=>{const b=d;v(),b?.unsubscribe()};return $i((b,M)=>{g++,!y&&!m&&_();const w=f=f??a();M.add(()=>{g--,g===0&&!y&&!m&&(p=Ng(x,u))}),w.subscribe(M),!d&&g>0&&(d=new Ee({next:S=>w.next(S),error:S=>{y=!0,_(),p=Ng(v,l,S),w.error(S)},complete:()=>{m=!0,_(),p=Ng(v,h),w.complete()}}),pn(b).subscribe(d))})(c)}}({connector:()=>new $b(i,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function zg(n){return $i((t,e)=>{let i,s=null,r=!1;s=t.subscribe(Ki(e,void 0,void 0,o=>{i=pn(n(o,zg(n)(t))),s?(s.unsubscribe(),s=null,i.subscribe(e)):r=!0})),r&&(s.unsubscribe(),s=null,i.subscribe(e))})}const Jb=new ei(n=>n.complete());function jg(n){return n<=0?()=>Jb:$i((t,e)=>{let i=0;t.subscribe(Ki(e,s=>{++i<=n&&(e.next(s),n<=i&&e.complete())}))})}var Qb={},qT={};function VT(n){for(var t=[],e=0,i=0,s=0;s<n.length;s+=1){var r=Qb[n[s]];if(r===void 0)throw new Error("Invalid character ("+n[s]+")");var o=32&r;if(i+=(r&=31)<<e,o)e+=5;else{var a=1&i;i>>>=1,t.push(a?i===0?-2147483648:-i:i),i=e=0}}return t}"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(function(n,t){Qb[n]=t,qT[t]=n});const sc="TOKEN_LOGGER_CONFIG";class BT{constructor(t){this.config=this._clone(t)}get level(){return this.config.level}get serverLogLevel(){return this.config.serverLogLevel}updateConfig(t){this.config=this._clone(t)}partialUpdateConfig(t){t&&Object.keys(t).forEach(e=>{this.config[e]=t[e]})}getConfig(){return this._clone(this.config)}_clone(t){const e={level:null};return Object.keys(t).forEach(i=>{e[i]=t[i]}),e}}const vl="TOKEN_LOGGER_CONFIG_ENGINE_FACTORY";class WT{provideConfigEngine(t){return new BT(t)}}const xl="TOKEN_LOGGER_MAPPER_SERVICE";let UT=(()=>{class n{constructor(e){this.httpBackend=e,this.sourceMapCache=new Map,this.logPositionCache=new Map}getLogPosition(e,i){const s=this.getStackLine(e);if(!s)return is({fileName:"",lineNumber:0,columnNumber:0});const r=this.getLocalPosition(s);if(!e.enableSourceMaps)return is(r);const o=this.getSourceMapLocation(s);return this.getSourceMap(o,r)}getStackLine(e){const i=new Error;try{throw i}catch{try{let s=4;return i.stack.split(`
`)[0].includes(".js:")||(s+=1),i.stack.split(`
`)[s+(e.proxiedSteps||0)]}catch{return null}}}getLocalPosition(e){const i=e.lastIndexOf("/");let s=e.indexOf(")");s<0&&(s=void 0);const r=e.substring(i+1,s).split(":");return r.length===3?{fileName:r[0],lineNumber:+r[1],columnNumber:+r[2]}:{fileName:"unknown",lineNumber:0,columnNumber:0}}getTranspileLocation(e){let i=e.indexOf("(");i<0&&(i=e.lastIndexOf("@"),i<0&&(i=e.lastIndexOf(" ")));let s=e.indexOf(")");return s<0&&(s=void 0),e.substring(i+1,s)}getSourceMapLocation(e){const i=this.getTranspileLocation(e),s=i.substring(0,i.lastIndexOf(":"));return s.substring(0,s.lastIndexOf(":"))+".map"}getMapping(e,i){let s=0,r=0,o=0;const a=e.mappings.split(";");for(let l=0;l<a.length;l++){let h=0;const u=a[l].split(",");for(let c=0;c<u.length;c++){const d=VT(u[c]);if(d.length>=4&&(h+=d[0],s+=d[1],r+=d[2],o+=d[3]),l===i.lineNumber){if(h===i.columnNumber)return{fileName:e.sources[s],lineNumber:r,columnNumber:o};if(c+1===u.length)return{fileName:e.sources[s],lineNumber:r,columnNumber:0}}}}return{fileName:"unknown",lineNumber:0,columnNumber:0}}getSourceMap(e,i){const s=new yr("GET",e),r=`${i.fileName}:${i.lineNumber}:${i.columnNumber}`;if(this.logPositionCache.has(r))return this.logPositionCache.get(r);this.sourceMapCache.has(e)||(this.httpBackend?this.sourceMapCache.set(e,this.httpBackend.handle(s).pipe(Qu(a=>a instanceof Go),Ji(a=>a.body),function(l=1/0){let h;h=l&&typeof l=="object"?l:{count:l};const{count:u=1/0,delay:c,resetOnSuccess:d=!1}=h;return u<=0?cc:$i((p,f)=>{let g,m=0;const y=()=>{let _=!1;g=p.subscribe(Ki(f,v=>{d&&(m=0),f.next(v)},void 0,v=>{if(m++<u){const x=()=>{g?(g.unsubscribe(),g=null,y()):_=!0};if(c!=null){const b=typeof c=="number"?Yb(c):pn(c(v,m)),M=Ki(f,()=>{M.unsubscribe(),x()},()=>{f.complete()});b.subscribe(M)}else x()}else f.error(v)})),_&&(g.unsubscribe(),g=null,y())};y()})}(3),Kb(1))):(console.error("NGXLogger : Can't get sourcemap because HttpBackend is not provided. You need to import HttpClientModule"),this.sourceMapCache.set(e,is(null))));const o=this.sourceMapCache.get(e).pipe(Ji(a=>a?this.getMapping(a,i):i),zg(()=>is(i)),Kb(1));return this.logPositionCache.set(r,o),o}}return n.\u0275fac=function(t){return new(t||n)(ot(tc,8))},n.\u0275prov=zt({token:n,factory:n.\u0275fac}),n})();const bl="TOKEN_LOGGER_METADATA_SERVICE";let HT=(()=>{class n{constructor(e){this.datePipe=e}computeTimestamp(e){const i=()=>new Date().toISOString();return e.timestampFormat?this.datePipe?this.datePipe.transform(new Date,e.timestampFormat):(console.error("NGXLogger : Can't use timeStampFormat because DatePipe is not provided. You need to provide DatePipe"),i()):i()}getMetadata(e,i,s,r){const o={level:e,additional:r};return o.message=s&&typeof s=="function"?s():s,o.timestamp=this.computeTimestamp(i),o}}return n.\u0275fac=function(t){return new(t||n)(ot(gC,8))},n.\u0275prov=zt({token:n,factory:n.\u0275fac}),n})();const wl="TOKEN_LOGGER_RULES_SERVICE";let XT=(()=>{class n{shouldCallWriter(e,i,s,r){return!i.disableConsoleLogging&&e>=i.level}shouldCallServer(e,i,s,r){return!!i.serverLoggingUrl&&e>=i.serverLogLevel}shouldCallMonitor(e,i,s,r){return this.shouldCallWriter(e,i,s,r)||this.shouldCallServer(e,i,s,r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=zt({token:n,factory:n.\u0275fac}),n})();const Cl="TOKEN_LOGGER_SERVER_SERVICE";let ZT=(()=>{class n{constructor(e,i){this.httpBackend=e,this.ngZone=i,this.serverCallsQueue=[],this.flushingQueue=new Hg(!1)}ngOnDestroy(){this.flushingQueue&&(this.flushingQueue.complete(),this.flushingQueue=null),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null)}secureErrorObject(e){return e?.stack}secureAdditionalParameters(e){return e==null?null:e.map((i,s)=>{try{return i instanceof Error?this.secureErrorObject(i):(typeof i=="object"&&JSON.stringify(i),i)}catch{return`The additional[${s}] value could not be parsed using JSON.stringify().`}})}secureMessage(e){try{if(e instanceof Error)return this.secureErrorObject(e);typeof e!="string"&&(e=JSON.stringify(e,null,2))}catch{e='The provided "message" value could not be parsed with JSON.stringify().'}return e}alterHttpRequest(e){return e}logOnServer(e,i,s){if(!this.httpBackend)return console.error("NGXLogger : Can't log on server because HttpBackend is not provided. You need to import HttpClientModule"),is(null);let r=new yr("POST",e,i,s||{}),o=is(r);const a=this.alterHttpRequest(r);return function(h){return!!h&&(h instanceof ei||rt(h.lift)&&rt(h.subscribe))}(a)?o=a:a?o=is(a):console.warn("NGXLogger : alterHttpRequest returned an invalid request. Using default one instead"),o.pipe(Ab(l=>l?this.httpBackend.handle(l):(console.warn("NGXLogger : alterHttpRequest returned an invalid request (observable). Using default one instead"),this.httpBackend.handle(r))),Qu(l=>l instanceof Go),Ji(l=>l.body))}customiseRequestBody(e){return e}flushQueue(e){this.flushingQueue.next(!0),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null),this.serverCallsQueue&&this.serverCallsQueue.length>0&&this.sendToServerAction(this.serverCallsQueue,e),this.serverCallsQueue=[],this.flushingQueue.next(!1)}sendToServerAction(e,i){let s;const r=l=>{const h={...l};return h.additional=this.secureAdditionalParameters(h.additional),h.message=this.secureMessage(h.message),h};Array.isArray(e)?(s=[],e.forEach(l=>{s.push(r(l))})):s=r(e),s=this.customiseRequestBody(s);const o=i.customHttpHeaders||new Rn;o.has("Content-Type")||o.set("Content-Type","application/json");const a=()=>{this.logOnServer(i.serverLoggingUrl,s,{headers:o,params:i.customHttpParams||new ns,responseType:i.httpResponseType||"json",withCredentials:i.withCredentials||!1}).pipe(zg(l=>(console.error("NGXLogger: Failed to log on server",l),function(u,c){const d=rt(u)?u:()=>u,p=f=>f.error(d());return new ei(c?f=>c.schedule(p,0,f):p)}(l)))).subscribe()};if(i.serverCallsOutsideNgZone===!0){if(!this.ngZone)return void console.error("NGXLogger: NgZone is not provided and serverCallsOutsideNgZone is set to true");this.ngZone.runOutsideAngular(a)}else a()}sendToServer(e,i){if((!i.serverCallsBatchSize||i.serverCallsBatchSize<=0)&&(!i.serverCallsTimer||i.serverCallsTimer<=0))return void this.sendToServerAction(e,i);const s=()=>{this.serverCallsQueue.push({...e}),i.serverCallsBatchSize&&this.serverCallsQueue.length>i.serverCallsBatchSize&&this.flushQueue(i),i.serverCallsTimer>0&&!this.addToQueueTimer&&(this.addToQueueTimer=Yb(i.serverCallsTimer).subscribe(r=>{this.flushQueue(i)}))};this.flushingQueue.value===!0?this.flushingQueue.pipe(Qu(r=>r===!1),jg(1)).subscribe(r=>{s()}):s()}}return n.\u0275fac=function(t){return new(t||n)(ot(tc,8),ot(We,8))},n.\u0275prov=zt({token:n,factory:n.\u0275fac}),n})();const Ml="TOKEN_LOGGER_WRITER_SERVICE";var ze=function(n){return n[n.TRACE=0]="TRACE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.LOG=3]="LOG",n[n.WARN=4]="WARN",n[n.ERROR=5]="ERROR",n[n.FATAL=6]="FATAL",n[n.OFF=7]="OFF",n}(ze||{});const YT=["purple","teal","gray","gray","red","red","red"];let $T=(()=>{class n{constructor(e){this.platformId=e,this.prepareMetaStringFuncs=[this.getTimestampToWrite,this.getLevelToWrite,this.getFileDetailsToWrite,this.getContextToWrite],this.isIE=function(s){return s===Vy}(e)&&navigator&&navigator.userAgent&&!(navigator.userAgent.indexOf("MSIE")===-1&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.logFunc=this.isIE?this.logIE.bind(this):this.logModern.bind(this)}getTimestampToWrite(e,i){return e.timestamp}getLevelToWrite(e,i){return ze[e.level]}getFileDetailsToWrite(e,i){return i.disableFileDetails===!0?"":`[${e.fileName}:${e.lineNumber}:${e.columnNumber}]`}getContextToWrite(e,i){return i.context?`{${i.context}}`:""}prepareMetaString(e,i){let s="";return this.prepareMetaStringFuncs.forEach(r=>{const o=r(e,i);o&&(s=s+" "+o)}),s.trim()}getColor(e,i){if(e.level!==ze.OFF)return(i.colorScheme??YT)[e.level]}logIE(e,i,s){const r=e.additional||[];switch(e.level){case ze.WARN:console.warn(`${s} `,e.message,...r);break;case ze.ERROR:case ze.FATAL:console.error(`${s} `,e.message,...r);break;case ze.INFO:console.info(`${s} `,e.message,...r);break;default:console.log(`${s} `,e.message,...r)}}logModern(e,i,s){const r=this.getColor(e,i),o=e.additional||[];switch(e.level){case ze.WARN:console.warn(`%c${s}`,`color:${r}`,e.message,...o);break;case ze.ERROR:case ze.FATAL:console.error(`%c${s}`,`color:${r}`,e.message,...o);break;case ze.INFO:console.info(`%c${s}`,`color:${r}`,e.message,...o);break;case ze.DEBUG:console.debug(`%c${s}`,`color:${r}`,e.message,...o);break;default:console.log(`%c${s}`,`color:${r}`,e.message,...o)}}writeMessage(e,i){const s=this.prepareMetaString(e,i);this.logFunc(e,i,s)}}return n.\u0275fac=function(t){return new(t||n)(ot(Pr))},n.\u0275prov=zt({token:n,factory:n.\u0275fac}),n})(),_r=(()=>{class n{constructor(e,i,s,r,o,a,l){this.metadataService=s,this.ruleService=r,this.mapperService=o,this.writerService=a,this.serverService=l,this.configEngine=i.provideConfigEngine(e)}get level(){return this.configEngine.level}get serverLogLevel(){return this.configEngine.serverLogLevel}trace(e,...i){this._log(ze.TRACE,e,i)}debug(e,...i){this._log(ze.DEBUG,e,i)}info(e,...i){this._log(ze.INFO,e,i)}log(e,...i){this._log(ze.LOG,e,i)}warn(e,...i){this._log(ze.WARN,e,i)}error(e,...i){this._log(ze.ERROR,e,i)}fatal(e,...i){this._log(ze.FATAL,e,i)}setCustomHttpHeaders(e){const i=this.getConfigSnapshot();i.customHttpHeaders=e,this.updateConfig(i)}setCustomParams(e){const i=this.getConfigSnapshot();i.customHttpParams=e,this.updateConfig(i)}setWithCredentialsOptionValue(e){const i=this.getConfigSnapshot();i.withCredentials=e,this.updateConfig(i)}registerMonitor(e){this._loggerMonitor=e}updateConfig(e){this.configEngine.updateConfig(e)}partialUpdateConfig(e){this.configEngine.partialUpdateConfig(e)}getConfigSnapshot(){return this.configEngine.getConfig()}flushServerQueue(){this.serverService.flushQueue(this.getConfigSnapshot())}_log(e,i,s=[]){const r=this.configEngine.getConfig(),o=this.ruleService.shouldCallWriter(e,r,i,s),a=this.ruleService.shouldCallServer(e,r,i,s),l=this.ruleService.shouldCallMonitor(e,r,i,s);if(!o&&!a&&!l)return;const h=this.metadataService.getMetadata(e,r,i,s);this.mapperService.getLogPosition(r,h).pipe(jg(1)).subscribe(u=>{u&&(h.fileName=u.fileName,h.lineNumber=u.lineNumber,h.columnNumber=u.columnNumber),l&&this._loggerMonitor&&this._loggerMonitor.onLog(h,r),o&&this.writerService.writeMessage(h,r),a&&this.serverService.sendToServer(h,r)})}}return n.\u0275fac=function(t){return new(t||n)(ot(sc),ot(vl),ot(bl),ot(wl),ot(xl),ot(Ml),ot(Cl))},n.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),KT=(()=>{class n{constructor(e,i,s,r,o,a,l){this.logger=e,this.configEngineFactory=i,this.metadataService=s,this.ruleService=r,this.mapperService=o,this.writerService=a,this.serverService=l}create(e,i,s,r){return this.getNewInstance({config:e,serverService:i,logMonitor:s,mapperService:r})}getNewInstance(e){const i=new _r(e?.config??this.logger.getConfigSnapshot(),e?.configEngineFactory??this.configEngineFactory,e?.metadataService??this.metadataService,e?.ruleService??this.ruleService,e?.mapperService??this.mapperService,e?.writerService??this.writerService,e?.serverService??this.serverService);return e?.partialConfig&&i.partialUpdateConfig(e.partialConfig),e?.logMonitor&&i.registerMonitor(e.logMonitor),i}}return n.\u0275fac=function(t){return new(t||n)(ot(_r),ot(vl),ot(bl),ot(wl),ot(xl),ot(Ml),ot(Cl))},n.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JT=(()=>{class n{static forRoot(e,i){if(i||(i={}),i.configProvider){if(i.configProvider.provide!==sc)throw new Error(`Wrong injection token for configProvider, it should be ${sc} and you used ${i.configProvider.provide}`)}else i.configProvider={provide:sc,useValue:e||{}};if(i.configEngineFactoryProvider){if(i.configEngineFactoryProvider.provide!==vl)throw new Error(`Wrong injection token for configEngineFactoryProvider, it should be '${vl}' and you used '${i.configEngineFactoryProvider.provide}'`)}else i.configEngineFactoryProvider={provide:vl,useClass:WT};if(i.metadataProvider){if(i.metadataProvider.provide!==bl)throw new Error(`Wrong injection token for metadataProvider, it should be '${bl}' and you used '${i.metadataProvider.provide}'`)}else i.metadataProvider={provide:bl,useClass:HT};if(i.ruleProvider){if(i.ruleProvider.provide!==wl)throw new Error(`Wrong injection token for ruleProvider, it should be '${wl}' and you used '${i.ruleProvider.provide}'`)}else i.ruleProvider={provide:wl,useClass:XT};if(i.mapperProvider){if(i.mapperProvider.provide!==xl)throw new Error(`Wrong injection token for mapperProvider, it should be '${xl}' and you used '${i.mapperProvider.provide}'`)}else i.mapperProvider={provide:xl,useClass:UT};if(i.writerProvider){if(i.writerProvider.provide!==Ml)throw new Error(`Wrong injection token for writerProvider, it should be '${Ml}' and you used '${i.writerProvider.provide}'`)}else i.writerProvider={provide:Ml,useClass:$T};if(i.serverProvider){if(i.serverProvider.provide!==Cl)throw new Error(`Wrong injection token for serverProvider, it should be '${Cl}' and you used '${i.writerProvider.provide}'`)}else i.serverProvider={provide:Cl,useClass:ZT};return{ngModule:n,providers:[_r,i.configProvider,i.configEngineFactoryProvider,i.metadataProvider,i.ruleProvider,i.mapperProvider,i.writerProvider,i.serverProvider,KT]}}static forChild(){return{ngModule:n}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=xr({type:n}),n.\u0275inj=vr({imports:[[ga]]}),n})(),QT=(()=>{class n{constructor(e){this.http=e}getMatrixSet(e){return this.http.get(e)}getMatrix(e){return this.http.get(e)}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ic))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tI(n,t){1&n&&Nr(0,"app-objectinfo-view",3),2&n&&cs("feature",eh().curFeature)}function t2(n){return n!=null&&`${n}`!="false"}let e2=(()=>{class n{set showGrid(e){this._showGrid=t2(e)}get showGrid(){return this._showGrid}set showObjectInfo(e){this._showObjectInfo=t2(e)}get showObjectInfo(){return this._showObjectInfo}set zoom(e){this._zoom=e,e!=-1&&(this.map.getView().setZoom(e),this.currentZoomLevel.next(e))}get zoom(){return this._zoom}constructor(e,i,s,r){this.logger=e,this.elementRef=i,this.matrixsetService=s,this.cdf=r,this.title="view-component",this.map=new ro({}),this.xyzSelector="/{z}/{y}/{x}?f=mvt",this._showGrid=!1,this._showObjectInfo=!1,this._zoom=-1,this.tileUrl=lf,this.currentZoomLevel=new Mi,this.activeFeature=new Mi,this.activeTileUrl=new Mi,this.mapHeight=600,this.mapWidth=800}ngOnChanges(e){e.styleUrl?.previousValue!==e.styleUrl?.currentValue&&(e.styleUrl.isFirstChange()||this.vectorTileLayer&&this.setStyle(this.vectorTileLayer)),e.tileUrl?.previousValue!==e.tileUrl?.currentValue&&(this.maxZoom=void 0,this.minZoom=void 0,this.zoom=-1,this.checkParams(),this.initialize())}initialize(){this.vectorTileLayer=void 0;let e=this.tileUrl.replace("tiles","tileMatrixSets")+"?f=json";this.matrixsetService.getMatrix(this.tileUrl).subscribe({next:i=>{const s=this.FindMatrixUrl(i.links);s?e=s:this.logger.log("tileurl :"+this.tileUrl+"not found"),this.drawFromMatrixUrl(i,e),this.SetZoomLevel(i),this.cdf.detectChanges()},error:i=>{this.logger.log(this.id+"error: "+JSON.stringify(i))}})}SetZoomLevel(e){e.tileMatrixSetLimits.forEach(i=>{this.minZoom||(this.minZoom=parseFloat(i.tileMatrix)+.01,this.zoom=this.minZoom),this.maxZoom=parseFloat(i.tileMatrix)+1})}FindMatrixUrl(e){let i;return e.forEach(s=>{if(s.rel=="http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"){const r=new URL(this.tileUrl);i=this.isFullURL(s.href)?s.href:new URL(r.origin+s.href).href}}),i}drawFromMatrixUrl(e,i){this.matrixsetService.getMatrixSet(i).subscribe({next:s=>{const r=[],o=[],a=[];s.tileMatrices.forEach(l=>{r[l.id]=l.cellSize,o[l.id]=this.tileUrl.includes(Tv)?[l.pointOfOrigin[1],l.pointOfOrigin[0]]:l.pointOfOrigin,a[l.id]=[l.tileWidth,l.tileHeight]}),this.tileGrid=new Ss({resolutions:r,tileSizes:a,origins:o}),this.drawMap(e)},error:s=>{this.logger.log(this.id+"tilematrixset not found: "+i,s),this.projection=new kv(this.tileUrl).Projection,this.tileGrid=new Ss({extent:this.projection.getExtent(),resolutions:this.calcResolutions(this.projection),tileSize:[256,256],origin:Gi(this.projection.getExtent())}),this.drawMap(e)}})}drawMap(e){this.map.setTarget(void 0),this.map=new ro({});const i=this.getMap();i.on("pointermove",r=>{i.forEachFeatureAtPixel(r.pixel,o=>{o&&(this._showObjectInfo&&(this.curFeature=o,this.cdf.detectChanges()),this.activeFeature.emit(o))},{hitTolerance:3})}),i.getView().on("change:resolution",()=>{const r=this.map.getView().getZoom();this.logger.log("zoom"+r),r&&(this._zoom=r,this.currentZoomLevel.next(r))}),this.SetZoomLevel(e);const s=this.elementRef.nativeElement.querySelector("[id='map']");this.mapWidth=this.elementRef.nativeElement.offsetWidth,this.mapHeight=.75*this.elementRef.nativeElement.offsetWidth,i.setTarget(s),this.cdf.detectChanges()}checkParams(){this.logger.log(this.id),this.tileUrl||this.logger.error("No TilteUrl was provided for the app-vectortile-view"),this.styleUrl||this.logger.log("No StyleUrl was provided for the app-vectortile-view"),this.centerX?this.logger.log("center-x="+this.centerX):this.logger.error("No zoom center-x was provided for the app-vectortile-view"),this.centerY?this.logger.log("center-y="+this.centerY):this.logger.error("No center-y was provided for the app-vectortile-view")}getMap(){(function(){(function(l){qi=Bt(l)})("EPSG:4326")})();const e=this.generateLayers(),i=e.layers,s=[this.centerX,this.centerY];this.vectorTileLayer=e.vectorTileLayer;const r=v_({zoom:this.maxZoom-this.minZoom>1}).extend([new vT]);return this.map=new ro({controls:r,layers:i,view:new ki({center:s,zoom:this.zoom,maxZoom:this.maxZoom,minZoom:this.minZoom,enableRotation:!1,projection:this.projection})}),this.map}generateLayers(){this.projection=new kv(this.tileUrl).Projection;const e=this.getVectorTileLayer(this.projection);this.setStyle(e);let i=[e];if(this.showGrid){const s=e.getSource();if(s){const r=s.getTileGrid();r&&(i=[e,new kg({source:new LM({template:"z:{z} y:{y} x:{x}",projection:this.projection,tileGrid:r,wrapX:s.getWrapX(),zDirection:1})})])}}return{vectorTileLayer:e,layers:i}}setStyle(e){if(this.styleUrl){const i=e.getSource()?.getProjection();pb(e,this.styleUrl).then(()=>{this.tileUrl!==lf&&e.setSource(this.getVectorTileSource(i,this.tileUrl))}).catch(s=>this.logger.error("error loading: "+this.id+" "+this.styleUrl+" "+s))}else{const i=new Ri({fill:new Ui({color:"rgba(255,255,255,0.4)"}),stroke:new Xi({color:"#3399CC",width:1.25})});e.setStyle(i)}}getVectorTileLayer(e){return new cl({source:this.getVectorTileSource(e,this.tileUrl),renderMode:"hybrid",declutter:!0,useInterimTilesOnError:!1,minZoom:-1})}calcResolutions(e){const i=ee(e.getExtent())/256,s=[];for(let r=0;r<=21;r++)s[r]=i/Math.pow(2,r);return s}getVectorTileSource(e,i){const s=new Yp({format:new Mf,projection:e,tileGrid:this.tileGrid,url:i+this.xyzSelector,cacheSize:0});return s.on(["tileloadend"],r=>{this.activeTileUrl.next(r.tile.key)}),s}isFullURL(e){return e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")}static#t=this.\u0275fac=function(e){return new(e||n)(Le(_r),Le(la),Le(QT),Le(ay))};static#e=this.\u0275cmp=Yo({type:n,selectors:[["app-vectortile-view"]],inputs:{showGrid:"showGrid",showObjectInfo:"showObjectInfo",tileUrl:"tileUrl",styleUrl:"styleUrl",id:"id",zoom:"zoom",centerX:"centerX",centerY:"centerY"},outputs:{currentZoomLevel:"currentZoomLevel",activeFeature:"activeFeature",activeTileUrl:"activeTileUrl"},standalone:!0,features:[Ol,da],decls:3,vars:5,consts:[["id","map",1,"maparea"],[1,"toprightpanel"],["class","objectinfopanel","id","objectinfo",3,"feature",4,"ngIf"],["id","objectinfo",1,"objectinfopanel",3,"feature"]],template:function(e,i){1&e&&(mi(0,"div",0)(1,"div",1),Dr(2,tI,1,1,"app-objectinfo-view",2),Si()()),2&e&&(Jl("width",i.mapWidth,"px")("height",i.mapHeight,"px"),us(2),cs("ngIf",i.showObjectInfo))},dependencies:[ga,Rd],styles:[".maparea[_ngcontent-%COMP%]{z-index:1;position:relative;display:flex;background:#fff}.toprightpanel[_ngcontent-%COMP%]{position:absolute;flex:1;top:6%;right:1%;z-index:2;max-height:90%;max-width:40%;height:100%}"],changeDetection:0})}return n})();const rc={schedule(n,t){const e=setTimeout(n,t);return()=>clearTimeout(e)},scheduleBeforeRender(n){if(typeof window>"u")return rc.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return rc.schedule(n,16);const t=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(t)}};let Gg;function eI(n,t,e){let i=e;return function(r){return!!r&&r.nodeType===Node.ELEMENT_NODE}(n)&&t.some((s,r)=>!(s==="*"||!function(a,l){if(!Gg){const h=Element.prototype;Gg=h.matches||h.matchesSelector||h.mozMatchesSelector||h.msMatchesSelector||h.oMatchesSelector||h.webkitMatchesSelector}return a.nodeType===Node.ELEMENT_NODE&&Gg.call(a,l)}(n,s)||(i=r,0))),i}class iI{constructor(t,e){this.componentFactory=e.get(Fr).resolveComponentFactory(t)}create(t){return new nI(this.componentFactory,t)}}class nI{constructor(t,e){this.componentFactory=t,this.injector=e,this.eventEmitters=new $b(1),this.events=this.eventEmitters.pipe(Db(i=>function(...r){const o=xb(r),a=function(u,c){return typeof vb(u)=="number"?u.pop():c}(r,1/0),l=r;return l.length?l.length===1?pn(l[0]):function(u=1/0){return Ju(cc,u)}(a)(Pg(l,o)):Jb}(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(We),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(this.scheduledDestroyFn!==null)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);this.componentRef===null&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=rc.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(t){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e,i){this.runInZone(()=>{i&&(e=i.call(this.componentRef?.instance,e)),this.componentRef!==null?function(r,o){return r===o||r!=r&&o!=o}(e,this.getInputValue(t))&&(e!==void 0||!this.unchangedInputs.has(t))||(this.recordInputChange(t,e),this.unchangedInputs.delete(t),this.hasInputChanges=!0,this.componentRef.instance[t]=e,this.scheduleDetectChanges()):this.initialInputValues.set(t,e)})}initializeComponent(t){const e=aa.create({providers:[],parent:this.injector}),i=function(r,o){const a=r.childNodes,l=o.map(()=>[]);let h=-1;o.some((u,c)=>u==="*"&&(h=c,!0));for(let u=0,c=a.length;u<c;++u){const d=a[u],p=eI(d,o,h);p!==-1&&l[p].push(d)}return l}(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,i,t),this.viewChangeDetectorRef=this.componentRef.injector.get(ay),this.implementsOnChanges=function(r){return typeof r=="function"}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(rh).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:t,transform:e})=>{this.initialInputValues.has(t)&&this.setInputValue(t,this.initialInputValues.get(t),e)}),this.initialInputValues.clear()}initializeOutputs(t){const e=this.componentFactory.outputs.map(({propName:i,templateName:s})=>t.instance[i].pipe(Ji(r=>({name:s,value:r}))));this.eventEmitters.next(e)}callNgOnChanges(t){if(!this.implementsOnChanges||this.inputChanges===null)return;const e=this.inputChanges;this.inputChanges=null,t.instance.ngOnChanges(e)}markViewForCheck(t){this.hasInputChanges&&(this.hasInputChanges=!1,t.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=rc.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(t,e){if(!this.implementsOnChanges)return;this.inputChanges===null&&(this.inputChanges={});const i=this.inputChanges[t];if(i)return void(i.currentValue=e);const s=this.unchangedInputs.has(t),r=s?void 0:this.getInputValue(t);this.inputChanges[t]=new S0(r,e,s)}detectChanges(){this.componentRef!==null&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}}class sI extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function oc(n,t){const e=function(a,l){return l.get(Fr).resolveComponentFactory(a).inputs}(n,t.injector),i=t.strategyFactory||new iI(n,t.injector),s=function(a){const l={};return a.forEach(({propName:h,templateName:u,transform:c})=>{l[function(p){return p.replace(/[A-Z]/g,f=>`-${f.toLowerCase()}`)}(u)]=[h,c]}),l}(e);class r extends sI{static#t=this.observedAttributes=Object.keys(s);get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||t.injector);e.forEach(({propName:l,transform:h})=>{if(!this.hasOwnProperty(l))return;const u=this[l];delete this[l],a.setInputValue(l,u,h)})}return this._ngElementStrategy}constructor(a){super(),this.injector=a}attributeChangedCallback(a,l,h,u){const[c,d]=s[a];this.ngElementStrategy.setInputValue(c,h,d)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(l)})}}return e.forEach(({propName:o,transform:a})=>{Object.defineProperty(r.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(l){this.ngElementStrategy.setInputValue(o,l,a)},configurable:!0,enumerable:!0})}),r}function rI(n,t){if(1&n&&(mi(0,"tr")(1,"td"),zr(2),Si(),mi(3,"td"),zr(4),Si()()),2&n){const e=t.$implicit;us(2),ih(e.title),us(2),ih(e.value)}}function oI(n,t){if(1&n&&(mi(0,"table",2)(1,"caption",3),zr(2," Object Informatie: "),Si(),mi(3,"thead")(4,"th",4),zr(5,"Veld"),Si(),mi(6,"th",5),zr(7,"Waarde"),Si()(),mi(8,"tbody"),Dr(9,rI,5,2,"tr",6),Si()()),2&n){const e=eh();us(9),cs("ngForOf",e.getFeatureProperties())}}let aI=(()=>{class n{getFeatureProperties(){const e=[];if(this.feature){const i=this.feature.getProperties();for(const s in i)s!=="mapbox-layer"&&e.push({title:s,value:i[s]});return e}return[]}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275cmp=Yo({type:n,selectors:[["app-object-info"]],inputs:{feature:"feature"},standalone:!0,features:[da],decls:2,vars:1,consts:[["tabindex","0",1,"objectinfo"],["class","featuretable",4,"ngIf"],[1,"featuretable"],[1,"featuretablecaption"],["id","Veld"],["id","Waarde"],[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(mi(0,"div",0),Dr(1,oI,10,1,"table",1),Si()),2&e&&(us(),cs("ngIf",i.getFeatureProperties().length>0))},dependencies:[ga,jy,Rd],styles:[`.objectinfo{margin-top:0;margin-bottom:0;margin-right:0;background-color:#fff;overflow-y:auto;overflow-x:auto;max-height:98%}.featuretable{text-align:left}.featuretablecaption{text-align:left;font-weight:700}
`],encapsulation:3})}return n})();var ss=function(n){return n.Circle="circle",n.Fill="fill",n.Line="line",n.Raster="raster",n.Symbol="symbol",n}(ss||{});let i2=(()=>{class n{constructor(e){this.http=e}getMapboxStyle(e){return this.http.get(e)}getLayersids(e){const i=[];return e.layers.forEach(s=>{i.push(s.id)}),i}removeRasterLayers(e){return e.layers=e.layers.filter(i=>i.type!==ss.Raster),e}isFillPatternWithStops(e){return e.stops!==void 0}getItems(e,i,s){const r=[];return e.layers.forEach(o=>{const a=function(h,u){return function c(d){if(Array.isArray(d)){const p=d[0],f=d.slice(1);p==="all"||p==="any"?f.forEach(g=>c(g)):(typeof d[1]=="string"&&typeof d[2]=="string"&&(h[d[1]]=d[2]),typeof d[1]=="string"&&typeof d[2]=="number"&&(h[d[1]]=d[2]))}}(u),h}({},o.filter);if(o.layout?.["text-field"]){const l=o.layout?.["text-field"].replace("{","").replace("}","");a[""+l]=l.substring(0,6);const h=i(o["source-layer"],a,s,o.id),u=l[0].toUpperCase()+l.substring(1);this.pushItem(h+" "+u,o,r,a)}else{let l=i(o["source-layer"],a,s,o.id);this.pushItem(l,o,r,a);let h={};o.type==ss.Circle&&(h=o.paint["circle-color"]),o.type==ss.Fill&&(h=o.paint["fill-color"],h||(h=o.paint["fill-pattern"])),h&&this.isFillPatternWithStops(h)&&h.stops.forEach(u=>{const c={};c[""+h.property]=u[0],l=u[0],this.pushItem(l,o,r,c)})}}),r.sort((o,a)=>o.title.localeCompare(a.title))}capitalizeFirstLetter(e){return[...e][0].toUpperCase()+e.slice(1)}idTitle(e,i,s,r){return r}customTitle(e,i,s){let r="";return s.forEach(o=>{r=function(l,h){return i[h]?l+" "+i[h]:l}(r,o)}),r===""&&(r=e+" "),r=r.trimStart(),r=r.replace("_"," "),[...r][0].toUpperCase()+r.slice(1)}pushItem(e,i,s,r={}){s.find(o=>o.title===e)||s.push({name:i.id,title:e,geoType:i.type,style:[],sourceLayer:i["source-layer"],feature:void 0,properties:r})}static#t=this.\u0275fac=function(e){return new(e||n)(ot(ic))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lI=(()=>{class n{constructor(e,i,s){this.logger=e,this.mapboxStyleService=i,this.elementRef=s,this._itemHeight=40,this._itemWidth=60,this.itemLeft=10,this.itemRight=50,this.extent=[0,0,this.itemWidth,this.itemHeight],this.projection=new Un({code:"pixel-map",units:"pixels",extent:this.extent}),this.map=new ro({}),this.vectorSource=new Yp({format:new Mf,projection:this.projection}),this.vectorLayer=new cl({source:this.vectorSource})}get itemHeight(){return this._itemHeight}get itemWidth(){return this._itemWidth}ngOnInit(){const e=this.newFeature(this.item);this.map=new ro({controls:[],interactions:[],layers:[this.vectorLayer],view:new ki({projection:this.projection,center:ln(this.extent),zoom:2,minZoom:2,maxZoom:2})}),this.vectorLayer.getSource()?.setTileLoadFunction(r=>{const o=r;o.setLoader(()=>{const a=[];a.push(e),o.setFeatures(a)})});const i=[];i.push(1);const s=this.mapboxStyleService.getLayersids(this.mapboxStyle);pb(this.vectorLayer,this.mapboxStyle,s,void 0,i).then(()=>{this.vectorLayer.getSource()?.refresh();const r=this.elementRef.nativeElement.querySelector("[id='itemmap']");this.map.setTarget(r)}).catch(r=>{this.logger.error("error loading legend style:  "+r)})}newFeature(e){switch(e.geoType){case ss.Fill:{const i=Nh(this.extent);i.scale(.05,.05);const s=new Tn({geometry:i,layer:e.sourceLayer});return s.setProperties(e.properties),s}case ss.Circle:case ss.Raster:case ss.Symbol:{const i=new Tn({geometry:new Hn(ln(this.extent)),layer:e.sourceLayer});return i.setProperties(e.properties),i}case ss.Line:{const i=this.itemHeight/2,s=new Tn({geometry:new $n([[this.itemLeft,i],[this.itemRight,i]]),layer:e.sourceLayer});return s.setProperties(e.properties),s}default:(function(s){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(s)}`)})(e.geoType)}}static#t=this.\u0275fac=function(e){return new(e||n)(Le(_r),Le(i2),Le(la))};static#e=this.\u0275cmp=Yo({type:n,selectors:[["app-legend-item"]],inputs:{item:"item",mapboxStyle:"mapboxStyle"},standalone:!0,features:[da],decls:1,vars:4,consts:[["id","itemmap",1,"legenditem"]],template:function(e,i){1&e&&Nr(0,"div",0),2&e&&Jl("width",i.itemWidth,"px")("height",i.itemHeight,"px")},changeDetection:0})}return n})();function hI(n,t){if(1&n&&(mi(0,"div",3),Nr(1,"app-legend-item",4),mi(2,"div",5),zr(3),Si()()),2&n){const e=t.$implicit,i=eh(2);us(),cs("item",e)("mapboxStyle",i.mapboxStyle),us(2),ih(e.title)}}function uI(n,t){if(1&n&&(mi(0,"div",1),Dr(1,hI,4,3,"div",2),Si()),2&n){const e=eh();us(),cs("ngForOf",e.LegendItems)}}let cI=(()=>{class n{constructor(e,i,s){this.logger=e,this.mapboxStyleService=i,this.elementRef=s,this.LegendItems=[],function(o=!1){db=o}(!0)}ngOnChanges(e){e.styleUrl?.previousValue!==e.styleUrl?.currentValue&&(e.styleUrl.isFirstChange()||this.generateLegend()),this.titleItems&&e.titleItems.previousValue!==e.titleItems.currentValue&&(e.titleItems.isFirstChange()||this.generateLegend())}ngOnInit(){this.generateLegend()}generateLegend(){this.styleUrl?this.mapboxStyleService.getMapboxStyle(this.styleUrl).subscribe(e=>{if(this.mapboxStyle=this.mapboxStyleService.removeRasterLayers(e),this.titleItems)if(this.titleItems.toLocaleLowerCase()==="id")this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.idTitle,[]);else{const i=this.titleItems.split(",");this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.customTitle,i)}else this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.capitalizeFirstLetter,[])}):this.logger.error("no style url supplied")}static#t=this.\u0275fac=function(e){return new(e||n)(Le(_r),Le(i2),Le(la))};static#e=this.\u0275cmp=Yo({type:n,selectors:[["app-legend-view"]],inputs:{styleUrl:"styleUrl",titleItems:"titleItems"},standalone:!0,features:[Ol,da],decls:1,vars:1,consts:[["class","legendContainer",4,"ngIf"],[1,"legendContainer"],["class","legendItem",4,"ngFor","ngForOf"],[1,"legendItem"],[3,"item","mapboxStyle"],[1,"legendText"]],template:function(e,i){1&e&&Dr(0,uI,2,1,"div",0),2&e&&cs("ngIf",i.LegendItems.length>0)},dependencies:[ga,jy,Rd,lI],styles:[".legendContainer[_ngcontent-%COMP%]{display:flex;flex:0 1 auto;flex-wrap:wrap;flex-direction:column;justify-content:flex-start;align-items:flex-start;max-height:100%;padding:5px;margin:5px;min-height:0}.legendItem[_ngcontent-%COMP%]{max-width:23vw;display:flex;flex-wrap:nowrap;flex-direction:row;align-items:center;flex:0 1 auto}.legendText[_ngcontent-%COMP%]{font-size:calc((var(--h) / 3));margin-left:1em}"]})}return n})();const dI=class extends an{constructor(t){super(),this.options=t,this.id=t.id,this.insertFirst=t.insertFirst===void 0||t.insertFirst,this.stopEvent=t.stopEvent===void 0||t.stopEvent,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener("element",this.handleElementChanged),this.addChangeListener("map",this.handleMapChanged),this.addChangeListener("offset",this.handleOffsetChanged),this.addChangeListener("position",this.handlePositionChanged),this.addChangeListener("positioning",this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get("element")}getId(){return this.id}getMap(){return this.get("map")||null}getOffset(){return this.get("offset")}getPosition(){return this.get("position")}getPositioning(){return this.get("positioning")}handleElementChanged(){f_(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(Bh(this.element),me(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=Dt(t,"postrender",this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set("element",t)}setMap(t){this.set("map",t)}setOffset(t){this.set("offset",t)}setPosition(t){this.set("position",t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get("position"))return;const i=this.getRect(e.getTargetElement(),e.getSize()),s=this.getElement(),r=this.getRect(s,[sM(s),rM(s)]),o=(t=t||{}).margin===void 0?20:t.margin;if(!_s(i,r)){const a=r[0]-i[0],l=i[2]-r[2],h=r[1]-i[1],u=i[3]-r[3],c=[0,0];if(a<0?c[0]=a-o:l<0&&(c[0]=Math.abs(l)+o),h<0?c[1]=h-o:u<0&&(c[1]=Math.abs(u)+o),c[0]!==0||c[1]!==0){const d=e.getView().getCenterInternal(),p=e.getPixelFromCoordinateInternal(d);if(!p)return;const f=[p[0]+c[0],p[1]+c[1]],g=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(f),duration:g.duration,easing:g.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),s=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[s,r,s+e[0],r+e[1]]}setPositioning(t){this.set("positioning",t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),s=t.getSize();this.updateRenderedPosition(i,s)}updateRenderedPosition(t,e){const i=this.element.style,s=this.getOffset(),r=this.getPositioning();this.setVisible(!0);let o="0%",a="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?o="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(o="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?a="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(a="-50%");const l=`translate(${o}, ${a}) translate(${Math.round(t[0]+s[0])+"px"}, ${Math.round(t[1]+s[1])+"px"})`;this.rendered.transform_!=l&&(this.rendered.transform_=l,i.transform=l)}getOptions(){return this.options}},pI=class extends q_{constructor(t){let e;e=(t=t||{}).attributions!==void 0?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin!==void 0?t.crossOrigin:"anonymous",interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,opaque:t.opaque===void 0||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:t.wrapX,zDirection:t.zDirection})}};function n2(n,t){const e=[];Object.keys(t).forEach(function(s){t[s]!=null&&e.push(s+"="+encodeURIComponent(t[s]))});const i=e.join("&");return n=n.replace(/[?&]$/,""),(n+=n.includes("?")?"&":"?")+i}const fI=class extends Zp{constructor(t){const e=t.requestEncoding!==void 0?t.requestEncoding:"KVP",i=t.tileGrid;let s=t.urls;s===void 0&&t.url!==void 0&&(s=Hp(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:s,wrapX:t.wrapX!==void 0&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=t.version!==void 0?t.version:"1.0.0",this.format_=t.format!==void 0?t.format:"image/jpeg",this.dimensions_=t.dimensions!==void 0?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),s&&s.length>0&&(this.tileUrlFunction=Up(s.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join(`
`);this.setTileUrlFunction(Up(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e=="KVP"?n2(t,i):t.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const s=this.tileGrid,r=this.dimensions_;return function(o,a,l){if(!o)return;const h={TileMatrix:s.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,r);let u=t;return u=e=="KVP"?n2(u,h):u.replace(/\{(\w+?)\}/g,function(c,d){return h[d]}),u}}},gI=class extends Ss{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}},s2={bgtBackgroundUrl:"https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0?",loglevel:ze.OFF},r2={dataProjection:"EPSG:4326",visualProjection:"EPSG:3857"};let mI=(()=>{class n{constructor(e,i){this.logger=e,this.http=i}getFeatures(e){return this.logger.log(JSON.stringify(e)),this.http.get(e.url).pipe(Ji(i=>new Cf().readFeatures(i,{dataProjection:e.dataMapping.dataProjection,featureProjection:e.dataMapping.visualProjection})))}getProjectionMapping(e="http://www.opengis.net/def/crs/OGC/1.3/CRS84"){return Iv(),e?typeof e=="string"?e.substring(e.lastIndexOf("/")+1).toLocaleUpperCase()==="CRS84"?r2:e.toLowerCase().startsWith("http://www.opengis.net/def/crs/epsg/")?{dataProjection:"EPSG:"+e.substring(e.lastIndexOf("/")+1),visualProjection:"EPSG:3857"}:{dataProjection:e,visualProjection:e}:(this.logger.error("wrong value:"),this.logger.error(e),e):{dataProjection:e,visualProjection:e}}static#t=this.\u0275fac=function(e){return new(e||n)(ot(_r),ot(ic))};static#e=this.\u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class qg extends bs{constructor(t,e,i){super(),i!==void 0&&e===void 0?this.setFlatCoordinates(i,t):this.setCenterAndRadius(t,e=e||0,i)}clone(){const t=new qg(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){const r=this.flatCoordinates,o=t-r[0],a=e-r[1],l=o*o+a*a;if(l<s){if(l===0)for(let h=0;h<this.stride;++h)i[h]=r[h];else{const h=this.getRadius()/Math.sqrt(l);i[0]=r[0]+h*o,i[1]=r[1]+h*a;for(let u=2;u<this.stride;++u)i[u]=r[u]}return i.length=this.stride,l}return s}containsXY(t,e){const i=this.flatCoordinates,s=t-i[0],r=e-i[1];return s*s+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return xn(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){if(Fe(t,this.getExtent())){const e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||Zd(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],s=t.slice();s[e]=s[0]+i;for(let r=1;r<e;++r)s[e+r]=t[r];this.setFlatCoordinates(this.layout,s),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const s=this.flatCoordinates;let r=K1(s,0,t);s[r++]=s[0]+e;for(let o=1,a=this.stride;o<a;++o)s[r++]=s[o];s.length=r,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),s=this.getStride();this.setCenter(gp(i,0,i.length,s,t,e,i)),this.changed()}}const yI=qg;class ac extends yn{constructor(t,e){super(t),this.feature=e}}function lc(n,t){return Wn(n[0],n[1],t[0],t[1])}function qo(n,t){const e=n.length;return t<0?n[t+e]:t>=e?n[t-e]:n[t]}function hc(n,t,e){let i,s;t<e?(i=t,s=e):(i=e,s=t);const r=Math.ceil(i),o=Math.floor(s);if(r>o)return lc(Vo(n,i),Vo(n,s));let a=0;i<r&&(a+=lc(Vo(n,i),qo(n,r))),o<s&&(a+=lc(qo(n,o),Vo(n,s)));for(let l=r;l<o-1;++l)a+=lc(qo(n,l),qo(n,l+1));return a}function o2(n,t,e){if(t instanceof $n)uc(n,t.getCoordinates(),!1,e);else if(t instanceof du){const i=t.getCoordinates();for(let s=0,r=i.length;s<r;++s)uc(n,i[s],!1,e)}else if(t instanceof Cs){const i=t.getCoordinates();for(let s=0,r=i.length;s<r;++s)uc(n,i[s],!0,e)}else if(t instanceof fu){const i=t.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s];for(let a=0,l=o.length;a<l;++a)uc(n,o[a],!0,e)}}else if(t instanceof jv){const i=t.getGeometries();for(let s=0;s<i.length;++s)o2(n,i[s],e)}}const Vg={index:-1,endIndex:NaN};function uc(n,t,e,i){const s=n[0],r=n[1];for(let o=0,a=t.length-1;o<a;++o){const l=a2(s,r,t[o],t[o+1]);if(l.squaredDistance===0){const h=o+l.along;return void i.push({coordinates:t,ring:e,startIndex:h,endIndex:h})}}}const Bg={along:0,squaredDistance:0};function a2(n,t,e,i){const s=e[0],r=e[1],o=i[0]-s,a=i[1]-r;let l=0,h=s,u=r;return(o!==0||a!==0)&&(l=Te(((n-s)*o+(t-r)*a)/(o*o+a*a),0,1),h+=o*l,u+=a*l),Bg.along=l,Bg.squaredDistance=Ch(Wn(n,t,h,u),10),Bg}function Vo(n,t){const e=n.length;let i=Math.floor(t);const s=t-i;i>=e?i-=e:i<0&&(i+=e);let r=i+1;r>=e&&(r-=e);const o=n[i],a=o[0],l=o[1],h=n[r];return[a+(h[0]-a)*s,l+(h[1]-l)*s]}function _I(){const n=function(){const e={},i=[255,255,255,1],s=[0,153,255,1];return e.Polygon=[new Fs({fill:new Ui({color:[255,255,255,.5]})})],e.MultiPolygon=e.Polygon,e.LineString=[new Fs({stroke:new Xi({color:i,width:5})}),new Fs({stroke:new Xi({color:s,width:3})})],e.MultiLineString=e.LineString,e.Circle=e.Polygon.concat(e.LineString),e.Point=[new Fs({image:new tl({radius:6,fill:new Ui({color:s}),stroke:new Xi({color:i,width:1.5})}),zIndex:1/0})],e.MultiPoint=e.Point,e.GeometryCollection=e.Polygon.concat(e.LineString,e.Point),e}();return function(t,e){return n[t.getGeometry().getType()]}}const vI=class extends so{constructor(t){const e=t;e.stopDown||(e.stopDown=Gr),super(e),this.shouldHandle_=!1,this.downPx_=null,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(r){switch(r){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+r)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:jr,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const s=this.mode_;if(s==="Circle")i=function(r,o,a){const l=o||new yI([NaN,NaN]),h=Vi(r[0],a),u=P1(h,Vi(r[r.length-1],a));l.setCenterAndRadius(h,Math.sqrt(u),this.geometryLayout_);const c=Ta();return c&&l.transform(a,c),l};else{let r;s==="Point"?r=Hn:s==="LineString"?r=$n:s==="Polygon"&&(r=Cs),i=function(o,a,l){return a?a.setCoordinates(s==="Polygon"?o[0].length?[o[0].concat([o[0][0]])]:[]:o,this.geometryLayout_):a=new r(o,this.geometryLayout_),a}}}this.geometryFunction_=i,this.dragVertexDelay_=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Eu({source:new dr({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:_I(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:zp,this.freehandCondition_=t.freehand?Np:t.freehandCondition?t.freehandCondition:w_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener("active",this.updateState_)}setTrace(t){let e;e=t?t===!0?Np:t:mM,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type==="contextmenu"&&t.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(t);let e=t.type===ie.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===ie.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===ie.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===ie.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===ie.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===ie.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(t)):t.type===ie.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Zn(ie.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active)return void this.deactivateTrace_();const e=this.getMap(),i=_a([e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_])]),s=this.traceSource_.getFeaturesInExtent(i);if(s.length===0)return;const r=function(a,l){const h=[];for(let u=0;u<l.length;++u)o2(a,l[u].getGeometry(),h);return h}(t.coordinate,s);r.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex;i===t.startIndex<=e?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const s=Math.ceil(t);let r=Math.floor(e);r===e&&(r-=1),i=r-s+1}else{const s=Math.floor(t);let r=Math.ceil(e);r===e&&(r+=1),i=s-r+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const s=[];if(e<i){const r=Math.ceil(e);let o=Math.floor(i);o===i&&(o-=1);for(let a=r;a<=o;++a)s.push(qo(t.coordinates,a))}else{const r=Math.floor(e);let o=Math.ceil(i);o===i&&(o+=1);for(let a=r;a>=o;--a)s.push(qo(t.coordinates,a))}s.length&&this.appendCoordinates(s)}updateTrace_(t){const e=this.traceState_;if(!e.active||e.targetIndex===-1&&R1(e.startPx,t.pixel)<this.snapTolerance_)return;const i=function(l,h,u,c){const d=l[0],p=l[1];let f=1/0,g=-1,m=NaN;for(let v=0;v<h.targets.length;++v){const x=h.targets[v],b=x.coordinates;let M,w=1/0;for(let S=0;S<b.length-1;++S){const k=a2(d,p,b[S],b[S+1]);k.squaredDistance<w&&(w=k.squaredDistance,M=S+k.along)}w<f&&(f=w,x.ring&&h.targetIndex===v&&(x.endIndex>x.startIndex?M<x.startIndex&&(M+=b.length):x.endIndex<x.startIndex&&M>x.startIndex&&(M-=b.length)),m=M,g=v)}const y=h.targets[g];let _=y.ring;if(h.targetIndex===g&&_){const v=Vo(y.coordinates,m);R1(u.getPixelFromCoordinate(v),h.startPx)>c&&(_=!1)}if(_){const v=y.coordinates,x=v.length,b=y.startIndex,M=m;if(b<M){const w=hc(v,b,M);hc(v,b,M-x)<w&&(m-=x)}else{const w=hc(v,b,M);hc(v,b,M+x)<w&&(m+=x)}}return Vg.index=g,Vg.endIndex=m,Vg}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(e.targetIndex!==-1){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=e.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else this.addOrRemoveTracedCoordinates_(e.targets[e.targetIndex],i.endIndex);e.targetIndex=i.index;const s=e.targets[e.targetIndex];s.endIndex=i.endIndex;const r=Vo(s.coordinates,s.endIndex),o=this.getMap().getPixelFromCoordinate(r);t.coordinate=r,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(t){let e=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const s=!this.finishCoordinate_;s&&this.startDrawing_(t.coordinate),!s&&this.freehand_?this.finishDrawing():!this.freehand_&&(!s||this.mode_==="Point")&&(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,s=e[0]-i[0],r=e[1]-i[1],o=s*s+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(t),this.modifyDrawing_(t.coordinate)):this.createOrUpdateSketchPoint_(t.coordinate.slice())}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let s=!1,r=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")i=!0;else if(o==="Circle")i=this.sketchCoords_.length===2;else if(o==="LineString")s=!e&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;s=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],r=e?[a[0][0]]:[a[0][0],a[0][a[0].length-2]]}if(s){const a=this.getMap();for(let l=0,h=r.length;l<h;l++){const u=r[l],c=a.getPixelFromCoordinate(u),d=t[0]-c[0],p=t[1]-c[1],f=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(d*d+p*p)<=f,i){this.finishCoordinate_=u;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new Tn(new Hn(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new Tn);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new $n(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=Rh(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,this.mode_==="Point"?this.sketchCoords_=t.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Tn(new $n(this.sketchLineCoords_)));const s=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new Tn,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(s),this.updateSketchFeatures_(),this.dispatchEvent(new ac("drawstart",this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),s=e.getView().getProjection(),r=Rh(this.geometryLayout_);let o,a;for(;t.length<r;)t.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=t[0],a[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let s,r;const o=this.mode_;o==="LineString"||o==="Circle"?(this.finishCoordinate_=t.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(t.slice()),this.geometryFunction_(r,e,i)):o==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(t.slice()),s&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),s&&this.finishDrawing()}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),s=this.mode_;for(let r=0;r<t;++r){let o;if(s==="LineString"||s==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,i),e.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(s==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,i)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry(),s=this.getMap().getView().getProjection();this.mode_==="LineString"?(e.pop(),this.geometryFunction_(e,i,s)):this.mode_==="Polygon"&&(e[0].pop(),this.geometryFunction_(e,i,s),e=i.getCoordinates()),this.type_==="MultiPoint"?t.setGeometry(new uu([e])):this.type_==="MultiLineString"?t.setGeometry(new du([e])):this.type_==="MultiPolygon"&&t.setGeometry(new fu([e])),this.dispatchEvent(new ac("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new ac("drawabort",t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;let s;if(i&&this.startDrawing_(t[0]),e==="LineString"||e==="Circle")s=this.sketchCoords_;else{if(e!=="Polygon")return;s=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&s.shift(),s.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const r=t[t.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}extend(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new Tn(new Hn(i)),this.updateSketchFeatures_(),this.dispatchEvent(new ac("drawstart",this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}};class xI extends Da{constructor(t,e){const i=e||{},s=document.createElement("button"),r=document.createElement("div");r.className="boundingboxcontrol ol-unselectable ol-control",s.title="Draw boundingbox",r.appendChild(s),super({element:r,target:i.target}),this.boxEmitter=t,s.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" class = "innersvg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M368 80h32v32H368V80zM352 32c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3 0 64v64c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32H96c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V384c0-17.7-14.3-32-32-32V160c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32H352zM96 160c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32V160zM48 400H80v32H48V400zm320 32V400h32v32H368zM48 112V80H80v32H48z"/></svg>
      `,s.addEventListener("click",this.addBox.bind(this),!1)}addBox(){const t=new vI({source:new dr({}),type:"Circle",geometryFunction:function(e,i,s){const r=_a([e[0],e[e.length-1]].map(function(l){return Vi(l,s)})),o=[[Wr(r),xa(r),ba(r),Gi(r),Wr(r)]];i?i.setCoordinates(o):i=new Cs(o);const a=Ta();return a&&i.transform(s,a),i}});t.on("drawend",e=>{const i=this.getMap(),s=e.feature,r=s.getGeometry();if(r){if(i.getView().getProjection().getCode()==="EPSG:3857"){const h=r.transform(i.getView().getProjection(),"EPSG:4326").getExtent().join(",");this.boxEmitter.emit(h)}else{const h=r.getExtent().join(",");this.boxEmitter.emit(h)}const o=new Ri({stroke:new Xi({color:"blue",width:3}),fill:new Ui({color:"rgba(0, 0, 255, 0.06)"})}),a=new dr({});a.addFeature(s);const l=new Eu({source:a,style:o});i.addLayer(l),i.removeInteraction(t)}}),this.getMap().addInteraction(t)}}let bI=(()=>{class n{set projection(e){this._projection=this.featureService.getProjectionMapping(e)}set showBoundingBoxButton(e){this._showBoundingBoxButton=function(s){return s!=null&&`${s}`!="false"}(e)}get showBoundingBoxButton(){return this._showBoundingBoxButton}constructor(e,i){this.el=e,this.featureService=i,this._projection=r2,this.backgroundMap="OSM",this._showBoundingBoxButton=!0,this.box=new Mi,this.activeFeature=new Mi,this.mapHeight=400,this.mapWidth=600,this.map=this.getMap(),this.features=[]}getMap(){return new ro({view:new ki({projection:this._projection.visualProjection})})}init(){this.mapWidth=.99*this.el.nativeElement.offsetWidth,this.mapHeight=.75*this.mapWidth;const e=this.el.nativeElement.querySelector("#featuremap");this.map.setTarget(e),this.featureService.getFeatures({url:this.itemsUrl,dataMapping:this._projection}).pipe(jg(1)).subscribe(i=>{this.features=i,this.map.setLayerGroup(new La),this.loadFeatures(this.features),this.loadBackground()})}ngAfterViewInit(){this._showBoundingBoxButton&&this.map.addControl(new xI(this.box,{})),this.addFeatureEmit()}ngOnChanges(e){(e.itemsUrl?.previousValue!==e.itemsUrl?.currentValue||e.projection?.previousValue!==e.projection?.currentValue)&&e.itemsUrl?.currentValue&&this.init()}loadBackground(){switch(this.backgroundMap){case"OSM":{const e=new kg({source:new pI});return void this.map.addLayer(e)}case"BRT":return void this.map.addLayer(this.brtLayer(function(){const i=new Un({code:"EPSG:3857",units:"m",extent:[-20037508342789244e-9,-20037508342789244e-9,20037508342789244e-9,20037508342789244e-9],worldExtent:[-180,-85,180,85],axisOrientation:"enu",global:!0}),s=ee(i.getExtent())/256,r=new Array(20),o=new Array(20);for(let a=0;a<20;++a)r[a]=s/Math.pow(2,a),o[a]=("0"+a).slice(-2);return{projection:i,resolutions:r,matrixIds:o}}()));default:(function(i){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(i)}`)})(this.backgroundMap)}}loadFeatures(e){const i=new dr({features:e});this.map.addLayer(new Eu({source:i,style:this.getStyle(),zIndex:10}));const s=i.getExtent();return e.length>0&&this.setViewExtent(s,e.length<3?10:1.05),s}getStyle(){const e=new Ui({color:"rgba(0,0,255)"}),i=new Xi({color:"#3399CC",width:1.25});return[new Ri({image:new tl({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}setViewExtent(e,i){const s=new ki({}),r={size:this.map.getSize()},o=Nh(e);o.scale(i),s.fit(o,r),this.map.setView(s)}brtLayer(e){return new kg({source:new fI({attributions:'Kaartgegevens: &copy; <a href="https://www.kadaster.nl">Kadaster</a>',url:s2.bgtBackgroundUrl,layer:"grijs",matrixSet:e.projection.getCode(),format:"image/png",projection:e.projection,tileGrid:new gI({origin:Gi(e.projection.getExtent()),resolutions:e.resolutions,matrixIds:e.matrixIds}),style:"default",wrapX:!1})})}addFeatureEmit(){const e=this.el.nativeElement.querySelector("[id='tooltip']");e.style.visibility="hidden";const i=this.el.nativeElement.querySelector("[id='tooltip-content']"),s=new dI({element:e,autoPan:{duration:250}});this.map.addOverlay(s),this.map.on("pointermove",r=>{this.map.forEachFeatureAtPixel(r.pixel,o=>{if(o){const a=o.getId();if(a){const l="items",h=this.itemsUrl.toLowerCase(),u=new URL(h.substring(0,h.indexOf(l)+l.length));i.innerHTML='<a href="'+u.protocol+"//"+u.host+u.pathname+"/"+a+'">'+a+"</a>";const c=o.getGeometry();c&&(s.setPosition(ln(c.getExtent())),e.style.visibility="visible"),this.activeFeature.emit(o)}}},{hitTolerance:3})})}static#t=this.\u0275fac=function(e){return new(e||n)(Le(la),Le(mI))};static#e=this.\u0275cmp=Yo({type:n,selectors:[["app-feature-view"]],inputs:{itemsUrl:"itemsUrl",backgroundMap:"backgroundMap",projection:"projection",showBoundingBoxButton:"showBoundingBoxButton"},outputs:{box:"box",activeFeature:"activeFeature"},standalone:!0,features:[Ol,da],decls:3,vars:4,consts:[["id","featuremap",1,"featuremaparea"],["id","tooltip",1,"maptooltip"],["id","tooltip-content"]],template:function(e,i){1&e&&(Nr(0,"div",0),mi(1,"div",1),Nr(2,"div",2),Si()),2&e&&Jl("width",i.mapWidth,"px")("height",i.mapHeight,"px")},styles:[".featuremaparea[_ngcontent-%COMP%]{height:100vh}.maptooltip[_ngcontent-%COMP%]{visibility:hidden;font-weight:700;margin:1px;text-decoration:none;text-align:center;border-radius:2px;font-size:16px;background-color:#fff;border:1px solid rgb(26,30,79);padding:5px 10px}"],changeDetection:0})}return n})(),wI=(()=>{class n{constructor(e){this.injector=e;const i=oc(e2,{injector:e});customElements.define("app-vectortile-view",i);const s=oc(aI,{injector:e});customElements.define("app-objectinfo-view",s);const r=oc(cI,{injector:e});customElements.define("app-legend-view",r);const o=oc(bI,{injector:e});customElements.define("app-feature-view",o)}ngDoBootstrap(){}static#t=this.\u0275fac=function(e){return new(e||n)(ot(aa))};static#e=this.\u0275mod=xr({type:n});static#i=this.\u0275inj=vr({imports:[IC,zT,e2,JT.forRoot({serverLoggingUrl:"/api/logs",level:s2.loglevel,serverLogLevel:ze.OFF})]})}return n})();MC().bootstrapModule(wI).catch(n=>console.error(n))},605:qe=>{"use strict";qe.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},20:(qe,Fn)=>{Fn.read=function(ke,Tt,Z,Et,Ot){var It,dt,pe=8*Ot-Et-1,he=(1<<pe)-1,Pe=he>>1,rt=-7,xe=Z?Ot-1:0,Ae=Z?-1:1,_e=ke[Tt+xe];for(xe+=Ae,It=_e&(1<<-rt)-1,_e>>=-rt,rt+=pe;rt>0;It=256*It+ke[Tt+xe],xe+=Ae,rt-=8);for(dt=It&(1<<-rt)-1,It>>=-rt,rt+=Et;rt>0;dt=256*dt+ke[Tt+xe],xe+=Ae,rt-=8);if(It===0)It=1-Pe;else{if(It===he)return dt?NaN:1/0*(_e?-1:1);dt+=Math.pow(2,Et),It-=Pe}return(_e?-1:1)*dt*Math.pow(2,It-Et)},Fn.write=function(ke,Tt,Z,Et,Ot,It){var dt,pe,he,Pe=8*It-Ot-1,rt=(1<<Pe)-1,xe=rt>>1,Ae=Ot===23?Math.pow(2,-24)-Math.pow(2,-77):0,_e=Et?0:It-1,be=Et?1:-1,A=Tt<0||Tt===0&&1/Tt<0?1:0;for(Tt=Math.abs(Tt),isNaN(Tt)||Tt===1/0?(pe=isNaN(Tt)?1:0,dt=rt):(dt=Math.floor(Math.log(Tt)/Math.LN2),Tt*(he=Math.pow(2,-dt))<1&&(dt--,he*=2),(Tt+=dt+xe>=1?Ae/he:Ae*Math.pow(2,1-xe))*he>=2&&(dt++,he/=2),dt+xe>=rt?(pe=0,dt=rt):dt+xe>=1?(pe=(Tt*he-1)*Math.pow(2,Ot),dt+=xe):(pe=Tt*Math.pow(2,xe-1)*Math.pow(2,Ot),dt=0));Ot>=8;ke[Z+_e]=255&pe,_e+=be,pe/=256,Ot-=8);for(dt=dt<<Ot|pe,Pe+=Ot;Pe>0;ke[Z+_e]=255&dt,_e+=be,dt/=256,Pe-=8);ke[Z+_e-be]|=128*A}},496:(qe,Fn,ke)=>{"use strict";qe.exports=Z;var Tt=ke(20);function Z(C){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(C)?C:new Uint8Array(C||0),this.pos=0,this.type=0,this.length=this.buf.length}Z.Varint=0,Z.Fixed64=1,Z.Bytes=2,Z.Fixed32=5;var Et=4294967296,Ot=1/Et,It=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function dt(C){return C.type===Z.Bytes?C.readVarint()+C.pos:C.pos+1}function pe(C,T,z){var it=T<=16383?1:T<=2097151?2:T<=268435455?3:Math.floor(Math.log(T)/(7*Math.LN2));z.realloc(it);for(var Q=z.pos-1;Q>=C;Q--)z.buf[Q+it]=z.buf[Q]}function he(C,T){for(var z=0;z<C.length;z++)T.writeVarint(C[z])}function Pe(C,T){for(var z=0;z<C.length;z++)T.writeSVarint(C[z])}function rt(C,T){for(var z=0;z<C.length;z++)T.writeFloat(C[z])}function xe(C,T){for(var z=0;z<C.length;z++)T.writeDouble(C[z])}function Ae(C,T){for(var z=0;z<C.length;z++)T.writeBoolean(C[z])}function _e(C,T){for(var z=0;z<C.length;z++)T.writeFixed32(C[z])}function be(C,T){for(var z=0;z<C.length;z++)T.writeSFixed32(C[z])}function A(C,T){for(var z=0;z<C.length;z++)T.writeFixed64(C[z])}function j(C,T){for(var z=0;z<C.length;z++)T.writeSFixed64(C[z])}function U(C,T){return(C[T]|C[T+1]<<8|C[T+2]<<16)+16777216*C[T+3]}function et(C,T,z){C[z]=T,C[z+1]=T>>>8,C[z+2]=T>>>16,C[z+3]=T>>>24}function nt(C,T){return(C[T]|C[T+1]<<8|C[T+2]<<16)+(C[T+3]<<24)}Z.prototype={destroy:function(){this.buf=null},readFields:function(C,T,z){for(z=z||this.length;this.pos<z;){var it=this.readVarint(),Q=it>>3,vt=this.pos;this.type=7&it,C(Q,T,this),this.pos===vt&&this.skip(it)}return T},readMessage:function(C,T){return this.readFields(C,T,this.readVarint()+this.pos)},readFixed32:function(){var C=U(this.buf,this.pos);return this.pos+=4,C},readSFixed32:function(){var C=nt(this.buf,this.pos);return this.pos+=4,C},readFixed64:function(){var C=U(this.buf,this.pos)+U(this.buf,this.pos+4)*Et;return this.pos+=8,C},readSFixed64:function(){var C=U(this.buf,this.pos)+nt(this.buf,this.pos+4)*Et;return this.pos+=8,C},readFloat:function(){var C=Tt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,C},readDouble:function(){var C=Tt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,C},readVarint:function(C){var T,z,it=this.buf;return T=127&(z=it[this.pos++]),z<128||(T|=(127&(z=it[this.pos++]))<<7,z<128)||(T|=(127&(z=it[this.pos++]))<<14,z<128)||(T|=(127&(z=it[this.pos++]))<<21,z<128)?T:function(vt,lt,X){var yt,ft,Ee=X.buf;if(yt=(112&(ft=Ee[X.pos++]))>>4,ft<128||(yt|=(127&(ft=Ee[X.pos++]))<<3,ft<128)||(yt|=(127&(ft=Ee[X.pos++]))<<10,ft<128)||(yt|=(127&(ft=Ee[X.pos++]))<<17,ft<128)||(yt|=(127&(ft=Ee[X.pos++]))<<24,ft<128)||(yt|=(1&(ft=Ee[X.pos++]))<<31,ft<128))return function(Yt,Me,Bo){return Bo?4294967296*Me+(Yt>>>0):4294967296*(Me>>>0)+(Yt>>>0)}(vt,yt,lt);throw new Error("Expected varint not more than 10 bytes")}(T|=(15&(z=it[this.pos]))<<28,C,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var C=this.readVarint();return C%2==1?(C+1)/-2:C/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var C=this.readVarint()+this.pos,T=this.pos;return this.pos=C,C-T>=12&&It?function(it,Q,vt){return It.decode(it.subarray(Q,vt))}(this.buf,T,C):function(it,Q,vt){for(var lt="",X=Q;X<vt;){var yt,ft,Ee,Ce=it[X],Yt=null,Me=Ce>239?4:Ce>223?3:Ce>191?2:1;if(X+Me>vt)break;Me===1?Ce<128&&(Yt=Ce):Me===2?(192&(yt=it[X+1]))==128&&(Yt=(31&Ce)<<6|63&yt)<=127&&(Yt=null):Me===3?(ft=it[X+2],(192&(yt=it[X+1]))==128&&(192&ft)==128&&((Yt=(15&Ce)<<12|(63&yt)<<6|63&ft)<=2047||Yt>=55296&&Yt<=57343)&&(Yt=null)):Me===4&&(ft=it[X+2],Ee=it[X+3],(192&(yt=it[X+1]))==128&&(192&ft)==128&&(192&Ee)==128&&((Yt=(15&Ce)<<18|(63&yt)<<12|(63&ft)<<6|63&Ee)<=65535||Yt>=1114112)&&(Yt=null)),Yt===null?(Yt=65533,Me=1):Yt>65535&&(Yt-=65536,lt+=String.fromCharCode(Yt>>>10&1023|55296),Yt=56320|1023&Yt),lt+=String.fromCharCode(Yt),X+=Me}return lt}(this.buf,T,C)},readBytes:function(){var C=this.readVarint()+this.pos,T=this.buf.subarray(this.pos,C);return this.pos=C,T},readPackedVarint:function(C,T){if(this.type!==Z.Bytes)return C.push(this.readVarint(T));var z=dt(this);for(C=C||[];this.pos<z;)C.push(this.readVarint(T));return C},readPackedSVarint:function(C){if(this.type!==Z.Bytes)return C.push(this.readSVarint());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readSVarint());return C},readPackedBoolean:function(C){if(this.type!==Z.Bytes)return C.push(this.readBoolean());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readBoolean());return C},readPackedFloat:function(C){if(this.type!==Z.Bytes)return C.push(this.readFloat());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readFloat());return C},readPackedDouble:function(C){if(this.type!==Z.Bytes)return C.push(this.readDouble());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readDouble());return C},readPackedFixed32:function(C){if(this.type!==Z.Bytes)return C.push(this.readFixed32());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readFixed32());return C},readPackedSFixed32:function(C){if(this.type!==Z.Bytes)return C.push(this.readSFixed32());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readSFixed32());return C},readPackedFixed64:function(C){if(this.type!==Z.Bytes)return C.push(this.readFixed64());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readFixed64());return C},readPackedSFixed64:function(C){if(this.type!==Z.Bytes)return C.push(this.readSFixed64());var T=dt(this);for(C=C||[];this.pos<T;)C.push(this.readSFixed64());return C},skip:function(C){var T=7&C;if(T===Z.Varint)for(;this.buf[this.pos++]>127;);else if(T===Z.Bytes)this.pos=this.readVarint()+this.pos;else if(T===Z.Fixed32)this.pos+=4;else{if(T!==Z.Fixed64)throw new Error("Unimplemented type: "+T);this.pos+=8}},writeTag:function(C,T){this.writeVarint(C<<3|T)},realloc:function(C){for(var T=this.length||16;T<this.pos+C;)T*=2;if(T!==this.length){var z=new Uint8Array(T);z.set(this.buf),this.buf=z,this.length=T}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(C){this.realloc(4),et(this.buf,C,this.pos),this.pos+=4},writeSFixed32:function(C){this.realloc(4),et(this.buf,C,this.pos),this.pos+=4},writeFixed64:function(C){this.realloc(8),et(this.buf,-1&C,this.pos),et(this.buf,Math.floor(C*Ot),this.pos+4),this.pos+=8},writeSFixed64:function(C){this.realloc(8),et(this.buf,-1&C,this.pos),et(this.buf,Math.floor(C*Ot),this.pos+4),this.pos+=8},writeVarint:function(C){(C=+C||0)>268435455||C<0?function(z,it){var Q,vt;if(z>=0?(Q=z%4294967296|0,vt=z/4294967296|0):(vt=~(-z/4294967296),4294967295^(Q=~(-z%4294967296))?Q=Q+1|0:(Q=0,vt=vt+1|0)),z>=18446744073709552e3||z<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");it.realloc(10),function(X,yt,ft){ft.buf[ft.pos++]=127&X|128,X>>>=7,ft.buf[ft.pos++]=127&X|128,X>>>=7,ft.buf[ft.pos++]=127&X|128,X>>>=7,ft.buf[ft.pos++]=127&X|128,ft.buf[ft.pos]=127&(X>>>=7)}(Q,0,it),function(X,yt){var ft=(7&X)<<4;yt.buf[yt.pos++]|=ft|((X>>>=3)?128:0),X&&(yt.buf[yt.pos++]=127&X|((X>>>=7)?128:0),X&&(yt.buf[yt.pos++]=127&X|((X>>>=7)?128:0),X&&(yt.buf[yt.pos++]=127&X|((X>>>=7)?128:0),X&&(yt.buf[yt.pos++]=127&X|((X>>>=7)?128:0),X&&(yt.buf[yt.pos++]=127&X)))))}(vt,it)}(C,this):(this.realloc(4),this.buf[this.pos++]=127&C|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=C>>>7&127))))},writeSVarint:function(C){this.writeVarint(C<0?2*-C-1:2*C)},writeBoolean:function(C){this.writeVarint(!!C)},writeString:function(C){C=String(C),this.realloc(4*C.length),this.pos++;var T=this.pos;this.pos=function(Q,vt,lt){for(var X,yt,ft=0;ft<vt.length;ft++){if((X=vt.charCodeAt(ft))>55295&&X<57344){if(!yt){X>56319||ft+1===vt.length?(Q[lt++]=239,Q[lt++]=191,Q[lt++]=189):yt=X;continue}if(X<56320){Q[lt++]=239,Q[lt++]=191,Q[lt++]=189,yt=X;continue}X=yt-55296<<10|X-56320|65536,yt=null}else yt&&(Q[lt++]=239,Q[lt++]=191,Q[lt++]=189,yt=null);X<128?Q[lt++]=X:(X<2048?Q[lt++]=X>>6|192:(X<65536?Q[lt++]=X>>12|224:(Q[lt++]=X>>18|240,Q[lt++]=X>>12&63|128),Q[lt++]=X>>6&63|128),Q[lt++]=63&X|128)}return lt}(this.buf,C,this.pos);var z=this.pos-T;z>=128&&pe(T,z,this),this.pos=T-1,this.writeVarint(z),this.pos+=z},writeFloat:function(C){this.realloc(4),Tt.write(this.buf,C,this.pos,!0,23,4),this.pos+=4},writeDouble:function(C){this.realloc(8),Tt.write(this.buf,C,this.pos,!0,52,8),this.pos+=8},writeBytes:function(C){var T=C.length;this.writeVarint(T),this.realloc(T);for(var z=0;z<T;z++)this.buf[this.pos++]=C[z]},writeRawMessage:function(C,T){this.pos++;var z=this.pos;C(T,this);var it=this.pos-z;it>=128&&pe(z,it,this),this.pos=z-1,this.writeVarint(it),this.pos+=it},writeMessage:function(C,T,z){this.writeTag(C,Z.Bytes),this.writeRawMessage(T,z)},writePackedVarint:function(C,T){T.length&&this.writeMessage(C,he,T)},writePackedSVarint:function(C,T){T.length&&this.writeMessage(C,Pe,T)},writePackedBoolean:function(C,T){T.length&&this.writeMessage(C,Ae,T)},writePackedFloat:function(C,T){T.length&&this.writeMessage(C,rt,T)},writePackedDouble:function(C,T){T.length&&this.writeMessage(C,xe,T)},writePackedFixed32:function(C,T){T.length&&this.writeMessage(C,_e,T)},writePackedSFixed32:function(C,T){T.length&&this.writeMessage(C,be,T)},writePackedFixed64:function(C,T){T.length&&this.writeMessage(C,A,T)},writePackedSFixed64:function(C,T){T.length&&this.writeMessage(C,j,T)},writeBytesField:function(C,T){this.writeTag(C,Z.Bytes),this.writeBytes(T)},writeFixed32Field:function(C,T){this.writeTag(C,Z.Fixed32),this.writeFixed32(T)},writeSFixed32Field:function(C,T){this.writeTag(C,Z.Fixed32),this.writeSFixed32(T)},writeFixed64Field:function(C,T){this.writeTag(C,Z.Fixed64),this.writeFixed64(T)},writeSFixed64Field:function(C,T){this.writeTag(C,Z.Fixed64),this.writeSFixed64(T)},writeVarintField:function(C,T){this.writeTag(C,Z.Varint),this.writeVarint(T)},writeSVarintField:function(C,T){this.writeTag(C,Z.Varint),this.writeSVarint(T)},writeStringField:function(C,T){this.writeTag(C,Z.Bytes),this.writeString(T)},writeFloatField:function(C,T){this.writeTag(C,Z.Fixed32),this.writeFloat(T)},writeDoubleField:function(C,T){this.writeTag(C,Z.Fixed64),this.writeDouble(T)},writeBooleanField:function(C,T){this.writeVarintField(C,!!T)}}},218:function(qe){qe.exports=function(){"use strict";function Fn(A,j,U,et,nt){(function C(T,z,it,Q,vt){for(;Q>it;){if(Q-it>600){var lt=Q-it+1,X=z-it+1,yt=Math.log(lt),ft=.5*Math.exp(2*yt/3),Ee=.5*Math.sqrt(yt*ft*(lt-ft)/lt)*(X-lt/2<0?-1:1);C(T,z,Math.max(it,Math.floor(z-X*ft/lt+Ee)),Math.min(Q,Math.floor(z+(lt-X)*ft/lt+Ee)),vt)}var Ce=T[z],Yt=it,Me=Q;for(ke(T,it,z),vt(T[Q],Ce)>0&&ke(T,it,Q);Yt<Me;){for(ke(T,Yt,Me),Yt++,Me--;vt(T[Yt],Ce)<0;)Yt++;for(;vt(T[Me],Ce)>0;)Me--}vt(T[it],Ce)===0?ke(T,it,Me):ke(T,++Me,Q),Me<=z&&(it=Me+1),z<=Me&&(Q=Me-1)}})(A,j,U||0,et||A.length-1,nt||Tt)}function ke(A,j,U){var et=A[j];A[j]=A[U],A[U]=et}function Tt(A,j){return A<j?-1:A>j?1:0}var Z=function(A){A===void 0&&(A=9),this._maxEntries=Math.max(4,A),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function Et(A,j,U){if(!U)return j.indexOf(A);for(var et=0;et<j.length;et++)if(U(A,j[et]))return et;return-1}function Ot(A,j){It(A,0,A.children.length,j,A)}function It(A,j,U,et,nt){nt||(nt=_e(null)),nt.minX=1/0,nt.minY=1/0,nt.maxX=-1/0,nt.maxY=-1/0;for(var C=j;C<U;C++){var T=A.children[C];dt(nt,A.leaf?et(T):T)}return nt}function dt(A,j){return A.minX=Math.min(A.minX,j.minX),A.minY=Math.min(A.minY,j.minY),A.maxX=Math.max(A.maxX,j.maxX),A.maxY=Math.max(A.maxY,j.maxY),A}function pe(A,j){return A.minX-j.minX}function he(A,j){return A.minY-j.minY}function Pe(A){return(A.maxX-A.minX)*(A.maxY-A.minY)}function rt(A){return A.maxX-A.minX+(A.maxY-A.minY)}function xe(A,j){return A.minX<=j.minX&&A.minY<=j.minY&&j.maxX<=A.maxX&&j.maxY<=A.maxY}function Ae(A,j){return j.minX<=A.maxX&&j.minY<=A.maxY&&j.maxX>=A.minX&&j.maxY>=A.minY}function _e(A){return{children:A,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function be(A,j,U,et,nt){for(var C=[j,U];C.length;)if(!((U=C.pop())-(j=C.pop())<=et)){var T=j+Math.ceil((U-j)/et/2)*et;Fn(A,T,j,U,nt),C.push(j,T,T,U)}}return Z.prototype.all=function(){return this._all(this.data,[])},Z.prototype.search=function(A){var j=this.data,U=[];if(!Ae(A,j))return U;for(var et=this.toBBox,nt=[];j;){for(var C=0;C<j.children.length;C++){var T=j.children[C],z=j.leaf?et(T):T;Ae(A,z)&&(j.leaf?U.push(T):xe(A,z)?this._all(T,U):nt.push(T))}j=nt.pop()}return U},Z.prototype.collides=function(A){var j=this.data;if(!Ae(A,j))return!1;for(var U=[];j;){for(var et=0;et<j.children.length;et++){var nt=j.children[et],C=j.leaf?this.toBBox(nt):nt;if(Ae(A,C)){if(j.leaf||xe(A,C))return!0;U.push(nt)}}j=U.pop()}return!1},Z.prototype.load=function(A){if(!A||!A.length)return this;if(A.length<this._minEntries){for(var j=0;j<A.length;j++)this.insert(A[j]);return this}var U=this._build(A.slice(),0,A.length-1,0);if(this.data.children.length)if(this.data.height===U.height)this._splitRoot(this.data,U);else{if(this.data.height<U.height){var et=this.data;this.data=U,U=et}this._insert(U,this.data.height-U.height-1,!0)}else this.data=U;return this},Z.prototype.insert=function(A){return A&&this._insert(A,this.data.height-1),this},Z.prototype.clear=function(){return this.data=_e([]),this},Z.prototype.remove=function(A,j){if(!A)return this;for(var U,et,nt,C=this.data,T=this.toBBox(A),z=[],it=[];C||z.length;){if(C||(C=z.pop(),et=z[z.length-1],U=it.pop(),nt=!0),C.leaf){var Q=Et(A,C.children,j);if(Q!==-1)return C.children.splice(Q,1),z.push(C),this._condense(z),this}nt||C.leaf||!xe(C,T)?et?(U++,C=et.children[U],nt=!1):C=null:(z.push(C),it.push(U),U=0,et=C,C=C.children[0])}return this},Z.prototype.toBBox=function(A){return A},Z.prototype.compareMinX=function(A,j){return A.minX-j.minX},Z.prototype.compareMinY=function(A,j){return A.minY-j.minY},Z.prototype.toJSON=function(){return this.data},Z.prototype.fromJSON=function(A){return this.data=A,this},Z.prototype._all=function(A,j){for(var U=[];A;)A.leaf?j.push.apply(j,A.children):U.push.apply(U,A.children),A=U.pop();return j},Z.prototype._build=function(A,j,U,et){var nt,C=U-j+1,T=this._maxEntries;if(C<=T)return Ot(nt=_e(A.slice(j,U+1)),this.toBBox),nt;et||(et=Math.ceil(Math.log(C)/Math.log(T)),T=Math.ceil(C/Math.pow(T,et-1))),(nt=_e([])).leaf=!1,nt.height=et;var z=Math.ceil(C/T),it=z*Math.ceil(Math.sqrt(T));be(A,j,U,it,this.compareMinX);for(var Q=j;Q<=U;Q+=it){var vt=Math.min(Q+it-1,U);be(A,Q,vt,z,this.compareMinY);for(var lt=Q;lt<=vt;lt+=z){var X=Math.min(lt+z-1,vt);nt.children.push(this._build(A,lt,X,et-1))}}return Ot(nt,this.toBBox),nt},Z.prototype._chooseSubtree=function(A,j,U,et){for(;et.push(j),!j.leaf&&et.length-1!==U;){for(var nt=1/0,C=1/0,T=void 0,z=0;z<j.children.length;z++){var it=j.children[z],Q=Pe(it),vt=(lt=A,X=it,(Math.max(X.maxX,lt.maxX)-Math.min(X.minX,lt.minX))*(Math.max(X.maxY,lt.maxY)-Math.min(X.minY,lt.minY))-Q);vt<C?(C=vt,nt=Q<nt?Q:nt,T=it):vt===C&&Q<nt&&(nt=Q,T=it)}j=T||j.children[0]}var lt,X;return j},Z.prototype._insert=function(A,j,U){var et=U?A:this.toBBox(A),nt=[],C=this._chooseSubtree(et,this.data,j,nt);for(C.children.push(A),dt(C,et);j>=0&&nt[j].children.length>this._maxEntries;)this._split(nt,j),j--;this._adjustParentBBoxes(et,nt,j)},Z.prototype._split=function(A,j){var U=A[j],et=U.children.length,nt=this._minEntries;this._chooseSplitAxis(U,nt,et);var C=this._chooseSplitIndex(U,nt,et),T=_e(U.children.splice(C,U.children.length-C));T.height=U.height,T.leaf=U.leaf,Ot(U,this.toBBox),Ot(T,this.toBBox),j?A[j-1].children.push(T):this._splitRoot(U,T)},Z.prototype._splitRoot=function(A,j){this.data=_e([A,j]),this.data.height=A.height+1,this.data.leaf=!1,Ot(this.data,this.toBBox)},Z.prototype._chooseSplitIndex=function(A,j,U){for(var et,nt,C,T,z,it,Q,vt=1/0,lt=1/0,X=j;X<=U-j;X++){var yt=It(A,0,X,this.toBBox),ft=It(A,X,U,this.toBBox),Ee=(nt=yt,C=ft,T=Math.max(nt.minX,C.minX),z=Math.max(nt.minY,C.minY),it=Math.min(nt.maxX,C.maxX),Q=Math.min(nt.maxY,C.maxY),Math.max(0,it-T)*Math.max(0,Q-z)),Ce=Pe(yt)+Pe(ft);Ee<vt?(vt=Ee,et=X,lt=Ce<lt?Ce:lt):Ee===vt&&Ce<lt&&(lt=Ce,et=X)}return et||U-j},Z.prototype._chooseSplitAxis=function(A,j,U){var et=A.leaf?this.compareMinX:pe,nt=A.leaf?this.compareMinY:he;this._allDistMargin(A,j,U,et)<this._allDistMargin(A,j,U,nt)&&A.children.sort(et)},Z.prototype._allDistMargin=function(A,j,U,et){A.children.sort(et);for(var nt=this.toBBox,C=It(A,0,j,nt),T=It(A,U-j,U,nt),z=rt(C)+rt(T),it=j;it<U-j;it++){var Q=A.children[it];dt(C,A.leaf?nt(Q):Q),z+=rt(C)}for(var vt=U-j-1;vt>=j;vt--){var lt=A.children[vt];dt(T,A.leaf?nt(lt):lt),z+=rt(T)}return z},Z.prototype._adjustParentBBoxes=function(A,j,U){for(var et=U;et>=0;et--)dt(j[et],A)},Z.prototype._condense=function(A){for(var j=A.length-1,U=void 0;j>=0;j--)A[j].children.length===0?j>0?(U=A[j-1].children).splice(U.indexOf(A[j]),1):this.clear():Ot(A[j],this.toBBox)},Z}()}},qe=>{qe(qe.s=319)}]),(()=>{"use strict";var qe,Fn={},ke={};function Tt(Z){var Et=ke[Z];if(Et!==void 0)return Et.exports;var Ot=ke[Z]={exports:{}};return Fn[Z].call(Ot.exports,Ot,Ot.exports,Tt),Ot.exports}Tt.m=Fn,qe=[],Tt.O=(Z,Et,Ot,It)=>{if(!Et){var dt=1/0;for(rt=0;rt<qe.length;rt++){for(var[Et,Ot,It]=qe[rt],pe=!0,he=0;he<Et.length;he++)(!1&It||dt>=It)&&Object.keys(Tt.O).every(be=>Tt.O[be](Et[he]))?Et.splice(he--,1):(pe=!1,It<dt&&(dt=It));if(pe){qe.splice(rt--,1);var Pe=Ot();Pe!==void 0&&(Z=Pe)}}return Z}It=It||0;for(var rt=qe.length;rt>0&&qe[rt-1][2]>It;rt--)qe[rt]=qe[rt-1];qe[rt]=[Et,Ot,It]},Tt.o=(Z,Et)=>Object.prototype.hasOwnProperty.call(Z,Et),(()=>{var Z={121:0};Tt.O.j=It=>Z[It]===0;var Et=(It,dt)=>{var pe,he,[Pe,rt,xe]=dt,Ae=0;if(Pe.some(be=>Z[be]!==0)){for(pe in rt)Tt.o(rt,pe)&&(Tt.m[pe]=rt[pe]);if(xe)var _e=xe(Tt)}for(It&&It(dt);Ae<Pe.length;Ae++)Tt.o(Z,he=Pe[Ae])&&Z[he]&&Z[he][0](),Z[he]=0;return Tt.O(_e)},Ot=self.webpackChunkview_component=self.webpackChunkview_component||[];Ot.forEach(Et.bind(null,0)),Ot.push=Et.bind(null,Ot.push.bind(Ot))})()})();
