(self.webpackChunkview_component=self.webpackChunkview_component||[]).push([[792],{319:(Ue,vn,ai)=>{"use strict";let ie=null,ot=1;function $t(n){const t=ie;return ie=n,t}function se(n){if((!fe(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==ot)){if(!n.producerMustRecompute(n)&&!Kt(n))return n.dirty=!1,void(n.lastCleanEpoch=ot);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=ot}}function Kt(n){ue(n);for(let t=0;t<n.producerNode.length;t++){const e=n.producerNode[t],i=n.producerLastReadVersion[t];if(i!==e.version||(se(e),i!==e.version))return!0}return!1}function Dt(n,t){if(r=n,r.liveConsumerNode??=[],r.liveConsumerIndexOfThis??=[],ue(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Dt(n.producerNode[i],n.producerIndexOfThis[i]);var r;const e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[t],r=n.liveConsumerNode[t];ue(r),r.producerIndexOfThis[i]=t}}function fe(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function ue(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Je=null;function Ct(n){return"function"==typeof n}function Xe(n){const t=n(e=>{Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const qt=Xe(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((e,i)=>`${i+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Fe(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class ke{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Ct(i))try{i()}catch(s){t=s instanceof qt?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{rt(s)}catch(o){t=t??[],o instanceof qt?t=[...t,...o.errors]:t.push(o)}}if(t)throw new qt(t)}}add(t){var e;if(t&&t!==this)if(this.closed)rt(t);else{if(t instanceof ke){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Fe(e,t)}remove(t){const{_finalizers:e}=this;e&&Fe(e,t),t instanceof ke&&t._removeParent(this)}}ke.EMPTY=(()=>{const n=new ke;return n.closed=!0,n})();const L=ke.EMPTY;function H(n){return n instanceof ke||n&&"closed"in n&&Ct(n.remove)&&Ct(n.add)&&Ct(n.unsubscribe)}function rt(n){Ct(n)?n():n.unsubscribe()}const gt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},bt={setTimeout(n,t,...e){const{delegate:i}=bt;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=bt;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function C(n){bt.setTimeout(()=>{const{onUnhandledError:t}=gt;if(!t)throw n;t(n)})}function k(){}const W=mt("C",void 0,void 0);function mt(n,t,e){return{kind:n,value:t,error:e}}let pt=null;function Bt(n){if(gt.useDeprecatedSynchronousErrorHandling){const t=!pt;if(t&&(pt={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=pt;if(pt=null,e)throw i}}else n()}class Pt extends ke{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,H(t)&&t.add(this)):this.destination=Qe}static create(t,e,i){return new ui(t,e,i)}next(t){this.isStopped?xe(mt("N",t,void 0),this):this._next(t)}error(t){this.isStopped?xe(mt("E",void 0,t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?xe(W,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const it=Function.prototype.bind;function zt(n,t){return it.call(n,t)}class Ft{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){ve(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){ve(i)}else ve(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){ve(e)}}}class ui extends Pt{constructor(t,e,i){let r;if(super(),Ct(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let s;this&&gt.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&zt(t.next,s),error:t.error&&zt(t.error,s),complete:t.complete&&zt(t.complete,s)}):r=t}this.destination=new Ft(r)}}function ve(n){var e;gt.useDeprecatedSynchronousErrorHandling?(e=n,gt.useDeprecatedSynchronousErrorHandling&&pt&&(pt.errorThrown=!0,pt.error=e)):C(n)}function xe(n,t){const{onStoppedNotification:e}=gt;e&&bt.setTimeout(()=>e(n,t))}const Qe={closed:!0,next:k,error:function(t){throw t},complete:k},Gs="function"==typeof Symbol&&Symbol.observable||"@@observable";function ar(n){return n}let Ai=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=(a=e)&&a instanceof Pt||(h=a)&&Ct(h.next)&&Ct(h.error)&&Ct(h.complete)&&H(a)?e:new ui(e,i,r);var a,h;return Bt(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Ki(i))((r,s)=>{const o=new ui({next:a=>{try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Gs](){return this}pipe(...e){return(0===(r=e).length?ar:1===r.length?r[0]:function(s){return r.reduce((o,a)=>a(o),s)})(this);var r}toPromise(e){return new(e=Ki(e))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=t=>new n(t),n})();function Ki(n){var t;return null!==(t=n??gt.Promise)&&void 0!==t?t:Promise}const xh=Xe(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ts=(()=>{class n extends Ai{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new qa(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new xh}next(e){Bt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Bt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Bt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?L:(this.currentObservers=null,s.push(e),new ke(()=>{this.currentObservers=null,Fe(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new Ai;return e.source=this,e}}return n.create=(t,e)=>new qa(t,e),n})();class qa extends ts{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:L}}class Va extends ts{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function xn(n){return t=>{if(i=t,Ct(i?.lift))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});var i;throw new TypeError("Unable to lift unknown Observable type")}}function an(n,t,e,i,r){return new ld(n,t,e,i,r)}class ld extends Pt{constructor(t,e,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function bn(n,t){return xn((e,i)=>{let r=0;e.subscribe(an(i,s=>{i.next(n.call(t,s,r++))}))})}function ze(n){for(let t in n)if(n[t]===ze)return t;throw Error("Could not find renamed property on target object.")}function ji(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ji).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function mo(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const yo=ze({__forward_ref__:ze});function Er(n){return n.__forward_ref__=Er,n.toString=function(){return ji(this())},n}function I(n){return"function"==typeof(e=n)&&e.hasOwnProperty(yo)&&e.__forward_ref__===Er?n():n;var e}function G(n){return n&&!!n.\u0275providers}class z extends Error{constructor(t,e){var s;super((s=e,`NG0${Math.abs(t)}${s?": "+s:""}`)),this.code=t}}const U=ze({\u0275cmp:ze}),J=ze({\u0275dir:ze}),tt=ze({\u0275pipe:ze}),_t=ze({\u0275mod:ze}),Tt=ze({\u0275fac:ze}),Mt=ze({__NG_ELEMENT_ID__:ze}),Vt=ze({__NG_ENV_ID__:ze});function Lt(n){return"string"==typeof n?n:null==n?"":String(n)}function ae(n,t){throw new z(-201,!1)}function vt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ge(n){return{providers:n.providers||[],imports:n.imports||[]}}function ce(n){return li(n,oe)||li(n,Ti)}function li(n,t){return n.hasOwnProperty(t)?n[t]:null}function xi(n){return n&&(n.hasOwnProperty(Ot)||n.hasOwnProperty($e))?n[Ot]:null}const oe=ze({\u0275prov:ze}),Ot=ze({\u0275inj:ze}),Ti=ze({ngInjectableDef:ze}),$e=ze({ngInjectorDef:ze});var n,kt=((n=kt||{})[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n);let be;function et(n){const t=be;return be=n,t}function te(n,t,e){const i=ce(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&kt.Optional?null:void 0!==t?t:void ae()}const lt=globalThis;class jt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=vt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const yi={},Gi="__NG_DI_FLAG__",di="ngTempTokenPath",Hi=/\n/gm,ni="__source";let qi;function Pi(n){const t=qi;return qi=n,t}function pi(n,t=kt.Default){if(void 0===qi)throw new z(-203,!1);return null===qi?te(n,void 0,t):qi.get(n,t&kt.Optional?null:void 0,t)}function X(n,t=kt.Default){return(function(){return be}()||pi)(I(n),t)}function ht(n,t=kt.Default){return X(n,E(t))}function E(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function O(n){const t=[];for(let e=0;e<n.length;e++){const i=I(n[e]);if(Array.isArray(i)){if(0===i.length)throw new z(900,!1);let r,s=kt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=B(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}t.push(X(r,s))}else t.push(X(i))}return t}function Z(n,t){return n[Gi]=t,n.prototype[Gi]=t,n}function B(n){return n[Gi]}function Y(n){return{toString:n}.toString()}var xt=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(xt||{}),Rt=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Rt||{});const wt={},St=[];function me(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}e=r+1}}function je(n,t,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const s=e[i++],o=e[i++],a=e[i++];n.setAttribute(t,o,a,s)}else{const s=r,o=e[++i];Dn(s)?n.setProperty(t,s,o):n.setAttribute(t,s,o),i++}}return i}function Ge(n){return 3===n||4===n||6===n}function Dn(n){return 64===n.charCodeAt(0)}function Ji(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||bh(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function bh(n,t,e,i,r){let s=0,o=n.length;if(-1===t)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,t),s=o+1),n.splice(s++,0,e),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const wh="ng-template";function Za(n,t,e){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(e&&"class"===s&&-1!==me(o.toLowerCase(),t,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===t)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Ba(n){return 4===n.type&&n.value!==wh}function _o(n,t,e){return t===(4!==n.type||e?n.value:wh)}function es(n,t,e){let i=4;const r=n.attrs||[],s=function(l){for(let h=0;h<l.length;h++)if(Ge(l[h]))return h;return l.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!_o(n,l,e)||""===l&&1===t.length){if(ln(i))return!1;o=!0}}else{const h=8&i?l:t[++a];if(8&i&&null!==n.attrs){if(!Za(n.attrs,h,e)){if(ln(i))return!1;o=!0}continue}const u=Ch(8&i?"class":l,r,Ba(n),e);if(-1===u){if(ln(i))return!1;o=!0;continue}if(""!==h){let c;c=u>s?"":r[u+1].toLowerCase();const d=8&i?c:null;if(d&&-1!==me(d,h,0)||2&i&&h!==c){if(ln(i))return!1;o=!0}}}}else{if(!o&&!ln(i)&&!ln(l))return!1;if(o&&ln(l))continue;o=!1,i=l|1&i}}return ln(i)||o}function ln(n){return!(1&n)}function Ch(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let s=!1;for(;r<t.length;){const o=t[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(o,a){let l=o.indexOf(4);if(l>-1)for(l++;l<o.length;){const h=o[l];if("number"==typeof h)return-1;if(h===a)return l;l++}return-1}(t,n)}function Mh(n,t,e=!1){for(let i=0;i<t.length;i++)if(es(n,t[i],e))return!0;return!1}function is(n,t){return n?":not("+t.trim()+")":t}function Nn(n){let t=n[0],e=1,i=2,r="",s=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&i){const a=n[++e];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ln(o)&&(t+=is(s,r),r=""),i=o,s=s||!ln(i);e++}return""!==r&&(t+=is(s,r)),t}function hn(n){return Y(()=>{const t=j0(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===xt.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Rt.Emulated,styles:n.styles||St,_:null,schemas:n.schemas||null,tView:null,id:""};G0(e);const i=n.dependencies;return e.directiveDefs=q0(i,!1),e.pipeDefs=q0(i,!0),e.id=function(s){let o=0;const a=[s.selectors,s.ngContentSelectors,s.hostVars,s.hostAttrs,s.consts,s.vars,s.decls,s.encapsulation,s.standalone,s.signals,s.exportAs,JSON.stringify(s.inputs),JSON.stringify(s.outputs),Object.getOwnPropertyNames(s.type.prototype),!!s.contentQueries,!!s.viewQuery].join("|");for(const l of a)o=Math.imul(31,o)+l.charCodeAt(0)|0;return o+=2147483648,"c"+o}(e),e})}function wn(n){return xo(n)||N0(n)}function hd(n){return null!==n}function vo(n){return Y(()=>({type:n.type,bootstrap:n.bootstrap||St,declarations:n.declarations||St,imports:n.imports||St,exports:n.exports||St,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function L0(n,t){if(null==n)return wt;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=i,t&&(t[r]=s)}return e}function D0(n){return Y(()=>{const t=j0(n);return G0(t),t})}function xo(n){return n[U]||null}function N0(n){return n[J]||null}function z0(n){return n[tt]||null}function j0(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:n.inputs||wt,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||St,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:L0(n.inputs,t),outputs:L0(n.outputs),debugInfo:null}}function G0(n){n.features?.forEach(t=>t(n))}function q0(n,t){if(!n)return null;const e=t?z0:wn;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(hd)}const Tr=0,we=1,Jt=2,Qi=3,Yn=4,Kn=5,Sh=6,V0=7,kr=8,bo=9,Ir=10,un=11,Wa=12,Z0=13,wo=14,lr=15,Eh=16,Co=17,Ha=18,Th=19,B0=20,Ua=21,ud=22,qs=23,ns=25,W0=1,Vs=7,kh=9,zn=10;var cd=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(cd||{});function Mo(n){return Array.isArray(n)&&"object"==typeof n[W0]}function Pr(n){return Array.isArray(n)&&!0===n[W0]}function H0(n){return!!(4&n.flags)}function Ih(n){return n.componentOffset>-1}function U0(n){return!(1&~n.flags)}function Xa(n){return!!n.template}function Ow(n){return!!(512&n[Jt])}function $a(n,t){return n.hasOwnProperty(Tt)?n[Tt]:null}class X0{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ph(){return $0}function $0(n){return n.type.prototype.ngOnChanges&&(n.setInput=Lw),Aw}function Aw(){const n=K0(this),t=n?.current;if(t){const e=n.previous;if(e===wt)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function Lw(n,t,e,i){const r=this.declaredInputs[e],s=K0(n)||(n[Y0]={previous:wt,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new X0(l&&l.currentValue,t,a===wt),n[i]=t}Ph.ngInherit=!0;const Y0="__ngSimpleChanges__";function K0(n){return n[Y0]||null}const rs=function(n,t,e){};function Rr(n){for(;Array.isArray(n);)n=n[Tr];return n}function J0(n,t){return Rr(t[n])}function hr(n,t){return Rr(t[n.index])}function Q0(n,t){return n.data[t]}function So(n,t){const e=t[n];return Mo(e)?e:e[Tr]}function dd(n){return!(128&~n[Jt])}function Rh(n,t){return null==t?null:n[t]}function tm(n){n[Co]=0}function Nw(n){1024&n[Jt]||(n[Jt]|=1024,dd(n)&&Ya(n))}function em(n){return 9216&n[Jt]||n[qs]?.dirty}function pd(n){em(n)?Ya(n):64&n[Jt]&&(function(){return false}()?(n[Jt]|=1024,Ya(n)):n[Ir].changeDetectionScheduler?.notify())}function Ya(n){n[Ir].changeDetectionScheduler?.notify();let t=Ka(n);for(;null!==t&&!(8192&t[Jt])&&(t[Jt]|=8192,dd(t));)t=Ka(t)}function Ka(n){const t=n[Qi];return Pr(t)?t[Qi]:t}const Ce={lFrame:hm(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function im(){return Ce.bindingsEnabled}function Ui(){return Ce.lFrame.lView}function Zs(){return Ce.lFrame.tView}function Fr(){let n=nm();for(;null!==n&&64===n.type;)n=n.parent;return n}function nm(){return Ce.lFrame.currentTNode}function Ja(n,t){const e=Ce.lFrame;e.currentTNode=n,e.isParent=t}function rm(){return Ce.lFrame.isParent}function sm(){return Ce.lFrame.bindingIndex++}function zw(n,t){const e=Ce.lFrame;e.bindingIndex=e.bindingRootIndex=n,fd(t)}function fd(n){Ce.lFrame.currentDirectiveIndex=n}function om(n){Ce.lFrame.currentQueryIndex=n}function jw(n){const t=n[we];return 2===t.type?t.declTNode:1===t.type?n[Kn]:null}function am(n,t,e){if(e&kt.SkipSelf){let r=t,s=n;for(;r=r.parent,!(null!==r||e&kt.Host||(r=jw(s),null===r||(s=s[wo],10&r.type))););if(null===r)return!1;t=r,n=s}const i=Ce.lFrame=lm();return i.currentTNode=t,i.lView=n,!0}function gd(n){const t=lm(),e=n[we];Ce.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function lm(){const n=Ce.lFrame,t=null===n?null:n.child;return null===t?hm(n):t}function hm(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function um(){const n=Ce.lFrame;return Ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const cm=um;function md(){const n=um();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Eo(){return Ce.lFrame.selectedIndex}function Bs(n){Ce.lFrame.selectedIndex=n}let dm=!0;function yd(){return dm}function _d(n){dm=n}function vd(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const r=n.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:o,ngAfterViewInit:a,ngAfterViewChecked:l,ngOnDestroy:h}=r;s&&(n.contentHooks??=[]).push(-e,s),o&&((n.contentHooks??=[]).push(e,o),(n.contentCheckHooks??=[]).push(e,o)),a&&(n.viewHooks??=[]).push(-e,a),l&&((n.viewHooks??=[]).push(e,l),(n.viewCheckHooks??=[]).push(e,l)),null!=h&&(n.destroyHooks??=[]).push(e,h)}}function Fh(n,t,e){pm(n,t,3,e)}function Oh(n,t,e,i){(3&n[Jt])===e&&pm(n,t,e,i)}function xd(n,t){let e=n[Jt];(3&e)===t&&(e&=16383,e+=1,n[Jt]=e)}function pm(n,t,e,i){const r=i??-1,s=t.length-1;let o=0;for(let a=void 0!==i?65535&n[Co]:0;a<s;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=i&&o>=i)break}else t[a]<0&&(n[Co]+=65536),(o<r||-1==r)&&(Gw(n,e,t,a),n[Co]=(4294901760&n[Co])+a+2),a++}function fm(n,t){rs(4,n,t);const e=$t(null);try{t.call(n)}finally{$t(e),rs(5,n,t)}}function Gw(n,t,e,i){const r=e[i]<0,s=e[i+1],o=n[r?-e[i]:e[i]];r?n[Jt]>>14<n[Co]>>16&&(3&n[Jt])===t&&(n[Jt]+=16384,fm(o,s)):fm(o,s)}const To=-1;class bd{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function gm(n){return n!==To}function Ah(n){return 32767&n}function Lh(n,t){let e=n>>16,i=t;for(;e>0;)i=i[wo],e--;return i}let wd=!0;function mm(n){const t=wd;return wd=n,t}const ym=255,_m=5;let qw=0;const ur={};function vm(n,t){const e=xm(n,t);if(-1!==e)return e;const i=t[we];i.firstCreatePass&&(n.injectorIndex=t.length,Cd(i.data,n),Cd(t,null),Cd(i.blueprint,null));const r=Md(n,t),s=n.injectorIndex;if(gm(r)){const o=Ah(r),a=Lh(r,t),l=a[we].data;for(let h=0;h<8;h++)t[s+h]=a[o+h]|l[o+h]}return t[s+8]=r,s}function Cd(n,t){n.push(0,0,0,0,0,0,0,0,t)}function xm(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Md(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){if(i=Tm(r),null===i)return To;if(e++,r=r[wo],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return To}function Vw(n,t,e){!function(r,s,o){let a;"string"==typeof o?a=o.charCodeAt(0)||0:o.hasOwnProperty(Mt)&&(a=o[Mt]),null==a&&(a=o[Mt]=qw++);const l=a&ym;s.data[r+(l>>_m)]|=1<<l}(n,t,e)}function bm(n,t,e){if(e&kt.Optional||void 0!==n)return n;ae()}function wm(n,t,e,i){if(e&kt.Optional&&void 0===i&&(i=null),!(e&(kt.Self|kt.Host))){const r=n[bo],s=et(void 0);try{return r?r.get(t,i,e&kt.Optional):te(t,i,e&kt.Optional)}finally{et(s)}}return bm(i,0,e)}function Cm(n,t,e,i=kt.Default,r){if(null!==n){if(2048&t[Jt]&&!(i&kt.Self)){const o=function(l,h,u,c,d){let p=l,f=h;for(;null!==p&&null!==f&&2048&f[Jt]&&!(512&f[Jt]);){const g=Mm(p,f,u,c|kt.Self,ur);if(g!==ur)return g;let m=p.parent;if(!m){const y=f[B0];if(y){const _=y.get(u,ur,c);if(_!==ur)return _}m=Tm(f),f=f[wo]}p=m}return d}(n,t,e,i,ur);if(o!==ur)return o}const s=Mm(n,t,e,i,ur);if(s!==ur)return s}return wm(t,e,i,r)}function Mm(n,t,e,i,r){const s=function(a){if("string"==typeof a)return a.charCodeAt(0)||0;const l=a.hasOwnProperty(Mt)?a[Mt]:void 0;return"number"==typeof l?l>=0?l&ym:Bw:l}(e);if("function"==typeof s){if(!am(t,n,i))return i&kt.Host?bm(r,0,i):wm(t,e,i,r);try{let o;if(o=s(i),null!=o||i&kt.Optional)return o;ae()}finally{cm()}}else if("number"==typeof s){let o=null,a=xm(n,t),l=To,h=i&kt.Host?t[lr][Kn]:null;for((-1===a||i&kt.SkipSelf)&&(l=-1===a?Md(n,t):t[a+8],l!==To&&Em(i,!1)?(o=t[we],a=Ah(l),t=Lh(l,t)):a=-1);-1!==a;){const u=t[we];if(Sm(s,a,u.data)){const c=Zw(a,t,e,o,i,h);if(c!==ur)return c}l=t[a+8],l!==To&&Em(i,t[we].data[a+8]===h)&&Sm(s,a,t)?(o=u,a=Ah(l),t=Lh(l,t)):a=-1}}return r}function Zw(n,t,e,i,r,s){const o=t[we],a=o.data[n+8],l=function(u,c,d,p,f){const g=u.providerIndexes,m=c.data,y=1048575&g,_=u.directiveStart,v=g>>20,x=f?y+v:u.directiveEnd;for(let b=p?y:y+v;b<x;b++){const M=m[b];if(b<_&&d===M||b>=_&&M.type===d)return b}if(f){const b=m[_];if(b&&Xa(b)&&b.type===d)return _}return null}(a,o,e,null==i?Ih(a)&&wd:i!=o&&!!(3&a.type),r&kt.Host&&s===a);return null!==l?Qa(t,o,l,a):ur}function Qa(n,t,e,i){let r=n[e];const s=t.data;if(r instanceof bd){const o=r;o.resolving&&function(u,c){throw new z(-200,`Circular dependency in DI detected for ${u}`)}("function"==typeof(u=s[e])?u.name||u.toString():"object"==typeof u&&null!=u&&"function"==typeof u.type?u.type.name||u.type.toString():Lt(u));const a=mm(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?et(o.injectImpl):null;am(n,i,kt.Default);try{r=n[e]=o.factory(void 0,s,n,i),t.firstCreatePass&&e>=i.directiveStart&&function(u,c,d){const{ngOnChanges:p,ngOnInit:f,ngDoCheck:g}=c.type.prototype;if(p){const m=$0(c);(d.preOrderHooks??=[]).push(u,m),(d.preOrderCheckHooks??=[]).push(u,m)}f&&(d.preOrderHooks??=[]).push(0-u,f),g&&((d.preOrderHooks??=[]).push(u,g),(d.preOrderCheckHooks??=[]).push(u,g))}(e,s[e],t)}finally{null!==l&&et(l),mm(a),o.resolving=!1,cm()}}var u;return r}function Sm(n,t,e){return!!(e[t+(n>>_m)]&1<<n)}function Em(n,t){return!(n&kt.Self||n&kt.Host&&t)}class tl{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return Cm(this._tNode,this._lView,t,E(i),e)}}function Bw(){return new tl(Fr(),Ui())}function Tm(n){const t=n[we],e=t.type;return 2===e?t.declTNode:1===e?n[Kn]:null}const Dh="__parameters__";function km(n,t,e){return Y(()=>{const i=function(o){return function(...a){if(o){const l=o(...a);for(const h in l)this[h]=l[h]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,h,u){const c=l.hasOwnProperty(Dh)?l[Dh]:Object.defineProperty(l,Dh,{value:[]})[Dh];for(;c.length<=u;)c.push(null);return(c[u]=c[u]||[]).push(o),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Sd(n,t){n.forEach(e=>Array.isArray(e)?Sd(e,t):t(e))}function Im(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Nh(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Ww(n,t,e){let i=el(n,t);return i>=0?n[1|i]=e:(i=~i,function(s,o,a,l){let h=s.length;if(h==o)s.push(a,l);else if(1===h)s.push(l,s[0]),s[0]=a;else{for(h--,s.push(s[h-1],s[h]);h>o;)s[h]=s[h-2],h--;s[o]=a,s[o+1]=l}}(n,i,t,e)),i}function Ed(n,t){const e=el(n,t);if(e>=0)return n[1|e]}function el(n,t){return function(i,r,s){let o=0,a=i.length>>1;for(;a!==o;){const l=o+(a-o>>1),h=i[l<<1];if(r===h)return l<<1;h>r?a=l:o=l+1}return~(a<<1)}(n,t)}const Hw=Z(km("Optional"),8),Uw=Z(km("SkipSelf"),4),zh=new jt("ENVIRONMENT_INITIALIZER"),Pm=new jt("INJECTOR",-1),Rm=new jt("INJECTOR_DEF_TYPES");class Fm{get(t,e=yi){if(e===yi){const i=new Error(`NullInjectorError: No provider for ${ji(t)}!`);throw i.name="NullInjectorError",i}return e}}function Xw(...n){return{\u0275providers:Om(0,n),\u0275fromNgModule:!0}}function Om(n,...t){const e=[],i=new Set;let r;const s=o=>{e.push(o)};return Sd(t,o=>{const a=o;Td(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Am(r,s),e}function Am(n,t){for(let e=0;e<n.length;e++){const{ngModule:i,providers:r}=n[e];kd(r,s=>{t(s,i)})}}function Td(n,t,e,i){if(!(n=I(n)))return!1;let r=null,s=xi(n);const o=!s&&xo(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=xi(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of l)Td(h,t,e,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let h;i.add(r);try{Sd(s.imports,u=>{Td(u,t,e,i)&&(h||=[],h.push(u))})}finally{}void 0!==h&&Am(h,t)}if(!a){const h=$a(r)||(()=>new r);t({provide:r,useFactory:h,deps:St},r),t({provide:Rm,useValue:r,multi:!0},r),t({provide:zh,useValue:()=>X(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const h=n;kd(l,u=>{t(u,h)})}}}return r!==n&&void 0!==n.providers}function kd(n,t){for(let e of n)G(e)&&(e=e.\u0275providers),Array.isArray(e)?kd(e,t):t(e)}const $w=ze({provide:String,useValue:ze});function Lm(n){return null!==n&&"object"==typeof n&&$w in n}function Id(n){return"function"==typeof n}const Pd=new jt("Set Injector scope."),jh={},Yw={};let Rd;function Fd(){return void 0===Rd&&(Rd=new Fm),Rd}class Ws{}class Od extends Ws{get destroyed(){return this._destroyed}constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ld(t,o=>this.processProvider(o)),this.records.set(Pm,ko(void 0,this)),r.has("environment")&&this.records.set(Ws,ko(void 0,this));const s=this.records.get(Pd);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Rm,St,kt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of t)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=Pi(this),i=et(void 0);try{return t()}finally{Pi(e),et(i)}}get(t,e=yi,i=kt.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Vt))return t[Vt](this);i=E(i);const r=Pi(this),s=et(void 0);try{if(!(i&kt.SkipSelf)){let o=this.records.get(t);if(void 0===o){const a=("function"==typeof(h=t)||"object"==typeof h&&h instanceof jt)&&ce(t);o=a&&this.injectableDefInScope(a)?ko(Ad(t),jh):null,this.records.set(t,o)}if(null!=o)return this.hydrate(t,o)}return(i&kt.Self?Fd():this.parent).get(t,e=i&kt.Optional&&e===yi?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[di]=o[di]||[]).unshift(ji(t)),r)throw o;return function(l,h,u,c){const d=l[di];throw h[ni]&&d.unshift(h[ni]),l.message=function(f,g,m,y=null){f=f&&"\n"===f.charAt(0)&&"\u0275"==f.charAt(1)?f.slice(2):f;let _=ji(g);if(Array.isArray(g))_=g.map(ji).join(" -> ");else if("object"==typeof g){let v=[];for(let x in g)if(g.hasOwnProperty(x)){let b=g[x];v.push(x+":"+("string"==typeof b?JSON.stringify(b):ji(b)))}_=`{${v.join(", ")}}`}return`${m}${y?"("+y+")":""}[${_}]: ${f.replace(Hi,"\n  ")}`}("\n"+l.message,d,"R3InjectorError",c),l.ngTokenPath=d,l[di]=null,l}(o,t,0,this.source)}throw o}finally{et(s),Pi(r)}var h}resolveInjectorInitializers(){const t=Pi(this),e=et(void 0);try{const i=this.get(zh,St,kt.Self);for(const r of i)r()}finally{Pi(t),et(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(ji(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new z(205,!1)}processProvider(t){let e=Id(t=I(t))?t:I(t&&t.provide);const i=Lm(s=t)?ko(void 0,s.useValue):ko(function(a,l,h){let u;if(Id(a)){const c=I(a);return $a(c)||Ad(c)}if(Lm(a))u=()=>I(a.useValue);else if((d=a)&&d.useFactory)u=()=>a.useFactory(...O(a.deps||[]));else if(function(d){return!(!d||!d.useExisting)}(a))u=()=>X(I(a.useExisting));else{const c=I(a&&(a.useClass||a.provide));if(!a.deps)return $a(c)||Ad(c);u=()=>new c(...O(a.deps))}var d;return u}(s),jh);var s;if(!Id(t)&&!0===t.multi){let r=this.records.get(e);r||(r=ko(void 0,jh,!0),r.factory=()=>O(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===jh&&(e.value=Yw,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(r=e.value)&&"object"==typeof r&&"function"==typeof r.ngOnDestroy&&this._ngOnDestroyHooks.add(e.value),e.value;var r}injectableDefInScope(t){if(!t.providedIn)return!1;const e=I(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Ad(n){const t=ce(n),e=null!==t?t.factory:$a(n);if(null!==e)return e;if(n instanceof jt)throw new z(204,!1);if(n instanceof Function)return function(r){if(r.length>0)throw new z(204,!1);const s=(a=r)&&(a[oe]||a[Ti])||null;var a;return null!==s?()=>s.factory(r):()=>new r}(n);throw new z(204,!1)}function ko(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Ld(n,t){for(const e of n)Array.isArray(e)?Ld(e,t):e&&G(e)?Ld(e.\u0275providers,t):t(e)}function Dm(n,t=null,e=null,i){const r=Nm(n,t,e,i);return r.resolveInjectorInitializers(),r}function Nm(n,t=null,e=null,i,r=new Set){const s=[e||St,Xw(n)];return i=i||("object"==typeof n?void 0:ji(n)),new Od(s,t||Fd(),i||null,r)}let Dd,il=(()=>{class n{static#t=this.THROW_IF_NOT_FOUND=yi;static#e=this.NULL=new Fm;static create(e,i){if(Array.isArray(e))return Dm({name:""},i,e,"");{const r=e.name??"";return Dm({name:r},e.parent,e.providers,r)}}static#i=this.\u0275prov=vt({token:n,providedIn:"any",factory:()=>X(Pm)});static#n=this.__NG_ELEMENT_ID__=-1}return n})();const Nd=new jt("AppId",{providedIn:"root",factory:()=>Kw}),Kw="ng",zm=new jt("Platform Initializer"),Io=new jt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),jm=new jt("CSP nonce",{providedIn:"root",factory:()=>function(){if(void 0!==Dd)return Dd;if(typeof document<"u")return document;throw new z(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function Gm(n){return!(128&~n.flags)}var Hs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Hs||{});const qm=new Map;let Jw=0;const Vm="__ngContext__";function Us(n,t){var i;Mo(t)?(n[Vm]=t[Th],qm.set((i=t)[Th],i)):n[Vm]=t}let Qw;function zd(n,t){return Qw(n,t)}function Po(n,t,e,i,r){if(null!=i){let s,o=!1;Pr(i)?s=i:Mo(i)&&(o=!0,i=i[Tr]);const a=Rr(i);0===n&&null!==e?null==r?Um(t,e,a):Gh(t,e,a,r||null,!0):1===n&&null!==e?Gh(t,e,a,r||null,!0):2===n?function(h,u,c){const d=qd(h,u);d&&h.removeChild(d,u,c)}(t,a,o):3===n&&t.destroyNode(a),null!=s&&function(h,u,c,d,p){const f=c[Vs];f!==Rr(c)&&Po(u,h,d,f,p);for(let g=zn;g<c.length;g++){const m=c[g];Vh(m[we],m,h,u,d,f)}}(t,n,s,e,r)}}function Zm(n,t,e){return n.createElement(t,e)}function Bm(n,t){t[Ir].changeDetectionScheduler?.notify(),Vh(n,t,t[un],2,null,null)}function Wm(n,t){const e=n[kh],i=e.indexOf(t);e.splice(i,1)}function jd(n,t){if(n.length<=zn)return;const e=zn+t,i=n[e];if(i){const r=i[Eh];null!==r&&r!==n&&Wm(r,i),t>0&&(n[e-1][Yn]=i[Yn]);const s=Nh(n,zn+t);Bm(i[we],h=i),h[Tr]=null,h[Kn]=null;const o=s[Ha];null!==o&&o.detachView(s[we]),i[Qi]=null,i[Yn]=null,i[Jt]&=-129}var h;return i}function Hm(n,t){if(!(256&t[Jt])){const e=t[un];e.destroyNode&&Vh(n,t,e,3,null,null),function(r){let s=r[Wa];if(!s)return Gd(r[we],r);for(;s;){let o=null;if(Mo(s))o=s[Wa];else{const a=s[zn];a&&(o=a)}if(!o){for(;s&&!s[Yn]&&s!==r;)Mo(s)&&Gd(s[we],s),s=s[Qi];null===s&&(s=r),Mo(s)&&Gd(s[we],s),o=s&&s[Yn]}s=o}}(t)}}function Gd(n,t){if(!(256&t[Jt])){t[Jt]&=-129,t[Jt]|=256,t[qs]&&function(r){if(ue(r),fe(r))for(let s=0;s<r.producerNode.length;s++)Dt(r.producerNode[s],r.producerIndexOfThis[s]);r.producerNode.length=r.producerLastReadVersion.length=r.producerIndexOfThis.length=0,r.liveConsumerNode&&(r.liveConsumerNode.length=r.liveConsumerIndexOfThis.length=0)}(t[qs]),function(r,s){let o;if(null!=r&&null!=(o=r.destroyHooks))for(let a=0;a<o.length;a+=2){const l=s[o[a]];if(!(l instanceof bd)){const h=o[a+1];if(Array.isArray(h))for(let u=0;u<h.length;u+=2){const c=l[h[u]],d=h[u+1];rs(4,c,d);try{d.call(c)}finally{rs(5,c,d)}}else{rs(4,l,h);try{h.call(l)}finally{rs(5,l,h)}}}}}(n,t),function(r,s){const o=r.cleanup,a=s[V0];if(null!==o)for(let h=0;h<o.length-1;h+=2)if("string"==typeof o[h]){const u=o[h+3];u>=0?a[u]():a[-u].unsubscribe(),h+=2}else o[h].call(a[o[h+1]]);null!==a&&(s[V0]=null);const l=s[Ua];if(null!==l){s[Ua]=null;for(let h=0;h<l.length;h++)(0,l[h])()}}(n,t),1===t[we].type&&t[un].destroy();const e=t[Eh];if(null!==e&&Pr(t[Qi])){e!==t[Qi]&&Wm(e,t);const i=t[Ha];null!==i&&i.detachView(n)}qm.delete(t[Th])}}function Gh(n,t,e,i,r){n.insertBefore(t,e,i,r)}function Um(n,t,e){n.appendChild(t,e)}function Xm(n,t,e,i,r){null!==i?Gh(n,t,e,i,r):Um(n,t,e)}function qd(n,t){return n.parentNode(t)}let $m,e2=function(t,e,i){return 40&t.type?hr(t,i):null};function Vd(n,t,e,i){const r=function t2(n,t,e){return function(r,s,o){let a=s;for(;null!==a&&40&a.type;)a=(s=a).parent;if(null===a)return o[Tr];{const{componentOffset:l}=a;if(l>-1){const{encapsulation:h}=r.data[a.directiveStart+l];if(h===Rt.None||h===Rt.Emulated)return null}return hr(a,o)}}(n,t.parent,e)}(n,i,t),s=t[un],o=e2(i.parent||t[Kn],i,t);if(null!=r)if(Array.isArray(e))for(let a=0;a<e.length;a++)Xm(s,r,e[a],o,!1);else Xm(s,r,e,o,!1);void 0!==$m&&$m(s,i,t,e,r)}function qh(n,t){if(null!==t){const e=t.type;if(3&e)return hr(t,n);if(4&e)return Zd(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return qh(n,i);{const r=n[t.index];return Pr(r)?Zd(-1,r):Rr(r)}}if(32&e)return zd(t,n)()||Rr(n[t.index]);{const i=Ym(n,t);return null!==i?Array.isArray(i)?i[0]:qh(Ka(n[lr]),i):qh(n,t.next)}}return null}function Ym(n,t){return null!==t?n[lr][Kn].projection[t.projection]:null}function Zd(n,t){const e=zn+n+1;if(e<t.length){const i=t[e],r=i[we].firstChild;if(null!==r)return qh(i,r)}return t[Vs]}function Bd(n,t,e,i,r,s,o){for(;null!=e;){const a=i[e.index],l=e.type;if(o&&0===t&&(a&&Us(Rr(a),i),e.flags|=2),32&~e.flags)if(8&l)Bd(n,t,e.child,i,r,s,!1),Po(t,n,r,a,s);else if(32&l){const h=zd(e,i);let u;for(;u=h();)Po(t,n,r,u,s);Po(t,n,r,a,s)}else 16&l?i2(n,t,i,e,r,s):Po(t,n,r,a,s);e=o?e.projectionNext:e.next}}function Vh(n,t,e,i,r,s){Bd(e,i,n.firstChild,t,r,s,!1)}function i2(n,t,e,i,r,s){const o=e[lr],a=o[Kn].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Po(t,n,r,a[l],s);else{let l=a;const h=o[Qi];Gm(i)&&(l.flags|=128),Bd(n,t,l,h,r,s,!0)}}function Km(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Jm(n,t,e){const{mergedAttrs:i,classes:r,styles:s}=e;null!==i&&je(n,t,i),null!==r&&Km(n,t,r),null!==s&&n.setAttribute(t,"style",s)}class n2{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class r2{}let s2=()=>null;function Wd(n,t,e=!1){return s2(n,t,e)}class o2{}class Qm{}class a2{resolveComponentFactory(t){throw function(i){const r=Error(`No component factory found for ${ji(i)}.`);return r.ngComponent=i,r}(t)}}let Ro=(()=>{class n{static#t=this.NULL=new a2}return n})();function l2(){return Zh(Fr(),Ui())}function Zh(n,t){return new nl(hr(n,t))}let nl=(()=>{class n{constructor(e){this.nativeElement=e}static#t=this.__NG_ELEMENT_ID__=l2}return n})();class ty{}let h2=(()=>{class n{static#t=this.\u0275prov=vt({token:n,providedIn:"root",factory:()=>null})}return n})();const Hd={};function ey(n){return!!function(e){return null!==e&&("function"==typeof e||"object"==typeof e)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}class u2{constructor(){}supports(t){return ey(t)}create(t){return new d2(t)}}const c2=(n,t)=>t;class d2{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||c2}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const o=!i||e&&e.currentIndex<ny(i,r,s)?e:i,a=ny(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{s||(s=[]);const h=a-r,u=l-r;if(h!=u){for(let c=0;c<h;c++){const d=c<s.length?s[c]:s[c]=0,p=d+c;u<=p&&p<h&&(s[c]=d+1)}s[o.previousIndex]=u-h}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ey(t))throw new z(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,i,r,s=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)i=t[a],r=this._trackByFn(a,i),null!==s&&Object.is(s.trackById,r)?(o&&(s=this._verifyReinsertion(s,i,r,a)),Object.is(s.item,i)||this._addIdentityChange(s,i)):(s=this._mismatch(s,i,r,a),o=!0),s=s._next}else e=0,function(l,h){if(Array.isArray(l))for(let u=0;u<l.length;u++)h(l[u]);else{const u=l[Symbol.iterator]();let c;for(;!(c=u.next()).done;)h(c.value)}}(t,a=>{r=this._trackByFn(e,a),null!==s&&Object.is(s.trackById,r)?(o&&(s=this._verifyReinsertion(s,a,r,e)),Object.is(s.item,a)||this._addIdentityChange(s,a)):(s=this._mismatch(s,a,r,e),o=!0),s=s._next,e++}),this.length=e;return this._truncate(s),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):t=this._addAfter(new p2(e,i),s,r),t}_verifyReinsertion(t,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new iy),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new iy),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class p2{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class f2{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class iy{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new f2,this.map.set(e,i)),i.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ny(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}function ry(){return new sy([new u2])}let sy=(()=>{class n{static#t=this.\u0275prov=vt({token:n,providedIn:"root",factory:ry});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||ry()),deps:[[n,new Uw,new Hw]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new z(901,!1)}}return n})();function Bh(n,t,e,i,r=!1){for(;null!==e;){const s=t[e.index];null!==s&&i.push(Rr(s)),Pr(s)&&g2(s,i);const o=e.type;if(8&o)Bh(n,t,e.child,i);else if(32&o){const a=zd(e,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Ym(t,e);if(Array.isArray(a))i.push(...a);else{const l=Ka(t[lr]);Bh(l[we],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function g2(n,t){for(let e=zn;e<n.length;e++){const i=n[e],r=i[we].firstChild;null!==r&&Bh(i[we],i,r,t)}n[Vs]!==n[Tr]&&t.push(n[Vs])}let oy=[];const m2={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Ya(n.lView)},consumerOnSignalRead(){this.lView[qs]=this}};function ay(n){return hy(n[Wa])}function ly(n){return hy(n[Yn])}function hy(n){for(;null!==n&&!Pr(n);)n=n[Yn];return n}function Ud(n){return n.ngOriginalError}class Fo{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Ud(t);for(;e&&Ud(e);)e=Ud(e);return e||null}}const uy=new jt("",{providedIn:"root",factory:()=>ht(Fo).handleError.bind(void 0)}),y2=new jt("",{providedIn:"root",factory:()=>!1}),Oo={};function ss(n=1){cy(Zs(),Ui(),Eo()+n,!1)}function cy(n,t,e,i){if(!i)if(3&~t[Jt]){const r=n.preOrderHooks;null!==r&&Oh(t,r,0,e)}else{const r=n.preOrderCheckHooks;null!==r&&Fh(t,r,e)}Bs(e)}function bi(n,t=kt.Default){const e=Ui();return null===e?X(n,t):Cm(Fr(),e,I(n),t)}function Wh(n,t,e,i,r,s,o,a,l,h,u){const c=t.blueprint.slice();return c[Tr]=r,c[Jt]=204|i,(null!==h||n&&2048&n[Jt])&&(c[Jt]|=2048),tm(c),c[Qi]=c[wo]=n,c[kr]=e,c[Ir]=o||n&&n[Ir],c[un]=a||n&&n[un],c[bo]=l||n&&n[bo]||null,c[Kn]=s,c[Th]=Jw++,c[Sh]=u,c[B0]=h,c[lr]=2==t.type?n[lr]:c,c}function Hh(n,t,e,i,r){let s=n.data[t];if(null===s)s=function(a,l,h,u,c){const d=nm(),p=rm(),f=a.data[l]=function(m,y,_,v,x,b){let w=0;return null!==Ce.skipHydrationRootTNode&&(w|=128),{type:_,index:v,insertBeforeIndex:null,injectorIndex:y?y.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:w,providerIndexes:0,value:x,attrs:b,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:y,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,p?d:d&&d.parent,h,l,u,c);return null===a.firstChild&&(a.firstChild=f),null!==d&&(p?null==d.child&&null!==f.parent&&(d.child=f):null===d.next&&(d.next=f,f.prev=d)),f}(n,t,e,i,r),Ce.lFrame.inI18n&&(s.flags|=32);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const o=function(){const l=Ce.lFrame,h=l.currentTNode;return l.isParent?h:h.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ja(s,!0),s}function dy(n,t,e,i){if(0===e)return-1;const r=t.length;for(let s=0;s<e;s++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function py(n,t,e,i,r){const s=Eo(),o=2&i;try{Bs(-1),o&&t.length>ns&&cy(n,t,ns,!1),rs(o?2:0,r),e(i,r)}finally{Bs(s),rs(o?3:1,r)}}function fy(n,t,e){if(H0(t)){const i=$t(null);try{const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,e[s],s)}}finally{$t(i)}}}function gy(n,t,e){im()&&(function(r,s,o,a){const l=o.directiveStart,h=o.directiveEnd;Ih(o)&&function(d,p,f){const g=hr(p,d),m=yy(f);let y=16;f.signals?y=4096:f.onPush&&(y=64);const _=Uh(d,Wh(d,m,null,y,g,p,null,d[Ir].rendererFactory.createRenderer(g,f),null,null,null));d[p.index]=_}(s,o,r.data[l+o.componentOffset]),r.firstCreatePass||vm(o,s),Us(a,s);const u=o.initialInputs;for(let c=l;c<h;c++){const d=r.data[c],p=Qa(s,r,c,o);Us(p,s),null!==u&&w2(0,c-l,p,d,0,u),Xa(d)&&(So(o.index,s)[kr]=Qa(s,r,c,o))}}(n,t,e,hr(e,t)),!(64&~e.flags)&&wy(n,t,e))}function my(n,t,e=hr){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?e(t,n):n[o];n[r++]=a}}}function yy(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=Xd(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function Xd(n,t,e,i,r,s,o,a,l,h,u){const c=ns+i,d=c+r,p=function(m,y){const _=[];for(let v=0;v<y;v++)_.push(v<m?null:Oo);return _}(c,d),f="function"==typeof h?h():h;return p[we]={type:n,blueprint:p,template:e,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1,ssrId:u}}function _y(n,t,e,i){for(let r in n)if(n.hasOwnProperty(r)){e=null===e?{}:e;const s=n[r];null===i?vy(e,t,r,s):i.hasOwnProperty(r)&&vy(e,t,i[r],s)}return e}function vy(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function xy(n,t,e,i){if(im()){const r=null===i?null:{"":-1},s=function(h,u){const c=h.directiveRegistry;let d=null,p=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];if(Mh(u,g.selectors,!1))if(d||(d=[]),Xa(g))if(null!==g.findHostDirectiveDefs){const m=[];p=p||new Map,g.findHostDirectiveDefs(g,m,p),d.unshift(...m,g),$d(h,u,m.length)}else d.unshift(g),$d(h,u,0);else p=p||new Map,g.findHostDirectiveDefs?.(g,d,p),d.push(g)}return null===d?null:[d,p]}(n,e);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&by(n,t,e,o,r,a),r&&function(h,u,c){if(u){const d=h.localNames=[];for(let p=0;p<u.length;p+=2){const f=c[u[p+1]];if(null==f)throw new z(-301,!1);d.push(u[p],f)}}}(e,i,r)}e.mergedAttrs=Ji(e.mergedAttrs,e.attrs)}function by(n,t,e,i,r,s){for(let h=0;h<i.length;h++)Vw(vm(e,t),n,i[h].type);var u,c,d;c=n.data.length,d=i.length,(u=e).flags|=1,u.directiveStart=c,u.directiveEnd=c+d,u.providerIndexes=c;for(let h=0;h<i.length;h++){const u=i[h];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=dy(n,t,i.length,null);for(let h=0;h<i.length;h++){const u=i[h];e.mergedAttrs=Ji(e.mergedAttrs,u.hostAttrs),b2(n,e,t,l,u),x2(l,u,r),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const c=u.type.prototype;!o&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),o=!0),!a&&(c.ngOnChanges||c.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}!function(u,c,d){const p=c.directiveEnd,f=u.data,g=c.attrs,m=[];let y=null,_=null;for(let v=c.directiveStart;v<p;v++){const x=f[v],b=d?d.get(x):null,M=b?b.outputs:null;y=_y(x.inputs,v,y,b?b.inputs:null),_=_y(x.outputs,v,_,M);const w=null===y||null===g||Ba(c)?null:C2(y,v,g);m.push(w)}null!==y&&(y.hasOwnProperty("class")&&(c.flags|=8),y.hasOwnProperty("style")&&(c.flags|=16)),c.initialInputs=m,c.inputs=y,c.outputs=_}(n,e,s)}function wy(n,t,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,o=Ce.lFrame.currentDirectiveIndex;try{Bs(s);for(let a=i;a<r;a++){const l=n.data[a],h=t[a];fd(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&v2(l,h)}}finally{Bs(-1),fd(o)}}function v2(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function $d(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function x2(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Xa(t)&&(e[""]=n)}}function b2(n,t,e,i,r){n.data[i]=r;const s=r.factory||(r.factory=$a(r.type)),o=new bd(s,Xa(r),bi);n.blueprint[i]=o,e[i]=o,function(l,h,u,c,d){const p=d.hostBindings;if(p){let f=l.hostBindingOpCodes;null===f&&(f=l.hostBindingOpCodes=[]);const g=~h.index;(function(y){let _=y.length;for(;_>0;){const v=y[--_];if("number"==typeof v&&v<0)return v}return 0})(f)!=g&&f.push(g),f.push(u,c,p)}}(n,t,i,dy(n,e,r.hostVars,Oo),r)}function w2(n,t,e,i,r,s){const o=s[t];if(null!==o)for(let a=0;a<o.length;)Cy(i,e,o[a++],o[a++],o[a++])}function Cy(n,t,e,i,r){const s=$t(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(t,r)),null!==n.setInput?n.setInput(t,r,e,i):t[i]=r}finally{$t(s)}}function C2(n,t,e){let i=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===t){i.push(s,o[a+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function My(n,t,e,i){return[n,!0,0,t,null,i,null,e,null,null]}function Sy(n,t){const e=n.contentQueries;if(null!==e){const i=$t(null);try{for(let r=0;r<e.length;r+=2){const s=e[r+1];if(-1!==s){const o=n.data[s];om(e[r]),o.contentQueries(2,t[s],s)}}}finally{$t(i)}}}function Uh(n,t){return n[Wa]?n[Z0][Yn]=t:n[Wa]=t,n[Z0]=t,t}function Yd(n,t,e){om(0);const i=$t(null);try{t(n,e)}finally{$t(i)}}function Kd(n,t,e,i,r){for(let s=0;s<e.length;){const o=e[s++],a=e[s++];Cy(n.data[o],t[o],i,a,r)}}function Ey(n,t){for(let e=ay(n);null!==e;e=ly(e))for(let i=zn;i<e.length;i++)Ty(e[i],t)}function E2(n,t,e){Ty(So(t,n),e)}function Ty(n,t){dd(n)&&Jd(n,t)}function Jd(n,t){const e=n[we],i=n[Jt],r=n[qs];let s=!!(0===t&&16&i);if(s||=!!(64&i&&0===t),s||=!!(1024&i),s||=!(!r?.dirty||!Kt(r)),r&&(r.dirty=!1),n[Jt]&=-9217,s)!function S2(n,t,e,i){const r=t[Jt];if(!(256&~r))return;t[Ir].inlineEffectRunner?.flush(),gd(t);let s=null,o=null;var l;2!==n.type&&(o=(l=t)[qs]??function(u){const c=oy.pop()??Object.create(m2);return c.lView=u,c}(l),s=function(l){return l&&(l.nextProducerIndex=0),$t(l)}(o));try{tm(t),Ce.lFrame.bindingIndex=n.bindingStartIndex,null!==e&&py(n,t,e,2,i);const a=!(3&~r);if(a){const u=n.preOrderCheckHooks;null!==u&&Fh(t,u,null)}else{const u=n.preOrderHooks;null!==u&&Oh(t,u,0,null),xd(t,0)}if(function(c){for(let d=ay(c);null!==d;d=ly(d)){if(!(d[Jt]&cd.HasTransplantedViews))continue;const p=d[kh];for(let f=0;f<p.length;f++)Nw(p[f])}}(t),Ey(t,0),null!==n.contentQueries&&Sy(n,t),a){const u=n.contentCheckHooks;null!==u&&Fh(t,u)}else{const u=n.contentHooks;null!==u&&Oh(t,u,1),xd(t,1)}!function(c,d){const p=c.hostBindingOpCodes;if(null!==p)try{for(let f=0;f<p.length;f++){const g=p[f];if(g<0)Bs(~g);else{const m=g,y=p[++f],_=p[++f];zw(y,m),_(2,d[m])}}}finally{Bs(-1)}}(n,t);const l=n.components;null!==l&&ky(t,l,0);const h=n.viewQuery;if(null!==h&&Yd(2,h,i),a){const u=n.viewCheckHooks;null!==u&&Fh(t,u)}else{const u=n.viewHooks;null!==u&&Oh(t,u,2),xd(t,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[ud]){for(const u of t[ud])u();t[ud]=null}t[Jt]&=-73}catch(a){throw Ya(t),a}finally{null!==o&&(function(l,h){if($t(h),l&&void 0!==l.producerNode&&void 0!==l.producerIndexOfThis&&void 0!==l.producerLastReadVersion){if(fe(l))for(let u=l.nextProducerIndex;u<l.producerNode.length;u++)Dt(l.producerNode[u],l.producerIndexOfThis[u]);for(;l.producerNode.length>l.nextProducerIndex;)l.producerNode.pop(),l.producerLastReadVersion.pop(),l.producerIndexOfThis.pop()}}(o,s),function(l){l.lView[qs]!==l&&(l.lView=null,oy.push(l))}(o)),md()}}(e,n,e.template,n[kr]);else if(8192&i){Ey(n,1);const o=e.components;null!==o&&ky(n,o,1)}}function ky(n,t,e){for(let i=0;i<t.length;i++)E2(n,t[i],e)}function Iy(n){for(n[Ir].changeDetectionScheduler?.notify();n;){n[Jt]|=64;const t=Ka(n);if(Ow(n)&&!t)return n;n=t}return null}class rl{get rootNodes(){const t=this._lView,e=t[we];return Bh(e,t,e.firstChild,[])}constructor(t,e,i=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[kr]}set context(t){this._lView[kr]=t}get destroyed(){return!(256&~this._lView[Jt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Qi];if(Pr(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(jd(t,i),Nh(e,i))}this._attachedToViewContainer=!1}Hm(this._lView[we],this._lView)}onDestroy(t){!function(i,r){if(!(256&~i[Jt]))throw new z(911,!1);null===i[Ua]&&(i[Ua]=[]),i[Ua].push(r)}(this._lView,t)}markForCheck(){Iy(this._cdRefInjectingView||this._lView)}detach(){this._lView[Jt]&=-129}reattach(){pd(this._lView),this._lView[Jt]|=128}detectChanges(){this._lView[Jt]|=1024,function M2(n,t=!0){const e=n[Ir],i=e.rendererFactory;i.begin?.();try{!function(s){Jd(s,0);let o=0;for(;em(s);){if(100===o)throw new z(103,!1);o++,Jd(s,1)}}(n)}catch(r){throw t&&function(o,a){const l=o[bo],h=l?l.get(Fo,null):null;h&&h.handleError(a)}(n,r),r}finally{i.end?.(),e.inlineEffectRunner?.flush()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,Bm(this._lView[we],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new z(902,!1);this._appRef=t,pd(this._lView)}}let Py=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=T2}return n})();function T2(n){return function(e,i,r){if(Ih(e)&&!r){const s=So(e.index,i);return new rl(s,s)}return 47&e.type?new rl(i[lr],i):null}(Fr(),Ui(),!(16&~n))}const Ry=new Set;function Qd(n){return t=>{setTimeout(n,void 0,t)}}const Cn=class extends ts{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let r=t,s=e||(()=>null),o=i;if(t&&"object"==typeof t){const l=t;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Qd(s),r&&(r=Qd(r)),o&&(o=Qd(o)));const a=super.subscribe({next:r,error:s,complete:o});return t instanceof ke&&t.add(a),a}};function Fy(...n){}class Ri{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Cn(!1),this.onMicrotaskEmpty=new Cn(!1),this.onStable=new Cn(!1),this.onError=new Cn(!1),typeof Zone>"u")throw new z(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){const o="function"==typeof lt.requestAnimationFrame;let a=lt[o?"requestAnimationFrame":"setTimeout"],l=lt[o?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&a&&l){const h=a[Zone.__symbol__("OriginalDelegate")];h&&(a=h);const u=l[Zone.__symbol__("OriginalDelegate")];u&&(l=u)}return{nativeRequestAnimationFrame:a,nativeCancelAnimationFrame:l}}().nativeRequestAnimationFrame,function(o){const a=()=>{var h;(h=o).isCheckStableRunning||-1!==h.lastRequestAnimationFrameId||(h.lastRequestAnimationFrameId=h.nativeRequestAnimationFrame.call(lt,()=>{h.fakeTopEventTask||(h.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{h.lastRequestAnimationFrameId=-1,ep(h),h.isCheckStableRunning=!0,tp(h),h.isCheckStableRunning=!1},void 0,()=>{},()=>{})),h.fakeTopEventTask.invoke()}),ep(h))};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,u,c,d,p)=>{if(g=p,Array.isArray(g)&&1===g.length&&!0===g[0].data?.__ignore_ng_zone__)return l.invokeTask(u,c,d,p);var g;try{return Oy(o),l.invokeTask(u,c,d,p)}finally{(o.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||o.shouldCoalesceRunChangeDetection)&&a(),Ay(o)}},onInvoke:(l,h,u,c,d,p,f)=>{try{return Oy(o),l.invoke(u,c,d,p,f)}finally{o.shouldCoalesceRunChangeDetection&&a(),Ay(o)}},onHasTask:(l,h,u,c)=>{l.hasTask(u,c),h===u&&("microTask"==c.change?(o._hasPendingMicrotasks=c.microTask,ep(o),tp(o)):"macroTask"==c.change&&(o.hasPendingMacrotasks=c.macroTask))},onHandleError:(l,h,u,c)=>(l.handleError(u,c),o.runOutsideAngular(()=>o.onError.emit(c)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ri.isInAngularZone())throw new z(909,!1)}static assertNotInAngularZone(){if(Ri.isInAngularZone())throw new z(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,k2,Fy,Fy);try{return s.runTask(o,e,i)}finally{s.cancelTask(o)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const k2={};function tp(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ep(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Oy(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Ay(n){n._nesting--,tp(n)}class I2{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Cn,this.onMicrotaskEmpty=new Cn,this.onStable=new Cn,this.onError=new Cn}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}let Ly=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of e)i();return!!this.handler?.execute()||e.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#t=this.\u0275prov=vt({token:n,providedIn:"root",factory:()=>new n})}return n})();function P2(n,t){const e=So(t,n),i=e[we];!function(o,a){for(let l=a.length;l<o.blueprint.length;l++)a.push(o.blueprint[l])}(i,e);const r=e[Tr];null!==r&&null===e[Sh]&&(e[Sh]=Wd(r,e[bo])),ip(i,e,e[kr])}function ip(n,t,e){gd(t);try{const i=n.viewQuery;null!==i&&Yd(1,i,e);const r=n.template;null!==r&&py(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Sy(n,t),n.staticViewQueries&&Yd(2,n.viewQuery,e);const s=n.components;null!==s&&function(a,l){for(let h=0;h<l.length;h++)P2(a,l[h])}(t,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[Jt]&=-5,md()}}function np(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?r=mo(r,a):2==s&&(i=mo(i,a+": "+t[++o]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}class Dy extends Ro{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=xo(t);return new zy(e,this.ngModule)}}function Ny(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class R2{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=E(i);const r=this.injector.get(t,Hd,i);return r!==Hd||e===Hd?r:this.parentInjector.get(t,e,i)}}class zy extends Qm{get inputs(){const t=this.componentDef,e=t.inputTransforms,i=Ny(t.inputs);if(null!==e)for(const r of i)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return i}get outputs(){return Ny(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Nn).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,r){let s=(r=r||this.ngModule)instanceof Ws?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new R2(t,s):t,a=o.get(ty,null);if(null===a)throw new z(407,!1);const l={rendererFactory:a,sanitizer:o.get(h2,null),inlineEffectRunner:null,afterRenderEventManager:o.get(Ly,null),changeDetectionScheduler:o.get(r2,null)},h=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=i?function(v,x,b,M){const w=M.get(y2,!1)||b===Rt.ShadowDom;return v.selectRootElement(x,w)}(h,i,this.componentDef.encapsulation,o):Zm(h,u,function(v){const x=v.toLowerCase();return"svg"===x?"svg":"math"===x?"math":null}(u));let d=512;this.componentDef.signals?d|=4096:this.componentDef.onPush||(d|=16);let p=null;null!==c&&(p=Wd(c,o,!0));const f=Xd(0,null,null,1,0,null,null,null,null,null,null),g=Wh(null,f,null,d,null,null,l,h,o,null,p);let m,y;gd(g);try{const _=this.componentDef;let v,x=null;_.findHostDirectiveDefs?(v=[],x=new Map,_.findHostDirectiveDefs(_,v,x),v.push(_)):v=[_];const M=function(S,R,P,A,T,K,N){const F=T[we];!function(D,V,It,yt){for(const Xt of D)V.mergedAttrs=Ji(V.mergedAttrs,Xt.hostAttrs);null!==V.mergedAttrs&&(np(V,V.mergedAttrs,!0),null!==It&&Jm(yt,It,V))}(A,S,R,N);let j=null;null!==R&&(j=Wd(R,T[bo]));const q=K.rendererFactory.createRenderer(R,P);let $=16;P.signals?$=4096:P.onPush&&($=64);const ct=Wh(T,yy(P),null,$,T[S.index],S,K,q,null,null,j);return F.firstCreatePass&&$d(F,S,A.length-1),Uh(T,ct),T[S.index]=ct}(function(S,R){const P=S[we],A=ns;return S[A]=R,Hh(P,A,2,"#host",null)}(g,c),c,_,v,g,l,h);y=Q0(f,ns),c&&function(S,R,P,A){if(A)je(S,P,["ng-version","17.0.9"]);else{const{attrs:T,classes:K}=function(F){const j=[],q=[];let $=1,ct=2;for(;$<F.length;){let dt=F[$];if("string"==typeof dt)2===ct?""!==dt&&j.push(dt,F[++$]):8===ct&&q.push(dt);else{if(!ln(ct))break;ct=dt}$++}return{attrs:j,classes:q}}(R.selectors[0]);T&&je(S,P,T),K&&K.length>0&&Km(S,P,K.join(" "))}}(h,_,c,i),void 0!==e&&function(S,R,P){const A=S.projection=[];for(let T=0;T<R.length;T++){const K=P[T];A.push(null!=K?Array.from(K):null)}}(y,this.ngContentSelectors,e),m=function(S,R,P,A,T,K){const N=Fr(),F=T[we],j=hr(N,T);by(F,T,N,P,null,A);for(let $=0;$<P.length;$++)Us(Qa(T,F,N.directiveStart+$,N),T);wy(F,T,N),j&&Us(j,T);const q=Qa(T,F,N.directiveStart+N.componentOffset,N);if(S[kr]=T[kr]=q,null!==K)for(const $ of K)$(q,R);return fy(F,N,S),q}(M,_,v,x,g,[O2]),ip(f,g,null)}finally{md()}return new F2(this.componentType,m,Zh(y,g),g,y)}}class F2 extends o2{constructor(t,e,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new rl(r,void 0,!1),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const s=this._rootLView;Kd(s[we],s,r,t,e),this.previousInputValues.set(t,e),Iy(So(this._tNode.index,s))}}get injector(){return new tl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function O2(){const n=Fr();vd(Ui()[we],n)}function rp(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Xh(n,t){return n<<17|t<<2}function Xs(n){return n>>17&32767}function sp(n){return 2|n}function Ao(n){return(131068&n)>>2}function op(n,t){return-131069&n|t<<2}function ap(n){return 1|n}function jy(n,t,e,i){const r=n[e+1],s=null===t;let o=i?Xs(r):Ao(r),a=!1;for(;0!==o&&(!1===a||s);){const l=n[o+1];A2(n[o],t)&&(a=!0,n[o+1]=i?ap(l):sp(l)),o=i?Xs(l):Ao(l)}a&&(n[e+1]=i?sp(r):ap(r))}function A2(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&el(n,t)>=0}function os(n,t,e){const i=Ui();return rp(i,sm(),t)&&function(s,o,a,l,h,u,c,d){const p=hr(o,a);let f,g=o.inputs;null!=g&&(f=g[l])?(Kd(s,a,f,l,h),Ih(o)&&function(y,_){const v=So(_,y);16&v[Jt]||(v[Jt]|=64)}(a,o.index)):3&o.type&&(l=function(y){return"class"===y?"className":"for"===y?"htmlFor":"formaction"===y?"formAction":"innerHtml"===y?"innerHTML":"readonly"===y?"readOnly":"tabindex"===y?"tabIndex":y}(l),h=null!=c?c(h,o.value||"",l):h,u.setProperty(p,l,h))}(Zs(),function(){const s=Ce.lFrame;return Q0(s.tView,s.selectedIndex)}(),i,n,t,i[un],e),os}function Gy(n,t,e,i,r){const s=r?"class":"style";Kd(n,e,t.inputs[s],s,i)}function $h(n,t,e){return function(r,s,o,a){const l=Ui(),h=Zs(),u=function(d){const p=Ce.lFrame,f=p.bindingIndex;return p.bindingIndex=p.bindingIndex+2,f}();var d,p,g;h.firstUpdatePass&&function(d,p,f,g){const m=d.data;if(null===m[f+1]){const y=m[Eo()],_=f>=d.expandoStartIndex;!!(16&y.flags)&&null===p&&!_&&(p=!1),p=function(x,b,M,w){const S=function(A){const T=Ce.lFrame.currentDirectiveIndex;return-1===T?null:A[T]}(x);let R=b.residualStyles;if(null===S)0===b.styleBindings&&(M=sl(M=lp(null,x,b,M,w),b.attrs,w),R=null);else{const P=b.directiveStylingLast;if(-1===P||x[P]!==S)if(M=lp(S,x,b,M,w),null===R){let A=function(K,N,F){const j=N.styleBindings;if(0!==Ao(j))return K[Xs(j)]}(x,b);void 0!==A&&Array.isArray(A)&&(A=lp(null,x,b,A[1],w),A=sl(A,b.attrs,w),j=A,x[Xs(b.styleBindings)]=j)}else R=function(T,K,N){let F;const j=K.directiveEnd;for(let q=1+K.directiveStylingLast;q<j;q++)F=sl(F,T[q].hostAttrs,N);return sl(F,K.attrs,N)}(x,b,w)}var j;return void 0!==R&&(b.residualStyles=R),M}(m,y,p,false),function(x,b,M,w,S,R){let P=b.styleBindings,A=Xs(P),T=Ao(P);x[w]=M;let K,N=!1;if(Array.isArray(M)?(K=M[1],(null===K||el(M,K)>0)&&(N=!0)):K=M,S)if(0!==T){const F=Xs(x[A+1]);x[w+1]=Xh(F,A),0!==F&&(x[F+1]=op(x[F+1],w)),x[A+1]=131071&x[A+1]|w<<17}else x[w+1]=Xh(A,0),0!==A&&(x[A+1]=op(x[A+1],w)),A=w;else x[w+1]=Xh(T,0),0===A?A=w:x[T+1]=op(x[T+1],w),T=w;N&&(x[w+1]=sp(x[w+1])),jy(x,K,w,!0),jy(x,K,w,!1),function(j,q,$,ct,dt){const D=j.residualStyles;null!=D&&"string"==typeof q&&el(D,q)>=0&&($[ct+1]=ap($[ct+1]))}(b,K,x,w),P=Xh(A,T),b.styleBindings=P}(m,y,p,f,_)}}(h,r,u),s!==Oo&&rp(l,u,s)&&function(d,p,f,g,m,y,_,v){if(!(3&p.type))return;const x=d.data,b=x[v+1];Yh(1&~b?void 0:qy(x,p,f,m,Ao(b),_))||(Yh(y)||!(2&~b)&&(y=qy(x,null,f,m,v,_)),function(S,R,P,A,T){{let K=-1===A.indexOf("-")?void 0:Hs.DashCase;null==T?S.removeStyle(P,A,K):("string"==typeof T&&T.endsWith("!important")&&(T=T.slice(0,-10),K|=Hs.Important),S.setStyle(P,A,T,K))}}(g,0,J0(Eo(),f),m,y))}(h,h.data[Eo()],l,l[un],r,l[u+1]=(p=o,null==(d=s)||""===d||("string"==typeof p?d+=p:"object"==typeof d&&(d=ji((g=d)instanceof n2?g.changingThisBreaksApplicationSecurity:g))),d),a,u)}(n,t,e,!1),$h}function lp(n,t,e,i,r){let s=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<o&&(s=t[a],i=sl(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(e.directiveStylingLast=a),i}function sl(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ww(n,o,!!e||t[++s]))}return void 0===n?null:n}function qy(n,t,e,i,r,s){const o=null===t;let a;for(;r>0;){const l=n[r],h=Array.isArray(l),u=h?l[1]:l,c=null===u;let d=e[r+1];d===Oo&&(d=c?St:void 0);let p=c?Ed(d,i):u===i?d:void 0;if(h&&!Yh(p)&&(p=Ed(l,i)),Yh(p)&&(a=p,o))return a;const f=n[r+1];r=o?Xs(f):Ao(f)}if(null!==t){let l=s?t.residualClasses:t.residualStyles;null!=l&&(a=Ed(l,i))}return a}function Yh(n){return void 0!==n}function Vy(n,t){return!t||null===t.firstChild||Gm(n)}let hp=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=D2}return n})();function D2(){return function(t,e){let i;const r=e[t.index];return Pr(r)?i=r:(i=My(r,e,null,t),e[t.index]=i,Uh(e,i)),z2(i,e,t,r),new Zy(i,t,e)}(Fr(),Ui())}const N2=hp,Zy=class extends N2{constructor(n,t,e){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=e}get element(){return Zh(this._hostTNode,this._hostLView)}get injector(){return new tl(this._hostTNode,this._hostLView)}get parentInjector(){const n=Md(this._hostTNode,this._hostLView);if(gm(n)){const t=Lh(n,this._hostLView),e=Ah(n);return new tl(t[we].data[e+8],t)}return new tl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=By(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-zn}createEmbeddedView(n,t,e){let i,r;"number"==typeof e?i=e:null!=e&&(i=e.index,r=e.injector);const s=n.createEmbeddedViewImpl(t||{},r,null);return this.insertImpl(s,i,Vy(this._hostTNode,null)),s}createComponent(n,t,e,i,r){const s=n&&!function(c){return"function"==typeof c}(n);let o;if(s)o=t;else{const u=t||{};o=u.index,e=u.injector,i=u.projectableNodes,r=u.environmentInjector||u.ngModuleRef}const a=s?n:new zy(xo(n)),l=e||this.parentInjector;if(!r&&null==a.ngModule){const u=(s?l:this.parentInjector).get(Ws,null);u&&(r=u)}xo(a.componentType??{});const h=a.create(l,i,null,r);return this.insertImpl(h.hostView,o,Vy(this._hostTNode,null)),h}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,e){const i=n._lView;if(Pr(i[Qi])){const o=this.indexOf(n);if(-1!==o)this.detach(o);else{const a=i[Qi],l=new Zy(a,a[Kn],a[Qi]);l.detach(l.indexOf(n))}}const r=this._adjustIndex(t),s=this._lContainer;return function L2(n,t,e,i=!0){const r=t[we];if(function(a,l,h,u){const c=zn+u,d=h.length;u>0&&(h[c-1][Yn]=l),u<d-zn?(l[Yn]=h[c],Im(h,zn+u,l)):(h.push(l),l[Yn]=null),l[Qi]=h;const p=l[Eh];null!==p&&h!==p&&function(m,y){const _=m[kh];y[lr]!==y[Qi][Qi][lr]&&(m[Jt]|=cd.HasTransplantedViews),null===_?m[kh]=[y]:_.push(y)}(p,l);const f=l[Ha];null!==f&&f.insertView(a),pd(l),l[Jt]|=128}(r,t,n,e),i){const o=Zd(e,n),a=t[un],l=qd(a,n[Vs]);null!==l&&(u=r,c=n[Kn],d=a,g=o,(p=t)[Tr]=f=l,p[Kn]=c,Vh(u,p,d,1,f,g))}var u,c,d,p,f,g;const s=t[Sh];null!==s&&null!==s.firstChild&&(s.firstChild=null)}(s,i,r,e),n.attachToViewContainerRef(),Im(up(s),r,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=By(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),e=jd(this._lContainer,t);e&&(Nh(up(this._lContainer),t),Hm(e[we],e))}detach(n){const t=this._adjustIndex(n,-1),e=jd(this._lContainer,t);return e&&null!=Nh(up(this._lContainer),t)?new rl(e):null}_adjustIndex(n,t=0){return n??this.length+t}};function By(n){return n[8]}function up(n){return n[8]||(n[8]=[])}let z2=function(t,e,i,r){if(t[Vs])return;let s;s=8&i.type?Rr(r):function(a,l){const h=a[un],u=h.createComment(""),c=hr(l,a);return Gh(h,qd(h,c),u,h.nextSibling(c),!1),u}(e,i),t[Vs]=s},j2=()=>!1;function Lo(n,t,e,i,r,s,o,a){const l=Ui(),h=Zs(),u=n+ns,c=h.firstCreatePass?function(g,m,y,_,v,x,b,M,w){const S=m.consts,R=Hh(m,g,4,b||null,Rh(S,M));xy(m,y,R,Rh(S,w)),vd(m,R);const P=R.tView=Xd(2,R,_,v,x,m.directiveRegistry,m.pipeRegistry,null,m.schemas,S,null);return null!==m.queries&&(m.queries.template(m,R),P.queries=m.queries.embeddedTView(R)),R}(u,h,l,t,e,i,r,s,o):h.data[u];Ja(c,!1);const d=G2(h,l,c,n);yd()&&Vd(h,l,d,c),Us(d,l);const p=My(d,l,d,c);return l[u]=p,Uh(l,p),j2(p,c,l),U0(c)&&gy(h,l,c),null!=o&&my(l,c,a),Lo}let G2=function(t,e,i,r){return _d(!0),e[un].createComment("")};function cn(n,t,e,i){const r=Ui(),s=Zs(),o=ns+n,a=r[un],l=s.firstCreatePass?function(d,p,f,g,m,y){const _=p.consts,v=Hh(p,d,2,g,Rh(_,m));return xy(p,f,v,Rh(_,y)),null!==v.attrs&&np(v,v.attrs,!1),null!==v.mergedAttrs&&np(v,v.mergedAttrs,!0),null!==p.queries&&p.queries.elementStart(p,v),v}(o,s,r,t,e,i):s.data[o],h=q2(s,r,l,a,t,n);r[o]=h;const u=U0(l);return Ja(l,!0),Jm(a,h,l),32&~l.flags&&yd()&&Vd(s,r,h,l),0===Ce.lFrame.elementDepthCount&&Us(h,r),Ce.lFrame.elementDepthCount++,u&&(gy(s,r,l),fy(s,l,r)),null!==i&&my(r,l),cn}function Mn(){let n=Fr();rm()?Ce.lFrame.isParent=!1:(n=n.parent,Ja(n,!1));const t=n;Ce.skipHydrationRootTNode===t&&(Ce.skipHydrationRootTNode=null),Ce.lFrame.elementDepthCount--;const e=Zs();return e.firstCreatePass&&(vd(e,n),H0(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function(r){return!!(8&r.flags)}(t)&&Gy(e,t,Ui(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(r){return!!(16&r.flags)}(t)&&Gy(e,t,Ui(),t.stylesWithoutHost,!1),Mn}function Do(n,t,e,i){return cn(n,t,e,i),Mn(),Do}let q2=(n,t,e,i,r,s)=>(_d(!0),Zm(i,r,Ce.lFrame.currentNamespace));const $s=void 0;var V2=["en",[["a","p"],["AM","PM"],$s],[["AM","PM"],$s,$s],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],$s,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],$s,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",$s,"{1} 'at' {0}",$s],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let cp={};function Jn(n){const t=n.toLowerCase().replace(/_/g,"-");let e=Wy(t);if(e)return e;const i=t.split("-")[0];if(e=Wy(i),e)return e;if("en"===i)return V2;throw new z(701,!1)}function Wy(n){return n in cp||(cp[n]=lt.ng&&lt.ng.common&&lt.ng.common.locales&&lt.ng.common.locales[n]),cp[n]}var ki=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ki||{});const Kh="en-US";let Z2=Kh;function Hy(n){return!!n&&"function"==typeof n.then}function B2(n){return!!n&&"function"==typeof n.subscribe}function Jh(n=1){return(Ce.lFrame.contextLView=function(r,s){for(;r>0;)s=s[wo],r--;return s}(n,Ce.lFrame.contextLView))[kr]}function No(n,t=""){const e=Ui(),i=Zs(),r=n+ns,s=i.firstCreatePass?Hh(i,r,1,t,null):i.data[r],o=W2(i,e,s,t,n);e[r]=o,yd()&&Vd(i,e,o,s),Ja(s,!1)}let W2=(n,t,e,i,r)=>(_d(!0),t[un].createText(i));function Qh(n){return Uy("",n,""),Qh}function Uy(n,t,e){const i=Ui(),r=(a=n,l=t,h=e,rp(i,sm(),l)?a+Lt(l)+h:Oo);var a,l,h;return r!==Oo&&function(o,a,l){const h=J0(a,o);o[un].setValue(h,l)}(i,Eo(),r),Uy}class ol{}class H2{}class Xy extends ol{constructor(t,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Dy(this);const r=function(o,a){return o[_t]||null}(t);var o;this._bootstrapComponents=(o=r.bootstrap)instanceof Function?o():o,this._r3Injector=Nm(t,e,[{provide:ol,useValue:this},{provide:Ro,useValue:this.componentFactoryResolver},...i],ji(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class U2 extends H2{constructor(t){super(),this.moduleType=t}create(t){return new Xy(this.moduleType,t,[])}}class X2 extends ol{constructor(t){super(),this.componentFactoryResolver=new Dy(this),this.instance=null;const e=new Od([...t.providers,{provide:ol,useValue:this},{provide:Ro,useValue:this.componentFactoryResolver}],t.parent||Fd(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}let $2=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=Om(0,e.type),r=i.length>0?function(o,a,l=null){return new X2({providers:o,parent:a,debugName:l,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#t=this.\u0275prov=vt({token:n,providedIn:"environment",factory:()=>new n(X(Ws))})}return n})();function al(n){var e;Ry.has(e="NgStandalone")||(Ry.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}})),n.getStandaloneInjector=t=>t.get($2).getOrCreateStandaloneInjector(n)}let dp=(()=>{class n{static#t=this.__NG_ELEMENT_ID__=J2}return n})();const Y2=dp,K2=class extends Y2{constructor(n,t,e){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=e}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,e){const i=function(s,o,a,l){const h=o.tView,u=Wh(s,h,a,4096&s[Jt]?4096:16,null,o,null,null,null,l?.injector??null,l?.dehydratedView??null);u[Eh]=s[o.index];const c=s[Ha];return null!==c&&(u[Ha]=c.createEmbeddedView(h)),ip(h,u,a),u}(this._declarationLView,this._declarationTContainer,n,{injector:t,dehydratedView:e});return new rl(i)}};function J2(){return t=Fr(),e=Ui(),4&t.type?new K2(e,t,Zh(t,e)):null;var t,e}let tu=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Va(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const $y=new jt(""),eu=new jt("");let pp,fp=(()=>{class n{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,pp||(pp=r,r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ri.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static#t=this.\u0275fac=function(e){return new(e||n)(X(Ri),X(gp),X(eu))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})(),gp=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return pp?.findTestabilityInTree(this,e,i)??null}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Q2=new jt("Application Initializer");let Yy=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=ht(Q2,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const s=r();if(Hy(s))e.push(s);else if(B2(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});e.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const tC=new jt("appBootstrapListener");function Ky(n,t){return Array.isArray(t)?t.reduce(Ky,n):{...n,...t}}let iu=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ht(uy),this.afterRenderEffectManager=ht(Ly),this.componentTypes=[],this.components=[],this.isStable=ht(tu).hasPendingTasks.pipe(bn(e=>!e)),this._injector=ht(Ws)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof Qm;if(!this._injector.get(Yy).done)throw!r&&(xo(c=e)||N0(c)||z0(c)),new z(405,!1);var c;let s;s=r?e:this._injector.get(Ro).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const o=s.isBoundToModule?void 0:this._injector.get(ol),a=s.create(il.NULL,[],i||s.selector,o),l=a.location.nativeElement,h=a.injector.get($y,null);return h?.registerApplication(l),a.onDestroy(()=>{this.detachView(a.hostView),nu(this.components,a),h?.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new z(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{try{this.afterRenderEffectManager.execute()}catch(e){this.internalErrorHandler(e)}this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;nu(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(tC,[]);[...this._bootstrapListeners,...i].forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>nu(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new z(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function nu(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let eC=(()=>{class n{constructor(){this.zone=ht(Ri),this.applicationRef=ht(iu)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function iC(){const n=ht(Ri),t=ht(Fo);return e=>n.runOutsideAngular(()=>t.handleError(e))}let nC=(()=>{class n{constructor(){this.subscription=new ke,this.initialized=!1,this.zone=ht(Ri),this.pendingTasks=ht(tu)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ri.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ri.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const mp=new jt("LocaleId",{providedIn:"root",factory:()=>ht(mp,kt.Optional|kt.SkipSelf)||typeof $localize<"u"&&$localize.locale||Kh}),Jy=new jt("PlatformDestroyListeners");let Qy=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function(o="zone.js",a){return"noop"===o?new I2:"zone.js"===o?new Ri(a):o}(i?.ngZone,(o={eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing},{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:o?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:o?.runCoalescing??!1}));var o;return r.run(()=>{const s=(l=e.moduleType,h=this.injector,u=function(l){return[{provide:Ri,useFactory:()=>r},{provide:zh,multi:!0,useFactory:()=>{const h=ht(eC,{optional:!0});return()=>h.initialize()}},{provide:zh,multi:!0,useFactory:()=>{const h=ht(nC);return()=>{h.initialize()}}},{provide:uy,useFactory:iC}]}(),new Xy(l,h,u)),o=s.injector.get(Fo,null);var l,h,u;return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{nu(this._modules,s),a.unsubscribe()})}),function(l,h,u){try{const c=u();return Hy(c)?c.catch(d=>{throw h.runOutsideAngular(()=>l.handleError(d)),d}):c}catch(c){throw h.runOutsideAngular(()=>l.handleError(c)),c}}(o,r,()=>{const a=s.injector.get(Yy);return a.runInitializers(),a.donePromise.then(()=>(function(h){(function Ut(n,t){null==n&&function(i,r,s,o){throw new Error(`ASSERTION ERROR: ${i} [Expected=> null != ${r} <=Actual]`)}(t,n)})(h,"Expected localeId to be defined"),"string"==typeof h&&(Z2=h.toLowerCase().replace(/_/g,"-"))}(s.injector.get(mp,Kh)||Kh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,i=[]){const r=Ky({},i);return function(o,a,l){const h=new U2(l);return Promise.resolve(h)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const i=e.injector.get(iu);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new z(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new z(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(Jy,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#t=this.\u0275fac=function(e){return new(e||n)(X(il))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),ll=null;const t1=new jt("AllowMultipleToken");function e1(n,t,e=[]){const i=`Platform: ${t}`,r=new jt(i);return(s=[])=>{let o=i1();if(!o||o.injector.get(t1,!1)){const a=[...e,...s,{provide:r,useValue:!0}];n?n(a):function(h){if(ll&&!ll.get(t1,!1))throw new z(400,!1);var d;Je=()=>{throw new z(600,!1)},ll=h,h.get(Qy),d=h,d.get(zm,null)?.forEach(p=>p())}(function(h=[],u){return il.create({name:u,providers:[{provide:Pd,useValue:"platform"},{provide:Jy,useValue:new Set([()=>ll=null])},...h]})}(a,i))}return function(l){const h=i1();if(!h)throw new z(401,!1);return h}()}}function i1(){return ll?.get(Qy)??null}const rC=e1(null,"core",[]);let sC=(()=>{class n{constructor(e){}static#t=this.\u0275fac=function(e){return new(e||n)(X(iu))};static#e=this.\u0275mod=vo({type:n});static#i=this.\u0275inj=ge({})}return n})(),yp=null;function _p(){return yp}class oC{}const as=new jt("DocumentToken");var tn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(tn||{}),ri=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(ri||{}),Sn=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Sn||{}),Or=function(n){return n[n.Decimal=0]="Decimal",n[n.Group=1]="Group",n[n.List=2]="List",n[n.PercentSign=3]="PercentSign",n[n.PlusSign=4]="PlusSign",n[n.MinusSign=5]="MinusSign",n[n.Exponential=6]="Exponential",n[n.SuperscriptingExponent=7]="SuperscriptingExponent",n[n.PerMille=8]="PerMille",n[n.Infinity=9]="Infinity",n[n.NaN=10]="NaN",n[n.TimeSeparator=11]="TimeSeparator",n[n.CurrencyDecimal=12]="CurrencyDecimal",n[n.CurrencyGroup=13]="CurrencyGroup",n}(Or||{});function ru(n,t){return jn(Jn(n)[ki.DateFormat],t)}function su(n,t){return jn(Jn(n)[ki.TimeFormat],t)}function ou(n,t){return jn(Jn(n)[ki.DateTimeFormat],t)}function au(n,t){const e=Jn(n),i=e[ki.NumberSymbols][t];if(typeof i>"u"){if(t===Or.CurrencyDecimal)return e[ki.NumberSymbols][Or.Decimal];if(t===Or.CurrencyGroup)return e[ki.NumberSymbols][Or.Group]}return i}function n1(n){if(!n[ki.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ki.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function jn(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function vp(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const aC=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,hl={},lC=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ar=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(Ar||{}),Oe=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(Oe||{}),Ae=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(Ae||{});function hC(n,t,e,i){let r=function(u){if(o1(u))return u;if("number"==typeof u&&!isNaN(u))return new Date(u);if("string"==typeof u){if(u=u.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(u)){const[f,g=1,m=1]=u.split("-").map(y=>+y);return lu(f,g-1,m)}const d=parseFloat(u);if(!isNaN(u-d))return new Date(d);let p;if(p=u.match(aC))return function(g){const m=new Date(0);let y=0,_=0;const v=g[8]?m.setUTCFullYear:m.setFullYear,x=g[8]?m.setUTCHours:m.setHours;g[9]&&(y=Number(g[9]+g[10]),_=Number(g[9]+g[11])),v.call(m,Number(g[1]),Number(g[2])-1,Number(g[3]));const b=Number(g[4]||0)-y,M=Number(g[5]||0)-_,w=Number(g[6]||0),S=Math.floor(1e3*parseFloat("0."+(g[7]||0)));return x.call(m,b,M,w,S),m}(p)}const c=new Date(u);if(!o1(c))throw new Error(`Unable to convert "${u}" into a date`);return c}(n);t=Lr(e,t)||t;let s,o=[];for(;t;){if(s=lC.exec(t),!s){o.push(t);break}{o=o.concat(s.slice(1));const h=o.pop();if(!h)break;t=h}}let a=r.getTimezoneOffset();i&&(a=s1(i,a),r=function(u,c,d){const f=u.getTimezoneOffset();return m=u,y=-1*(s1(c,f)-f),(m=new Date(m.getTime())).setMinutes(m.getMinutes()+y),m;var m,y}(r,i));let l="";return o.forEach(h=>{const u=function(d){if(bp[d])return bp[d];let p;switch(d){case"G":case"GG":case"GGG":p=hi(Ae.Eras,ri.Abbreviated);break;case"GGGG":p=hi(Ae.Eras,ri.Wide);break;case"GGGGG":p=hi(Ae.Eras,ri.Narrow);break;case"y":p=Ii(Oe.FullYear,1,0,!1,!0);break;case"yy":p=Ii(Oe.FullYear,2,0,!0,!0);break;case"yyy":p=Ii(Oe.FullYear,3,0,!1,!0);break;case"yyyy":p=Ii(Oe.FullYear,4,0,!1,!0);break;case"Y":p=du(1);break;case"YY":p=du(2,!0);break;case"YYY":p=du(3);break;case"YYYY":p=du(4);break;case"M":case"L":p=Ii(Oe.Month,1,1);break;case"MM":case"LL":p=Ii(Oe.Month,2,1);break;case"MMM":p=hi(Ae.Months,ri.Abbreviated);break;case"MMMM":p=hi(Ae.Months,ri.Wide);break;case"MMMMM":p=hi(Ae.Months,ri.Narrow);break;case"LLL":p=hi(Ae.Months,ri.Abbreviated,tn.Standalone);break;case"LLLL":p=hi(Ae.Months,ri.Wide,tn.Standalone);break;case"LLLLL":p=hi(Ae.Months,ri.Narrow,tn.Standalone);break;case"w":p=xp(1);break;case"ww":p=xp(2);break;case"W":p=xp(1,!0);break;case"d":p=Ii(Oe.Date,1);break;case"dd":p=Ii(Oe.Date,2);break;case"c":case"cc":p=Ii(Oe.Day,1);break;case"ccc":p=hi(Ae.Days,ri.Abbreviated,tn.Standalone);break;case"cccc":p=hi(Ae.Days,ri.Wide,tn.Standalone);break;case"ccccc":p=hi(Ae.Days,ri.Narrow,tn.Standalone);break;case"cccccc":p=hi(Ae.Days,ri.Short,tn.Standalone);break;case"E":case"EE":case"EEE":p=hi(Ae.Days,ri.Abbreviated);break;case"EEEE":p=hi(Ae.Days,ri.Wide);break;case"EEEEE":p=hi(Ae.Days,ri.Narrow);break;case"EEEEEE":p=hi(Ae.Days,ri.Short);break;case"a":case"aa":case"aaa":p=hi(Ae.DayPeriods,ri.Abbreviated);break;case"aaaa":p=hi(Ae.DayPeriods,ri.Wide);break;case"aaaaa":p=hi(Ae.DayPeriods,ri.Narrow);break;case"b":case"bb":case"bbb":p=hi(Ae.DayPeriods,ri.Abbreviated,tn.Standalone,!0);break;case"bbbb":p=hi(Ae.DayPeriods,ri.Wide,tn.Standalone,!0);break;case"bbbbb":p=hi(Ae.DayPeriods,ri.Narrow,tn.Standalone,!0);break;case"B":case"BB":case"BBB":p=hi(Ae.DayPeriods,ri.Abbreviated,tn.Format,!0);break;case"BBBB":p=hi(Ae.DayPeriods,ri.Wide,tn.Format,!0);break;case"BBBBB":p=hi(Ae.DayPeriods,ri.Narrow,tn.Format,!0);break;case"h":p=Ii(Oe.Hours,1,-12);break;case"hh":p=Ii(Oe.Hours,2,-12);break;case"H":p=Ii(Oe.Hours,1);break;case"HH":p=Ii(Oe.Hours,2);break;case"m":p=Ii(Oe.Minutes,1);break;case"mm":p=Ii(Oe.Minutes,2);break;case"s":p=Ii(Oe.Seconds,1);break;case"ss":p=Ii(Oe.Seconds,2);break;case"S":p=Ii(Oe.FractionalSeconds,1);break;case"SS":p=Ii(Oe.FractionalSeconds,2);break;case"SSS":p=Ii(Oe.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":p=uu(Ar.Short);break;case"ZZZZZ":p=uu(Ar.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":p=uu(Ar.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":p=uu(Ar.Long);break;default:return null}return bp[d]=p,p}(h);l+=u?u(r,e,a):"''"===h?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function lu(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Lr(n,t){const e=Jn(n)[ki.LocaleId];if(hl[e]=hl[e]||{},hl[e][t])return hl[e][t];let i="";switch(t){case"shortDate":i=ru(n,Sn.Short);break;case"mediumDate":i=ru(n,Sn.Medium);break;case"longDate":i=ru(n,Sn.Long);break;case"fullDate":i=ru(n,Sn.Full);break;case"shortTime":i=su(n,Sn.Short);break;case"mediumTime":i=su(n,Sn.Medium);break;case"longTime":i=su(n,Sn.Long);break;case"fullTime":i=su(n,Sn.Full);break;case"short":const r=Lr(n,"shortTime"),s=Lr(n,"shortDate");i=hu(ou(n,Sn.Short),[r,s]);break;case"medium":const o=Lr(n,"mediumTime"),a=Lr(n,"mediumDate");i=hu(ou(n,Sn.Medium),[o,a]);break;case"long":const l=Lr(n,"longTime"),h=Lr(n,"longDate");i=hu(ou(n,Sn.Long),[l,h]);break;case"full":const u=Lr(n,"fullTime"),c=Lr(n,"fullDate");i=hu(ou(n,Sn.Full),[u,c])}return i&&(hl[e][t]=i),i}function hu(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function Qn(n,t,e="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=e));let o=String(n);for(;o.length<t;)o="0"+o;return i&&(o=o.slice(o.length-t)),s+o}function Ii(n,t,e=0,i=!1,r=!1){return function(s,o){let a=function(u,c){switch(u){case Oe.FullYear:return c.getFullYear();case Oe.Month:return c.getMonth();case Oe.Date:return c.getDate();case Oe.Hours:return c.getHours();case Oe.Minutes:return c.getMinutes();case Oe.Seconds:return c.getSeconds();case Oe.FractionalSeconds:return c.getMilliseconds();case Oe.Day:return c.getDay();default:throw new Error(`Unknown DateType value "${u}".`)}}(n,s);if((e>0||a>-e)&&(a+=e),n===Oe.Hours)0===a&&-12===e&&(a=12);else if(n===Oe.FractionalSeconds)return c=t,Qn(a,3).substring(0,c);var c;const l=au(o,Or.MinusSign);return Qn(a,t,l,i,r)}}function hi(n,t,e=tn.Format,i=!1){return function(r,s){return function(a,l,h,u,c,d){switch(h){case Ae.Months:return function(m,y,_){const v=Jn(m),x=jn([v[ki.MonthsFormat],v[ki.MonthsStandalone]],y);return jn(x,_)}(l,c,u)[a.getMonth()];case Ae.Days:return function(m,y,_){const v=Jn(m),x=jn([v[ki.DaysFormat],v[ki.DaysStandalone]],y);return jn(x,_)}(l,c,u)[a.getDay()];case Ae.DayPeriods:const p=a.getHours(),f=a.getMinutes();if(d){const g=function(v){const x=Jn(v);return n1(x),(x[ki.ExtraData][2]||[]).map(b=>"string"==typeof b?vp(b):[vp(b[0]),vp(b[1])])}(l),m=function(v,x,b){const M=Jn(v);n1(M);const w=jn([M[ki.ExtraData][0],M[ki.ExtraData][1]],x)||[];return jn(w,b)||[]}(l,c,u),y=g.findIndex(_=>{if(Array.isArray(_)){const[v,x]=_,b=p>=v.hours&&f>=v.minutes,M=p<x.hours||p===x.hours&&f<x.minutes;if(v.hours<x.hours){if(b&&M)return!0}else if(b||M)return!0}else if(_.hours===p&&_.minutes===f)return!0;return!1});if(-1!==y)return m[y]}return function(m,y,_){const v=Jn(m),x=jn([v[ki.DayPeriodsFormat],v[ki.DayPeriodsStandalone]],y);return jn(x,_)}(l,c,u)[p<12?0:1];case Ae.Eras:return(m=l,y=u,jn(Jn(m)[ki.Eras],y))[a.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${h}`)}var m,y}(r,s,n,t,e,i)}}function uu(n){return function(t,e,i){const r=-1*i,s=au(e,Or.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Ar.Short:return(r>=0?"+":"")+Qn(o,2,s)+Qn(Math.abs(r%60),2,s);case Ar.ShortGMT:return"GMT"+(r>=0?"+":"")+Qn(o,1,s);case Ar.Long:return"GMT"+(r>=0?"+":"")+Qn(o,2,s)+":"+Qn(Math.abs(r%60),2,s);case Ar.Extended:return 0===i?"Z":(r>=0?"+":"")+Qn(o,2,s)+":"+Qn(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const uC=0,cu=4;function r1(n){return lu(n.getFullYear(),n.getMonth(),n.getDate()+(cu-n.getDay()))}function xp(n,t=!1){return function(e,i){let r;if(t){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();r=1+Math.floor((o+s)/7)}else{const s=r1(e),o=function(h){const u=lu(h,uC,1).getDay();return lu(h,0,1+(u<=cu?cu:cu+7)-u)}(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return Qn(r,n,au(i,Or.MinusSign))}}function du(n,t=!1){return function(e,i){return Qn(r1(e).getFullYear(),n,au(i,Or.MinusSign),t)}}const bp={};function s1(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function o1(n){return n instanceof Date&&!isNaN(n.valueOf())}function a1(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}class cC{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let l1=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new cC(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),h1(a,r)}});for(let r=0,s=i.length;r<s;r++){const o=i.get(r).context;o.index=r,o.count=s,o.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{h1(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static#t=this.\u0275fac=function(e){return new(e||n)(bi(hp),bi(dp),bi(sy))};static#e=this.\u0275dir=D0({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function h1(n,t){n.context.$implicit=t.item}let wp=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new dC,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){u1("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){u1("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#t=this.\u0275fac=function(e){return new(e||n)(bi(hp),bi(dp))};static#e=this.\u0275dir=D0({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class dC{constructor(){this.$implicit=null,this.ngIf=null}}function u1(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${ji(t)}'.`)}const pC=new jt("DATE_PIPE_DEFAULT_TIMEZONE"),fC=new jt("DATE_PIPE_DEFAULT_OPTIONS");let gC=(()=>{class n{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,s){if(null==e||""===e||e!=e)return null;try{return hC(e,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch{throw new z(2100,!1)}}static#t=this.\u0275fac=function(e){return new(e||n)(bi(mp,16),bi(pC,24),bi(fC,24))};static#e=this.\u0275pipe=function Fw(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}({name:"date",type:n,pure:!0,standalone:!0})}return n})(),ul=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275mod=vo({type:n});static#i=this.\u0275inj=ge({})}return n})();const c1="browser";function d1(n){return"server"===n}class p1{}class mC extends oC{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Cp extends mC{static makeCurrent(){var e;e=new Cp,yp||(yp=e)}onAndCancel(t,e,i){return t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(cl=cl||document.querySelector("base"),cl?cl.getAttribute("href"):null);return null==e?null:new URL(e,document.baseURI).pathname}resetBaseElement(){cl=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return a1(document.cookie,t)}}let cl=null,yC=(()=>{class n{build(){return new XMLHttpRequest}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const Mp=new jt("EventManagerPlugins");let f1=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(r=>r.supports(e)),!i)throw new z(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#t=this.\u0275fac=function(e){return new(e||n)(X(Mp),X(Ri))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();class g1{constructor(t){this._doc=t}}const Sp="ng-app-id";let m1=(()=>{class n{constructor(e,i,r,s={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=d1(s),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${Sp}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const s=r.get(e);return s.usage+=i,s.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===e)return r.delete(i),s.removeAttribute(Sp),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Sp,this.appId),e.appendChild(o),o}}addStyleToHost(e,i){const r=this.getStyleElement(e,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#t=this.\u0275fac=function(e){return new(e||n)(X(as),X(Nd),X(jm,8),X(Io))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const Ep={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Tp=/%COMP%/g,_C=new jt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function y1(n,t){return t.map(e=>e.replace(Tp,n))}let _1=(()=>{class n{constructor(e,i,r,s,o,a,l,h=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=d1(a),this.defaultRenderer=new kp(e,o,l,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Rt.ShadowDom&&(i={...i,encapsulation:Rt.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof x1?r.applyToHost(e):r instanceof Ip&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,c=this.platformIsServer;switch(i.encapsulation){case Rt.Emulated:s=new x1(l,h,i,this.appId,u,o,a,c);break;case Rt.ShadowDom:return new vC(l,h,e,i,o,a,this.nonce,c);default:s=new Ip(l,h,i,u,o,a,c)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#t=this.\u0275fac=function(e){return new(e||n)(X(f1),X(m1),X(Nd),X(_C),X(as),X(Io),X(Ri),X(jm))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();class kp{constructor(t,e,i,r){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(Ep[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(v1(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(v1(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new z(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const s=Ep[r];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=Ep[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(Hs.DashCase|Hs.Important)?t.style.setProperty(e,i,r&Hs.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Hs.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){null!=t&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i){if("string"==typeof t&&!(t=_p().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(i))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function v1(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class vC extends kp{constructor(t,e,i,r,s,o,a,l){super(t,s,o,l),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const h=y1(r.id,r.styles);for(const u of h){const c=document.createElement("style");a&&c.setAttribute("nonce",a),c.textContent=u,this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Ip extends kp{constructor(t,e,i,r,s,o,a,l){super(t,s,o,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=l?y1(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class x1 extends Ip{constructor(t,e,i,r,s,o,a,l){const h=r+"-"+i.id;super(t,e,i,s,o,a,l,h),this.contentAttr="_ngcontent-%COMP%".replace(Tp,h),this.hostAttr="_nghost-%COMP%".replace(Tp,h)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let xC=(()=>{class n extends g1{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}static#t=this.\u0275fac=function(e){return new(e||n)(X(as))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const b1=["alt","control","meta","shift"],bC={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wC={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let CC=(()=>{class n extends g1{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>_p().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),b1.forEach(h=>{const u=i.indexOf(h);u>-1&&(i.splice(u,1),o+=h+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(e,i){let r=bC[e.key]||e.key,s="";return i.indexOf("code.")>-1&&(r=e.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),b1.forEach(o=>{o!==r&&(0,wC[o])(e)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(e,i,r){return s=>{n.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#t=this.\u0275fac=function(e){return new(e||n)(X(as))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const MC=e1(rC,"browser",[{provide:Io,useValue:c1},{provide:zm,useValue:function(){Cp.makeCurrent()},multi:!0},{provide:as,useFactory:function(){return e=document,Dd=e,document;var e},deps:[]}]),SC=new jt(""),EC=[{provide:eu,useClass:class{addToWindow(t){lt.getAngularTestability=(e,i=!0)=>{const r=t.findTestabilityInTree(e,i);if(null==r)throw new z(5103,!1);return r},lt.getAllAngularTestabilities=()=>t.getAllTestabilities(),lt.getAllAngularRootElements=()=>t.getAllRootElements(),lt.frameworkStabilizers||(lt.frameworkStabilizers=[]),lt.frameworkStabilizers.push(e=>{const i=lt.getAllAngularTestabilities();let r=i.length,s=!1;const o=function(a){s=s||a,r--,0==r&&e(s)};i.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?_p().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:$y,useClass:fp,deps:[Ri,gp,eu]},{provide:fp,useClass:fp,deps:[Ri,gp,eu]}],TC=[{provide:Pd,useValue:"root"},{provide:Fo,useFactory:function(){return new Fo},deps:[]},{provide:Mp,useClass:xC,multi:!0,deps:[as,Ri,Io]},{provide:Mp,useClass:CC,multi:!0,deps:[as]},_1,m1,f1,{provide:ty,useExisting:_1},{provide:p1,useClass:yC,deps:[]},[]];let kC=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:Nd,useValue:e.appId}]}}static#t=this.\u0275fac=function(e){return new(e||n)(X(SC,12))};static#e=this.\u0275mod=vo({type:n});static#i=this.\u0275inj=ge({providers:[...TC,...EC],imports:[ul,sC]})}return n})();const cr=class{constructor(t){this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Pp=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function ls(n,t){return n>t?1:n<t?-1:0}function Rp(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if("function"==typeof e){for(let r=1;r<i;++r){const s=n[r];if(s===t)return r;if(s<t)return e(t,n[r-1],s)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function IC(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function dr(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function hs(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function zo(){return!0}function jo(){return!1}function Go(){}function w1(n){let t,e,i,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return(!r||this!==i||!hs(s,e))&&(r=!0,i=this,e=s,t=n.apply(this,arguments)),t}}function pu(n){return function(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}()}function dl(n){for(const t in n)delete n[t]}function us(n){let t;for(t in n)return!1;return!t}const fu=class extends Pp{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new cr(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;i in o||(o[i]=0,a[i]=0),++o[i];for(let h=0,u=r.length;h<u;++h)if(l="handleEvent"in r[h]?r[h].handleEvent(s):r[h].call(this,s),!1===l||s.propagationStopped){l=!1;break}if(0==--o[i]){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Go);delete o[i]}return l}disposeInternal(){this.listeners_&&dl(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=Go,++this.pendingRemovals_[t]):(i.splice(r,1),0===i.length&&delete this.listeners_[t]))}};function _e(n,t,e,i,r){if(i&&i!==n&&(e=e.bind(i)),r){const o=e;e=function(){n.removeEventListener(t,e),o.apply(this,arguments)}}const s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function gu(n,t,e,i){return _e(n,t,e,i,!0)}function si(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),dl(n))}const C1=class extends fu{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent("change")}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=_e(this,t[s],e);return r}return _e(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=gu(this,t[s],e)}else i=gu(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(s){if(Array.isArray(s))for(let o=0,a=s.length;o<a;++o)si(s[o]);else si(s)}(i);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}};function Wt(){throw new Error("Unimplemented abstract method.")}let PC=0;function Qt(n){return n.ol_uid||(n.ol_uid=String(++PC))}class M1 extends cr{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const tr=class extends C1{constructor(t){super(),Qt(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new M1(i,t,e)),i="propertychange",this.hasListener(i)&&this.dispatchEvent(new M1(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],us(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};class mu extends cr{constructor(t,e,i){super(t),this.element=e,this.index=i}}const pr=class extends tr{constructor(t,e){if(super(),this.unique_=!!(e=e||{}).unique,this.array_=t||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get("length")}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new mu("add",e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new mu("remove",e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new mu("remove",i,t)),this.dispatchEvent(new mu("add",e,t))}updateLength_(){this.set("length",this.array_.length)}assertUnique_(t,e){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},cs=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",RC=cs.includes("firefox"),FC=(cs.includes("safari")&&!cs.includes("chrom")&&(cs.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(cs)),cs.includes("webkit")&&!cs.includes("edge")),S1=cs.includes("macintosh"),E1=typeof devicePixelRatio<"u"?devicePixelRatio:1,Fp=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,T1=typeof Image<"u"&&Image.prototype.decode,k1=function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n}();function Me(n,t){if(!n)throw new Error(t)}const I1=new Array(6);function P1(n){return yu(n,1,0,0,1,0,0)}function Op(n,t){const e=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=t[0],h=t[1],u=t[2],c=t[3],d=t[4],p=t[5];return n[0]=e*l+r*h,n[1]=i*l+s*h,n[2]=e*u+r*c,n[3]=i*u+s*c,n[4]=e*d+r*p+o,n[5]=i*d+s*p+a,n}function yu(n,t,e,i,r,s,o){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n[4]=s,n[5]=o,n}function Fi(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function Ap(n,t,e){return Op(n,yu(I1,t,0,0,e,0,0))}function Dr(n,t,e,i,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*l,n[2]=-i*l,n[3]=r*h,n[4]=o*i*h-a*i*l+t,n[5]=o*r*l+a*r*h+e,n}function Lp(n,t){const e=(u=t)[0]*u[3]-u[1]*u[2];var u;Me(0!==e,"Transformation matrix cannot be inverted");const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return n[0]=o/e,n[1]=-r/e,n[2]=-s/e,n[3]=i/e,n[4]=(s*l-o*a)/e,n[5]=-(i*l-r*a)/e,n}let R1;function F1(n){const t="matrix("+n.join(", ")+")";if(Fp)return t;const e=R1||(R1=document.createElement("div"));return e.style.transform=t,e.style.transform}const Li={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function pl(n){const t=[1/0,1/0,-1/0,-1/0];for(let e=0,i=n.length;e<i;++e)fl(t,n[e]);return t}function ds(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function O1(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function Ys(n,t,e){let i,r;return i=t<n[0]?n[0]-t:n[2]<t?t-n[2]:0,r=e<n[1]?n[1]-e:n[3]<e?e-n[3]:0,i*i+r*r}function _u(n,t){return Dp(n,t[0],t[1])}function ps(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function Dp(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Np(n,t){const e=t[0],i=t[1];let r=Li.UNKNOWN;return e<n[0]?r|=Li.LEFT:e>n[2]&&(r|=Li.RIGHT),i<n[1]?r|=Li.BELOW:i>n[3]&&(r|=Li.ABOVE),r===Li.UNKNOWN&&(r=Li.INTERSECTING),r}function fr(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function qo(n){return fr(1/0,1/0,-1/0,-1/0,n)}function A1(n,t){const e=n[0],i=n[1];return fr(e,i,e,i,t)}function zp(n,t,e,i,r){return D1(qo(r),n,t,e,i)}function Vo(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function L1(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function fl(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function D1(n,t,e,i,r){for(;e<i;e+=r)OC(n,t[e],t[e+1]);return n}function OC(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function jp(n,t){let e;return e=t(Zo(n)),!!(e||(e=t(gl(n)),e)||(e=t(ml(n)),e)||(e=t(Gn(n)),e))&&e}function Gp(n){let t=0;return yl(n)||(t=qe(n)*En(n)),t}function Zo(n){return[n[0],n[1]]}function gl(n){return[n[2],n[1]]}function er(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function AC(n,t){let e;if("bottom-left"===t)e=Zo(n);else if("bottom-right"===t)e=gl(n);else if("top-left"===t)e=Gn(n);else{if("top-right"!==t)throw new Error("Invalid corner");e=ml(n)}return e}function qp(n,t,e,i,r){const[s,o,a,l,h,u,c,d]=Vp(n,t,e,i);return fr(Math.min(s,a,h,c),Math.min(o,l,u,d),Math.max(s,a,h,c),Math.max(o,l,u,d),r)}function Vp(n,t,e,i){const r=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=r*o,h=r*a,u=s*o,c=s*a,d=n[0],p=n[1];return[d-l+c,p-h-u,d-l-c,p-h+u,d+l-c,p+h+u,d+l+c,p+h-u,d-l+c,p-h-u]}function En(n){return n[3]-n[1]}function Ks(n,t,e){const i=e||[1/0,1/0,-1/0,-1/0];return _i(n,t)?(i[0]=n[0]>t[0]?n[0]:t[0],i[1]=n[1]>t[1]?n[1]:t[1],i[2]=n[2]<t[2]?n[2]:t[2],i[3]=n[3]<t[3]?n[3]:t[3]):qo(i),i}function Gn(n){return[n[0],n[3]]}function ml(n){return[n[2],n[3]]}function qe(n){return n[2]-n[0]}function _i(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function yl(n){return n[2]<n[0]||n[3]<n[1]}function N1(n,t,e,i){if(yl(n))return qo(e);let r=[];if(i>1){const a=n[2]-n[0],l=n[3]-n[1];for(let h=0;h<i;++h)r.push(n[0]+a*h/i,n[1],n[2],n[1]+l*h/i,n[2]-a*h/i,n[3],n[0],n[3]-l*h/i)}else r=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];t(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return l=s,h=o,u=e,fr(Math.min.apply(null,l),Math.min.apply(null,h),Math.max.apply(null,l),Math.max.apply(null,h),u);var l,h,u}function z1(n,t){const e=t.getExtent(),i=er(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const r=qe(e),s=Math.floor((i[0]-e[0])/r)*r;n[0]-=s,n[2]-=s}return n}const _l={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Bo={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Bo.max=Bo.whitepoint[2].D65,Bo.rgb=function(n,t){var e,i,r,s=n[0]/(t=t||Bo.whitepoint[2].E)[0],o=n[1]/t[1],a=n[2]/t[2];return i=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,r=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,e=(e=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},_l.xyz=function(n,t){var e=n[0]/255,i=n[1]/255,r=n[2]/255;return[(.41239079926595*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.35758433938387*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.18048078840183*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92))*(t=t||Bo.whitepoint[2].E)[0],(.21263900587151*e+.71516867876775*i+.072192315360733*r)*t[1],(.019330818715591*e+.11919477979462*i+.95053215224966*r)*t[2]]};const ir=Bo,Zp={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(n,t,e){var i,r,s,o,a,l,h;return 0===(s=n[0])?[0,0,0]:(i=n[1]/(13*s)+4*(a=ir.whitepoint[e=e||2][t=t||"D65"][0])/(a+15*(l=ir.whitepoint[e][t][1])+3*(h=ir.whitepoint[e][t][2]))||0,r=n[2]/(13*s)+9*l/(a+15*l+3*h)||0,[9*(o=s>8?l*Math.pow((s+16)/116,3):l*s*.0011070564598794539)*i/(4*r)||0,o,o*(12-3*i-20*r)/(4*r)||0])}};ir.luv=function(n,t,e){var i,r,s,o,a,l,h,u,c,d,p;d=4*(h=ir.whitepoint[e=e||2][t=t||"D65"][0])/(h+15*(u=ir.whitepoint[e][t][1])+3*(c=ir.whitepoint[e][t][2])),p=9*u/(h+15*u+3*c),i=4*(o=n[0])/(o+15*(a=n[1])+3*(l=n[2]))||0,r=9*a/(o+15*a+3*l)||0;var f=a/u;return[s=f<=.008856451679035631?903.2962962962961*f:116*Math.pow(f,1/3)-16,13*s*(i-d),13*s*(r-p)]};var j1={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(n){var t,e=n[1];return t=n[2]/360*2*Math.PI,[n[0],e*Math.cos(t),e*Math.sin(t)]},xyz:function(n){return Zp.xyz(j1.luv(n))}};const LC=j1;Zp.lchuv=function(n){var t=n[0],e=n[1],i=n[2],r=Math.sqrt(e*e+i*i),s=360*Math.atan2(i,e)/2/Math.PI;return s<0&&(s+=360),[t,r,s]},ir.lchuv=function(n){return Zp.lchuv(ir.luv(n))};var G1=ai(605);const DC=function(t){var e,i,r=[],s=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),G1[t])r=G1[t].slice(),i="rgb";else if("transparent"===t)s=0,i="rgb",r=[0,0,0];else if("#"===t[0]){var o=t.slice(1),a=o.length;s=1,a<=4?(r=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===a&&(s=parseInt(o[3]+o[3],16)/255)):(r=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===a&&(s=parseInt(o[6]+o[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var l="cmyk"===(i=e[1].replace(/a$/,""))?4:"gray"===i?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=r.shift()),s=(r=r.map(function(h,u){if("%"===h[h.length-1])return h=parseFloat(h)/100,3===u?h:"rgb"===i?255*h:"h"===i[0]||"l"===i[0]&&!u?100*h:"lab"===i?125*h:"lch"===i?u<2?150*h:360*h:"o"!==i[0]||u?"oklab"===i?.4*h:"oklch"===i?u<2?.4*h:360*h:h:h;if("h"===i[u]||2===u&&"h"===i[i.length-1]){if(void 0!==q1[h])return q1[h];if(h.endsWith("deg"))return parseFloat(h);if(h.endsWith("turn"))return 360*parseFloat(h);if(h.endsWith("grad"))return 360*parseFloat(h)/400;if(h.endsWith("rad"))return 180*parseFloat(h)/Math.PI}return"none"===h?0:parseFloat(h)})).length>l?r.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(r=t.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:r,alpha:s}};var q1={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Bp={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var t,e,i,r,s,o=n[0]/360,a=n[1]/100,l=n[2]/100,h=0;if(0===a)return[s=255*l,s,s];for(t=2*l-(e=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];h<3;)(i=o+1/3*-(h-1))<0?i++:i>1&&i--,r[h++]=255*(s=6*i<1?t+6*(e-t)*i:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t);return r}};function gi(n,t,e){return Math.min(Math.max(n,t),e)}function NC(n,t,e,i,r,s){const o=r-e,a=s-i;if(0!==o||0!==a){const l=((n-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=r,i=s):l>0&&(e+=o*l,i+=a*l)}return Nr(n,t,e,i)}function Nr(n,t,e,i){const r=e-n,s=i-t;return r*r+s*s}function vu(n){return n*Math.PI/180}function Wo(n,t){const e=n%t;return e*t<0?e+t:e}function Tn(n,t,e){return n+e*(t-n)}function xu(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function bu(n,t){return Math.floor(xu(n,t))}function wu(n,t){return Math.ceil(xu(n,t))}function V1(n){return"string"==typeof n?n:W1(n)}_l.hsl=function(n){var t,e,i=n[0]/255,r=n[1]/255,s=n[2]/255,o=Math.min(i,r,s),a=Math.max(i,r,s),l=a-o;return a===o?t=0:i===a?t=(r-s)/l:r===a?t=2+(s-i)/l:s===a&&(t=4+(i-r)/l),(t=Math.min(60*t,360))<0&&(t+=360),e=(o+a)/2,[t,100*(a===o?0:e<=.5?l/(a+o):l/(2-a-o)),100*e]};const zC=1024,vl={};let Wp=0;function jC(n){if(4===n.length)return n;const t=n.slice();return t[3]=1,t}function Z1(n){const t=ir.lchuv(_l.xyz(n));return t[3]=n[3],t}function Hp(n){if(vl.hasOwnProperty(n))return vl[n];if(Wp>=zC){let e=0;for(const i in vl)3&e++||(delete vl[i],--Wp)}const t=function(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var r,s=DC(i);if(!s.space)return[];const o="h"===s.space[0]?Bp.min:_l.min,a="h"===s.space[0]?Bp.max:_l.max;return(r=Array(3))[0]=Math.min(Math.max(s.values[0],o[0]),a[0]),r[1]=Math.min(Math.max(s.values[1],o[1]),a[1]),r[2]=Math.min(Math.max(s.values[2],o[2]),a[2]),"h"===s.space[0]&&(r=Bp.rgb(r)),r.push(Math.min(Math.max(s.alpha,0),1)),r}(n);if(4!==t.length)throw new Error('Failed to parse "'+n+'" as color');for(const e of t)if(isNaN(e))throw new Error('Failed to parse "'+n+'" as color');return B1(t),vl[n]=t,++Wp,t}function Cu(n){return Array.isArray(n)?n:Hp(n)}function B1(n){return n[0]=gi(n[0]+.5|0,0,255),n[1]=gi(n[1]+.5|0,0,255),n[2]=gi(n[2]+.5|0,0,255),n[3]=gi(n[3],0,1),n}function W1(n){let t=n[0];t!=(0|t)&&(t=t+.5|0);let e=n[1];e!=(0|e)&&(e=e+.5|0);let i=n[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+t+","+e+","+i+","+(void 0===n[3]?1:Math.round(100*n[3])/100)+")"}function H1(n,t,e){return t+":"+n+":"+(e?V1(e):"null")}const Mu=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_)!(3&t++)&&!this.cache_[e].hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}get(t,e,i){const r=H1(t,e,i);return r in this.cache_?this.cache_[r]:null}set(t,e,i,r){const s=H1(t,e,i);this.cache_[s]=r,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},U1=class extends tr{constructor(t){super(),this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e.opacity=void 0!==t.opacity?t.opacity:1,Me("number"==typeof e.opacity,"Layer opacity must be a number"),e.visible=void 0===t.visible||t.visible,e.zIndex=t.zIndex,e.maxResolution=void 0!==t.maxResolution?t.maxResolution:1/0,e.minResolution=void 0!==t.minResolution?t.minResolution:0,e.minZoom=void 0!==t.minZoom?t.minZoom:-1/0,e.maxZoom=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=gi(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return Wt()}getLayerStatesArray(t){return Wt()}getExtent(){return this.get("extent")}getMaxResolution(){return this.get("maxResolution")}getMinResolution(){return this.get("minResolution")}getMinZoom(){return this.get("minZoom")}getMaxZoom(){return this.get("maxZoom")}getOpacity(){return this.get("opacity")}getSourceState(){return Wt()}getVisible(){return this.get("visible")}getZIndex(){return this.get("zIndex")}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set("extent",t)}setMaxResolution(t){this.set("maxResolution",t)}setMinResolution(t){this.set("minResolution",t)}setMaxZoom(t){this.set("maxZoom",t)}setMinZoom(t){this.set("minZoom",t)}setOpacity(t){Me("number"==typeof t,"Layer opacity must be a number"),this.set("opacity",t)}setVisible(t){this.set("visible",t)}setZIndex(t){this.set("zIndex",t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},nr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},X1=42,Up=256,Ho={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},zr=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ho[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},xl=6378137,Uo=Math.PI*xl,GC=[-Uo,-Uo,Uo,Uo],qC=[-180,-85,180,85],Su=xl*Math.log(Math.tan(Math.PI/2));class Xo extends zr{constructor(t){super({code:t,units:"m",extent:GC,global:!0,worldExtent:qC,getPointResolution:function(e,i){return e/Math.cosh(i[1]/xl)}})}}const $1=[new Xo("EPSG:3857"),new Xo("EPSG:102100"),new Xo("EPSG:102113"),new Xo("EPSG:900913"),new Xo("http://www.opengis.net/def/crs/EPSG/0/3857"),new Xo("http://www.opengis.net/gml/srs/epsg.xml#3857")];const Y1=[-180,-90,180,90],BC=6378137*Math.PI/180;class Js extends zr{constructor(t,e){super({code:t,units:"degrees",extent:Y1,axisOrientation:e,global:!0,metersPerUnit:BC,worldExtent:Y1})}}const K1=[new Js("CRS:84"),new Js("EPSG:4326","neu"),new Js("urn:ogc:def:crs:OGC:1.3:CRS84"),new Js("urn:ogc:def:crs:OGC:2:84"),new Js("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Js("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Js("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Xp={},$o={};function Yo(n,t,e){const i=n.getCode(),r=t.getCode();i in $o||($o[i]={}),$o[i][r]=e}function J1(n,t){let e;return n in $o&&t in $o[n]&&(e=$o[n][t]),e}function Eu(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function $p(n,t){const e=Math.cos(t),i=Math.sin(t),r=n[1]*e+n[0]*i;return n[0]=n[0]*e-n[1]*i,n[1]=r,n}function Q1(n,t){const e=n[0]-t[0],i=n[1]-t[1];return e*e+i*i}function t_(n,t){return Math.sqrt(Q1(n,t))}function Yp(n,t){if(t.canWrapX()){const e=qe(t.getExtent()),i=e_(n,t,e);i&&(n[0]-=i*e)}return n}function e_(n,t,e){const i=t.getExtent();let r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||qe(i),r=Math.floor((n[0]-i[0])/e)),r}const WC=6371008.8;function i_(n,t,e){e=e||WC;const i=vu(n[1]),r=vu(t[1]),s=(r-i)/2,o=vu(t[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const n_={info:1,warn:2,error:3,none:4};let HC=n_.info;function r_(...n){HC>n_.warn||console.warn(...n)}let Kp=!0;function s_(n){Kp=!(void 0===n||n)}function Jp(n,t){if(void 0!==t)for(let e=0,i=n.length;e<i;++e)t[e]=n[e];else t=n.slice();return t}function o_(n,t){if(void 0!==t&&n!==t){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];n=t}return n}function a_(n){var e;e=n.getCode(),Xp[e]=n,Yo(n,n,Jp)}function Se(n){return"string"==typeof n?Xp[e=n]||Xp[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:n||null;var e}function l_(n,t,e,i){let r;const s=(n=Se(n)).getPointResolutionFunc();if(s){if(r=s(t,e),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/Ho[i])}}else{const o=n.getUnits();if("degrees"==o&&!i||"degrees"==i)r=t;else{const a=bl(n,Se("EPSG:4326"));if(a===o_&&"degrees"!==o)r=t*n.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2),r=(i_(h.slice(0,2),h.slice(2,4))+i_(h.slice(4,6),h.slice(6,8)))/2}const l=i?Ho[i]:n.getMetersPerUnit();void 0!==l&&(r/=l)}}return r}function Qp(n){n.forEach(a_),n.forEach(function(t){n.forEach(function(e){t!==e&&Yo(t,e,Jp)})})}function tf(n,t){return n?"string"==typeof n?Se(n):n:Se(t)}function h_(n){return function(t,e,i){const r=t.length;i=void 0!==i?i:2,e=void 0!==e?e:new Array(r);for(let s=0;s<r;s+=i){const o=n(t.slice(s,s+i)),a=o.length;for(let l=0,h=i;l<h;++l)e[s+l]=l>=a?t[s+l]:o[l]}return e}}function UC(n,t,e,i){const r=Se(n),s=Se(t);Yo(r,s,h_(e)),Yo(s,r,h_(i))}function u_(n,t){return s_(),Tu(n,"EPSG:4326",void 0!==t?t:"EPSG:3857")}function fs(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||bl(n,t)===Jp)&&e}function bl(n,t){let e=J1(n.getCode(),t.getCode());return e||(e=o_),e}function Ko(n,t){return bl(Se(n),Se(t))}function Tu(n,t,e){return Ko(t,e)(n,void 0,n.length)}function c_(n,t,e,i){return N1(n,Ko(t,e),void 0,i)}let qn=null;function wl(){return qn}function ef(n,t){return qn?Tu(n,t,qn):n}function Vn(n,t){return qn?Tu(n,qn,t):(Kp&&!Eu(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Kp=!1,r_("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function nf(n,t){return qn?c_(n,t,qn):n}function Qs(n,t){return qn?c_(n,qn,t):n}function XC(n,t){if(!qn)return n;const e=Se(t).getMetersPerUnit(),i=qn.getMetersPerUnit();return e&&i?n*e/i:n}function d_(n,t,e){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=qe(o);s=e_(i=i.slice(0),n,a),s&&(i[0]=i[0]-s*a),i[0]=gi(i[0],o[0],o[2]),i[1]=gi(i[1],o[1],o[3]),r=e(i)}else r=e(i);return s&&t.canWrapX()&&(r[0]+=s*qe(t.getExtent())),r}}function p_(n,t,e){return function(i,r,s,o,a){if(!i)return;if(!r&&!t)return i;const l=t?0:s[0]*r,h=t?0:s[1]*r,u=a?a[0]:0,c=a?a[1]:0;let d=n[0]+l/2+u,p=n[2]-l/2+u,f=n[1]+h/2+c,g=n[3]-h/2+c;d>p&&(d=(p+d)/2,p=d),f>g&&(f=(g+f)/2,g=f);let m=gi(i[0],d,p),y=gi(i[1],f,g);if(o&&e&&r){const _=30*r;m+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-p)/_),y+=-_*Math.log(1+Math.max(0,f-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-g)/_)}return[m,y]}}function $C(n){return n}function rf(n,t,e,i){const r=qe(t)/e[0],s=En(t)/e[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function sf(n,t,e){let i=Math.min(n,t);return i*=Math.log(1+50*Math.max(0,n/t-1))/50+1,e&&(i=Math.max(i,e),i/=Math.log(1+50*Math.max(0,e/n-1))/50+1),gi(i,e/2,2*t)}function f_(n,t,e,i,r){return e=void 0===e||e,function(s,o,a,l){if(void 0!==s){const h=i?rf(n,i,a,r):n;return e&&l?sf(s,h,t):gi(s,t,h)}}}function of(n){if(void 0!==n)return 0}function g_(n){if(void 0!==n)return n}function m_(n){return Math.pow(n,3)}function Jo(n){return 1-m_(1-n)}function YC(n){return 3*n*n-2*n*n*n}function KC(n){return n}function gs(n,t,e,i,r,s){s=s||[];let o=0;for(let a=t;a<e;a+=i){const l=n[a],h=n[a+1];s[o++]=r[0]*l+r[2]*h+r[4],s[o++]=r[1]*l+r[3]*h+r[5]}return s&&s.length!=o&&(s.length=o),s}function af(n,t,e,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],u=s[1];let c=0;for(let d=t;d<e;d+=i){const p=n[d]-h,f=n[d+1]-u;o[c++]=h+p*a-f*l,o[c++]=u+p*l+f*a;for(let g=d+2;g<d+i;++g)o[c++]=n[g]}return o&&o.length!=c&&(o.length=c),o}var i,r,s;Qp($1),Qp(K1),i=$1,r=function VC(n,t,e){const i=n.length;e=e>1?e:2,void 0===t&&(t=e>2?n.slice():new Array(i));for(let r=0;r<i;r+=e){t[r]=Uo*n[r]/180;let s=xl*Math.log(Math.tan(Math.PI*(+n[r+1]+90)/360));s>Su?s=Su:s<-Su&&(s=-Su),t[r+1]=s}return t},s=function ZC(n,t,e){const i=n.length;e=e>1?e:2,void 0===t&&(t=e>2?n.slice():new Array(i));for(let r=0;r<i;r+=e)t[r]=180*n[r]/Uo,t[r+1]=360*Math.atan(Math.exp(n[r+1]/xl))/Math.PI-90;return t},K1.forEach(function(o){i.forEach(function(a){Yo(o,a,r),Yo(a,o,s)})});const y_=[1,0,0,1,0,0],__=class extends tr{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=w1((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return Wt()}closestPointXY(t,e,i,r){return Wt()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return this.closestPointXY(t[0],t[1],e=e||[NaN,NaN],1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return Wt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&qo(e),this.extentRevision_=this.getRevision()}return function(i,r){return r?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r):i}(this.extent_,t)}rotate(t,e){Wt()}scale(t,e,i){Wt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return Wt()}getType(){return Wt()}applyTransform(t){Wt()}intersectsExtent(t){return Wt()}translate(t,e){Wt()}transform(t,e){const i=Se(t),r="tile-pixels"==i.getUnits()?function(s,o,a){const l=i.getExtent(),h=i.getWorldExtent(),u=En(h)/En(l);return Dr(y_,h[0],h[3],u,-u,0,0,0),gs(s,0,s.length,a,y_,o),Ko(i,e)(s,o,a)}:Ko(i,e);return this.applyTransform(r),this}};function to(n){let t;return 2==n?t="XY":3==n?t="XYZ":4==n&&(t="XYZM"),t}function ku(n){let t;return"XY"==n?t=2:"XYZ"==n||"XYM"==n?t=3:"XYZM"==n&&(t=4),t}const ms=class extends __{constructor(){super(),this.layout="XY",this.stride=2}computeExtent(t){return zp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return Wt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=ku(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){Wt()}setLayout(t,e,i){let r;if(t)r=ku(t);else{for(let s=0;s<i;++s){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}r=e.length,t=to(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();af(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=er(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();(function(a,l,h,u,c,d,p,f){f=f||[];const g=p[0],m=p[1];let y=0;for(let _=0;_<h;_+=u){const v=a[_+1]-m;f[y++]=g+c*(a[_]-g),f[y++]=m+d*v;for(let x=_+2;x<_+u;++x)f[y++]=a[x]}f&&f.length!=y&&(f.length=y)})(r,0,r.length,s,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();(function(o,a,l,h,u,c,d){d=d||[];let p=0;for(let f=0;f<l;f+=h){d[p++]=o[f]+u,d[p++]=o[f+1]+c;for(let g=f+2;g<f+h;++g)d[p++]=o[g]}d&&d.length!=p&&(d.length=p)})(i,0,i.length,r,t,e,i),this.changed()}}};function v_(n,t,e,i,r,s,o){const a=n[t],l=n[t+1],h=n[e]-a,u=n[e+1]-l;let c;if(0===h&&0===u)c=t;else{const d=((r-a)*h+(s-l)*u)/(h*h+u*u);if(d>1)c=e;else{if(d>0){for(let p=0;p<i;++p)o[p]=Tn(n[t+p],n[e+p],d);return void(o.length=i)}c=t}}for(let d=0;d<i;++d)o[d]=n[c+d];o.length=i}function lf(n,t,e,i,r){let s=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],l=n[t+1],h=Nr(s,o,a,l);h>r&&(r=h),s=a,o=l}return r}function hf(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=lf(n,t,a,i,r),t=a}return r}function uf(n,t,e,i,r,s,o,a,l,h,u){if(t==e)return h;let c,d;if(0===r){if(d=Nr(o,a,n[t],n[t+1]),d<h){for(c=0;c<i;++c)l[c]=n[t+c];return l.length=i,d}return h}u=u||[NaN,NaN];let p=t+i;for(;p<e;)if(v_(n,p-i,p,i,o,a,u),d=Nr(o,a,u[0],u[1]),d<h){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/r|0,1);if(s&&(v_(n,e-i,t,i,o,a,u),d=Nr(o,a,u[0],u[1]),d<h)){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i}return h}function cf(n,t,e,i,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=e.length;c<d;++c){const p=e[c];h=uf(n,t,p,i,r,s,o,a,l,h,u),t=p}return h}function x_(n,t,e,i){for(let r=0,s=e.length;r<s;++r)n[t++]=e[r];return t}function Iu(n,t,e,i){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function Cl(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Iu(n,t,e[o],i);r[s++]=l,t=l}return r.length=s,r}function b_(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Cl(n,t,e[o],i,r[s]);0===l.length&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function Pu(n,t,e,i,r,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=n[t],s[o++]=n[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-i];let u=0;for(;h.length>0;){const c=h.pop(),d=h.pop();let p=0;const f=n[d],g=n[d+1],m=n[c],y=n[c+1];for(let _=d+i;_<c;_+=i){const v=NC(n[_],n[_+1],f,g,m,y);v>p&&(u=_,p=v)}p>r&&(l[(u-t)/i]=1,d+i<u&&h.push(d,u),u+i<c&&h.push(u,c))}for(let c=0;c<a;++c)l[c]&&(s[o++]=n[t+c*i],s[o++]=n[t+c*i+1]);return o}function w_(n,t,e,i,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const u=e[l];o=Pu(n,t,u,i,r,s,o),a.push(o),t=u}return o}function eo(n,t){return t*Math.round(n/t)}function JC(n,t,e,i,r,s,o){if(t==e)return o;let a,l,h=eo(n[t],r),u=eo(n[t+1],r);t+=i,s[o++]=h,s[o++]=u;do{if(a=eo(n[t],r),l=eo(n[t+1],r),(t+=i)==e)return s[o++]=a,s[o++]=l,o}while(a==h&&l==u);for(;t<e;){const c=eo(n[t],r),d=eo(n[t+1],r);if(t+=i,c==a&&d==l)continue;const p=a-h,f=l-u,g=c-h,m=d-u;p*m==f*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(f<0&&m<f||f==m||f>0&&m>f)?(a=c,l=d):(s[o++]=a,s[o++]=l,h=a,u=l,a=c,l=d)}return s[o++]=a,s[o++]=l,o}function df(n,t,e,i,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const u=e[l];o=JC(n,t,u,i,r,s,o),a.push(o),t=u}return o}function ys(n,t,e,i,r){r=void 0!==r?r:[];let s=0;for(let o=t;o<e;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Ml(n,t,e,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=ys(n,t,l,i,r[s]),t=l}return r.length=s,r}function pf(n,t,e,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=1===l.length&&l[0]===t?[]:Ml(n,t,l,i,r[s]),t=l[l.length-1]}return r.length=s,r}function C_(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];r+=o*a-s*l,s=a,o=l}return r/2}function M_(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=C_(n,t,a,i),t=a}return r}class Ru extends ms{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Ru(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<Ys(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return C_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Pu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ru(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Iu(this.flatCoordinates,0,t,this.stride),this.changed()}}const S_=Ru;class ff extends ms{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new ff(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=Nr(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return A1(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Dp(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=x_(this.flatCoordinates,0,t),this.changed()}}const jr=ff;function QC(n,t,e,i,r){return!jp(r,function(s){return!io(n,t,e,i,s[0],s[1])})}function io(n,t,e,i,r,s){let o=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){const h=n[t],u=n[t+1];l<=s?u>s&&(h-a)*(s-l)-(r-a)*(u-l)>0&&o++:u<=s&&(h-a)*(s-l)-(r-a)*(u-l)<0&&o--,a=h,l=u}return 0!==o}function gf(n,t,e,i,r,s){if(0===e.length||!io(n,t,e[0],i,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(io(n,e[o-1],e[o],i,r,s))return!1;return!0}function mf(n,t,e,i,r,s,o){let a,l,h,u,c,d,p;const f=r[s+1],g=[];for(let _=0,v=e.length;_<v;++_){const x=e[_];for(u=n[x-i],d=n[x-i+1],a=t;a<x;a+=i)c=n[a],p=n[a+1],(f<=d&&p<=f||d<=f&&f<=p)&&(h=(f-d)/(p-d)*(c-u)+u,g.push(h)),u=c,d=p}let m=NaN,y=-1/0;for(g.sort(ls),u=g[0],a=1,l=g.length;a<l;++a){c=g[a];const _=Math.abs(c-u);_>y&&(h=(u+c)/2,gf(n,t,e,i,h,f)&&(m=h,y=_)),u=c}return isNaN(m)&&(m=r[s]),o?(o.push(m,f,y),o):[m,f,y]}function E_(n,t,e,i,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=mf(n,t,l,i,r,2*o,s),t=l[l.length-1]}return s}function T_(n,t,e,i,r){let s;for(t+=i;t<e;t+=i)if(s=r(n.slice(t-i,t),n.slice(t,t+i)),s)return s;return!1}function Fu(n,t,e,i,r){const s=D1([1/0,1/0,-1/0,-1/0],n,t,e,i);return!!_i(r,s)&&(!!(ps(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3])||T_(n,t,e,i,function(o,a){return function(h,u,c){let d=!1;const p=Np(h,u),f=Np(h,c);if(p===Li.INTERSECTING||f===Li.INTERSECTING)d=!0;else{const g=h[0],m=h[1],y=h[2],_=h[3],v=c[0],x=c[1],b=(x-u[1])/(v-u[0]);let M,w;f&Li.ABOVE&&!(p&Li.ABOVE)&&(M=v-(x-_)/b,d=M>=g&&M<=y),!d&&f&Li.RIGHT&&!(p&Li.RIGHT)&&(w=x-(v-y)*b,d=w>=m&&w<=_),!d&&f&Li.BELOW&&!(p&Li.BELOW)&&(M=v-(x-m)/b,d=M>=g&&M<=y),!d&&f&Li.LEFT&&!(p&Li.LEFT)&&(w=x-(v-g)*b,d=w>=m&&w<=_)}return d}(r,o,a)}))}function k_(n,t,e,i,r){return!!(Fu(n,t,e,i,r)||io(n,t,e,i,r[0],r[1])||io(n,t,e,i,r[0],r[3])||io(n,t,e,i,r[2],r[1])||io(n,t,e,i,r[2],r[3]))}function I_(n,t,e,i,r){if(!k_(n,t,e[0],i,r))return!1;if(1===e.length)return!0;for(let s=1,o=e.length;s<o;++s)if(QC(n,e[s-1],e[s],i,r)&&!Fu(n,e[s-1],e[s],i,r))return!1;return!0}function tM(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){const s=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=s}t+=i,e-=i}}function yf(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];r+=(a-s)*(l+o),s=a,o=l}return 0===r?void 0:r>0}function _f(n,t,e,i,r){r=void 0!==r&&r;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=yf(n,t,a,i);if(0===s){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function P_(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!_f(n,t,a,i,r))return!1;a.length&&(t=a[a.length-1])}return!0}function Ou(n,t,e,i,r){r=void 0!==r&&r;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=yf(n,t,a,i);(0===s?r&&l||!r&&!l:r&&!l||!r&&l)&&tM(n,t,a,i),t=a}return t}function vf(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s)t=Ou(n,t,e[s],i,r);return t}function R_(n,t){const e=[];let i,r=0,s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=yf(n,r,l,2);if(void 0===i&&(i=h),h===i)e.push(t.slice(s,o+1));else{if(0===e.length)continue;e[e.length-1].push(t[s])}s=o+1,r=l}return e}class Sl extends ms{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?dr(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Sl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ys(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hf(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return gf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return M_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Ou(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ml(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=er(this.getExtent());this.flatInteriorPoint_=mf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new jr(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new S_(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new S_(e.slice(s,l),t);r.push(h),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;_f(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ou(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=df(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Sl(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return I_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Cl(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const _s=Sl;function Au(n){if(yl(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],r=n[3],s=[t,e,t,r,i,r,i,e,t,e];return new Sl(s,"XY",[s.length])}function Lu(n,t){setTimeout(function(){n(t)},0)}function xf(n,t,e,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;return a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o,[a*s-l*o,l*s+a*o]}const kn=class extends tr{constructor(t){super(),t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.projection_=tf(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.nextCenter_=null,this.cancelAnchor_=void 0,t.projection&&s_(),t.center&&(t.center=Vn(t.center,this.projection_)),t.extent&&(t.extent=Qs(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in nr)delete e[a];this.setProperties(e,!0);const i=function(l){let h,u,c,d=void 0!==l.minZoom?l.minZoom:0,p=void 0!==l.maxZoom?l.maxZoom:28;const f=void 0!==l.zoomFactor?l.zoomFactor:2,g=void 0!==l.multiWorld&&l.multiWorld,m=void 0===l.smoothResolutionConstraint||l.smoothResolutionConstraint,y=void 0!==l.showFullExtent&&l.showFullExtent,_=tf(l.projection,"EPSG:3857"),v=_.getExtent();let x=l.constrainOnlyCenter,b=l.extent;if(!g&&!b&&_.isGlobal()&&(x=!1,b=v),void 0!==l.resolutions){const M=l.resolutions;u=M[d],c=void 0!==M[p]?M[p]:M[M.length-1],h=l.constrainResolution?(S=M,P=!x&&b,A=y,R=void 0===(R=m)||R,function(T,K,N,F){if(void 0!==T){const j=S[0],q=S[S.length-1],$=P?rf(j,P,N,A):j;if(F)return R?sf(T,$,q):gi(T,q,$);const ct=Math.min($,T),dt=Math.floor(Rp(S,ct,K));return S[dt]>$&&dt<S.length-1?S[dt+1]:S[dt]}}):f_(u,c,m,!x&&b,y)}else{const M=(v?Math.max(qe(v),En(v)):360*Ho.degrees/_.getMetersPerUnit())/Up/Math.pow(2,0),w=M/Math.pow(2,28);u=l.maxResolution,void 0!==u?d=0:u=M/Math.pow(f,d),c=l.minResolution,void 0===c&&(c=void 0!==l.maxZoom?void 0!==l.maxResolution?u/Math.pow(f,p):M/Math.pow(f,p):w),p=d+Math.floor(Math.log(u/c)/Math.log(f)),c=u/Math.pow(f,p-d),h=l.constrainResolution?function(R,P,A,T,K,N){return T=void 0===T||T,A=void 0!==A?A:0,function(F,j,q,$){if(void 0!==F){const ct=K?rf(P,K,q,N):P;if($)return T?sf(F,ct,A):gi(F,A,ct);const dt=1e-9,D=Math.ceil(Math.log(P/ct)/Math.log(R)-dt),V=-j*(.5-dt)+.5,It=Math.min(ct,F),yt=Math.floor(Math.log(P/It)/Math.log(R)+V),Xt=Math.max(D,yt);return gi(P/Math.pow(R,Xt),A,ct)}}}(f,u,c,m,!x&&b,y):f_(u,c,m,!x&&b,y)}var S,R,P,A;return{constraint:h,maxResolution:u,minResolution:c,minZoom:d,zoomFactor:f}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=function(l){if(void 0!==l.extent)return p_(l.extent,l.constrainOnlyCenter,void 0===l.smoothExtentConstraint||l.smoothExtentConstraint);const h=tf(l.projection,"EPSG:3857");if(!0!==l.multiWorld&&h.isGlobal()){const u=h.getExtent().slice();return u[0]=-1/0,u[2]=1/0,p_(u,!1,!1)}return $C}(t),s=i.constraint,o=function(l){if(void 0===l.enableRotation||l.enableRotation){const h=l.constrainRotation;return void 0===h||!0===h?function(c){const d=vu(5);return function(p,f){return f||void 0===p?p:Math.abs(p)<=d?0:p}}():!1===h?g_:"number"==typeof h?function(c){const d=2*Math.PI/c;return function(p,f){return f?p:void 0!==p?p=Math.floor(p/d+.5)*d:void 0}}(h):g_}return of}(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution();this.setCenterInternal([i[0]+s/2*(r[3]-e[3]+e[1]-r[1]),i[1]-s/2*(r[0]-e[0]+e[2]-r[2])])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Vn(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Vn(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let r=0;for(;r<i&&!this.isDef();++r){const c=arguments[r];c.center&&this.setCenterInternal(c.center),void 0!==c.zoom?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),void 0!==c.rotation&&this.setRotation(c.rotation)}if(r===i)return void(e&&Lu(e,!0));let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;r<i;++r){const c=arguments[r],d={start:s,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||YC,callback:e};if(c.center&&(d.sourceCenter=o,d.targetCenter=c.center.slice(),o=d.targetCenter),void 0!==c.zoom?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(c.zoom),a=d.targetResolution):c.resolution&&(d.sourceResolution=a,d.targetResolution=c.resolution,a=d.targetResolution),void 0!==c.rotation){d.sourceRotation=l;const p=Wo(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+p,l=d.targetRotation}(u=d).sourceCenter&&u.targetCenter&&!Eu(u.sourceCenter,u.targetCenter)||u.sourceResolution!==u.targetResolution||u.sourceRotation!==u.targetRotation?s+=d.duration:d.complete=!0,h.push(d)}var u;this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const r=this.animations_[e];if(r[0].callback&&Lu(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;let h=l.duration>0?(t-l.start)/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const c=l.sourceCenter[0],d=l.sourceCenter[1],p=l.targetCenter[0],f=l.targetCenter[1];this.nextCenter_=l.targetCenter,this.targetCenter_=[c+u*(p-c),d+u*(f-d)]}if(l.sourceResolution&&l.targetResolution){const c=1===u?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),p=this.constraints_.resolution(c,0,d,!0);this.targetCenter_=this.calculateCenterZoom(p,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=c,this.applyTargetState_(!0)}if(void 0!==l.sourceRotation&&void 0!==l.targetRotation){const c=1===u?Wo(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(c,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=c}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Lu(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();return void 0!==r&&(i=[r[0]-e[0],r[1]-e[1]],$p(i,t-this.getRotation()),(o=i)[0]+=+(a=e)[0],o[1]+=+a[1]),i;var o,a}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),s=this.getResolution();return void 0!==r&&void 0!==s&&(i=[e[0]-t*(e[0]-r[0])/s,e[1]-t*(e[1]-r[1])/s]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&ef(t,this.getProjection())}getCenterInternal(){return this.get(nr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return nf(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Me(e,"The view center is not defined");const i=this.getResolution();Me(void 0!==i,"The view resolution is not defined");const r=this.getRotation();return Me(void 0!==r,"The view rotation is not defined"),qp(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(nr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Qs(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=qe(t)/e[0],r=En(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=Math.log(e/this.minResolution_)/Math.log(t);return function(r){return e/Math.pow(t,r*i)}}getRotation(){return this.get(nr.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=Math.log(i/this.minResolution_)/e;return function(s){return Math.log(i/s)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=xf(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,r=this.minZoom_||0;if(this.resolutions_){const s=Rp(this.resolutions_,t,1);r=s,e=this.resolutions_[s],i=s==this.resolutions_.length-1?2:e/this.resolutions_[s+1]}else e=this.maxResolution_,i=this.zoomFactor_;return r+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=gi(Math.floor(t),0,this.resolutions_.length-2);return this.resolutions_[e]/Math.pow(this.resolutions_[e]/this.resolutions_[e+1],gi(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Me(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))Me(!yl(t),"Cannot fit empty extent provided as `geometry`"),i=Au(Qs(t,this.getProjection()));else if("Circle"===t.getType()){const r=Qs(t.getExtent(),this.getProjection());i=Au(r),i.rotate(this.getRotation(),er(r))}else{const r=wl();i=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let c=0,d=s.length;c<d;c+=o){const p=s[c]*i-s[c+1]*r,f=s[c]*r+s[c+1]*i;a=Math.min(a,p),l=Math.min(l,f),h=Math.max(h,p),u=Math.max(u,f)}return[a,l,h,u]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const r=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest;let o;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const h=this.getRotation(),u=Math.sin(h),c=Math.cos(h),d=er(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const p=this.getConstrainedCenter([d[0]*c-d[1]*u,d[1]*c+d[0]*u],l),f=e.callback?e.callback:Go;void 0!==e.duration?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},f):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),Lu(f,!0))}centerOn(t,e,i){this.centerOnInternal(Vn(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(xf(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=xf(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=ef(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Vn(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Vn(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Vn(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(nr.ROTATION)!==r&&this.set(nr.ROTATION,r),this.get(nr.RESOLUTION)!==o&&(this.set(nr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(nr.CENTER)||!Eu(this.get(nr.CENTER),a))&&this.set(nr.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Eu(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:Jo,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&Vn(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function bf(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}const Du=class extends U1{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener("source",this.handleSourcePropertyChange_),this.setSource(t.source?t.source:null)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get("source")||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!this.sourceReady_&&"ready"===this.getSource().getState()&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(si(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=_e(t,"change",this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let r;!t&&i&&(t=i.getView()),e=t instanceof kn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),r=e.layerStatesArray?e.layerStatesArray.find(o=>o.layer===this):this.getLayerState();const s=this.getExtent();return bf(r,e.viewState)&&(!s||_i(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let r=e(t instanceof kn?t.getViewStateAndExtent():t);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(si(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(si(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=_e(t,"precompose",function(e){const i=e.frameState.layerStatesArray,r=this.getLayerState(!1);Me(!i.some(function(s){return s.layer===r.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),i.push(r)},this),this.mapRenderKey_=_e(this,"change",t.render,t),this.changed())}setSource(t){this.set("source",t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function eM(n,t){Mu.expire()}const iM=class extends Pp{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){Wt()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Dr(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Lp(r,i)}forEachFeatureAtCoordinate(t,e,i,r,s,o,a,l){let h;const u=e.viewState;function c(x,b,M,w){return s.call(o,b,x?M:null,w)}const d=u.projection,p=Yp(t.slice(),d),f=[[0,0]];if(d.canWrapX()&&r){const x=qe(d.getExtent());f.push([-x,0],[x,0])}const g=e.layerStatesArray,m=g.length,y=[],_=[];for(let x=0;x<f.length;x++)for(let b=m-1;b>=0;--b){const M=g[b],w=M.layer;if(w.hasRenderer()&&bf(M,u)&&a.call(l,w)){const S=w.getRenderer(),R=w.getSource();if(S&&R){const P=R.getWrapX()?p:t,A=c.bind(null,M.managed);_[0]=P[0]+f[x][0],_[1]=P[1]+f[x][1],h=S.forEachFeatureAtCoordinate(_,e,i,A,y)}if(h)return h}}if(0===y.length)return;const v=1/y.length;return y.forEach((x,b)=>x.distanceSq+=b*v),y.sort((x,b)=>x.distanceSq-b.distanceSq),y.some(x=>h=x.callback(x.feature,x.layer,x.geometry)),h}hasFeatureAtCoordinate(t,e,i,r,s,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,r,zo,this,s,o)}getMap(){return this.map_}renderFrame(t){Wt()}flushDeclutterItems(t){}scheduleExpireIconCache(t){Mu.canExpireCache()&&t.postRenderFunctions.push(eM)}},F_=class extends cr{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}},Nu="ol-hidden",El="ol-unselectable",O_="ol-unsupported",zu="ol-control",A_="ol-collapsed",nM=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),L_=["style","variant","weight","size","lineHeight","family"],D_=function(n){const t=n.match(nM);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=L_.length;i<r;++i){const s=t[i+1];void 0!==s&&(e[L_[i]]=s)}return e.families=e.family.split(/,\s?/),e};function Vi(n,t,e,i){let r;return r=e&&e.length?e.shift():Fp?new OffscreenCanvas(n||300,t||300):document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}function Tl(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function rM(n){let t=n.offsetWidth;const e=getComputedStyle(n);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function sM(n){let t=n.offsetHeight;const e=getComputedStyle(n);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function ju(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function Gu(n){return n&&n.parentNode?n.parentNode.removeChild(n):null}function N_(n){for(;n.lastChild;)n.removeChild(n.lastChild)}const z_="10px sans-serif",dn="#000",Qo="round",Gr=[],ta="round",kl="#000",Il="center",qu="middle",no=[0,0,0,0],gr=new tr;let wf,ea=null;const Cf={},j_=function(){const n="32px ",t=["monospace","serif"],e=t.length,i="wmytzilWMYTZIL@#/&?$%10\uf013";let r,s;function o(l,h,u){let c=!0;for(let d=0;d<e;++d){const p=t[d];if(s=Vu(l+" "+h+" "+n+p,i),u!=p){const f=Vu(l+" "+h+" "+n+u+","+p,i);c=c&&f!=s}}return!!c}function a(){let l=!0;const h=gr.getKeys();for(let u=0,c=h.length;u<c;++u){const d=h[u];gr.get(d)<100&&(o.apply(this,d.split("\n"))?(dl(Cf),ea=null,wf=void 0,gr.set(d,100)):(gr.set(d,gr.get(d)+1,!0),l=!1))}l&&(clearInterval(r),r=void 0)}return function(l){const h=D_(l);if(!h)return;const u=h.families;for(let c=0,d=u.length;c<d;++c){const p=u[c],f=h.style+"\n"+h.weight+"\n"+p;void 0===gr.get(f)&&(gr.set(f,100,!0),o(h.style,h.weight,p)||(gr.set(f,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),oM=function(){let n;return function(t){let e=Cf[t];if(null==e){if(Fp){const i=D_(t),r=G_(t,"\u017dg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);Cf[t]=e}return e}}();function G_(n,t){return ea||(ea=Vi(1,1)),n!=wf&&(ea.font=n,wf=ea.font),ea.measureText(t)}function Vu(n,t){return G_(n,t).width}function q_(n,t,e){if(t in e)return e[t];const i=t.split("\n").reduce((r,s)=>Math.max(r,Vu(n,s)),0);return e[t]=i,i}const aM=class extends iM{constructor(t){super(t),this.fontChangeListenerKey_=_e(gr,"propertychange",t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=El+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new F_(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){si(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent("precompose",t);const e=t.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),i=t.viewState;this.children_.length=0;const r=this.declutterLayers_;r.length=0;let s=null;for(let o=0,a=e.length;o<a;++o){const l=e[o];t.layerIndex=o;const h=l.layer,u=h.getSourceState();if(!bf(l,i)||"ready"!=u&&"undefined"!=u){h.unrender();continue}const c=h.render(t,s);c&&(c!==s&&(this.children_.push(c),s=c),"getDeclutter"in h&&r.push(h))}this.flushDeclutterItems(t),function(a,l){const h=a.childNodes;for(let u=0;;++u){const c=h[u],d=l[u];if(!c&&!d)break;if(c!==d){if(!c){a.appendChild(d);continue}if(!d){a.removeChild(c),--u;continue}a.insertBefore(d,c)}}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class vs extends cr{constructor(t,e){super(t),this.layer=e}}class Mf extends U1{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener("layers",this.handleLayersChanged_),i?Array.isArray(i)?i=new pr(i.slice(),{unique:!0}):Me("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new pr(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(si),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(_e(t,"add",this.handleLayersAdd_,this),_e(t,"remove",this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(si);dl(this.listenerKeys_);const e=t.getArray();for(let i=0,r=e.length;i<r;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new vs("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[_e(t,"propertychange",this.handleLayerChange_,this),_e(t,"change",this.handleLayerChange_,this)];t instanceof Mf&&e.push(_e(t,"addlayer",this.handleLayerGroupAdd_,this),_e(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Qt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new vs("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new vs("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new vs("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=Qt(e);this.listenerKeys_[i].forEach(si),delete this.listenerKeys_[i],this.dispatchEvent(new vs("removelayer",e)),this.changed()}getLayers(){return this.get("layers")}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new vs("removelayer",i[r]))}this.set("layers",t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&void 0===r.zIndex&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),void 0!==r.extent&&(l.extent=void 0!==l.extent?Ks(l.extent,r.extent):r.extent),void 0===l.zIndex&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}const Pl=Mf,ia=class extends cr{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},qr=class extends ia{constructor(t,e,i,r,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==r&&r,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Ve={SINGLECLICK:"singleclick",CLICK:"click",DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},lM=class extends fu{constructor(t,e){super(t),this.map_=t,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=_e(i,"pointerdown",this.handlePointerDown_,this),this.relayedListenerKey_=_e(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener("touchmove",this.boundHandleTouchMove_,!!k1&&{passive:!1})}emulateClick_(t){let e=new qr(Ve.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new qr(Ve.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new qr(Ve.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Ve.POINTERUP||e.type==Ve.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==Ve.POINTERDOWN||e.type==Ve.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new qr(Ve.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(si),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new qr(Ve.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(_e(i,Ve.POINTERMOVE,this.handlePointerMove_,this),_e(i,Ve.POINTERUP,this.handlePointerUp_,this),_e(this.element_,Ve.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(_e(this.element_.getRootNode(),Ve.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new qr(Ve.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new qr(Ve.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&("boolean"!=typeof t.cancelable||!0===t.cancelable)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(si(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener("touchmove",this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(si(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(si),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Sf=1/0,hM=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,dl(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){Me(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Sf&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,s=e[t],o=i[t],a=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),u=h<r&&i[h]<i[l]?h:l;e[t]=e[u],i[t]=i[u],t=u}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,s=i[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(!(r[a]>o))break;i[e]=i[a],r[e]=r[a],e=a}i[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==Sf?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,e[r++]=o);e.length=r,i.length=r,this.heapify_()}},uM=class extends hM{constructor(t,e){super(function(i){return t.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener("change",this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener("change",this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,r,s,o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=this.dequeue()[0],s=r.getKey(),i=r.getState(),0===i&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++o,r.load())}},Rl=class extends tr{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Gu(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Gu(this.element);for(let e=0,i=this.listenerKeys.length;e<i;++e)si(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Go&&this.listenerKeys.push(_e(t,"postrender",this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},cM=class extends Rl{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",r=void 0!==t.expandClassName?t.expandClassName:e+"-expand",s=void 0!==t.collapseLabel?t.collapseLabel:"\u203a",o=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof s?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=void 0!==t.label?t.label:"i";"string"==typeof a?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener("click",this.handleClick_.bind(this),!1);const h=this.element;h.className=e+" "+El+" "+zu+(this.collapsed_&&this.collapsible_?" "+A_:"")+(this.collapsible_?"":" ol-uncollapsible"),h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(r=>r.getAttributions(t)))),i=!this.getMap().getAllLayers().some(r=>r.getSource()&&!1===r.getSource().getAttributionsCollapsible());return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!hs(e,this.renderedAttributions_)){N_(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(A_),this.collapsed_?ju(this.collapseLabel_,this.label_):ju(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},dM=class extends Rl{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"\u21e7",r=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener("click",this.handleClick_.bind(this),!1);const a=this.element;a.className=e+" "+El+" "+zu,a.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Nu)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Jo}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Nu);s||0!==i?s&&0!==i&&this.element.classList.remove(Nu):this.element.classList.add(Nu)}this.label_.style.transform=r}this.rotation_=i}},pM=class extends Rl{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,r=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",s=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",o=void 0!==t.zoomInLabel?t.zoomInLabel:"+",a=void 0!==t.zoomOutLabel?t.zoomOutLabel:"\u2013",l=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",h=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener("click",this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=s,c.setAttribute("type","button"),c.title=h,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener("click",this.handleClick_.bind(this,-i),!1);const d=this.element;d.className=e+" "+El+" "+zu,d.appendChild(u),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const r=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:Jo})):e.setZoom(r)}}};function V_(n){n=n||{};const t=new pr;return(void 0===n.zoom||n.zoom)&&t.push(new pM(n.zoomOptions)),(void 0===n.rotate||n.rotate)&&t.push(new dM(n.rotateOptions)),(void 0===n.attribution||n.attribution)&&t.push(new cM(n.attributionOptions)),t}function Ef(n,t,e,i){const r=n.getZoom();if(void 0===r)return;const s=n.getConstrainedZoom(r+t),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:void 0!==i?i:250,easing:Jo})}const Fl=class extends tr{constructor(t){super(),t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get("active")}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set("active",t)}setMap(t){this.map_=t}},fM=class extends Fl{constructor(t){super(),this.delta_=(t=t||{}).delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Ve.DBLCLICK){const i=t.originalEvent,r=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;Ef(t.map.getView(),s,r,this.duration_),i.preventDefault(),e=!0}return!e}};function Tf(n){const t=n.length;let e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}const na=class extends Fl{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ve.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Ve.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Ve.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Ve.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function kf(n){const t=arguments;return function(e){let i=!0;for(let r=0,s=t.length;r<s&&(i=i&&t[r](e),i);++r);return i}}const gM=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Z_=function(n){return!n.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(n)},If=zo,B_=function(n){const t=n.originalEvent;return 0==t.button&&!(FC&&S1&&t.ctrlKey)},mM=jo,Pf=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},W_=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},H_=function(n){const t=n.originalEvent,e=t.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e&&!t.target.isContentEditable},Rf=function(n){const t=n.originalEvent;return Me(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"mouse"==t.pointerType},yM=function(n){const t=n.originalEvent;return Me(void 0!==t,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&0===t.button},_M=class extends na{constructor(t){super({stopDown:jo}),this.kinetic_=(t=t||{}).kinetic,this.lastCentroid=null,this.panning_=!1;const e=t.condition?t.condition:kf(Pf,yM);this.condition_=t.onFocusOnly?kf(Z_,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(Tf(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],o=t.map.getView();l=s,h=o.getResolution(),l[0]*=h,l[1]*=h,$p(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();var l,h;this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Jo})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},vM=class extends na{constructor(t){t=t||{},super({stopDown:jo}),this.condition_=t.condition?t.condition:gM,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!Rf(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===of)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);void 0!==this.lastAngle_&&i.adjustRotationInternal(-(o-this.lastAngle_)),this.lastAngle_=o}handleUpEvent(t){return!Rf(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!(Rf(t)&&B_(t)&&this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)}},xM=class extends Pp{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new _s([i])}getGeometry(){return this.geometry_}};class Ff extends cr{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const bM=class extends na{constructor(t){super(),this.box_=new xM((t=t||{}).className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:B_,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],s=i[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ff("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ff(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ff("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},wM=class extends bM{constructor(t){super({condition:(t=t||{}).condition?t.condition:W_,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const r=e.rotatedExtentForGeometry(i),s=e.getResolutionForExtentInternal(r),o=e.getResolution()/s;i=i.clone(),i.scale(o*o)}e.fitInternal(i,{duration:this.duration_,easing:Jo})}},CM=class extends Fl{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Pf(e)&&H_(e)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if("keydown"==t.type){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&("ArrowDown"==r||"ArrowLeft"==r||"ArrowRight"==r||"ArrowUp"==r)){const s=t.map.getView(),o=s.getResolution()*this.pixelDelta_;let a=0,l=0;"ArrowDown"==r?l=-o:"ArrowLeft"==r?a=-o:"ArrowRight"==r?a=o:l=o;const h=[a,l];$p(h,s.getRotation()),function(c,d,p){const f=c.getCenterInternal();f&&c.animateInternal({duration:void 0!==p?p:250,easing:KC,center:c.getConstrainedCenter([f[0]+d[0],f[1]+d[1]])})}(s,h,this.duration_),i.preventDefault(),e=!0}}return!e}},MM=class extends Fl{constructor(t){super(),this.condition_=(t=t||{}).condition?t.condition:function(e){return!function(i){const r=i.originalEvent;return S1?r.metaKey:r.ctrlKey}(e)&&H_(e)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if("keydown"==t.type||"keypress"==t.type){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&("+"===r||"-"===r)){const s="+"===r?this.delta_:-this.delta_;Ef(t.map.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},SM=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},EM=class extends Fl{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:If;this.condition_=t.onFocusOnly?kf(Z_,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||"wheel"!==t.type)return!0;const e=t.map,i=t.originalEvent;let r;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),"wheel"==t.type&&(r=i.deltaY,RC&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=E1),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),0===r)return!1;this.lastDelta_=r;const s=Date.now();void 0===this.startTime_&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const o=e.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=r;const a=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),a),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-gi(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Ef(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},TM=class extends na{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=jo),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(void 0!==this.lastAngle_){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==of&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Tf(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},kM=class extends na{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=jo),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,h=l.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Tf(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_,this.lastScaleDelta_>1?1:-1),1))}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function U_(n){return n[0]>0&&n[1]>0}function Xi(n,t){return Array.isArray(n)?n:(void 0===t?t=[n,n]:(t[0]=n,t[1]=n),t)}function X_(n){n instanceof Du?n.setMapInternal(null):n instanceof Pl&&n.getLayers().forEach(X_)}function $_(n,t){if(n instanceof Du)n.setMapInternal(t);else if(n instanceof Pl){const e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)$_(e[i],t)}}const ra=class extends tr{constructor(t){super();const e=function(s){let o=null;void 0!==s.keyboardEventTarget&&(o="string"==typeof s.keyboardEventTarget?document.getElementById(s.keyboardEventTarget):s.keyboardEventTarget);const a={},l=s.layers&&"function"==typeof s.layers.getLayers?s.layers:new Pl({layers:s.layers});let h,u,c;return a.layergroup=l,a.target=s.target,a.view=s.view instanceof kn?s.view:new kn,void 0!==s.controls&&(Array.isArray(s.controls)?h=new pr(s.controls.slice()):(Me("function"==typeof s.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),h=s.controls)),void 0!==s.interactions&&(Array.isArray(s.interactions)?u=new pr(s.interactions.slice()):(Me("function"==typeof s.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),u=s.interactions)),void 0!==s.overlays?Array.isArray(s.overlays)?c=new pr(s.overlays.slice()):(Me("function"==typeof s.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),c=s.overlays):c=new pr,{controls:h,interactions:u,keyboardEventTarget:o,overlays:c,values:a}}(t=t||{});this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:E1,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||V_(),this.interactions=e.interactions||function(s){s=s||{};const o=new pr,a=new SM(-.005,.05,100);return(void 0===s.altShiftDragRotate||s.altShiftDragRotate)&&o.push(new vM),(void 0===s.doubleClickZoom||s.doubleClickZoom)&&o.push(new fM({delta:s.zoomDelta,duration:s.zoomDuration})),(void 0===s.dragPan||s.dragPan)&&o.push(new _M({onFocusOnly:s.onFocusOnly,kinetic:a})),(void 0===s.pinchRotate||s.pinchRotate)&&o.push(new TM),(void 0===s.pinchZoom||s.pinchZoom)&&o.push(new kM({duration:s.zoomDuration})),(void 0===s.keyboard||s.keyboard)&&(o.push(new CM),o.push(new MM({delta:s.zoomDelta,duration:s.zoomDuration}))),(void 0===s.mouseWheelZoom||s.mouseWheelZoom)&&o.push(new EM({onFocusOnly:s.onFocusOnly,duration:s.zoomDuration})),(void 0===s.shiftDragZoom||s.shiftDragZoom)&&o.push(new wM({duration:s.zoomDuration})),o}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new uM(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener("layergroup",this.handleLayerGroupChanged_),this.addChangeListener("view",this.handleViewChanged_),this.addChangeListener("size",this.handleSizeChanged_),this.addChangeListener("target",this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof kn)&&t.view.then(function(r){i.setView(new kn(r))}),this.controls.addEventListener("add",r=>{r.element.setMap(this)}),this.controls.addEventListener("remove",r=>{r.element.setMap(null)}),this.interactions.addEventListener("add",r=>{r.element.setMap(this)}),this.interactions.addEventListener("remove",r=>{r.element.setMap(null)}),this.overlays_.addEventListener("add",r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener("remove",r=>{const s=r.element.getId();void 0!==s&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){$_(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,!1!==i.checkWrapped,e,null,void 0!==i.layerFilter?i.layerFilter:zo,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){const t=[];return function e(i){i.forEach(function(r){r instanceof Pl?e(r.getLayers()):t.push(r)})}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,void 0!==(e=void 0!==e?e:{}).hitTolerance?e.hitTolerance:0,!1!==e.checkWrapped,void 0!==e.layerFilter?e.layerFilter:zo,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),r="changedTouches"in t?t.changedTouches[0]:t;return[(r.clientX-e.left)/(e.width/i[0]),(r.clientY-e.top)/(e.height/i[1])]}getTarget(){return this.get("target")}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return ef(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Fi(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get("layergroup")}setLayers(t){const e=this.getLayerGroup();if(t instanceof pr)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Vn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Fi(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get("size")}getView(){return this.get("view")}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return function(o,a,l,h,u){if(!o||!(l in o.wantedTiles)||!o.wantedTiles[l][a.getKey()])return Sf;const c=o.viewState.center,d=h[0]-c[0],p=h[1]-c[1];return 65536*Math.log(u)+Math.sqrt(d*d+p*p)/u}(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){const i=new qr(e=e||t.type,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if("pointerdown"===i||"wheel"===i||"keydown"===i){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===r?r.documentElement:s).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()===this&&o.getActive()&&this.getTargetElement()&&(!o.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[0]||o[1]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener("rendercomplete")&&this.renderer_.dispatchRenderEvent("rendercomplete",t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new ia("loadend",this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new ia("loadstart",this,t))));const i=this.postRenderFunctions_;for(let r=0,s=i.length;r<s;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)si(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener("contextmenu",this.boundHandleBrowserEvent_),this.viewport_.removeEventListener("wheel",this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Gu(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new aM(this)),this.mapBrowserEventHandler_=new lM(this,this.moveTolerance_);for(const s in Ve)this.mapBrowserEventHandler_.addEventListener(Ve[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener("contextmenu",this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener("wheel",this.boundHandleBrowserEvent_,!!k1&&{passive:!1});const i=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[_e(i,"keydown",this.handleBrowserEvent,this),_e(i,"keypress",this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(si(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(si(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=_e(t,"propertychange",this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=_e(t,"change",this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(si),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new vs("addlayer",t)),this.layerGroupPropertyListenerKeys_=[_e(t,"propertychange",this.render,this),_e(t,"change",this.render,this),_e(t,"addlayer",this.handleLayerAdd_,this),_e(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){X_(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(void 0!==e&&U_(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:qp(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:Qt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=qp(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!yl(this.previousExtent_)&&!Vo(s.extent,this.previousExtent_))&&(this.dispatchEvent(new ia("movestart",this,r)),this.previousExtent_=qo(this.previousExtent_)),this.previousExtent_&&!s.viewHints[0]&&!s.viewHints[1]&&!Vo(s.extent,this.previousExtent_)&&(this.dispatchEvent(new ia("moveend",this,s)),O1(s.extent,this.previousExtent_))),this.dispatchEvent(new ia("postrender",this,s)),this.renderComplete_=this.hasListener("loadstart")||this.hasListener("loadend")||this.hasListener("rendercomplete")?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new vs("removelayer",e)),this.set("layergroup",t)}setSize(t){this.set("size",t)}setTarget(t){this.set("target",t)}setView(t){if(!t||t instanceof kn)return void this.set("view",t);this.set("view",new kn);const e=this;t.then(function(i){e.setView(new kn(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(e=[s,o],!U_(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&r_("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!hs(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},Zu=class extends fu{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent("change")}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){Wt()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const r=e-i+1e3/60;return r>=this.transition_?1:m_(r/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},Y_=class extends Zu{constructor(t,e,i,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const e=Vi(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;this.state=t.naturalWidth&&t.naturalHeight?2:4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(e,i,r){const s=e;let o=!0,a=!1,l=!1;const h=[gu(s,"load",function(){l=!0,a||i()})];return s.src&&T1?(a=!0,s.decode().then(function(){o&&i()}).catch(function(u){o&&(l?i():r())})):h.push(gu(s,"error",r)),function(){o=!1,h.forEach(si)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},IM=class{constructor(t,e,i,r,s,o){this.sourceProj_=t,this.targetProj_=e;let a={};const l=Ko(this.targetProj_,this.sourceProj_);this.transformInv_=function(_){const v=_[0]+"/"+_[1];return a[v]||(a[v]=l(_)),a[v]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&qe(r)>=qe(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?qe(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?qe(this.targetProj_.getExtent()):null;const h=Gn(i),u=ml(i),c=gl(i),d=Zo(i),p=this.transformInv_(h),f=this.transformInv_(u),g=this.transformInv_(c),m=this.transformInv_(d),y=10+(o?Math.max(0,Math.ceil(Math.log2(Gp(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,c,d,p,f,g,m,y),this.wrapsXInSource_){let _=1/0;this.triangles_.forEach(function(v,x,b){_=Math.min(_,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-_>this.sourceWorldWidth_/2){const x=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];x[0][0]-_>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-_>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-_>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);const b=Math.min(x[0][0],x[1][0],x[2][0]);Math.max(x[0][0],x[1][0],x[2][0])-b<this.sourceWorldWidth_/2&&(v.source=x)}})}a={}}addTriangle_(t,e,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,i]})}addQuad_(t,e,i,r,s,o,a,l,h){const u=pl([s,o,a,l]),c=this.sourceWorldWidth_?qe(u)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&c>.5&&c<1;let f=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(f=qe(pl([t,e,i,r]))/this.targetWorldWidth_>.25||f),!p&&this.sourceProj_.isGlobal()&&c&&(f=c>.25||f)),!f&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!_i(u,this.maxSourceExtent_))return;let g=0;if(!(f||isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(l[0])&&isFinite(l[1])))if(h>0)f=!0;else if(g=(isFinite(s[0])&&isFinite(s[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1),1!=g&&2!=g&&4!=g&&8!=g)return;if(h>0){if(!f){const m=this.transformInv_([(t[0]+i[0])/2,(t[1]+i[1])/2]);let y;y=p?(Wo(s[0],d)+Wo(a[0],d))/2-Wo(m[0],d):(s[0]+a[0])/2-m[0];const _=(s[1]+a[1])/2-m[1];f=y*y+_*_>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m),_=[(r[0]+t[0])/2,(r[1]+t[1])/2],v=this.transformInv_(_);this.addQuad_(t,e,m,_,s,o,y,v,h-1),this.addQuad_(_,m,i,r,v,y,a,l,h-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],y=this.transformInv_(m),_=[(i[0]+r[0])/2,(i[1]+r[1])/2],v=this.transformInv_(_);this.addQuad_(t,m,_,r,s,y,v,l,h-1),this.addQuad_(m,e,i,_,y,o,a,v,h-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&g||this.addTriangle_(t,i,r,s,a,l),14&g||this.addTriangle_(t,i,e,s,a,o),g&&(13&g||this.addTriangle_(e,r,t,o,l,s),7&g||this.addTriangle_(e,r,i,o,l,a))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,i,r){const s=e.source;fl(t,s[0]),fl(t,s[1]),fl(t,s[2])}),t}getTriangles(){return this.triangles_}};let Of;const sa=[];function K_(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function Af(n,t){return Math.abs(n[4*t]-210)>2||Math.abs(n[4*t+3]-191.25)>2}function J_(n,t,e,i){const r=Tu(e,t,n);let s=l_(t,i,e);const o=t.getMetersPerUnit();void 0!==o&&(s*=o);const a=n.getMetersPerUnit();void 0!==a&&(s/=a);const l=n.getExtent();if(!l||_u(l,r)){const h=l_(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}const Lf=class extends Zu{constructor(t,e,i,r,s,o,a,l,h,u,c,d){super(s,0,d),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const p=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const m=f?Ks(p,f):p;if(0===Gp(m))return void(this.state=4);const y=t.getExtent();y&&(g=g?Ks(g,y):y);const _=r.getResolution(this.wrappedTileCoord_[0]),v=function(M,w,S,R){const P=er(S);let A=J_(M,w,P,R);return(!isFinite(A)||A<=0)&&jp(S,function(T){return A=J_(M,w,T,R),isFinite(A)&&A>0}),A}(t,i,m,_);if(!isFinite(v)||v<=0)return void(this.state=4);if(this.triangulation_=new IM(t,i,m,g,v*(void 0!==u?u:.5),_),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(x[1]=gi(x[1],g[1],g[3]),x[3]=gi(x[3],g[1],g[3])):x=Ks(x,g)),Gp(x)){const b=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let M=b.minX;M<=b.maxX;M++)for(let w=b.minY;w<=b.maxY;w++){const S=h(this.sourceZ_,M,w,a);S&&this.sourceTiles_.push(S)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r="number"==typeof i?i:i[0],s="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(u,c,d,p,f,g,m,y,_,v,x,b,M){const w=Vi(Math.round(d*u),Math.round(d*c),sa);if(b||(w.imageSmoothingEnabled=!1),0===_.length)return w.canvas;function S(T){return Math.round(T*d)/d}w.scale(d,d),w.globalCompositeOperation="lighter";const R=[1/0,1/0,-1/0,-1/0];let P;_.forEach(function(T,K,N){L1(R,T.extent)});{const T=qe(R),K=En(R);P=Vi(Math.round(d*T/p),Math.round(d*K/p),sa),b||(P.imageSmoothingEnabled=!1);const N=d/p;_.forEach(function(F,j,q){const $=F.extent[0]-R[0],ct=-(F.extent[3]-R[3]),dt=qe(F.extent),D=En(F.extent);F.image.width>0&&F.image.height>0&&P.drawImage(F.image,v,v,F.image.width-2*v,F.image.height-2*v,$*N,ct*N,dt*N,D*N)})}const A=Gn(m);return y.getTriangles().forEach(function(T,K,N){const F=T.source,j=T.target;let q=F[0][0],$=F[0][1],ct=F[1][0],dt=F[1][1],D=F[2][0],V=F[2][1];const It=S((j[0][0]-A[0])/g),yt=S(-(j[0][1]-A[1])/g),Xt=S((j[1][0]-A[0])/g),he=S(-(j[1][1]-A[1])/g),Ee=S((j[2][0]-A[0])/g),Ie=S(-(j[2][1]-A[1])/g),De=q,oi=$;q=0,$=0,ct-=De,dt-=oi,D-=De,V-=oi;const st=function(Nt){const Ye=Nt.length;for(let ye=0;ye<Ye;ye++){let Si=ye,Di=Math.abs(Nt[ye][ye]);for(let ei=ye+1;ei<Ye;ei++){const mi=Math.abs(Nt[ei][ye]);mi>Di&&(Di=mi,Si=ei)}if(0===Di)return null;const nn=Nt[Si];Nt[Si]=Nt[ye],Nt[ye]=nn;for(let ei=ye+1;ei<Ye;ei++){const mi=-Nt[ei][ye]/Nt[ye][ye];for(let Ht=ye;Ht<Ye+1;Ht++)ye==Ht?Nt[ei][Ht]=0:Nt[ei][Ht]+=mi*Nt[ye][Ht]}}const Te=new Array(Ye);for(let ye=Ye-1;ye>=0;ye--){Te[ye]=Nt[ye][Ye]/Nt[ye][ye];for(let Si=ye-1;Si>=0;Si--)Nt[Si][Ye]-=Nt[Si][ye]*Te[ye]}return Te}([[ct,dt,0,0,Xt-It],[D,V,0,0,Ee-It],[0,0,ct,dt,he-yt],[0,0,D,V,Ie-yt]]);if(!st)return;if(w.save(),w.beginPath(),function(){if(void 0===Of){const Nt=Vi(6,6,sa);Nt.globalCompositeOperation="lighter",Nt.fillStyle="rgba(210, 0, 0, 0.75)",K_(Nt,4,5,4,0),K_(Nt,4,5,0,5);const Ye=Nt.getImageData(0,0,3,3).data;Of=Af(Ye,0)||Af(Ye,4)||Af(Ye,8),Tl(Nt),sa.push(Nt.canvas)}return Of}()||!b){w.moveTo(Xt,he);const ti=4,Nt=It-Xt,Ye=yt-he;for(let Te=0;Te<ti;Te++)w.lineTo(Xt+S((Te+1)*Nt/ti),he+S(Te*Ye/(ti-1))),Te!=ti-1&&w.lineTo(Xt+S((Te+1)*Nt/ti),he+S((Te+1)*Ye/(ti-1)));w.lineTo(Ee,Ie)}else w.moveTo(Xt,he),w.lineTo(It,yt),w.lineTo(Ee,Ie);let ci;if(w.clip(),w.transform(st[0],st[2],st[1],st[3],It,yt),w.translate(R[0]-De,R[3]-oi),P)ci=P.canvas,w.scale(p/d,-p/d);else{const ti=_[0],Nt=ti.extent;ci=ti.image,w.scale(qe(Nt)/ci.width,-En(Nt)/ci.height)}w.drawImage(ci,0,0),w.restore()}),P&&(Tl(P),sa.push(P.canvas)),x&&(w.save(),w.globalCompositeOperation="source-over",w.strokeStyle="black",w.lineWidth=1,y.getTriangles().forEach(function(T,K,N){const F=T.target,j=(F[0][0]-A[0])/g,q=-(F[0][1]-A[1])/g,$=(F[1][0]-A[0])/g,ct=-(F[1][1]-A[1])/g,dt=(F[2][0]-A[0])/g,D=-(F[2][1]-A[1])/g;w.beginPath(),w.moveTo($,ct),w.lineTo(j,q),w.lineTo(dt,D),w.closePath(),w.stroke()}),w.restore()),w.canvas}(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{const i=e.getState();if(0==i||1==i){t++;const r=_e(e,"change",function(s){const o=e.getState();(2==o||3==o||4==o)&&(si(r),t--,0===t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,i,r){0==e.getState()&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(si),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Tl(this.canvas_.getContext("2d")),sa.push(this.canvas_),this.canvas_=null),super.release()}},PM=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Me(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Me(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Me(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function Q_(n,t,e,i){return void 0!==i?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function oa(n,t,e){return n+"/"+t+"/"+e}function tv(n){return oa(n[0],n[1],n[2])}function ev(n){return n.split("/").map(Number)}const Df=class extends PM{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=ev(this.peekFirstKey())[0];this.forEach(e=>{e.tileCoord[0]!==t&&(this.remove(tv(e.tileCoord)),e.release())})}};function iv(n){return n?Array.isArray(n)?function(t){return n}:"function"==typeof n?n:function(t){return[n]}:null}const nv=class extends tr{constructor(t){super(),this.projection=Se(t.projection),this.attributions_=iv(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=iv(t),this.changed()}setState(t){this.state_=t,this.changed()}};class rv{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function aa(n,t,e,i,r){return void 0!==r?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new rv(n,t,e,i)}const sv=rv,la=[0,0,0],xs=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Me(function(s,o,a){const l=((r,s)=>s-r)||ls;return s.every(function(h,u){if(0===u)return!0;const c=l(s[u-1],h);return!(c>0||0===c)})}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(e){if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}else e=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Me(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0!==i&&!this.origin_&&!this.origins_&&(this.origin_=Gn(i)),Me(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Me(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Up,Me(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new sv(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,r){let s,o,a,l=null,h=t[0]-1;for(2===this.zoomFactor_?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(void 0!==o&&void 0!==a?(o=Math.floor(o/2),a=Math.floor(a/2),s=aa(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,h,i),e(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const s=2*t[1],o=2*t[2];return aa(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return aa(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),h=Math.floor(s*l),u=Math.floor(o*l);return e<r?aa(h,h,u,u,i):aa(h,Math.floor(l*(s+1))-1,u,Math.floor(l*(o+1))-1,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,la);const r=la[1],s=la[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,la),aa(r,la[1],s,la[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Xi(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=Xi(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*r,a=i[1]-(t[2]+1)*s[1]*r;return fr(o,a,o+s[0]*r,a+s[1]*r,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=Xi(this.getTileSize(o),this.tmpSize_);let u=a*(t-l[0])/i/h[0],c=a*(l[1]-e)/i/h[1];return r?(u=wu(u,5)-1,c=wu(c,5)-1):(u=bu(u,5),c=bu(c,5)),Q_(o,u,c,s)}getTileCoordForXYAndZ_(t,e,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=Xi(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/a/l[0],u=(o[1]-e)/a/l[1];return r?(h=wu(h,5)-1,u=wu(u,5)-1):(h=bu(h,5),u=bu(u,5)),Q_(i,h,u,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return gi(Rp(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return k_(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}};function ov(n){let t=n.getDefaultTileGrid();return t||(t=function(i,r,s,o){return function(l,h,u,c){c=void 0!==c?c:"top-left";const d=av(l,void 0,u);return new xs({extent:l,origin:AC(l,c),resolutions:d,tileSize:u})}(Ol(i),0,void 0,void 0)}(n),n.setDefaultTileGrid(t)),t}function Bu(n){const t=n||{},e=t.extent||Se("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:av(e,t.maxZoom,t.tileSize,t.maxResolution)};return new xs(i)}function av(n,t,e,i){t=void 0!==t?t:X1,e=Xi(void 0!==e?e:Up);const r=En(n),s=qe(n);i=i>0?i:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function Ol(n){let t=(n=Se(n)).getExtent();if(!t){const e=180*Ho.degrees/n.getMetersPerUnit();t=fr(-e,-e,e,e)}return t}class RM extends cr{constructor(t,e){super(t),this.tile=e}}const FM=class extends nv{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,this.tileGrid&&Xi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new Df(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,r){const s=this.getTileCacheForProjection(t);if(!s)return!1;let o,a,l,h=!0;for(let u=i.minX;u<=i.maxX;++u)for(let c=i.minY;c<=i.maxY;++c)a=oa(e,u,c),l=!1,s.containsKey(a)&&(o=s.get(a),l=2===o.getState(),l&&(l=!1!==r(o))),l||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,s){return Wt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:ov(t)}getTileCacheForProjection(t){const e=this.getProjection();return Me(null===e||fs(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=Xi(r.getTileSize(t),this.tmpSize);return 1==s?o:(void 0===(u=this.tmpSize)&&(u=[0,0]),u[0]=(l=o)[0]*(h=s)+.5|0,u[1]=l[1]*h+.5|0,u);var l,h,u}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(s,o,a){const l=o[0],h=s.getTileCoordCenter(o),u=Ol(a);if(!_u(u,h)){const c=qe(u),d=Math.ceil((u[0]-h[0])/c);return h[0]+=c*d,s.getTileCoordForCoordAndZ(h,l)}return o}(i,t,e)),function(s,o){const a=s[0],l=s[1],h=s[2];if(o.getMinZoom()>a||a>o.getMaxZoom())return!1;const u=o.getFullTileRange(a);return!u||u.containsXY(l,h)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,r){}};function OM(n,t){const e=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return n.replace(e,o[0].toString()).replace(i,o[1].toString()).replace(r,o[2].toString()).replace(s,function(){const h=t.getFullTileRange(o[0]);if(!h)throw new Error("The {-y} placeholder requires a tile grid with extent");return(h.getHeight()-o[2]-1).toString()})}}function lv(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=OM(n[r],t);return Nf(i)}function Nf(n){return 1===n.length?n[0]:function(t,e,i){if(!t)return;const s=Wo(((a=t)[1]<<a[0])+a[2],n.length);var a;return n[s](t,e,i)}}function zf(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=i;s<=r;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}class jf extends FM{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===jf.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=Qt(e),r=e.getState();let s;1==r?(this.tileLoadingKeys_[i]=!0,s="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=3==r?"tileloaderror":2==r?"tileloadend":void 0),null!=s&&this.dispatchEvent(new RM(s,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=zf(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(lv(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const r=oa(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const hv=jf;function AM(n,t){n.getImage().src=t}const Gf=class extends hv{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:AM,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Y_,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const r in this.tileCacheForProjection){const s=this.tileCacheForProjection[r];s.expireCache(s==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!fs(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!fs(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||fs(e,t)))return this.tileGrid;const i=Qt(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=ov(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||fs(e,t))return this.tileCache;const i=Qt(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Df(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,r,s,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,s),h=l?this.tileUrlFunction(l,r,s):void 0,u=new this.tileClass(a,void 0!==h?0:4,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener("change",this.handleTileChange.bind(this)),u}getTile(t,e,i,r,s){const o=this.getProjection();if(!o||!s||fs(o,s))return this.getTileInternal(t,e,i,r,o||s);const a=this.getTileCacheForProjection(s),l=[t,e,i];let h;const u=tv(l);a.containsKey(u)&&(h=a.get(u));const c=this.getKey();if(h&&h.key==c)return h;const d=this.getTileGridForProjection(o),p=this.getTileGridForProjection(s),f=this.getTileCoordForTileUrlFunction(l,s),g=new Lf(o,d,s,p,l,f,this.getTilePixelRatio(r),this.getGutter(),(m,y,_,v)=>this.getTileInternal(m,y,_,v,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,h?(g.interimTile=h,g.refreshInterimChain(),a.replace(u,g)):a.set(u,g),g}getTileInternal(t,e,i,r,s){let o=null;const a=oa(t,e,i),l=this.getKey();if(this.tileCache.containsKey(a)){if(o=this.tileCache.get(a),o.key!=l){const h=o;o=this.createTile_(t,e,i,r,s,l),o.interimTile=0==h.getState()?h.interimTile:h,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,i,r,s,l),this.tileCache.set(a,o);return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const i=Se(t);if(i){const r=Qt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},uv=class extends Gf{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:Bu({extent:Ol(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},LM=class extends uv{constructor(t){super({opaque:!1,projection:(t=t||{}).projection,tileGrid:t.tileGrid,wrapX:void 0===t.wrapX||t.wrapX,zDirection:t.zDirection,url:t.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(e,i)=>{const r=e.getTileCoord()[0],s=Xi(this.tileGrid.getTileSize(r)),o=Vi(s[0],s[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,s[0]+.5,s[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,s[0]/2,s[1]/2,s[0]),o.fillText(i,s[0]/2,s[1]/2,s[0]),e.setImage(o.canvas)}})}},cv=class extends Zu{constructor(t,e,i,r,s,o){super(t,e,o),this.extent=null,this.format_=r,this.features_=null,this.projection=null,this.tileLoadFunction_=s,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){0==this.state&&(this.setState(1),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(3)}setFeatures(t){this.features_=t,this.setState(2)}setLoader(t){this.loader_=t}},dv=[],DM=class extends Zu{constructor(t,e,i,r){super(t,e,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.getSourceTiles=r.bind(void 0,this),this.wrappedTileCoord=i}getContext(t){const e=Qt(t);return e in this.context_||(this.context_[e]=Vi(1,1,dv)),this.context_[e]}hasContext(t){return Qt(t)in this.context_}getImage(t){return this.hasContext(t)?this.getContext(t).canvas:null}getReplayState(t){const e=Qt(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){for(const t in this.context_){const e=this.context_[t];Tl(e),dv.push(e.canvas),delete this.context_[t]}super.release()}};let NM=!1;function pv(n,t,e,i,r,s,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof n?n(e,i,r):n,!0),"arraybuffer"==t.getType()&&(a.responseType="arraybuffer"),a.withCredentials=NM,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();let u;"json"==h?u=JSON.parse(a.responseText):"text"==h?u=a.responseText:"xml"==h?(u=a.responseXML,u||(u=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==h&&(u=a.response),u?s(t.readFeatures(u,{extent:e,featureProjection:r}),t.readProjection(u)):o()}else o()},a.onerror=o,a.send()}function fv(n,t){return function(e,i,r,s,o){const a=this;pv(n,t,e,i,r,function(l,h){a.addFeatures(l),void 0!==s&&s(l)},o||Go)}}const qf=class extends hv{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||Ol(e),r=t.tileGrid||Bu({extent:i,maxResolution:t.maxResolution,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,opaque:!1,projection:e,state:t.state,tileGrid:r,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:gv,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache=new Df(this.tileCache.highWaterMark),this.overlaps_=null==t.overlaps||t.overlaps,this.tileClass=t.tileClass?t.tileClass:cv,this.tileGrids_={}}getFeaturesInExtent(t){const e=[],i=this.tileCache;if(0===i.getCount())return e;const r=ev(i.peekFirstKey())[0],s=this.tileGrid;return i.forEach(function(o){if(o.tileCoord[0]!==r||2!==o.getState())return;const a=o.getSourceTiles();for(let l=0,h=a.length;l<h;++l){const u=a[l];if(_i(t,s.getTileCoordExtent(u.tileCoord))){const c=u.getFeatures();if(c)for(let d=0,p=c.length;d<p;++d){const f=c[d],g=f.getGeometry();_i(t,g.getExtent())&&e.push(f)}}}}),e}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(t,e){const i=this.getTileCacheForProjection(t),r=Object.keys(e).reduce((s,o)=>{const a=function(u){const[c,d,p]=u.substring(u.lastIndexOf("/")+1,u.length).split(",").map(Number);return oa(c,d,p)}(o),l=i.peek(a);if(l){const h=l.sourceTiles;for(let u=0,c=h.length;u<c;++u)s[h[u].getKey()]=!0}return s},{});super.expireCache(t,e),this.sourceTileCache.expireCache(r)}getSourceTiles(t,e,i){if(0===i.getState()){i.setState(1);const r=i.wrappedTileCoord,s=this.getTileGridForProjection(e),o=s.getTileCoordExtent(r),a=s.getResolution(r[0]);ds(o,-a,o);const l=this.tileGrid,h=l.getExtent();h&&Ks(o,h,o);const u=l.getZForResolution(a,this.zDirection);l.forEachTileCoord(o,u,c=>{const d=this.tileUrlFunction(c,t,e),p=this.sourceTileCache.containsKey(d)?this.sourceTileCache.get(d):new this.tileClass(c,d?0:4,d,this.format_,this.tileLoadFunction);i.sourceTiles.push(p);const f=p.getState();if(f<2){const g=m=>{this.handleTileChange(m);const y=p.getState();if(2===y||3===y){const _=p.getKey();_ in i.errorTileKeys?2===p.getState()&&delete i.errorTileKeys[_]:i.loadingSourceTiles--,3===y?i.errorTileKeys[_]=!0:p.removeEventListener("change",g),0===i.loadingSourceTiles&&i.setState(us(i.errorTileKeys)?2:3)}};p.addEventListener("change",g),i.loadingSourceTiles++}0===f&&(p.extent=l.getTileCoordExtent(c),p.projection=e,p.resolution=l.getResolution(c[0]),this.sourceTileCache.set(d,p),p.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(c=>3===c.getState())?3:2)}return i.sourceTiles}getTile(t,e,i,r,s){const o=oa(t,e,i),a=this.getKey();let l;if(this.tileCache.containsKey(o)&&(l=this.tileCache.get(o),l.key===a))return l;const h=[t,e,i];let u=this.getTileCoordForTileUrlFunction(h,s);const c=this.getTileGrid().getExtent(),d=this.getTileGridForProjection(s);if(u&&c){const g=d.getTileCoordExtent(u);ds(g,-d.getResolution(t),g),_i(c,g)||(u=null)}let p=!0;if(null!==u){const g=this.tileGrid,m=d.getResolution(t),y=g.getZForResolution(m,1),_=d.getTileCoordExtent(u);ds(_,-m,_),g.forEachTileCoord(_,y,v=>{p=p&&!this.tileUrlFunction(v,r,s)})}const f=new DM(h,p?4:0,u,this.getSourceTiles.bind(this,r,s));return f.key=a,l?(f.interimTile=l,f.refreshInterimChain(),this.tileCache.replace(o,f)):this.tileCache.set(o,f),f}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const r=this.tileGrid,s=r.getResolutions().slice(),o=s.map(function(h,u){return r.getOrigin(u)}),a=s.map(function(h,u){return r.getTileSize(u)}),l=X1+1;for(let h=s.length;h<l;++h)s.push(s[h-1]/2),o.push(o[h-1]),a.push(a[h-1]);i=new xs({extent:r.getExtent(),origins:o,resolutions:s,tileSizes:a}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const r=Xi(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]}updateCacheSize(t,e){super.updateCacheSize(2*t,e),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(e).highWaterMark}};function gv(n,t){n.setLoader(function(e,i,r){pv(t,n.getFormat(),e,i,r,n.onLoad.bind(n),n.onError.bind(n))})}let zM=null;var ro=1,so=2,ha=3,Vf=5,mv=6378137,jM=6356752.314,yv=.0066943799901413165,Al=484813681109536e-20,nt=Math.PI/2,ft=1e-10,Zi=.017453292519943295,mr=57.29577951308232,Ze=Math.PI/4,Ll=2*Math.PI,wi=3.14159265359,GM={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const qM={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var _v=/[\s_\-\/\(\)]/g;function bs(n,t){if(n[t])return n[t];for(var e,i=Object.keys(n),r=t.toLowerCase().replace(_v,""),s=-1;++s<i.length;)if((e=i[s]).toLowerCase().replace(_v,"")===r)return n[e]}function Zf(n){var t,e,i,r={},s=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var h=l.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),o={proj:"projName",datum:"datumCode",rf:function(a){r.rf=parseFloat(a)},lat_0:function(a){r.lat0=a*Zi},lat_1:function(a){r.lat1=a*Zi},lat_2:function(a){r.lat2=a*Zi},lat_ts:function(a){r.lat_ts=a*Zi},lon_0:function(a){r.long0=a*Zi},lon_1:function(a){r.long1=a*Zi},lon_2:function(a){r.long2=a*Zi},alpha:function(a){r.alpha=parseFloat(a)*Zi},gamma:function(a){r.rectified_grid_angle=parseFloat(a)},lonc:function(a){r.longc=a*Zi},x_0:function(a){r.x0=parseFloat(a)},y_0:function(a){r.y0=parseFloat(a)},k_0:function(a){r.k0=parseFloat(a)},k:function(a){r.k0=parseFloat(a)},a:function(a){r.a=parseFloat(a)},b:function(a){r.b=parseFloat(a)},r_a:function(){r.R_A=!0},zone:function(a){r.zone=parseInt(a,10)},south:function(){r.utmSouth=!0},towgs84:function(a){r.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){r.to_meter=parseFloat(a)},units:function(a){r.units=a;var l=bs(qM,a);l&&(r.to_meter=l.to_meter)},from_greenwich:function(a){r.from_greenwich=a*Zi},pm:function(a){var l=bs(GM,a);r.from_greenwich=(l||parseFloat(a))*Zi},nadgrids:function(a){"@null"===a?r.datumCode="none":r.nadgrids=a},axis:function(a){var l="ewnsud";3===a.length&&-1!==l.indexOf(a.substr(0,1))&&-1!==l.indexOf(a.substr(1,1))&&-1!==l.indexOf(a.substr(2,1))&&(r.axis=a)},approx:function(){r.approx=!0}};for(t in s)e=s[t],t in o?"function"==typeof(i=o[t])?i(e):r[i]=e:r[t]=e;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}const VM=function(t){return new Vr(t).output()};var Dl=1,ZM=/\s/,BM=/[A-Za-z]/,WM=/[A-Za-z84_]/,Wu=/[,\]]/,vv=/[\d\.E\-\+]/;function Vr(n){if("string"!=typeof n)throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Dl}function xv(n,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var i=e.reduce(function(r,s){return ua(s,r),r},t?{}:n);t&&(n[t]=i)}function ua(n,t){if(Array.isArray(n)){var e=n.shift();if("PARAMETER"===e&&(e=n.shift()),1===n.length)return Array.isArray(n[0])?(t[e]={},void ua(n[0],t[e])):void(t[e]=n[0]);if(n.length)if("TOWGS84"!==e){if("AXIS"===e)return e in t||(t[e]=[]),void t[e].push(n);var i;switch(Array.isArray(e)||(t[e]={}),e){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[e]={name:n[0].toLowerCase(),convert:n[1]},void(3===n.length&&ua(n[2],t[e]));case"SPHEROID":case"ELLIPSOID":return t[e]={name:n[0],a:n[1],rf:n[2]},void(4===n.length&&ua(n[3],t[e]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return n[0]=["name",n[0]],void xv(t,e,n);default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return ua(n,t[e]);return xv(t,e,n)}}else t[e]=n;else t[e]=!0}else t[n]=!0}Vr.prototype.readCharicter=function(){var n=this.text[this.place++];if(4!==this.state)for(;ZM.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Dl:return this.neutral(n);case 2:return this.keyword(n);case 4:return this.quoted(n);case 5:return this.afterquote(n);case 3:return this.number(n);case-1:return}},Vr.prototype.afterquote=function(n){if('"'===n)return this.word+='"',void(this.state=4);if(Wu.test(n))return this.word=this.word.trim(),void this.afterItem(n);throw new Error("havn't handled \""+n+'" in afterquote yet, index '+this.place)},Vr.prototype.afterItem=function(n){return","===n?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Dl)):"]"===n?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Dl,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Vr.prototype.number=function(n){if(!vv.test(n)){if(Wu.test(n))return this.word=parseFloat(this.word),void this.afterItem(n);throw new Error("havn't handled \""+n+'" in number yet, index '+this.place)}this.word+=n},Vr.prototype.quoted=function(n){'"'!==n?this.word+=n:this.state=5},Vr.prototype.keyword=function(n){if(WM.test(n))this.word+=n;else{if("["===n){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=Dl)}if(!Wu.test(n))throw new Error("havn't handled \""+n+'" in keyword yet, index '+this.place);this.afterItem(n)}},Vr.prototype.neutral=function(n){if(BM.test(n))return this.word=n,void(this.state=2);if('"'===n)return this.word="",void(this.state=4);if(vv.test(n))return this.word=n,void(this.state=3);if(!Wu.test(n))throw new Error("havn't handled \""+n+'" in neutral yet, index '+this.place);this.afterItem(n)},Vr.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var t,HM=.017453292519943295;function yr(n){return n*HM}function bv(n){var t=VM(n),e=t.shift(),i=t.shift();t.unshift(["name",i]),t.unshift(["type",e]);var r={};return ua(t,r),function(o){if("GEOGCS"===o.type?o.projName="longlat":"LOCAL_CS"===o.type?(o.projName="identity",o.local=!0):o.projName="object"==typeof o.PROJECTION?Object.keys(o.PROJECTION)[0]:o.PROJECTION,o.AXIS){for(var a="",l=0,h=o.AXIS.length;l<h;++l){var u=[o.AXIS[l][0].toLowerCase(),o.AXIS[l][1].toLowerCase()];-1!==u[0].indexOf("north")||("y"===u[0]||"lat"===u[0])&&"north"===u[1]?a+="n":-1!==u[0].indexOf("south")||("y"===u[0]||"lat"===u[0])&&"south"===u[1]?a+="s":-1!==u[0].indexOf("east")||("x"===u[0]||"lon"===u[0])&&"east"===u[1]?a+="e":(-1!==u[0].indexOf("west")||("x"===u[0]||"lon"===u[0])&&"west"===u[1])&&(a+="w")}2===a.length&&(a+="u"),3===a.length&&(o.axis=a)}o.UNIT&&(o.units=o.UNIT.name.toLowerCase(),"metre"===o.units&&(o.units="meter"),o.UNIT.convert&&("GEOGCS"===o.type?o.DATUM&&o.DATUM.SPHEROID&&(o.to_meter=o.UNIT.convert*o.DATUM.SPHEROID.a):o.to_meter=o.UNIT.convert));var c=o.GEOGCS;function d(p){return p*(o.to_meter||1)}"GEOGCS"===o.type&&(c=o),c&&(o.datumCode=c.DATUM?c.DATUM.name.toLowerCase():c.name.toLowerCase(),"d_"===o.datumCode.slice(0,2)&&(o.datumCode=o.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===o.datumCode||"new_zealand_1949"===o.datumCode)&&(o.datumCode="nzgd49"),("wgs_1984"===o.datumCode||"world_geodetic_system_1984"===o.datumCode)&&("Mercator_Auxiliary_Sphere"===o.PROJECTION&&(o.sphere=!0),o.datumCode="wgs84"),"_ferro"===o.datumCode.slice(-6)&&(o.datumCode=o.datumCode.slice(0,-6)),"_jakarta"===o.datumCode.slice(-8)&&(o.datumCode=o.datumCode.slice(0,-8)),~o.datumCode.indexOf("belge")&&(o.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(o.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===o.ellps.toLowerCase().slice(0,13)&&(o.ellps="intl"),o.a=c.DATUM.SPHEROID.a,o.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(o.datum_params=c.DATUM.TOWGS84),~o.datumCode.indexOf("osgb_1936")&&(o.datumCode="osgb36"),~o.datumCode.indexOf("osni_1952")&&(o.datumCode="osni52"),(~o.datumCode.indexOf("tm65")||~o.datumCode.indexOf("geodetic_datum_of_1965"))&&(o.datumCode="ire65"),"ch1903+"===o.datumCode&&(o.datumCode="ch1903"),~o.datumCode.indexOf("israel")&&(o.datumCode="isr93")),o.b&&!isFinite(o.b)&&(o.b=o.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",yr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",yr],["x0","false_easting",d],["y0","false_northing",d],["long0","central_meridian",yr],["lat0","latitude_of_origin",yr],["lat0","standard_parallel_1",yr],["lat1","standard_parallel_1",yr],["lat2","standard_parallel_2",yr],["azimuth","Azimuth"],["alpha","azimuth",yr],["srsCode","name"]].forEach(function(p){return _=(m=p)[1],void(!((y=m[0])in(g=o))&&_ in g&&(g[y]=g[_],3===m.length&&(g[y]=m[2](g[y]))));var g,m,y,_}),!o.long0&&o.longc&&("Albers_Conic_Equal_Area"===o.projName||"Lambert_Azimuthal_Equal_Area"===o.projName)&&(o.long0=o.longc),o.lat_ts||!o.lat1||"Stereographic_South_Pole"!==o.projName&&"Polar Stereographic (variant B)"!==o.projName?!o.lat_ts&&o.lat0&&"Polar_Stereographic"===o.projName&&(o.lat_ts=o.lat0,o.lat0=yr(o.lat0>0?90:-90)):(o.lat0=yr(o.lat1>0?90:-90),o.lat_ts=o.lat1)}(r),r}function _r(n){var t=this;if(2===arguments.length){var e=arguments[1];_r[n]="string"==typeof e?"+"===e.charAt(0)?Zf(arguments[1]):bv(arguments[1]):e}else if(1===arguments.length){if(Array.isArray(n))return n.map(function(i){Array.isArray(i)?_r.apply(t,i):_r(i)});if("string"==typeof n){if(n in _r)return _r[n]}else"EPSG"in n?_r["EPSG:"+n.EPSG]=n:"ESRI"in n?_r["ESRI:"+n.ESRI]=n:"IAU2000"in n?_r["IAU2000:"+n.IAU2000]=n:console.log(n);return}}(t=_r)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"];const Hu=_r;var UM=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],XM=["3857","900913","3785","102113"];function wv(n,t){var e,i;if(n=n||{},!t)return n;for(i in t)void 0!==(e=t[i])&&(n[i]=e);return n}function vr(n,t,e){var i=n*t;return e/Math.sqrt(1-i*i)}function Nl(n){return n<0?-1:1}function Et(n){return Math.abs(n)<=wi?n:n-Nl(n)*Ll}function rr(n,t,e){var i=n*e;return i=Math.pow((1-i)/(1+i),.5*n),Math.tan(.5*(nt-t))/i}function zl(n,t){for(var e,i,r=.5*n,s=nt-2*Math.atan(t),o=0;o<=15;o++)if(e=n*Math.sin(s),s+=i=nt-2*Math.atan(t*Math.pow((1-e)/(1+e),r))-s,Math.abs(i)<=1e-10)return s;return-9999}function Cv(n){return n}var $M=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):vr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(t){var e,i,r=t.x,s=t.y;if(s*mr>90&&s*mr<-90&&r*mr>180&&r*mr<-180||Math.abs(Math.abs(s)-nt)<=ft)return null;if(this.sphere)e=this.x0+this.a*this.k0*Et(r-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Ze+.5*s));else{var o=Math.sin(s),a=rr(this.e,s,o);e=this.x0+this.a*this.k0*Et(r-this.long0),i=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,r=t.x-this.x0,s=t.y-this.y0;if(this.sphere)i=nt-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var o=Math.exp(-s/(this.a*this.k0));if(-9999===(i=zl(this.e,o)))return null}return e=Et(this.long0+r/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Cv,inverse:Cv,names:["longlat","identity"]}],Uu={},Xu=[];function Mv(n,t){var e=Xu.length;return n.names?(Xu[e]=n,n.names.forEach(function(i){Uu[i.toLowerCase()]=e}),this):(console.log(t),!0)}const YM={start:function(){$M.forEach(Mv)},add:Mv,get:function(t){if(!t)return!1;var e=t.toLowerCase();return typeof Uu[e]<"u"&&Xu[Uu[e]]?Xu[Uu[e]]:void 0}};var Bf={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},KM=Bf.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Bf.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var JM={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},militargeographische_institut:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},Sv={};function QM(n){if(0===n.length)return null;var t="@"===n[0];return t&&(n=n.slice(1)),"null"===n?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:n,mandatory:!t,grid:Sv[n]||null,isNull:!1}}function ca(n){return n/3600*Math.PI/180}function Wf(n,t,e){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(t,e)))}function tS(n){return n.map(function(t){return[ca(t.longitudeShift),ca(t.latitudeShift)]})}function eS(n,t,e){return{name:Wf(n,t+8,t+16).trim(),parent:Wf(n,t+24,t+24+8).trim(),lowerLatitude:n.getFloat64(t+72,e),upperLatitude:n.getFloat64(t+88,e),lowerLongitude:n.getFloat64(t+104,e),upperLongitude:n.getFloat64(t+120,e),latitudeInterval:n.getFloat64(t+136,e),longitudeInterval:n.getFloat64(t+152,e),gridNodeCount:n.getInt32(t+168,e)}}function iS(n,t,e,i){for(var r=t+176,s=[],o=0;o<e.gridNodeCount;o++){var a={latitudeShift:n.getFloat32(r+16*o,i),longitudeShift:n.getFloat32(r+16*o+4,i),latitudeAccuracy:n.getFloat32(r+16*o+8,i),longitudeAccuracy:n.getFloat32(r+16*o+12,i)};s.push(a)}return s}function jl(n,t){if(!(this instanceof jl))return new jl(n);t=t||function(h){if(h)throw h};var u,c,f,g,m,y,e=function(u){if(!function(f){return"string"==typeof f}(u))return u;if(u in Hu)return Hu[u];if(function(f){return UM.some(function(g){return f.indexOf(g)>-1})}(u)){var c=bv(u);if(function(f){var g=bs(f,"authority");if(g){var m=bs(g,"epsg");return m&&XM.indexOf(m)>-1}}(c))return Hu["EPSG:3857"];var d=function(f){var g=bs(f,"extension");if(g)return bs(g,"proj4")}(c);return d?Zf(d):c}return function(f){return"+"===f[0]}(u)?Zf(u):void 0}(n);if("object"==typeof e){var i=jl.projections.get(e.projName);if(i){if(e.datumCode&&"none"!==e.datumCode){var r=bs(JM,e.datumCode);r&&(e.datum_params=e.datum_params||(r.towgs84?r.towgs84.split(","):null),e.ellps=r.ellipse,e.datumName=r.datumName?r.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var s=function(u,c,d,p,f){if(!u){var g=bs(Bf,p);g||(g=KM),u=g.a,c=g.b,d=g.rf}return d&&!c&&(c=(1-1/d)*u),(0===d||Math.abs(u-c)<ft)&&(f=!0,c=u),{a:u,b:c,rf:d,sphere:f}}(e.a,e.b,e.rf,e.ellps,e.sphere),o=(m=((f=(u=s.a)*u)-(g=(c=s.b)*c))/f,y=0,e.R_A?(f=(u*=1-m*(.16666666666666666+m*(.04722222222222222+.022156084656084655*m)))*u,m=0):y=Math.sqrt(m),{es:m,e:y,ep2:(f-g)/g}),a=function(u){return void 0===u?null:u.split(",").map(QM)}(e.nadgrids),l=e.datum||function(u,c,d,p,f,g,m){var y={};return y.datum_type=void 0===u||"none"===u?Vf:4,c&&(y.datum_params=c.map(parseFloat),(0!==y.datum_params[0]||0!==y.datum_params[1]||0!==y.datum_params[2])&&(y.datum_type=ro),y.datum_params.length>3&&(0!==y.datum_params[3]||0!==y.datum_params[4]||0!==y.datum_params[5]||0!==y.datum_params[6])&&(y.datum_type=so,y.datum_params[3]*=Al,y.datum_params[4]*=Al,y.datum_params[5]*=Al,y.datum_params[6]=y.datum_params[6]/1e6+1)),m&&(y.datum_type=ha,y.grids=m),y.a=d,y.b=p,y.es=f,y.ep2=g,y}(e.datumCode,e.datum_params,s.a,s.b,o.es,o.ep2,a);wv(this,e),wv(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),t(null,this)}else t(n)}else t(n)}(jl.projections=YM).start();const Gl=jl;function Ev(n,t,e){var i,r,s,o=n.x,a=n.y,l=n.z?n.z:0;if(a<-nt&&a>-1.001*nt)a=-nt;else if(a>nt&&a<1.001*nt)a=nt;else{if(a<-nt)return{x:-1/0,y:-1/0,z:n.z};if(a>nt)return{x:1/0,y:1/0,z:n.z}}return o>Math.PI&&(o-=2*Math.PI),r=Math.sin(a),s=Math.cos(a),{x:((i=e/Math.sqrt(1-t*(r*r)))+l)*s*Math.cos(o),y:(i+l)*s*Math.sin(o),z:(i*(1-t)+l)*r}}function Tv(n,t,e,i){var r,s,o,a,l,h,u,c,d,p,f,g,m,y,_,v=n.x,x=n.y,b=n.z?n.z:0;if(r=Math.sqrt(v*v+x*x),s=Math.sqrt(v*v+x*x+b*b),r/e<1e-12){if(y=0,s/e<1e-12)return _=-i,{x:n.x,y:n.y,z:n.z}}else y=Math.atan2(x,v);o=b/s,c=(a=r/s)*(1-t)*(l=1/Math.sqrt(1-t*(2-t)*a*a)),d=o*l,m=0;do{m++,h=t*(u=e/Math.sqrt(1-t*d*d))/(u+(_=r*c+b*d-u*(1-t*d*d))),g=(f=o*(l=1/Math.sqrt(1-h*(2-h)*a*a)))*c-(p=a*(1-h)*l)*d,c=p,d=f}while(g*g>1e-24&&m<30);return{x:y,y:Math.atan(f/Math.abs(p)),z:_}}function $u(n){return n===ro||n===so}function kv(n,t,e){if(null===n.grids||0===n.grids.length)return console.log("Grid shift grids not found"),-1;var i={x:-e.x,y:e.y},r={x:Number.NaN,y:Number.NaN},s=[];t:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(null!==a.grid)for(var l=a.grid.subgrids,h=0,u=l.length;h<u;h++){var c=l[h],d=(Math.abs(c.del[1])+Math.abs(c.del[0]))/1e4;if(!(c.ll[1]-d>i.y||c.ll[0]-d>i.x||c.ll[1]+(c.lim[1]-1)*c.del[1]+d<i.y||c.ll[0]+(c.lim[0]-1)*c.del[0]+d<i.x||(r=nS(i,t,c),isNaN(r.x))))break t}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*mr+" "+i.y*mr+" tried: '"+s+"'"),-1):(e.x=-r.x,e.y=r.y,0)}function nS(n,t,e){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=e.ll[0],r.y-=e.ll[1],r.x=Et(r.x-Math.PI)+Math.PI;var s=Iv(r,e);if(t){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o,a,l=9;do{if(a=Iv(s,e),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}s.x+=(o={x:r.x-(a.x+s.x),y:r.y-(a.y+s.y)}).x,s.y+=o.y}while(l--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Et(s.x+e.ll[0]),i.y=s.y+e.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function Iv(n,t){var e,i={x:n.x/t.del[0],y:n.y/t.del[1]},r=Math.floor(i.x),s=Math.floor(i.y),o=i.x-1*r,a=i.y-1*s,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=t.lim[0]||s<0||s>=t.lim[1])return l;var h=t.cvs[e=s*t.lim[0]+r][0],u=t.cvs[e][1];e++;var c=t.cvs[e][0],d=t.cvs[e][1],p=t.cvs[e+=t.lim[0]][0],f=t.cvs[e][1];e--;var g=t.cvs[e][1],m=o*a,y=o*(1-a),_=(1-o)*(1-a),v=(1-o)*a;return l.x=_*h+y*c+v*t.cvs[e][0]+m*p,l.y=_*u+y*d+v*g+m*f,l}function Pv(n,t,e){var i,r,s,o=e.x,a=e.y,l=e.z||0,h={};for(s=0;s<3;s++)if(!t||2!==s||void 0!==e.z)switch(0===s?(i=o,r=-1!=="ew".indexOf(n.axis[s])?"x":"y"):1===s?(i=a,r=-1!=="ns".indexOf(n.axis[s])?"y":"x"):(i=l,r="z"),n.axis[s]){case"e":case"n":h[r]=i;break;case"w":case"s":h[r]=-i;break;case"u":void 0!==e[r]&&(h.z=i);break;case"d":void 0!==e[r]&&(h.z=-i);break;default:return null}return h}function Rv(n){var t={x:n[0],y:n[1]};return n.length>2&&(t.z=n[2]),n.length>3&&(t.m=n[3]),t}function Fv(n){if("function"==typeof Number.isFinite){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof n||n!=n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Yu(n,t,e,i){var r,a,s=void 0!==(e=Array.isArray(e)?Rv(e):{x:e.x,y:e.y,z:e.z,m:e.m}).z;if(Fv((a=e).x),Fv(a.y),n.datum&&t.datum&&function(a,l){return(a.datum.datum_type===ro||a.datum.datum_type===so||a.datum.datum_type===ha)&&"WGS84"!==l.datumCode||(l.datum.datum_type===ro||l.datum.datum_type===so||l.datum.datum_type===ha)&&"WGS84"!==a.datumCode}(n,t)&&(e=Yu(n,r=new Gl("WGS84"),e,i),n=r),i&&"enu"!==n.axis&&(e=Pv(n,!1,e)),"longlat"===n.projName)e={x:e.x*Zi,y:e.y*Zi,z:e.z||0};else if(n.to_meter&&(e={x:e.x*n.to_meter,y:e.y*n.to_meter,z:e.z||0}),!(e=n.inverse(e)))return;if(n.from_greenwich&&(e.x+=n.from_greenwich),e=function(a,l,h){if(!((m=a).datum_type!==(y=l).datum_type||m.a!==y.a||Math.abs(m.es-y.es)>5e-11)&&(m.datum_type===ro?m.datum_params[0]===y.datum_params[0]&&m.datum_params[1]===y.datum_params[1]&&m.datum_params[2]===y.datum_params[2]:m.datum_type!==so||m.datum_params[0]===y.datum_params[0]&&m.datum_params[1]===y.datum_params[1]&&m.datum_params[2]===y.datum_params[2]&&m.datum_params[3]===y.datum_params[3]&&m.datum_params[4]===y.datum_params[4]&&m.datum_params[5]===y.datum_params[5]&&m.datum_params[6]===y.datum_params[6])||a.datum_type===Vf||l.datum_type===Vf)return h;var m,y,u=a.a,c=a.es;if(a.datum_type===ha){if(0!==kv(a,!1,h))return;u=mv,c=yv}var d=l.a,p=l.b,f=l.es;return l.datum_type===ha&&(d=mv,p=jM,f=yv),c!==f||u!==d||$u(a.datum_type)||$u(l.datum_type)?(h=Ev(h,c,u),$u(a.datum_type)&&(h=function(m,y,_){if(y===ro)return{x:m.x+_[0],y:m.y+_[1],z:m.z+_[2]};if(y===so){var v=_[3],x=_[4],b=_[5],M=_[6];return{x:M*(m.x-b*m.y+x*m.z)+_[0],y:M*(b*m.x+m.y-v*m.z)+_[1],z:M*(-x*m.x+v*m.y+m.z)+_[2]}}}(h,a.datum_type,a.datum_params)),$u(l.datum_type)&&(h=function(m,y,_){if(y===ro)return{x:m.x-_[0],y:m.y-_[1],z:m.z-_[2]};if(y===so){var v=_[3],x=_[4],b=_[5],M=_[6],w=(m.x-_[0])/M,S=(m.y-_[1])/M,R=(m.z-_[2])/M;return{x:w+b*S-x*R,y:-b*w+S+v*R,z:x*w-v*S+R}}}(h,l.datum_type,l.datum_params)),h=Tv(h,f,d,p),l.datum_type!==ha||0===kv(l,!0,h)?h:void 0):h}(n.datum,t.datum,e))return t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),"longlat"===t.projName?e={x:e.x*mr,y:e.y*mr,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),i&&"enu"!==t.axis?Pv(t,!0,e):(e&&!s&&delete e.z,e)}var Ov=Gl("WGS84");function Hf(n,t,e,i){var r,s,o;return Array.isArray(e)?(r=Yu(n,t,e,i)||{x:NaN,y:NaN},e.length>2?typeof n.name<"u"&&"geocent"===n.name||typeof t.name<"u"&&"geocent"===t.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(e.splice(3)):[r.x,r.y,e[2]].concat(e.splice(3)):[r.x,r.y].concat(e.splice(2)):[r.x,r.y]):(s=Yu(n,t,e,i),2===(o=Object.keys(e)).length||o.forEach(function(a){if(typeof n.name<"u"&&"geocent"===n.name||typeof t.name<"u"&&"geocent"===t.name){if("x"===a||"y"===a||"z"===a)return}else if("x"===a||"y"===a)return;s[a]=e[a]}),s)}function Av(n){return n instanceof Gl?n:n.oProj?n.oProj:Gl(n)}const In=function(t,e,i){t=Av(t);var r,s=!1;return typeof e>"u"?(e=t,t=Ov,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(i=e,e=t,t=Ov,s=!0),e=Av(e),i?Hf(t,e,i):(r={forward:function(o,a){return Hf(t,e,o,a)},inverse:function(o,a){return Hf(e,t,o,a)}},s&&(r.oProj=e),r)};var Lv=6,Dv="AJSAJS",Nv="AFAFAF",da=65,pn=73,Zn=79,ql=86,Vl=90;const rS={forward:zv,inverse:function(t){var e=Xf(Vv(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:jv};function zv(n,t){return t=t||5,function(i,r){var l,h,p,f,m,y,_,v,x,b,c,s="00000"+i.easting,o="00000"+i.northing;return i.zoneNumber+i.zoneLetter+(l=i.easting,h=i.northing,c=qv(i.zoneNumber),p=Math.floor(l/1e5),f=Math.floor(h/1e5)%20,y=Dv.charCodeAt(m=c-1),_=Nv.charCodeAt(m),b=!1,(v=y+p-1)>Vl&&(v=v-Vl+da-1,b=!0),(v===pn||y<pn&&v>pn||(v>pn||y<pn)&&b)&&v++,(v===Zn||y<Zn&&v>Zn||(v>Zn||y<Zn)&&b)&&++v===pn&&v++,v>Vl&&(v=v-Vl+da-1),(x=_+f)>ql?(x=x-ql+da-1,b=!0):b=!1,(x===pn||_<pn&&x>pn||(x>pn||_<pn)&&b)&&x++,(x===Zn||_<Zn&&x>Zn||(x>Zn||_<Zn)&&b)&&++x===pn&&x++,x>ql&&(x=x-ql+da-1),String.fromCharCode(v)+String.fromCharCode(x))+s.substr(s.length-5,r)+o.substr(o.length-5,r)}(function(i){var r,s,o,a,l,h,u,c=i.lat,d=i.lon,p=6378137,f=.00669438,g=.9996,m=Uf(c),y=Uf(d);u=Math.floor((d+180)/6)+1,180===d&&(u=60),c>=56&&c<64&&d>=3&&d<12&&(u=32),c>=72&&c<84&&(d>=0&&d<9?u=31:d>=9&&d<21?u=33:d>=21&&d<33?u=35:d>=33&&d<42&&(u=37)),h=Uf(6*(u-1)-180+3),r=f/(1-f),s=p/Math.sqrt(1-f*Math.sin(m)*Math.sin(m)),o=Math.tan(m)*Math.tan(m),a=r*Math.cos(m)*Math.cos(m);var _=g*s*((l=Math.cos(m)*(y-h))+(1-o+a)*l*l*l/6+(5-18*o+o*o+72*a-58*r)*l*l*l*l*l/120)+5e5,v=g*(p*(.9983242984503243*m-.002514607064228144*Math.sin(2*m)+2639046602129982e-21*Math.sin(4*m)-35*f*f*f/3072*Math.sin(6*m))+s*Math.tan(m)*(l*l/2+(5-o+9*a+4*a*a)*l*l*l*l/24+(61-58*o+o*o+600*a-330*r)*l*l*l*l*l*l/720));return c<0&&(v+=1e7),{northing:Math.round(v),easting:Math.round(_),zoneNumber:u,zoneLetter:sS(c)}}({lat:n[1],lon:n[0]}),t)}function jv(n){var t=Xf(Vv(n.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function Uf(n){return n*(Math.PI/180)}function Gv(n){return n/Math.PI*180}function Xf(n){var t=n.northing,e=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s,o,a,l,h,u,c,d,p,f=.9996,g=6378137,m=.00669438,y=(1-Math.sqrt(1-m))/(1+Math.sqrt(1-m)),_=e-5e5,v=t;i<"N"&&(v-=1e7),c=6*(r-1)-180+3,s=m/(1-m),p=(d=v/f/6367449.145945056)+(3*y/2-27*y*y*y/32)*Math.sin(2*d)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*d)+151*y*y*y/96*Math.sin(6*d),o=g/Math.sqrt(1-m*Math.sin(p)*Math.sin(p)),a=Math.tan(p)*Math.tan(p),l=s*Math.cos(p)*Math.cos(p),h=g*(1-m)/Math.pow(1-m*Math.sin(p)*Math.sin(p),1.5),u=_/(o*f);var x=p-o*Math.tan(p)/h*(u*u/2-(5+3*a+10*l-4*l*l-9*s)*u*u*u*u/24+(61+90*a+298*l+45*a*a-252*s-3*l*l)*u*u*u*u*u*u/720);x=Gv(x);var b,M=(u-(1+2*a+l)*u*u*u/6+(5-2*l+28*a-3*l*l+8*s+24*a*a)*u*u*u*u*u/120)/Math.cos(p);if(M=c+Gv(M),n.accuracy){var w=Xf({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});b={top:w.lat,right:w.lon,bottom:x,left:M}}else b={lat:x,lon:M};return b}function sS(n){var t="Z";return 84>=n&&n>=72?t="X":72>n&&n>=64?t="W":64>n&&n>=56?t="V":56>n&&n>=48?t="U":48>n&&n>=40?t="T":40>n&&n>=32?t="S":32>n&&n>=24?t="R":24>n&&n>=16?t="Q":16>n&&n>=8?t="P":8>n&&n>=0?t="N":0>n&&n>=-8?t="M":-8>n&&n>=-16?t="L":-16>n&&n>=-24?t="K":-24>n&&n>=-32?t="J":-32>n&&n>=-40?t="H":-40>n&&n>=-48?t="G":-48>n&&n>=-56?t="F":-56>n&&n>=-64?t="E":-64>n&&n>=-72?t="D":-72>n&&n>=-80&&(t="C"),t}function qv(n){var t=n%Lv;return 0===t&&(t=Lv),t}function Vv(n){if(n&&0===n.length)throw"MGRSPoint coverting from nothing";for(var t,e=n.length,i=null,r="",s=0;!/[A-Z]/.test(t=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=t,s++}var o=parseInt(r,10);if(0===s||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+n;i=n.substring(s,s+=2);for(var l=qv(o),h=function(v,x){for(var b=Dv.charCodeAt(x-1),M=1e5,w=!1;b!==v.charCodeAt(0);){if(++b===pn&&b++,b===Zn&&b++,b>Vl){if(w)throw"Bad character: "+v;b=da,w=!0}M+=1e5}return M}(i.charAt(0),l),u=function(v,x){if(v>"V")throw"MGRSPoint given invalid Northing "+v;for(var b=Nv.charCodeAt(x-1),M=0,w=!1;b!==v.charCodeAt(0);){if(++b===pn&&b++,b===Zn&&b++,b>ql){if(w)throw"Bad character: "+v;b=da,w=!0}M+=1e5}return M}(i.charAt(1),l);u<oS(a);)u+=2e6;var c=e-s;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+n;var d,p,f,g=c/2,m=0,y=0;return g>0&&(d=1e5/Math.pow(10,g),p=n.substring(s,s+g),m=parseFloat(p)*d,f=n.substring(s+g),y=parseFloat(f)*d),{easting:m+h,northing:y+u,zoneLetter:a,zoneNumber:o,accuracy:d}}function oS(n){var t;switch(n){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+n}function pa(n,t,e){if(!(this instanceof pa))return new pa(n,t,e);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if("object"==typeof n)this.x=n.x,this.y=n.y,this.z=n.z||0;else if("string"==typeof n&&typeof t>"u"){var i=n.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=n,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}pa.fromMGRS=function(n){return new pa(jv(n))},pa.prototype.toMGRS=function(n){return zv([this.x,this.y],n)};const aS=pa;var Zv=.01953125,Bv=.01068115234375;function Wv(n){var t=[];t[0]=1-n*(.25+n*(.046875+n*(Zv+n*Bv))),t[1]=n*(.75-n*(.046875+n*(Zv+n*Bv)));var e=n*n;return t[2]=e*(.46875-n*(.013020833333333334+.007120768229166667*n)),t[3]=(e*=n)*(.3645833333333333-.005696614583333333*n),t[4]=e*n*.3076171875,t}function Ku(n,t,e,i){return i[0]*n-(e*=t)*(i[1]+(t*=t)*(i[2]+t*(i[3]+t*i[4])))}function Hv(n,t,e){for(var i=1/(1-t),r=n,s=20;s;--s){var o=Math.sin(r),a=1-t*o*o;if(r-=a=(Ku(r,o,Math.cos(r),e)-n)*(a*Math.sqrt(a))*i,Math.abs(a)<ft)return r}return r}const Ju={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Wv(this.es),this.ml0=Ku(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,r,s=t.y,o=Et(t.x-this.long0),a=Math.sin(s),l=Math.cos(s);if(this.es){var h=l*o,u=Math.pow(h,2),c=this.ep2*Math.pow(l,2),d=Math.pow(c,2),p=Math.abs(l)>ft?Math.tan(s):0,f=Math.pow(p,2),g=Math.pow(f,2);e=1-this.es*Math.pow(a,2),h/=Math.sqrt(e);var m=Ku(s,a,l,this.en);i=this.a*(this.k0*h*(1+u/6*(1-f+c+u/20*(5-18*f+g+14*c-58*f*c+u/42*(61+179*g-g*f-479*f)))))+this.x0,r=this.a*(this.k0*(m-this.ml0+a*o*h/2*(1+u/12*(5-f+9*c+4*d+u/30*(61+g-58*f+270*c-330*f*c+u/56*(1385+543*g-g*f-3111*f))))))+this.y0}else{var y=l*Math.sin(o);if(Math.abs(Math.abs(y)-1)<ft)return 93;if(i=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,r=l*Math.cos(o)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(r))>=1){if(y-1>ft)return 93;r=0}else r=Math.acos(r);s<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return t.x=i,t.y=r,t},inverse:function(t){var e,i,r,s,o=1/this.a*(t.x-this.x0),a=1/this.a*(t.y-this.y0);if(this.es)if(i=Hv(e=this.ml0+a/this.k0,this.es,this.en),Math.abs(i)<nt){var l=Math.sin(i),h=Math.cos(i),u=Math.abs(h)>ft?Math.tan(i):0,c=this.ep2*Math.pow(h,2),d=Math.pow(c,2),p=Math.pow(u,2),f=Math.pow(p,2);e=1-this.es*Math.pow(l,2);var g=o*Math.sqrt(e)/this.k0,m=Math.pow(g,2);r=i-(e*=u)*m/(1-this.es)*.5*(1-m/12*(5+3*p-9*c*p+c-4*d-m/30*(61+90*p-252*c*p+45*f+46*c-m/56*(1385+3633*p+4095*f+1574*f*p)))),s=Et(this.long0+g*(1-m/6*(1+2*p+c-m/20*(5+28*p+24*f+8*c*p+6*c-m/42*(61+662*p+1320*f+720*f*p))))/h)}else r=nt*Nl(a),s=0;else{var y=Math.exp(o/this.k0),_=.5*(y-1/y),v=Math.cos(this.lat0+a/this.k0);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(_,2))),r=Math.asin(e),a<0&&(r=-r),s=0===_&&0===v?0:Et(Math.atan2(_,v)+this.long0)}return t.x=s,t.y=r,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function Uv(n){var t=Math.exp(n);return(t-1/t)/2}function Bn(n,t){n=Math.abs(n),t=Math.abs(t);var e=Math.max(n,t),i=Math.min(n,t)/(e||1);return e*Math.sqrt(1+Math.pow(i,2))}function $f(n,t){for(var e,i=2*Math.cos(2*t),r=n.length-1,s=n[r],o=0;--r>=0;)e=i*s-o+n[r],o=s,s=e;return t+e*Math.sin(2*t)}function Xv(n,t,e){for(var i,r,s=Math.sin(t),o=Math.cos(t),a=Uv(e),l=(void 0,((_=Math.exp(e))+1/_)/2),h=2*o*l,u=-2*s*a,c=n.length-1,d=n[c],p=0,f=0,g=0;--c>=0;)i=f,r=p,d=h*(f=d)-i-u*(p=g)+n[c],g=u*f-r+h*p;var _;return[(h=s*l)*d-(u=o*a)*g,h*g+u*d]}const Qu={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Ju.init.apply(this),this.forward=Ju.forward,this.inverse=Ju.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),this.cgb[1]=(i*=e)*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),this.cgb[2]=(i*=e)*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),this.cgb[3]=(i*=e)*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),this.cgb[4]=(i*=e)*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),this.cgb[5]=(i*=e)*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),this.utg[2]=(i*=e)*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),this.utg[3]=(i*=e)*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),this.utg[4]=(i*=e)*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),this.utg[5]=(i*=e)*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var r=$f(this.cbg,this.lat0);this.Zb=-this.Qn*(r+function(o,a){for(var l,h=2*Math.cos(a),u=o.length-1,c=o[u],d=0;--u>=0;)l=h*c-d+o[u],d=c,c=l;return Math.sin(a)*l}(this.gtu,2*r))},forward:function(t){var e=Et(t.x-this.long0),i=t.y;i=$f(this.cbg,i);var d,g,m,y,p,r=Math.sin(i),s=Math.cos(i),o=Math.sin(e),a=Math.cos(e);i=Math.atan2(r,a*s),e=Math.atan2(o*s,Bn(r,s*a)),d=Math.tan(e),p=0==(y=(m=1+(g=(p=Math.abs(d))*(1+p/(Bn(1,p)+1))))-1)?g:g*Math.log(m)/y;var l,h,u=Xv(this.gtu,2*i,2*(e=d<0?-p:p));return i+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(l=1/0,h=1/0),t.x=l,t.y=h,t},inverse:function(t){var e,i,r=1/this.a*(t.x-this.x0),s=1/this.a*(t.y-this.y0);if(s=(s-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var o=Xv(this.utg,2*s,2*r);s+=o[0],r+=o[1],r=Math.atan(Uv(r));var a=Math.sin(s),l=Math.cos(s),h=Math.sin(r),u=Math.cos(r);s=Math.atan2(a*u,Bn(h,u*l)),e=Et((r=Math.atan2(h,u*l))+this.long0),i=$f(this.cgb,s)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},lS={init:function(){var t=function(i,r){if(void 0===i){if((i=Math.floor(30*(Et(r)+Math.PI)/Math.PI)+1)<0)return 0;if(i>60)return 60}return i}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Zi,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Qu.init.apply(this),this.forward=Qu.forward,this.inverse=Qu.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Yf(n,t){return Math.pow((1-n)/(1+n),t)}const Kf={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ze)/(Math.pow(Math.tan(.5*this.lat0+Ze),this.C)*Yf(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Ze),this.C)*Yf(this.e*Math.sin(i),this.ratexp))-nt,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,r=Math.pow(Math.tan(.5*i+Ze)/this.K,1/this.C),s=20;s>0&&(i=2*Math.atan(r*Yf(this.e*Math.sin(t.y),-.5*this.e))-nt,!(Math.abs(i-t.y)<1e-14));--s)t.y=i;return s?(t.x=e,t.y=i,t):null},names:["gauss"]},hS={init:function(){Kf.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,r,s;return t.x=Et(t.x-this.long0),Kf.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),r=Math.cos(t.x),t.x=(s=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*r))*i*Math.sin(t.x),t.y=s*(this.cosc0*e-this.sinc0*i*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,r,s,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Bn(t.x,t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),i=Math.cos(a),s=Math.asin(i*this.sinc0+t.y*e*this.cosc0/o),r=Math.atan2(t.x*e,o*this.cosc0*i-t.y*this.sinc0*e)}else s=this.phic0,r=0;return t.x=r,t.y=s,Kf.inverse.apply(this,[t]),t.x=Et(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},uS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ft&&(this.k0=.5*(1+Nl(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ft&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ft&&Math.abs(Math.cos(this.lat_ts))>ft&&(this.k0=.5*this.cons*vr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/rr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=vr(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-nt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,r,s,o,a,l=t.x,h=t.y,u=Math.sin(h),c=Math.cos(h),d=Et(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=ft&&Math.abs(h+this.lat0)<=ft?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(d)),t.x=this.a*e*c*Math.sin(d)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(d))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,u,this.e))-nt,s=Math.cos(i),r=Math.sin(i),Math.abs(this.coslat0)<=ft?(o=rr(this.e,h*this.con,this.con*u),t.x=this.x0+(a=2*this.a*this.k0*o/this.cons)*Math.sin(l-this.long0),t.y=this.y0-this.con*a*Math.cos(l-this.long0),t):(Math.abs(this.sinlat0)<ft?(e=2*this.a*this.k0/(1+s*Math.cos(d)),t.y=e*r):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*s*Math.cos(d))),t.y=e*(this.cosX0*r-this.sinX0*s*Math.cos(d))+this.y0),t.x=e*s*Math.sin(d)+this.x0,t))},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,r,s,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,i=this.lat0,o<=ft?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<ft?Et(this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y)):Et(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=ft){if(o<=ft)return i=this.lat0,t.x=e=this.long0,t.y=i,t;t.x*=this.con,t.y*=this.con,i=this.con*zl(this.e,o*this.cons/(2*this.a*this.k0)),e=this.con*Et(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=ft?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/o),e=Et(this.long0+Math.atan2(t.x*Math.sin(r),o*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),i=-1*zl(this.e,Math.tan(.5*(nt+s)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(nt+t))*Math.pow((1-e)/(1+e),.5*i)}},cS={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,r=1/this.rf,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*i*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=2*(Math.atan(Math.exp(-this.alpha*(e+i)+this.K))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=(t.x-this.x0)/this.R,i=2*(Math.atan(Math.exp((t.y-this.y0)/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(e)),s=Math.atan(Math.sin(e)/(Math.cos(this.b0)*Math.cos(e)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+s/this.alpha,a=0,l=r,h=-1e3,u=0;Math.abs(l-h)>1e-7;){if(++u>20)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(a))-Math.PI/2}return t.x=o,t.y=l,t},names:["somerc"]};var fa=1e-7;const dS={init:function(){var t,e,i,r,s,o,a,l,h,u,c,w,S,d=0,p=0,f=0,g=0,m=0,y=0,_=0;this.no_off=(S="object"==typeof(w=this).PROJECTION?Object.keys(w.PROJECTION)[0]:w.PROJECTION,"no_uoff"in w||"no_off"in w||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(S)),this.no_rot="no_rot"in this;var v=!1;"alpha"in this&&(v=!0);var x=!1;if("rectified_grid_angle"in this&&(x=!0),v&&(_=this.alpha),x&&(d=this.rectified_grid_angle*Zi),v||x)p=this.longc;else if(f=this.long1,m=this.lat1,g=this.long2,y=this.lat2,Math.abs(m-y)<=fa||(t=Math.abs(m))<=fa||Math.abs(t-nt)<=fa||Math.abs(Math.abs(this.lat0)-nt)<=fa||Math.abs(Math.abs(y)-nt)<=fa)throw new Error;var b=1-this.es;e=Math.sqrt(b),Math.abs(this.lat0)>ft?(l=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*l*l,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*e/t,(s=(r=this.B*e/(i*Math.sqrt(t)))*r-1)<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=r,this.E*=Math.pow(rr(this.e,this.lat0,l),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=s=1),v||x?(v?(c=Math.asin(Math.sin(_)/r),x||(d=_)):(c=d,_=Math.asin(r*Math.sin(c))),this.lam0=p-Math.asin(.5*(s-1/s)*Math.tan(c))/this.B):(o=Math.pow(rr(this.e,m,Math.sin(m)),this.B),a=Math.pow(rr(this.e,y,Math.sin(y)),this.B),s=this.E/o,h=(a-o)/(a+o),u=((u=this.E*this.E)-a*o)/(u+a*o),(t=f-g)<-Math.pi?g-=Ll:t>Math.pi&&(g+=Ll),this.lam0=Et(.5*(f+g)-Math.atan(u*Math.tan(.5*this.B*(f-g))/h)/this.B),c=Math.atan(2*Math.sin(this.B*Et(f-this.lam0))/(s-1/s)),d=_=Math.asin(r*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(Ze-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ze+s))},forward:function(t){var e,i,r,s,o,a,l,h,u={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-nt)>ft){if(e=.5*((o=this.E/Math.pow(rr(this.e,t.y,Math.sin(t.y)),this.B))-(a=1/o)),i=.5*(o+a),s=Math.sin(this.B*t.x),r=(e*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<ft)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*t.x),l=Math.abs(a)<fa?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+s*this.singam,a)}else h=t.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*t.y;return this.no_rot?(u.x=l,u.y=h):(u.x=h*this.cosrot+(l-=this.u_0)*this.sinrot,u.y=l*this.cosrot-h*this.sinrot),u.x=this.a*u.x+this.x0,u.y=this.a*u.y+this.y0,u},inverse:function(t){var e,i,r,s,o,a,l,h={};if(t.x=1/this.a*(t.x-this.x0),t.y=1/this.a*(t.y-this.y0),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),s=.5*((r=Math.exp(-this.BrA*i))-1/r),o=.5*(r+1/r),l=((a=Math.sin(this.BrA*e))*this.cosgam+s*this.singam)/o,Math.abs(Math.abs(l)-1)<ft)h.x=0,h.y=l<0?-nt:nt;else{if(h.y=this.E/Math.sqrt((1+l)/(1-l)),h.y=zl(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(s*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},pS={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ft)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),r=vr(this.e,e,i),s=rr(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),l=vr(this.e,o,a),h=rr(this.e,this.lat2,o),u=rr(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>ft?Math.log(r/l)/Math.log(s/h):e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=ft&&(i=Nl(i)*(nt-2*ft));var r,s,o=Math.abs(Math.abs(i)-nt);if(o>ft)r=rr(this.e,i,Math.sin(i)),s=this.a*this.f0*Math.pow(r,this.ns);else{if((o=i*this.ns)<=0)return null;s=0}var a=this.ns*Et(e-this.long0);return t.x=this.k0*(s*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,t},inverse:function(t){var e,i,r,s,o,a=(t.x-this.x0)/this.k0,l=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+l*l),i=1):(e=-Math.sqrt(a*a+l*l),i=-1);var h=0;if(0!==e&&(h=Math.atan2(i*a,i*l)),0!==e||this.ns>0){if(i=1/this.ns,r=Math.pow(e/(this.a*this.f0),i),-9999===(s=zl(this.e,r)))return null}else s=-nt;return o=Et(h/this.ns+this.long0),t.x=o,t.y=s,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},fS={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,r,s,o,a,l,h=t.y,u=Et(t.x-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),o=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(s)),a=this.n*o,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),t.y=l*Math.cos(a)/1,t.x=l*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,r,s,o,a,l,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(s)),i=Math.asin(Math.cos(r)*Math.sin(s)/Math.cos(e)),t.x=this.long0-i/this.alfa,a=e,l=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1}while(0===l&&u<15);return u>=15?null:t},names:["Krovak","krovak"]};function en(n,t,e,i,r){return n*r-t*Math.sin(2*r)+e*Math.sin(4*r)-i*Math.sin(6*r)}function Zl(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Bl(n){return.375*n*(1+.25*n*(1+.46875*n))}function Wl(n){return.05859375*n*n*(1+.75*n)}function Hl(n){return n*n*n*(35/3072)}function ga(n,t,e){var i=t*e;return n/Math.sqrt(1-i*i)}function ma(n){return Math.abs(n)<nt?n:n-Nl(n)*Math.PI}function tc(n,t,e,i,r){var s,o;s=n/t;for(var a=0;a<15;a++)if(s+=o=(n-(t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(t-2*e*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(o)<=1e-10)return s;return NaN}const gS={init:function(){this.sphere||(this.e0=Zl(this.es),this.e1=Bl(this.es),this.e2=Wl(this.es),this.e3=Hl(this.es),this.ml0=this.a*en(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,r=t.x,s=t.y;if(r=Et(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(s)*Math.sin(r)),i=this.a*(Math.atan2(Math.tan(s),Math.cos(r))-this.lat0);else{var o=Math.sin(s),a=Math.cos(s),l=ga(this.a,this.e,o),h=Math.tan(s)*Math.tan(s),u=r*Math.cos(s),c=u*u,d=this.es*a*a/(1-this.es);e=l*u*(1-c*h*(1/6-(8-h+8*d)*c/120)),i=this.a*en(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+l*o/a*c*(.5+(5-h+6*d)*c/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,r=t.x/this.a,s=t.y/this.a;if(this.sphere){var o=s+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(r)),i=Math.atan2(Math.tan(r),Math.cos(o))}else{var a=tc(this.ml0/this.a+s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-nt)<=ft)return t.x=this.long0,t.y=nt,s<0&&(t.y*=-1),t;var l=ga(this.a,this.e,Math.sin(a)),h=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),c=r*this.a/l,d=c*c;e=a-l*Math.tan(a)/h*c*c*(.5-(1+3*u)*c*c/24),i=c*(1-d*(u/3+(1+3*u)*u*d/15))/Math.cos(a)}return t.x=Et(i+this.long0),t.y=ma(e),t},names:["Cassini","Cassini_Soldner","cass"]};function ws(n,t){var e;return n>1e-7?(1-n*n)*(t/(1-(e=n*t)*e)-.5/n*Math.log((1-e)/(1+e))):2*t}const mS={init:function(){var t,e=Math.abs(this.lat0);if(this.mode=Math.abs(e-nt)<ft?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<ft?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=ws(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(r){var s,o=[];return o[0]=.3333333333333333*r,o[0]+=.17222222222222222*(s=r*r),o[1]=.06388888888888888*s,o[0]+=.10257936507936508*(s*=r),o[1]+=.0664021164021164*s,o[2]=.016415012942191543*s,o}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=ws(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,r,s,o,a,l,h,u,c,d=t.x,p=t.y;if(d=Et(d-this.long0),this.sphere){if(o=Math.sin(p),c=Math.cos(p),r=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+c*r:1+this.sinph0*o+this.cosph0*c*r)<=ft)return null;e=(i=Math.sqrt(2/i))*c*Math.sin(d),i*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(p+this.lat0)<ft)return null;i=Ze-.5*p,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(d),i*=r}}else{switch(l=0,h=0,u=0,r=Math.cos(d),s=Math.sin(d),o=Math.sin(p),a=ws(this.e,o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=a/this.qp,h=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:u=1+this.sinb1*l+this.cosb1*h*r;break;case this.EQUIT:u=1+h*r;break;case this.N_POLE:u=nt+p,a=this.qp-a;break;case this.S_POLE:u=p-nt,a=this.qp+a}if(Math.abs(u)<ft)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),i=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*l-this.sinb1*h*r):(u=Math.sqrt(2/(1+h*r)))*l*this.ymf,e=this.xmf*u*h*s;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*s,i=r*(this.mode===this.S_POLE?u:-u)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,r,s,o,a,l,g,m,y,h=t.x/this.a,u=t.y/this.a;if(this.sphere){var c,d=0,p=0;if((i=.5*(c=Math.sqrt(h*h+u*u)))>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(i),d=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(c)<=ft?0:Math.asin(u*p/c),h*=p,u=d*c;break;case this.OBLIQ:i=Math.abs(c)<=ft?this.lat0:Math.asin(d*this.sinph0+u*p*this.cosph0/c),h*=p*this.cosph0,u=(d-Math.sin(i)*this.sinph0)*c;break;case this.N_POLE:u=-u,i=nt-i;break;case this.S_POLE:i-=nt}e=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(h,u):0}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h/=this.dd,u*=this.dd,(a=Math.sqrt(h*h+u*u))<ft)return t.x=this.long0,t.y=this.lat0,t;s=2*Math.asin(.5*a/this.rq),r=Math.cos(s),h*=s=Math.sin(s),this.mode===this.OBLIQ?(o=this.qp*(l=r*this.sinb1+u*s*this.cosb1/a),u=a*this.cosb1*r-u*this.sinb1*s):(o=this.qp*(l=u*s/a),u=a*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),!(o=h*h+u*u))return t.x=this.long0,t.y=this.lat0,t;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}e=Math.atan2(h,u),y=(g=Math.asin(l))+g,i=g+(m=this.apa)[0]*Math.sin(y)+m[1]*Math.sin(y+y)+m[2]*Math.sin(y+y+y)}return t.x=Et(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Cs(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}const yS={init:function(){Math.abs(this.lat1+this.lat2)<ft||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=vr(this.e3,this.sin_po,this.cos_po),this.qs1=ws(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=vr(this.e3,this.sin_po,this.cos_po),this.qs2=ws(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ws(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>ft?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var r=ws(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,o=this.ns0*Et(e-this.long0),a=s*Math.sin(o)+this.x0,l=this.rh-s*Math.cos(o)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i,r,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,o=this.sphere?Math.asin((this.c-i*i)/(2*this.ns0)):this.phi1z(this.e3,(this.c-i*i)/this.ns0),s=Et(r/this.ns0+this.long0),t.x=s,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,r,s,o,a=Cs(.5*e);if(t<ft)return a;for(var l=t*t,h=1;h<=25;h++)if(a+=o=.5*(s=1-(r=t*(i=Math.sin(a)))*r)*s/Math.cos(a)*(e/(1-l)-i/s+.5/t*Math.log((1-r)/(1+r))),Math.abs(o)<=1e-7)return a;return null}},_S={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,r,s,o,a,l,h=t.y;return r=Et(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),s=Math.cos(r),(o=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(o)<=ft?(a=this.x0+1*this.a*i*Math.sin(r)/o,l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)/o):(a=this.x0+this.infinity_dist*i*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*s)),t.x=a,t.y=l,t},inverse:function(t){var e,i,r,s,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(s=Math.atan2(e,this.rc),i=Math.sin(s),a=Cs((r=Math.cos(s))*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i),o=Et(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t},names:["gnom"]},vS={init:function(){this.sphere||(this.k0=vr(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,r=t.y,s=Et(t.x-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var o=ws(this.e,Math.sin(r));e=this.x0+this.a*this.k0*s,i=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Et(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(s,o){var a=1-(1-s*s)/(2*s)*Math.log((1-s)/(1+s));if(Math.abs(Math.abs(o)-a)<1e-6)return o<0?-1*nt:nt;for(var l,h,u,c,d=Math.asin(.5*o),p=0;p<30;p++)if(h=Math.sin(d),u=Math.cos(d),c=s*h,d+=l=Math.pow(1-c*c,2)/(2*u)*(o/(1-s*s)-h/(1-c*c)+.5/s*Math.log((1-c)/(1+c))),Math.abs(l)<=1e-10)return d;return NaN}(this.e,2*t.y*this.k0/this.a),e=Et(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},xS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.y,i=Et(t.x-this.long0),r=ma(e-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.y;return t.x=Et(this.long0+(t.x-this.x0)/(this.a*this.rc)),t.y=ma(this.lat0+(e-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},bS={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Zl(this.es),this.e1=Bl(this.es),this.e2=Wl(this.es),this.e3=Hl(this.es),this.ml0=this.a*en(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,r,s=t.y,o=Et(t.x-this.long0);if(r=o*Math.sin(s),this.sphere)Math.abs(s)<=ft?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(r)/Math.tan(s),i=this.a*(ma(s-this.lat0)+(1-Math.cos(r))/Math.tan(s)));else if(Math.abs(s)<=ft)e=this.a*o,i=-1*this.ml0;else{var a=ga(this.a,this.e,Math.sin(s))/Math.tan(s);e=a*Math.sin(r),i=this.a*en(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*(1-Math.cos(r))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,r,s,o,a,l,h,u;if(r=t.x-this.x0,s=t.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=ft)e=Et(r/this.a+this.long0),i=0;else{var c;for(l=r*r/this.a/this.a+(a=this.lat0+s/this.a)*a,h=a,o=20;o;--o)if(h+=u=-1*(a*(h*(c=Math.tan(h))+1)-h-.5*(h*h+l)*c)/((h-a)/c-1),Math.abs(u)<=ft){i=h;break}e=Et(this.long0+Math.asin(r*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(s+this.ml0)<=ft)i=0,e=Et(this.long0+r/this.a);else{var d,p,f,g,m;for(l=r*r/this.a/this.a+(a=(this.ml0+s)/this.a)*a,h=a,o=20;o;--o)if(m=this.e*Math.sin(h),d=Math.sqrt(1-m*m)*Math.tan(h),p=this.a*en(this.e0,this.e1,this.e2,this.e3,h),f=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=u=(a*(d*(g=p/this.a)+1)-g-.5*d*(g*g+l))/(this.es*Math.sin(2*h)*(g*g+l-2*a*g)/(4*d)+(a-g)*(d*f-2/Math.sin(2*h))-f),Math.abs(u)<=ft){i=h;break}d=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=Et(this.long0+Math.asin(r*d/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},wS={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=(t.y-this.lat0)/Al*1e-5,r=t.x-this.long0,s=1,o=0;for(e=1;e<=10;e++)o+=this.A[e]*(s*=i);var a,l=o,h=r,u=1,c=0,d=0,p=0;for(e=1;e<=6;e++)a=c*l+u*h,d=d+this.B_re[e]*(u=u*l-c*h)-this.B_im[e]*(c=a),p=p+this.B_im[e]*u+this.B_re[e]*c;return t.x=p*this.a+this.x0,t.y=d*this.a+this.y0,t},inverse:function(t){var e,i,r=(t.y-this.y0)/this.a,s=(t.x-this.x0)/this.a,o=1,a=0,l=0,h=0;for(e=1;e<=6;e++)i=a*r+o*s,l=l+this.C_re[e]*(o=o*r-a*s)-this.C_im[e]*(a=i),h=h+this.C_im[e]*o+this.C_re[e]*a;for(var u=0;u<this.iterations;u++){var c,d=l,p=h,f=r,g=s;for(e=2;e<=6;e++)c=p*l+d*h,f+=(e-1)*(this.B_re[e]*(d=d*l-p*h)-this.B_im[e]*(p=c)),g+=(e-1)*(this.B_im[e]*d+this.B_re[e]*p);d=1,p=0;var m=this.B_re[1],y=this.B_im[1];for(e=2;e<=6;e++)c=p*l+d*h,m+=e*(this.B_re[e]*(d=d*l-p*h)-this.B_im[e]*(p=c)),y+=e*(this.B_im[e]*d+this.B_re[e]*p);var _=m*m+y*y;l=(f*m+g*y)/_,h=(g*m-f*y)/_}var v=l,x=h,b=1,M=0;for(e=1;e<=9;e++)M+=this.D[e]*(b*=v);var w=this.lat0+M*Al*1e5;return t.x=this.long0+x,t.y=w,t},names:["New_Zealand_Map_Grid","nzmg"]},CS={init:function(){},forward:function(t){var e=t.y,i=Et(t.x-this.long0),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return t.x=r,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Et(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},MS={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Wv(this.es)},forward:function(t){var e,i,r=t.x,s=t.y;if(r=Et(r-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(s),a=20;a;--a){var l=(this.m*s+Math.sin(s)-o)/(this.m+Math.cos(s));if(s-=l,Math.abs(l)<ft)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;e=this.a*this.C_x*r*(this.m+Math.cos(s)),i=this.a*this.C_y*s}else{var h=Math.sin(s),u=Math.cos(s);i=this.a*Ku(s,h,u,this.en),e=this.a*r*u/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,r;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Cs((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Cs(Math.sin(e)/this.n)),i=Et(i+this.long0),e=ma(e)):(e=Hv(t.y/this.a,this.es,this.en),(r=Math.abs(e))<nt?(r=Math.sin(e),i=Et(this.long0+t.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)))):r-ft<nt&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},SS={init:function(){},forward:function(t){for(var e=t.y,i=Et(t.x-this.long0),r=e,s=Math.PI*Math.sin(e);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<ft)break}r/=2,Math.PI/2-Math.abs(e)<ft&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var r=Et(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var s=Math.asin(i);return t.x=r,t.y=s,t},names:["Mollweide","moll"]},ES={init:function(){Math.abs(this.lat1+this.lat2)<ft||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Zl(this.es),this.e1=Bl(this.es),this.e2=Wl(this.es),this.e3=Hl(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=vr(this.e,this.sinphi,this.cosphi),this.ml1=en(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ft?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=vr(this.e,this.sinphi,this.cosphi),this.ml2=en(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=en(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,r=t.y;if(this.sphere)e=this.a*(this.g-r);else{var s=en(this.e0,this.e1,this.e2,this.e3,r);e=this.a*(this.g-s)}var o=this.ns*Et(i-this.long0),a=this.x0+e*Math.sin(o),l=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=l,t},inverse:function(t){var e,i,r,s;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;return 0!==i&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere?(s=Et(this.long0+o/this.ns),r=ma(this.g-i/this.a),t.x=s,t.y=r,t):(r=tc(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),s=Et(this.long0+o/this.ns),t.x=s,t.y=r,t)},names:["Equidistant_Conic","eqdc"]},TS={init:function(){this.R=this.a},forward:function(t){var e,i,r=t.y,s=Et(t.x-this.long0);Math.abs(r)<=ft&&(e=this.x0+this.R*s,i=this.y0);var o=Cs(2*Math.abs(r/Math.PI));(Math.abs(s)<=ft||Math.abs(Math.abs(r)-nt)<=ft)&&(e=this.x0,i=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/s-s/Math.PI),l=a*a,h=Math.sin(o),u=Math.cos(o),c=u/(h+u-1),d=c*(2/h-1),p=d*d,f=Math.PI*this.R*(a*(c-p)+Math.sqrt(l*(c-p)*(c-p)-(p+l)*(c*c-p)))/(p+l);s<0&&(f=-f),e=this.x0+f;var g=l+c;return f=Math.PI*this.R*(d*g-a*Math.sqrt((p+l)*(l+1)-g*g))/(p+l),i=r>=0?this.y0+f:this.y0-f,t.x=e,t.y=i,t},inverse:function(t){var e,i,r,s,o,a,l,h,u,c,d,p;return t.x-=this.x0,t.y-=this.y0,d=Math.PI*this.R,o=(r=t.x/d)*r+(s=t.y/d)*s,d=3*(s*s/(h=-2*(a=-Math.abs(s)*(1+o))+1+2*s*s+o*o)+(2*(l=a-2*s*s+r*r)*l*l/h/h/h-9*a*l/h/h)/27)/(u=(a-l*l/3/h)/h)/(c=2*Math.sqrt(-u/3)),Math.abs(d)>1&&(d=d>=0?1:-1),p=Math.acos(d)/3,i=t.y>=0?(-c*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI:-(-c*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI,e=Math.abs(r)<ft?this.long0:Et(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(r*r-s*s)+o*o))/2/r),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},kS={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,r,s,o,a,l,h,u,c,d,p,f,g,m,y,_,v,x,b,M,w,S=t.x,R=t.y,P=Math.sin(t.y),A=Math.cos(t.y),T=Et(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ft?(t.x=this.x0+this.a*(nt-R)*Math.sin(T),t.y=this.y0-this.a*(nt-R)*Math.cos(T),t):Math.abs(this.sin_p12+1)<=ft?(t.x=this.x0+this.a*(nt+R)*Math.sin(T),t.y=this.y0+this.a*(nt+R)*Math.cos(T),t):(v=this.sin_p12*P+this.cos_p12*A*Math.cos(T),_=(y=Math.acos(v))?y/Math.sin(y):1,t.x=this.x0+this.a*_*A*Math.sin(T),t.y=this.y0+this.a*_*(this.cos_p12*P-this.sin_p12*A*Math.cos(T)),t):(e=Zl(this.es),i=Bl(this.es),r=Wl(this.es),s=Hl(this.es),Math.abs(this.sin_p12-1)<=ft?(o=this.a*en(e,i,r,s,nt),a=this.a*en(e,i,r,s,R),t.x=this.x0+(o-a)*Math.sin(T),t.y=this.y0-(o-a)*Math.cos(T),t):Math.abs(this.sin_p12+1)<=ft?(o=this.a*en(e,i,r,s,nt),a=this.a*en(e,i,r,s,R),t.x=this.x0+(o+a)*Math.sin(T),t.y=this.y0+(o+a)*Math.cos(T),t):(l=P/A,h=ga(this.a,this.e,this.sin_p12),u=ga(this.a,this.e,P),c=Math.atan((1-this.es)*l+this.es*h*this.sin_p12/(u*A)),x=0===(d=Math.atan2(Math.sin(T),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(T)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(d)-Math.PI)<=ft?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(T)*Math.cos(c)/Math.sin(d)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),f=this.e*this.cos_p12*Math.cos(d)/Math.sqrt(1-this.es),t.x=this.x0+(y=h*x*(1-(b=x*x)*(m=f*f)*(1-m)/6+(M=b*x)/8*(g=p*f)*(1-2*m)+(w=M*x)/120*(m*(4-7*m)-3*p*p*(1-7*m))-w*x/48*g))*Math.sin(d),t.y=this.y0+y*Math.cos(d),t))},inverse:function(t){var e,i,r,s,o,a,l,h,u,c,d,p,f,g,m,y,_,v,x,b,M,w,S;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y))>2*nt*this.a?void 0:(i=e/this.a,r=Math.sin(i),s=Math.cos(i),o=this.long0,Math.abs(e)<=ft?a=this.lat0:(a=Cs(s*this.sin_p12+t.y*r*this.cos_p12/e),l=Math.abs(this.lat0)-nt,o=Math.abs(l)<=ft?Et(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)):Et(this.long0+Math.atan2(t.x*r,e*this.cos_p12*s-t.y*this.sin_p12*r))),t.x=o,t.y=a,t):(h=Zl(this.es),u=Bl(this.es),c=Wl(this.es),d=Hl(this.es),Math.abs(this.sin_p12-1)<=ft?(a=tc(((p=this.a*en(h,u,c,d,nt))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,u,c,d),o=Et(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=ft?(p=this.a*en(h,u,c,d,nt),a=tc(((e=Math.sqrt(t.x*t.x+t.y*t.y))-p)/this.a,h,u,c,d),o=Et(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),f=ga(this.a,this.e,this.sin_p12),y=Math.cos(m),x=3*this.es*(1-(v=-(_=this.e*this.cos_p12*y)*_/(1-this.es)))*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-v*(M=(b=e/f)-v*(1+v)*Math.pow(b,3)/6-x*(1+3*v)*Math.pow(b,4)/24)*M/2-b*M*M*M/6,g=Math.asin(this.sin_p12*Math.cos(M)+this.cos_p12*Math.sin(M)*y),o=Et(this.long0+Math.asin(Math.sin(m)*Math.sin(M)/Math.cos(g))),S=Math.sin(g),a=Math.atan2((S-this.es*w*this.sin_p12)*Math.tan(g),S*(1-this.es)),t.x=o,t.y=a,t))},names:["Azimuthal_Equidistant","aeqd"]},IS={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,r,s,o,a,l,h=t.y;return r=Et(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),s=Math.cos(r),((o=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(o)<=ft)&&(a=1*this.a*i*Math.sin(r),l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)),t.x=a,t.y=l,t},inverse:function(t){var e,i,r,s,o,a,l;return t.x-=this.x0,t.y-=this.y0,i=Cs((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),r=Math.sin(i),s=Math.cos(i),a=this.long0,Math.abs(e)<=ft?(l=this.lat0,t.x=a,t.y=l,t):(l=Cs(s*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.abs(this.lat0)-nt,Math.abs(o)<=ft?(a=Et(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=l,t):(a=Et(this.long0+Math.atan2(t.x*r,e*this.cos_p14*s-t.y*this.sin_p14*r)),t.x=a,t.y=l,t))},names:["ortho"]};function ec(n,t,e,i){var r;return n<ft?(i.value=1,r=0):(r=Math.atan2(t,e),Math.abs(r)<=Ze?i.value=1:r>Ze&&r<=nt+Ze?(i.value=2,r-=nt):r>nt+Ze||r<=-(nt+Ze)?(i.value=3,r=r>=0?r-wi:r+wi):(i.value=4,r+=nt)),r}function _a(n,t){var e=n+t;return e<-wi?e+=Ll:e>+wi&&(e-=Ll),e}const PS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=nt-Ze/2?5:this.lat0<=-(nt-Ze/2)?6:Math.abs(this.long0)<=Ze?1:Math.abs(this.long0)<=nt+Ze?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,r,s,o,a,l={x:0,y:0},h={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)s=nt-e,i>=Ze&&i<=nt+Ze?(h.value=1,r=i-nt):i>nt+Ze||i<=-(nt+Ze)?(h.value=2,r=i>0?i-wi:i+wi):i>-(nt+Ze)&&i<=-Ze?(h.value=3,r=i+nt):(h.value=4,r=i);else if(6===this.face)s=nt+e,i>=Ze&&i<=nt+Ze?(h.value=1,r=-i+nt):i<Ze&&i>=-Ze?(h.value=2,r=-i):i<-Ze&&i>=-(nt+Ze)?(h.value=3,r=-i-nt):(h.value=4,r=i>0?-i+wi:-i-wi);else{var u,c,d,p,f,g;2===this.face?i=_a(i,+nt):3===this.face?i=_a(i,+wi):4===this.face&&(i=_a(i,-nt)),p=Math.sin(e),f=Math.cos(e),g=Math.sin(i),u=f*Math.cos(i),c=f*g,d=p,1===this.face?r=ec(s=Math.acos(u),d,c,h):2===this.face?r=ec(s=Math.acos(c),d,-u,h):3===this.face?r=ec(s=Math.acos(-u),d,-c,h):4===this.face?r=ec(s=Math.acos(-c),d,u,h):(s=r=0,h.value=1)}return a=Math.atan(12/wi*(r+Math.acos(Math.sin(r)*Math.cos(Ze))-nt)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),2===h.value?a+=nt:3===h.value?a+=wi:4===h.value&&(a+=1.5*wi),l.x=o*Math.cos(a),l.y=o*Math.sin(a),l.x=l.x*this.a+this.x0,l.y=l.y*this.a+this.y0,t.x=l.x,t.y=l.y,t},inverse:function(t){var e,i,r,s,o,a,l,h,u,c,d,p,f={lam:0,phi:0},g={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?g.value=1:t.y>=0&&t.y>=Math.abs(t.x)?(g.value=2,e-=nt):t.x<0&&-t.x>=Math.abs(t.y)?(g.value=3,e=e<0?e+wi:e-wi):(g.value=4,e+=nt),u=wi/12*Math.tan(e),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),(l=1-(r=Math.cos(e))*r*(s=Math.tan(i))*s*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?l=-1:l>1&&(l=1),5===this.face)h=Math.acos(l),f.phi=nt-h,f.lam=1===g.value?a+nt:2===g.value?a<0?a+wi:a-wi:3===g.value?a-nt:a;else if(6===this.face)h=Math.acos(l),f.phi=h-nt,f.lam=1===g.value?-a+nt:2===g.value?-a:3===g.value?-a-nt:a<0?-a-wi:-a+wi;else{var m,y,_;u=(m=l)*m,y=(u+=(_=u>=1?0:Math.sqrt(1-u)*Math.sin(a))*_)>=1?0:Math.sqrt(1-u),2===g.value?(u=y,y=-_,_=u):3===g.value?(y=-y,_=-_):4===g.value&&(u=y,y=_,_=-u),2===this.face?(u=m,m=-y,y=u):3===this.face?(m=-m,y=-y):4===this.face&&(u=m,m=y,y=-u),f.phi=Math.acos(-_)-nt,f.lam=Math.atan2(y,m),2===this.face?f.lam=_a(f.lam,-nt):3===this.face?f.lam=_a(f.lam,-wi):4===this.face&&(f.lam=_a(f.lam,+nt))}return 0!==this.es&&(c=f.phi<0?1:0,d=Math.tan(f.phi),p=this.b/Math.sqrt(d*d+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),c&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Jf=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Ul=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],$v=mr/5,RS=1/$v,ic=function(n,t){return n[0]+t*(n[1]+t*(n[2]+t*n[3]))};const FS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Et(t.x-this.long0),i=Math.abs(t.y),r=Math.floor(i*$v);r<0?r=0:r>=18&&(r=17);var s={x:ic(Jf[r],i=mr*(i-RS*r))*e,y:ic(Ul[r],i)};return t.y<0&&(s.y=-s.y),s.x=s.x*this.a*.8487+this.x0,s.y=s.y*this.a*1.3523+this.y0,s},inverse:function(t){var e={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(e.y>=1)e.x/=Jf[18][0],e.y=t.y<0?-nt:nt;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(Ul[i][0]>e.y)--i;else{if(!(Ul[i+1][0]<=e.y))break;++i}var r=Ul[i],s=5*(e.y-r[0])/(Ul[i+1][0]-r[0]);s=function(a,l,h,u){for(var c=l;u;--u){var d=(ic(r,o=c)-e.y)/function(a,l){return a[1]+l*(2*a[2]+3*l*a[3])}(r,o);if(c-=d,Math.abs(d)<1e-10)break}var o;return c}(0,s,0,100),e.x/=ic(Jf[i],s),e.y=(5*i+s)*Zi,t.y<0&&(e.y=-e.y)}return e.x=Et(e.x+this.long0),e},names:["Robinson","robin"]},OS={init:function(){this.name="geocent"},forward:function(t){return Ev(t,this.es,this.a)},inverse:function(t){return Tv(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var Xl={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const AS={init:function(){if(Object.keys(Xl).forEach(function(i){if(typeof this[i]>"u")this[i]=Xl[i].def;else{if(Xl[i].num&&isNaN(this[i]))throw new Error("Invalid parameter value, must be numeric "+i+" = "+this[i]);Xl[i].num&&(this[i]=parseFloat(this[i]))}Xl[i].degrees&&(this[i]=this[i]*Zi)}.bind(this)),Math.abs(Math.abs(this.lat0)-nt)<ft?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<ft?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,r,s,o=Math.sin(t.y),a=Math.cos(t.y),l=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*o+this.cosph0*a*l;break;case 2:i=a*l;break;case 1:i=-o;break;case 0:i=o}switch(e=(i=this.pn1/(this.p-i))*a*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*o-this.sinph0*a*l;break;case 2:i*=o;break;case 0:i*=-a*l;break;case 1:i*=a*l}return e=(e*this.cg-i*this.sg)*this.cw*(s=1/((r=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw)),i=r*s,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,r,s={x:t.x,y:t.y};t.x=(e=this.pn1*t.x*(r=1/(this.pn1-t.y*this.sw)))*this.cg+(i=this.pn1*t.y*this.cw*r)*this.sg,t.y=i*this.cg-e*this.sg;var o=Bn(t.x,t.y);if(Math.abs(o)<ft)s.x=0,s.y=t.y;else{var a,l;switch(l=1-o*o*this.pfact,l=(this.p-Math.sqrt(l))/(this.pn1/o+o/this.pn1),a=Math.sqrt(1-l*l),this.mode){case 3:s.y=Math.asin(a*this.sinph0+t.y*l*this.cosph0/o),t.y=(a-this.sinph0*Math.sin(s.y))*o,t.x*=l*this.cosph0;break;case 2:s.y=Math.asin(t.y*l/o),t.y=a*o,t.x*=l;break;case 0:s.y=Math.asin(a),t.y=-t.y;break;case 1:s.y=-Math.asin(a)}s.x=Math.atan2(t.x,t.y)}return t.x=s.x+this.long0,t.y=s.y,t},names:["Tilted_Perspective","tpers"]},LS={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,r,s,o=t.x,a=t.y;if(o-=this.long0,"ellipse"===this.shape){a=Math.atan(this.radius_p2*Math.tan(a));var l=this.radius_p/Bn(this.radius_p*Math.cos(a),Math.sin(a));if(i=l*Math.cos(o)*Math.cos(a),r=l*Math.sin(o)*Math.cos(a),s=l*Math.sin(a),(this.radius_g-i)*i-r*r-s*s*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(r/Bn(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(r/e),t.y=this.radius_g_1*Math.atan(s/Bn(r,e)))}else"sphere"===this.shape&&(e=Math.cos(a),i=Math.cos(o)*e,r=Math.sin(o)*e,s=Math.sin(a),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(r/Bn(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(r/e),t.y=this.radius_g_1*Math.atan(s/Bn(r,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,r,s,o=-1,a=0,l=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(l=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*Bn(1,l)):(a=Math.tan(t.x/this.radius_g_1),l=Math.tan(t.y/this.radius_g_1)*Bn(1,a));var h=l/this.radius_p;if((r=(i=2*this.radius_g*o)*i-4*(e=a*a+h*h+o*o)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(r))/(2*e),o=this.radius_g+s*o,a*=s,l*=s,t.x=Math.atan2(a,o),t.y=Math.atan(l*Math.cos(t.x)/o),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(l=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+l*l)):(a=Math.tan(t.x/this.radius_g_1),l=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+a*a)),(r=(i=2*this.radius_g*o)*i-4*(e=a*a+l*l+o*o)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(r))/(2*e),o=this.radius_g+s*o,a*=s,l*=s,t.x=Math.atan2(a,o),t.y=Math.atan(l*Math.cos(t.x)/o)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};In.defaultDatum="WGS84",In.Proj=Gl,In.WGS84=new In.Proj("WGS84"),In.Point=aS,In.toPoint=Rv,In.defs=Hu,In.nadgrid=function(t,e){var h,i=new DataView(e),r=11!==(h=i).getInt32(8,!1)&&(11!==h.getInt32(8,!0)&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0),s=function(h,u){return{nFields:h.getInt32(8,u),nSubgridFields:h.getInt32(24,u),nSubgrids:h.getInt32(40,u),shiftType:Wf(h,56,64).trim(),fromSemiMajorAxis:h.getFloat64(120,u),fromSemiMinorAxis:h.getFloat64(136,u),toSemiMajorAxis:h.getFloat64(152,u),toSemiMinorAxis:h.getFloat64(168,u)}}(i,r),o=function(h,u,c){for(var d=176,p=[],f=0;f<u.nSubgrids;f++){var g=eS(h,d,c),m=iS(h,d,g,c),y=Math.round(1+(g.upperLongitude-g.lowerLongitude)/g.longitudeInterval),_=Math.round(1+(g.upperLatitude-g.lowerLatitude)/g.latitudeInterval);p.push({ll:[ca(g.lowerLongitude),ca(g.lowerLatitude)],del:[ca(g.longitudeInterval),ca(g.latitudeInterval)],lim:[y,_],count:g.gridNodeCount,cvs:tS(m)}),d+=176+16*g.gridNodeCount}return p}(i,s,r),a={header:s,subgrids:o};return Sv[t]=a,a},In.transform=Yu,In.mgrs=rS,In.version="__VERSION__",function(t){t.Proj.projections.add(Ju),t.Proj.projections.add(Qu),t.Proj.projections.add(lS),t.Proj.projections.add(hS),t.Proj.projections.add(uS),t.Proj.projections.add(cS),t.Proj.projections.add(dS),t.Proj.projections.add(pS),t.Proj.projections.add(fS),t.Proj.projections.add(gS),t.Proj.projections.add(mS),t.Proj.projections.add(yS),t.Proj.projections.add(_S),t.Proj.projections.add(vS),t.Proj.projections.add(xS),t.Proj.projections.add(bS),t.Proj.projections.add(wS),t.Proj.projections.add(CS),t.Proj.projections.add(MS),t.Proj.projections.add(SS),t.Proj.projections.add(ES),t.Proj.projections.add(TS),t.Proj.projections.add(kS),t.Proj.projections.add(IS),t.Proj.projections.add(PS),t.Proj.projections.add(FS),t.Proj.projections.add(OS),t.Proj.projections.add(AS),t.Proj.projections.add(LS)}(In);const nc=In,Qf="NetherlandsRDNewQuad",Yv="EuropeanETRS89_LAEAQuad";function Kv(){nc.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs"),nc.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs"),nc.defs("EPSG:4258","+proj=longlat +ellps=GRS80 +no_defs +type=crs"),function(t){zM=t;const e=Object.keys(t.defs),i=e.length;let r,s;for(r=0;r<i;++r){const o=e[r];if(!Se(o)){const a=t.defs(o);let l=a.units;!l&&"longlat"===a.projName&&(l="degrees"),a_(new zr({code:o,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:l}))}}for(r=0;r<i;++r){const o=e[r],a=Se(o);for(s=0;s<i;++s){const l=e[s],h=Se(l);if(!J1(o,l))if(t.defs[o]===t.defs[l])Qp([a,h]);else{const u=t(o,l);UC(a,h,d_(a,h,u.forward),d_(h,a,u.inverse))}}}}(nc)}class Jv{constructor(t){Kv(),this._tileUrl=t}get Projection(){const t=new zr({code:"EPSG:28992",units:"m",extent:[-285401.92,22598.08,595401.92,903401.92],axisOrientation:"enu",global:!1}),e=new zr({code:"EPSG:3857",units:"m",extent:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],worldExtent:[-180,-85,180,85],axisOrientation:"enu",global:!0}),i=new zr({axisOrientation:"neu",code:"EPSG:3035",units:"m",extent:[2e6,2164940.6031185603,5394791.161618613,55e5]});return this._tileUrl.includes(Qf)?t:this._tileUrl.includes(Yv)?i:e}}class tg{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Xi(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new tg({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Wt()}getImage(t){return Wt()}getHitDetectionImage(){return Wt()}getPixelRatio(t){return 1}getImageState(){return Wt()}getImageSize(){return Wt()}getOrigin(){return Wt()}getSize(){return Wt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Xi(t)}listenImageChange(t){Wt()}load(){Wt()}unlistenImageChange(t){Wt()}}const Qv=tg;function xr(n){return Array.isArray(n)?W1(n):n}class eg extends Qv{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.render()}clone(){const t=this.getScale(),e=new eg({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,r=Vi(i.size*t,i.size*t);this.draw_(i,r,t),e=r.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return 2}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let r=this.radius_,s=void 0===this.radius2_?r:this.radius2_;if(r<s){const y=r;r=s,s=y}const o=2*Math.PI/(void 0===this.radius2_?this.points_:2*this.points_),a=s*Math.sin(o),l=r-Math.sqrt(s*s-a*a),h=Math.sqrt(a*a+l*l),u=h/a;if("miter"===t&&u<=i)return u*e;const c=e/2/u,d=e/2*(l/h),p=Math.sqrt((r+c)*(r+c)+d*d)-r;if(void 0===this.radius2_||"bevel"===t)return 2*p;const f=r*Math.sin(o),g=s-Math.sqrt(r*r-f*f),m=Math.sqrt(f*f+g*g)/f;return m<=i?2*Math.max(p,m*e/2-s-r):2*p}createRenderOptions(){let t,e=Qo,i=ta,r=0,s=null,o=0,a=0;this.stroke_&&(t=xr(this.stroke_.getColor()??kl),a=this.stroke_.getWidth()??1,s=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??ta,e=this.stroke_.getLineCap()??Qo,r=this.stroke_.getMiterLimit()??10);const l=this.calculateLineJoinSize_(i,a,r),h=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:a,size:Math.ceil(2*h+l),lineCap:e,lineDash:s,lineDashOffset:o,lineJoin:i,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();null===r&&(r=dn),e.fillStyle=xr(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;"string"==typeof i&&(i=Cu(i)),null===i?r=1:Array.isArray(i)&&(r=4===i.length?i[3]:1),0===r&&(e=Vi(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const r=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,h=a%2==0?i:r;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=dn,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const tx=eg;class ig extends tx{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new ig({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const $l=ig;class ng{constructor(t){this.color_=void 0!==(t=t||{}).color?t.color:null}clone(){const t=this.getColor();return new ng({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const Wn=ng;let Yl=null;class DS extends fu{constructor(t,e,i,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=void 0===r?0:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){Yl||(Yl=Vi(1,1,void 0,{willReadFrequently:!0})),Yl.drawImage(this.image_,0,0);try{Yl.getImageData(0,0,1,1),this.tainted_=!1}catch{Yl=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent("change")}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Vi(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&function(e,i){return i&&(e.src=i),e.src&&T1?new Promise((r,s)=>e.decode().then(()=>r(e)).catch(o=>e.complete&&e.width?r(e):s(o))):function(s,o){return new Promise((a,l)=>{function h(){c(),a(s)}function u(){c(),l(new Error("Image load error"))}function c(){s.removeEventListener("load",h),s.removeEventListener("error",u)}s.addEventListener("load",h),s.addEventListener("error",u)})}(e)}(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||2!==this.imageState_)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const r=i.getContext("2d");r.scale(t,t),r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=V1(this.color_),r.fillRect(0,0,i.width/t,i.height/t),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0),this.canvas_[t]=i}}function ex(n,t,e,i){return void 0!==e&&void 0!==i?[e/n,i/t]:void 0!==e?e/n:void 0!==i?i/t:1}class rg extends Qv{constructor(t){super({opacity:void 0!==(t=t||{}).opacity?t.opacity:1,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const e=void 0!==t.img?t.img:null;let i,r=t.src;if(Me(!(void 0!==r&&e),"`image` and `src` cannot be provided at the same time"),(void 0===r||0===r.length)&&e&&(r=e.src||Qt(e)),Me(void 0!==r&&r.length>0,"A defined and non-empty `src` or `image` must be provided"),Me(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?i=0:void 0!==e&&(i=e instanceof HTMLImageElement?e.complete?e.src?2:0:1:2),this.color_=void 0!==t.color?Cu(t.color):null,this.iconImage_=function(o,a,l,h,u){let c=void 0===a?void 0:Mu.get(a,l,u);return c||(c=new DS(o,o instanceof HTMLImageElement?o.src||void 0:a,l,h,u),Mu.set(a,l,u,c)),c}(e,r,this.crossOrigin_,i,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let s,o;if(t.size)[s,o]=t.size;else{const a=this.getImage(1);if(a.width&&a.height)s=a.width,o=a.height;else if(a instanceof HTMLImageElement){this.initialOptions_=t;const l=()=>{if(this.unlistenImageChange(l),!this.initialOptions_)return;const h=this.iconImage_.getSize();this.setScale(ex(h[0],h[1],t.width,t.height))};return void this.listenImageChange(l)}}void 0!==s&&this.setScale(ex(s,o,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new rg({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!r)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=r[0]),"fraction"==this.anchorYUnits_&&(t[1]*=r[1])}if("top-left"!=this.anchorOrigin_){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),("top-right"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(t[0]=-t[0]+r[0]),("bottom-left"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),("top-right"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(t[0]=i[0]-e[0]-t[0]),("bottom-left"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener("change",t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener("change",t)}}const rc=rg;function sc(n,t,e,i,r,s,o){let a,l;const h=(e-t)/i;if(1===h)a=t;else if(2===h)a=t,l=r;else if(0!==h){let u=n[t],c=n[t+1],d=0;const p=[0];for(let m=t+i;m<e;m+=i){const y=n[m],_=n[m+1];d+=Math.sqrt((y-u)*(y-u)+(_-c)*(_-c)),p.push(d),u=y,c=_}const f=r*d,g=function(y,_,v){let x,b;v=v||ls;let M=0,w=y.length,S=!1;for(;M<w;)x=M+(w-M>>1),b=+v(y[x],_),b<0?M=x+1:(w=x,S=!b);return S?M:~M}(p,f);g<0?(l=(f-p[-g-2])/(p[-g-1]-p[-g-2]),a=t+(-g-2)*i):a=t+g*i}o=o>1?o:2,s=s||new Array(o);for(let u=0;u<o;++u)s[u]=void 0===a?NaN:void 0===l?n[a+u]:Tn(n[a+u],n[a+i+u],l);return s}function sg(n,t,e,i,r,s){if(e==t)return null;let o;if(r<n[t+i-1])return s?(o=n.slice(t,t+i),o[i-1]=r,o):null;if(n[e-1]<r)return s?(o=n.slice(e-i,e),o[i-1]=r,o):null;if(r==n[t+i-1])return n.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const c=a+l>>1;r<n[(c+1)*i-1]?l=c:a=c+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const u=(r-h)/(n[(a+1)*i-1]-h);o=[];for(let c=0;c<i-1;++c)o.push(Tn(n[(a-1)*i+c],n[a*i+c],u));return o.push(r),o}function ix(n,t,e,i){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=zp(n,t,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}const nx=[1,0,0,1,0,0];class va{constructor(t,e,i,r,s,o){this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=s,this.stride_=r}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?A1(this.flatCoordinates_):zp(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=er(this.getExtent());this.flatInteriorPoints_=mf(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=R_(this.flatCoordinates_,this.ends_),e=ix(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=E_(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=sc(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=sc(t,e,o,2,.5);dr(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Se(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const r=En(i)/En(e);Dr(nx,i[0],i[3],r,-r,0,0,0),gs(this.flatCoordinates_,0,this.flatCoordinates_.length,2,nx,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new va(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=w1((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Pu(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=w_(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=df(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r)}return r&&(this.simplifiedGeometry_=new va(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}va.prototype.getFlatCoordinates=va.prototype.getOrientedFlatCoordinates;const Hn=va;class og{constructor(t){this.color_=void 0!==(t=t||{}).color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new og({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Un=og;class Ts{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=rx,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Ts({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=rx,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let ag=null;function NS(n,t){if(!ag){const e=new Wn({color:"rgba(255,255,255,0.4)"}),i=new Un({color:"#3399CC",width:1.25});ag=[new Ts({image:new $l({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return ag}function rx(n){return n.getGeometry()}const Pn=Ts;class lg{constructor(t){this.font_=(t=t||{}).font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Xi(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new Wn({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new lg({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Xi(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const sx=lg;class hg extends tr{constructor(t){super(),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t&&("function"==typeof t.getSimplifiedGeometry?this.setGeometry(t):this.setProperties(t))}clone(){const t=new hg(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(si(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=_e(t,"change",this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(i){if("function"==typeof i)return i;let r;return Array.isArray(i)?r=i:(Me("function"==typeof i.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),r=[i]),function(){return r}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const br=hg;function ox(n,t,e,i){let r=n[t],s=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=n[a],h=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(h-s)*(h-s)),r=l,s=h}return o}class oc extends ms{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){dr(this.flatCoordinates,t),this.changed()}clone(){const t=new oc(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ys(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}forEachSegment(t){return T_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:sg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e=void 0!==e&&e)}getCoordinates(){return ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return ox(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Pu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new oc(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Fu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Iu(this.flatCoordinates,0,t,this.stride),this.changed()}}const Zr=oc;class ug extends ms{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){dr(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ug(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<Ys(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const h=Nr(t,e,s[a],s[a+1]);if(h<r){r=h;for(let u=0;u<o;++u)i[u]=s[a+u];i.length=o}}return r}getCoordinates(){return ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){return t<0||this.flatCoordinates.length/this.stride<=t?null:new jr(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=i){const a=new jr(t.slice(s,s+i),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let r=0,s=e.length;r<s;r+=i)if(Dp(t,e[r],e[r+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Iu(this.flatCoordinates,0,t,this.stride),this.changed()}}const ac=ug;class lc extends ms{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const r=t,s=[],o=[];for(let l=0,h=r.length;l<h;++l)dr(s,r[l].getFlatCoordinates()),o.push(s.length);const a=0===r.length?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){dr(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new lc(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ys(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hf(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:function(s,o,a,l,h,u,c){if(c)return sg(s,o,a[a.length-1],l,h,u);let d;if(h<s[l-1])return u?(d=s.slice(0,l),d[l-1]=h,d):null;if(s[s.length-1]<h)return u?(d=s.slice(s.length-l),d[l-1]=h,d):null;for(let p=0,f=a.length;p<f;++p){const g=a[p];if(o!=g){if(h<s[o+l-1])return null;if(h<=s[g-1])return sg(s,o,g,l,h,!1);o=g}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e=void 0!==e&&e,i=void 0!==i&&i)}getCoordinates(){return Ml(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Zr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new Zr(t.slice(s,l),i);r.push(h),s=l}return r}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o];dr(t,sc(e,i,l,s,.5)),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=w_(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new lc(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(i,r,s,o,a){for(let l=0,h=s.length;l<h;++l){if(Fu(i,r,s[l],o,a))return!0;r=s[l]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Cl(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const hc=lc;class uc extends ms{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const h=r[a],u=s.length,c=h.getEnds();for(let d=0,p=c.length;d<p;++d)c[d]+=u;dr(s,h.getFlatCoordinates()),o.push(c)}e=0===r.length?this.getLayout():r[0].getLayout(),t=s,i=o}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;dr(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const i=new uc(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,r){return r<Ys(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(o,a,l,h,u){for(let c=0,d=l.length;c<d;++c){const p=l[c];u=hf(o,a,p,h,u),a=p[p.length-1]}return u}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(o,a,l,h,u,c,d,p,f,g,m){m=m||[NaN,NaN];for(let y=0,_=l.length;y<_;++y){const v=l[y];g=cf(o,a,v,h,u,!0,d,p,f,g,m),a=v[v.length-1]}return g}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,r))}containsXY(t,e){return function(r,s,o,a,l,h){if(0===o.length)return!1;for(let u=0,c=o.length;u<c;++u){const d=o[u];if(gf(r,s,d,a,l,h))return!0;s=d[d.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(e,i,r,s){let o=0;for(let a=0,l=r.length;a<l;++a){const h=r[a];o+=M_(e,i,h,s),i=h[h.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),vf(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,pf(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=ix(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=E_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ac(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;P_(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=vf(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(s,o,a,l,h,u,c,d){for(let p=0,f=a.length;p<f;++p){const g=a[p],m=[];c=df(s,o,g,l,h,u,c,m),d.push(m),o=g[g.length-1]}return c}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new uc(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),r=i[i.length-1];if(0!==e)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new _s(this.flatCoordinates.slice(e,r),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(0!==s)for(let c=0,d=l.length;c<d;++c)l[c]-=s;const u=new _s(e.slice(s,h),t,l);r.push(u),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return function(i,r,s,o,a){for(let l=0,h=s.length;l<h;++l){const u=s[l];if(I_(i,r,u,o,a))return!0;r=u[u.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=b_(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()}}const cc=uc;class dc extends __{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(si),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(_e(this.geometries_[t],"change",this.changed,this))}clone(){const t=new dc(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<Ys(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,i,r);return r}containsXY(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(t,e))return!0;return!1}computeExtent(t){qo(t);const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)L1(t,e[i].getExtent());return t}getGeometries(){return ax(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}if(r){const s=new dc(null);return s.setGeometriesArray(e),s}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(t,e);this.changed()}scale(t,e,i){i||(i=er(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(ax(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function ax(n){const t=[];for(let e=0,i=n.length;e<i;++e)t.push(n[e].clone());return t}const lx=dc,hx=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=br,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Se(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=Se(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return Wt()}readFeature(t,e){return Wt()}readFeatures(t,e){return Wt()}readGeometry(t,e){return Wt()}readProjection(t){return Wt()}writeFeature(t,e){return Wt()}writeFeatures(t,e){return Wt()}writeGeometry(t,e){return Wt()}};function pc(n,t,e){const i=e?Se(e.featureProjection):null,r=e?Se(e.dataProjection):null;let s=n;if(i&&r&&!fs(i,r)){t&&(s=n.clone());const o=t?i:r,a=t?r:i;"tile-pixels"===o.getUnits()?s.transform(o,a):s.applyTransform(Ko(o,a))}if(t&&e&&void 0!==e.decimals){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,u=l.length;h<u;++h)l[h]=Math.round(l[h]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const zS={Point:jr,LineString:Zr,Polygon:_s,MultiPoint:ac,MultiLineString:hc,MultiPolygon:cc};function ux(n,t){const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(s=>ux({...n,geometry:s})).flat();const i="MultiPolygon"===e.type?"Polygon":e.type;if("GeometryCollection"===i||"Circle"===i)throw new Error("Unsupported geometry type: "+i);const r=e.layout.length;return pc(new Hn(i,"Polygon"===i?(o=e.flatCoordinates,a=e.ends,l=r,Array.isArray(a[0])?(P_(o,0,a,l)||vf(o=o.slice(),0,a,l),o):(_f(o,0,a,l)||Ou(o=o.slice(),0,a,l),o)):e.flatCoordinates,e.ends?.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,t);var o,a,l}function cg(n,t){if(!n)return null;if(Array.isArray(n)){const e=n.map(i=>cg(i,t));return new lx(e)}return pc(new zS[n.type](n.flatCoordinates,n.layout,n.ends),!1,t)}function fc(n){return"string"==typeof n?JSON.parse(n)||null:null!==n?n:null}const jS=class extends hx{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(fc(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(fc(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return Wt()}readFeaturesFromObject(t,e){return Wt()}readGeometry(t,e){return this.readGeometryFromObject(fc(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return Wt()}readProjection(t){return this.readProjectionFromObject(fc(t))}readProjectionFromObject(t){return Wt()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return Wt()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return Wt()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return Wt()}};function dg(n,t){if(!n)return null;let e;switch(n.type){case"Point":e=function(r){const s=r.coordinates;return{type:"Point",flatCoordinates:s,layout:to(s.length)}}(n);break;case"LineString":e=function(r){const s=r.coordinates,o=s.flat();return{type:"LineString",flatCoordinates:o,ends:[o.length],layout:to(s[0].length)}}(n);break;case"Polygon":e=function(r){const s=r.coordinates,o=[],a=s[0][0].length;return{type:"Polygon",flatCoordinates:o,ends:Cl(o,0,s,a),layout:to(a)}}(n);break;case"MultiPoint":e=function(r){const s=r.coordinates;return{type:"MultiPoint",flatCoordinates:s.flat(),layout:to(s[0].length)}}(n);break;case"MultiLineString":e=function(r){const s=r.coordinates,o=s[0][0].length,a=[];return{type:"MultiLineString",flatCoordinates:a,ends:Cl(a,0,s,o),layout:to(o)}}(n);break;case"MultiPolygon":e=function(r){const s=r.coordinates,o=[],a=s[0][0][0].length;return{type:"MultiPolygon",flatCoordinates:o,ends:b_(o,0,s,a),layout:to(a)}}(n);break;case"GeometryCollection":e=function(r,s){return r.geometries.map(function(o){return dg(o)})}(n);break;default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function pg(n,t){const e=(n=pc(n,!0,t)).getType();let i;switch(e){case"Point":i=function(s,o){return{type:"Point",coordinates:s.getCoordinates()}}(n);break;case"LineString":i=function(s,o){return{type:"LineString",coordinates:s.getCoordinates()}}(n);break;case"Polygon":i=function(s,o){let a;return o&&(a=o.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(a)}}(n,t);break;case"MultiPoint":i=function(s,o){return{type:"MultiPoint",coordinates:s.getCoordinates()}}(n);break;case"MultiLineString":i=function(s,o){return{type:"MultiLineString",coordinates:s.getCoordinates()}}(n);break;case"MultiPolygon":i=function(s,o){let a;return o&&(a=o.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(a)}}(n,t);break;case"GeometryCollection":i=function(s,o){return delete(o=Object.assign({},o)).featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(a){return pg(a,o)})}}(n,t);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e)}return i}const fg=class extends jS{constructor(t){t=t||{},super(),this.dataProjection=Se(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Se(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const r=dg(i.geometry);if(this.featureClass===Hn)return ux({geometry:r,id:i.id,properties:i.properties},e);const s=new br;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&s.setGeometryName(i.geometry_name),s.setGeometry(cg(r,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const r=t.features;for(let s=0,o=r.length;s<o;++s){const a=this.readFeatureFromObject(r[s],e);a&&i.push(a)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(r,s){return cg(dg(r),s)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if("name"==e.type)i=Se(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");i=Se("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},r=t.getId();if(void 0!==r&&(i.id=r),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=pg(o,e),delete s[t.getGeometryName()]),us(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let r=0,s=t.length;r<s;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return pg(t,this.adaptOptions(e))}};var GS=ai(496);function qS(n,t,e){if(3===n){const i={keys:[],values:[],features:[]},r=e.readVarint()+e.pos;e.readFields(VS,i,r),i.length=i.features.length,i.length&&(t[i.name]=i)}}function VS(n,t,e){if(15===n)t.version=e.readVarint();else if(1===n)t.name=e.readString();else if(5===n)t.extent=e.readVarint();else if(2===n)t.features.push(e.pos);else if(3===n)t.keys.push(e.readString());else if(4===n){let i=null;const r=e.readVarint()+e.pos;for(;e.pos<r;)i=1==(n=e.readVarint()>>3)?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null;t.values.push(i)}}function ZS(n,t,e){if(1==n)t.id=e.readVarint();else if(2==n){const i=e.readVarint()+e.pos;for(;e.pos<i;){const r=t.layer.keys[e.readVarint()],s=t.layer.values[e.readVarint()];t.properties[r]=s}}else 3==n?t.type=e.readVarint():4==n&&(t.geometry=e.pos)}function BS(n,t,e){n.pos=t.features[e];const i=n.readVarint()+n.pos,r={layer:t,type:0,properties:{}};return n.readFields(ZS,r,i),r}const gg=class extends hx{constructor(t){super(),t=t||{},this.dataProjection=new zr({code:"",units:"tile-pixels"}),this.featureClass_=t.featureClass?t.featureClass:Hn,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,r){t.pos=e.geometry;const s=t.readVarint()+t.pos;let o=1,a=0,l=0,h=0,u=0,c=0;for(;t.pos<s;){if(!a){const d=t.readVarint();o=7&d,a=d>>3}if(a--,1===o||2===o)l+=t.readSVarint(),h+=t.readSVarint(),1===o&&u>c&&(r.push(u),c=u),i.push(l,h),u+=2;else{if(7!==o)throw new Error("Invalid command found in the PBF");u>c&&(i.push(i[c],i[c+1]),u+=2)}}u>c&&(r.push(u),c=u)}createFeature_(t,e,i){const r=e.type;if(0===r)return null;let s;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],h=[];this.readRawGeometry_(t,e,l,h);const u=function(d,p){let f;return 1===d?f=1===p?"Point":"MultiPoint":2===d?f=1===p?"LineString":"MultiLineString":3===d&&(f="Polygon"),f}(r,h.length);if(this.featureClass_===Hn)s=new this.featureClass_(u,l,h,2,o,a),s.transform(i.dataProjection);else{let c;if("Polygon"==u){const p=R_(l,h);c=p.length>1?new cc(l,"XY",p):new _s(l,"XY",h)}else c="Point"===u?new jr(l,"XY"):"LineString"===u?new Zr(l,"XY"):"MultiPoint"===u?new ac(l,"XY"):"MultiLineString"===u?new hc(l,"XY",h):null;s=new this.featureClass_,this.geometryName_&&s.setGeometryName(this.geometryName_);const d=pc(c,!1,i);s.setGeometry(d),void 0!==a&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_,r=Se((e=this.adaptOptions(e)).dataProjection);r.setWorldExtent(e.extent),e.dataProjection=r;const s=new GS(t),o=s.readFields(qS,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const h=o[l];r.setExtent(h?[0,0,h.extent,h.extent]:null);for(let u=0,c=h.length;u<c;++u){const d=BS(s,h,u),p=this.createFeature_(s,d,e);null!==p&&a.push(p)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}},WS=class extends Gf{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:Se("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)!function(i,r,s,o){const a=document.createElement("script"),l="olc_"+Qt(r);function h(){delete window[l],a.parentNode.removeChild(a)}a.async=!0,a.src=i+(i.includes("?")?"&":"?")+"callback="+l;const u=setTimeout(function(){h(),s&&s()},1e4);window[l]=function(c){clearTimeout(u),h(),r(c)},document.head.appendChild(a)}(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else{if(!t.tileJSON)throw new Error("Either `url` or `tileJSON` options must be provided");this.handleTileJSONResponse(t.tileJSON)}}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let i;try{i=JSON.parse(e.responseText)}catch{return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=Se("EPSG:4326"),i=this.getProjection();let r;if(void 0!==t.bounds){const a=bl(e,i);r=N1(t.bounds,a)}const s=Ol(i),o=Bu({extent:s,maxZoom:t.maxzoom||22,minZoom:t.minzoom||0,tileSize:this.tileSize_});if(this.tileGrid=o,this.tileUrlFunction=lv(t.tiles,o),t.attribution&&!this.getAttributions()){const a=void 0!==r?r:s;this.setAttributions(function(l){return _i(a,l.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}};var cx=ai(218);let Kl=0;const xa=0,Ci=1<<Kl++,At=1<<Kl++,sr=1<<Kl++,$i=1<<Kl++,ks=1<<Kl++,fn=Math.pow(2,5)-1,dx={[Ci]:"boolean",[At]:"number",[sr]:"string",[$i]:"color",[ks]:"number[]"},HS=Object.keys(dx).map(Number).sort(ls);function Yi(n){const t=[];for(const e of HS)US(n,e)&&t.push(dx[e]);return 0===t.length?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function US(n,t){return(n&t)===t}function wr(n,t){return!!(n&t)}function gc(n,t){return n===t}class Is{constructor(t,e){this.type=t,this.value=e}}class XS{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function px(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function Be(n,t,e){switch(typeof n){case"boolean":return new Is(Ci,n);case"number":return new Is(At,n);case"string":{let r=sr;return function(o){try{return Hp(o),!0}catch{return!1}}(n)&&(r|=$i),gc(r&e,xa)||(r&=e),new Is(r,n)}}if(!Array.isArray(n))throw new Error("Expression must be an array or a primitive value");if(0===n.length)throw new Error("Empty expression");if("string"==typeof n[0])return function(s,o,a){const l=s[0],h=$S[l];if(!h)throw new Error(`Unknown operator: ${l}`);return h(s,o,a)}(n,t,e);for(const r of n)if("number"!=typeof r)throw new Error("Expected an array of numbers");let i=ks;return(3===n.length||4===n.length)&&(i|=$i),e&&(i&=e),new Is(i,n)}const Q={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},$S={[Q.Get]:ee(([n,t])=>void 0!==t?function(i){switch(i){case"string":return sr;case"color":return $i;case"number":return At;case"boolean":return Ci;case"number[]":return ks;default:throw new Error(`Unrecognized type hint: ${i}`)}}(t.value):fn,de(1,2),function(t,e){const i=Be(t[1],e);if(!(i instanceof Is))throw new Error("Expected a literal argument for get operation");if("string"!=typeof i.value)throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),3===t.length?[i,Be(t[2],e)]:[i]}),[Q.Var]:ee(([n])=>n.type,de(1,1),function(t,e,i,r){const s=t[1];if("string"!=typeof s)throw new Error("Expected a string argument for var operation");if(e.variables.add(s),!("variables"in e.style)||void 0===e.style.variables[s])return[new Is(fn,s)];const o=Be(e.style.variables[s],e);if(o.value=s,r&&!wr(r,o.type))throw new Error(`The variable ${s} has type ${Yi(o.type)} but the following type was expected: ${Yi(r)}`);return[o]}),[Q.Id]:ee(At|sr,Jl,function(t,e){e.featureId=!0}),[Q.Concat]:ee(sr,de(2,1/0),Le(fn)),[Q.GeometryType]:ee(sr,Jl),[Q.Resolution]:ee(At,Jl),[Q.Zoom]:ee(At,Jl),[Q.Time]:ee(At,Jl),[Q.Any]:ee(Ci,de(2,1/0),Le(Ci)),[Q.All]:ee(Ci,de(2,1/0),Le(Ci)),[Q.Not]:ee(Ci,de(1,1),Le(Ci)),[Q.Equal]:ee(Ci,de(2,2),Le(fn),oo),[Q.NotEqual]:ee(Ci,de(2,2),Le(fn),oo),[Q.GreaterThan]:ee(Ci,de(2,2),Le(fn),oo),[Q.GreaterThanOrEqualTo]:ee(Ci,de(2,2),Le(fn),oo),[Q.LessThan]:ee(Ci,de(2,2),Le(fn),oo),[Q.LessThanOrEqualTo]:ee(Ci,de(2,2),Le(fn),oo),[Q.Multiply]:ee(n=>{let t=At|$i;for(let e=0;e<n.length;e++)t&=n[e].type;return t},de(2,1/0),Le(At|$i),oo),[Q.Divide]:ee(At,de(2,2),Le(At)),[Q.Add]:ee(At,de(2,1/0),Le(At)),[Q.Subtract]:ee(At,de(2,2),Le(At)),[Q.Clamp]:ee(At,de(3,3),Le(At)),[Q.Mod]:ee(At,de(2,2),Le(At)),[Q.Pow]:ee(At,de(2,2),Le(At)),[Q.Abs]:ee(At,de(1,1),Le(At)),[Q.Floor]:ee(At,de(1,1),Le(At)),[Q.Ceil]:ee(At,de(1,1),Le(At)),[Q.Round]:ee(At,de(1,1),Le(At)),[Q.Sin]:ee(At,de(1,1),Le(At)),[Q.Cos]:ee(At,de(1,1),Le(At)),[Q.Atan]:ee(At,de(1,2),Le(At)),[Q.Sqrt]:ee(At,de(1,1),Le(At)),[Q.Match]:ee(n=>{let t=fn;for(let e=2;e<n.length;e+=2)t&=n[e].type;return t&=n[n.length-1].type,t},de(4,1/0),fx,function(t,e,i,r){const s=t.length-1;let o=Be(t[1],e).type;const a=Be(t[t.length-1],e);let l=void 0!==r?r&a.type:a.type;const h=new Array(s-2);for(let c=0;c<s-2;c+=2){const d=Be(t[c+2],e),p=Be(t[c+3],e);o&=d.type,l&=p.type,h[c]=d,h[c+1]=p}const u=sr|At|Ci;if(!wr(u,o))throw new Error(`Expected an input of type ${Yi(u)} for the interpolate operation, got ${Yi(o)} instead`);if(gc(l,xa))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let c=0;c<s-2;c+=2){const d=Be(t[c+2],e,o),p=Be(t[c+3],e,l);h[c]=d,h[c+1]=p}return[Be(t[1],e,o),...h,Be(t[t.length-1],e,l)]}),[Q.Between]:ee(Ci,de(3,3),Le(At)),[Q.Interpolate]:ee(n=>{let t=$i|At;for(let e=3;e<n.length;e+=2)t&=n[e].type;return t},de(6,1/0),fx,function(t,e,i,r){const s=t[1];let o;switch(s[0]){case"linear":o=1;break;case"exponential":if(o=s[1],"number"!=typeof o)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(o)} instead`);break;default:o=null}if(!o)throw new Error(`Invalid interpolation type: ${JSON.stringify(s)}`);o=Be(o,e);let a=Be(t[2],e);if(!wr(At,a.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${Yi(a.type)} instead`);a=Be(t[2],e,At);const l=new Array(t.length-3);for(let h=0;h<l.length;h+=2){let u=Be(t[h+3],e);if(!wr(At,u.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${Yi(u.type)} at position ${h+2} instead`);let c=Be(t[h+4],e);if(!wr(At|$i,c.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${Yi(c.type)} at position ${h+3} instead`);u=Be(t[h+3],e,At),c=Be(t[h+4],e,At|$i),l[h]=u,l[h+1]=c}return[o,a,...l]}),[Q.Case]:ee(n=>{let t=fn;for(let e=1;e<n.length;e+=2)t&=n[e].type;return t&=n[n.length-1].type,t},de(3,1/0),function(t,e){const i=t.length-1;if(i%2==0)throw new Error(`An odd amount of arguments was expected for operation ${t[0]}, got ${JSON.stringify(i)} instead`)},function(t,e,i,r){const s=Be(t[t.length-1],e);let o=void 0!==r?r&s.type:s.type;const a=new Array(t.length-1);for(let l=0;l<a.length-1;l+=2){const h=Be(t[l+1],e),u=Be(t[l+2],e);if(!wr(Ci,h.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${Yi(h.type)} at position ${l} instead`);o&=u.type,a[l]=h,a[l+1]=u}if(gc(o,xa))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let l=0;l<a.length-1;l+=2)a[l+1]=Be(t[l+2],e,o);return a[a.length-1]=Be(t[t.length-1],e,o),a}),[Q.In]:ee(Ci,de(2,2),function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let r=sr|At;const s=new Array(i.length);for(let o=0;o<s.length;o++){const a=Be(i[o],e);r&=a.type,s[o]=a}if(gc(r,xa))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[Be(t[1],e,r),...s]}),[Q.Number]:ee(At,de(1,1/0),Le(fn)),[Q.String]:ee(sr,de(1,1/0),Le(fn)),[Q.Array]:ee(n=>3===n.length||4===n.length?ks|$i:ks,de(1,1/0),Le(At)),[Q.Color]:ee($i,de(3,4),Le(At)),[Q.Band]:ee(At,de(1,3),Le(At)),[Q.Palette]:ee($i,de(2,2),function(t,e){const i=Be(t[1],e,At);if(i.type!==At)throw new Error(`The first argument of palette must be an number, got ${Yi(i.type)} instead`);const r=t[2];if(!Array.isArray(r))throw new Error("The second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){const a=Be(r[o],e,$i);if(!(a instanceof Is))throw new Error(`The palette color at index ${o} must be a literal value`);if(!wr(a.type,$i))throw new Error(`The palette color at index ${o} should be of type color, got ${Yi(a.type)} instead`);s[o]=a}return[i,...s]})};function Jl(n,t){if(1!==n.length)throw new Error(`Expected no arguments for ${n[0]} operation`);return[]}function de(n,t){return function(e,i){const r=e[0],s=e.length-1;if(n===t){if(s!==n)throw new Error(`Expected ${n} argument${1===n?"":"s"} for ${r}, got ${s}`)}else if(s<n||s>t)throw new Error(`Expected ${t===1/0?`${n} or more`:`${n} to ${t}`} arguments for ${r}, got ${s}`)}}function Le(n){return function(t,e){const i=t[0],r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Be(t[o+1],e);if(!wr(n,a.type)){const l=Yi(n),h=Yi(a.type);throw new Error(`Unexpected type for argument ${o} of ${i} operation, got ${l} but expected ${h}`)}a.type&=n,s[o]=a}return s}}function oo(n,t,e){const i=n[0],r=n.length-1;let s=fn;for(let a=0;a<e.length;++a)s&=e[a].type;if(s===xa)throw new Error(`No common type could be found for arguments of ${i} operation`);const o=new Array(r);for(let a=0;a<r;++a)o[a]=Be(n[a+1],t,s);return o}function fx(n,t){const e=n.length-1;if(e%2==1)throw new Error(`An even amount of arguments was expected for operation ${n[0]}, got ${JSON.stringify(e)} instead`)}function ee(n,...t){return function(e,i,r){const s=e[0];let o=[];for(let l=0;l<t.length;l++)o=t[l](e,i,o,r)||o;let a="function"==typeof n?n(o):n;if(void 0!==r){if(!wr(a,r))throw new Error(`The following expression was expected to return ${Yi(r)}, but returns ${Yi(a)} instead: ${JSON.stringify(e)}`);a&=r}if(a===xa)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(e)}`);return new XS(a,s,...o)}}function Ps(n,t,e){const i=Be(n,e);if(!wr(t,i.type)){const r=Yi(t),s=Yi(i.type);throw new Error(`Expected expression to be of type ${r}, got ${s}`)}return Br(i,e)}function Br(n,t){if(n instanceof Is){if(n.type===$i&&"string"==typeof n.value){const i=Hp(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case Q.Number:case Q.String:return function(r,s){const o=r.operator,a=r.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Br(r.args[h],s);switch(o){case Q.Number:case Q.String:return h=>{for(let u=0;u<a;++u){const c=l[u](h);if(typeof c===o)return c}throw new Error(`Expected one of the values to be a ${o}`)};default:throw new Error(`Unsupported assertion operator ${o}`)}}(n,t);case Q.Get:case Q.Var:return function(r,s){const o=r.args[0].value;switch(r.operator){case Q.Get:return a=>a.properties[o];case Q.Var:return a=>a.variables[o];default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}(n);case Q.Id:return i=>i.featureId;case Q.Concat:{const i=n.args.map(r=>Br(r,t));return r=>"".concat(...i.map(s=>s(r).toString()))}case Q.Resolution:return i=>i.resolution;case Q.Any:case Q.All:case Q.Not:return function(r,s){const o=r.operator,a=r.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Br(r.args[h],s);switch(o){case Q.Any:return h=>{for(let u=0;u<a;++u)if(l[u](h))return!0;return!1};case Q.All:return h=>{for(let u=0;u<a;++u)if(!l[u](h))return!1;return!0};case Q.Not:return h=>!l[0](h);default:throw new Error(`Unsupported logical operator ${o}`)}}(n,t);case Q.Equal:case Q.NotEqual:case Q.LessThan:case Q.LessThanOrEqualTo:case Q.GreaterThan:case Q.GreaterThanOrEqualTo:return function(r,s){const o=r.operator,a=Br(r.args[0],s),l=Br(r.args[1],s);switch(o){case Q.Equal:return h=>a(h)===l(h);case Q.NotEqual:return h=>a(h)!==l(h);case Q.LessThan:return h=>a(h)<l(h);case Q.LessThanOrEqualTo:return h=>a(h)<=l(h);case Q.GreaterThan:return h=>a(h)>l(h);case Q.GreaterThanOrEqualTo:return h=>a(h)>=l(h);default:throw new Error(`Unsupported comparison operator ${o}`)}}(n,t);case Q.Multiply:case Q.Divide:case Q.Add:case Q.Subtract:case Q.Clamp:case Q.Mod:case Q.Pow:case Q.Abs:case Q.Floor:case Q.Ceil:case Q.Round:case Q.Sin:case Q.Cos:case Q.Atan:case Q.Sqrt:return function(r,s){const o=r.operator,a=r.args.length,l=new Array(a);for(let h=0;h<a;++h)l[h]=Br(r.args[h],s);switch(o){case Q.Multiply:return h=>{let u=1;for(let c=0;c<a;++c)u*=l[c](h);return u};case Q.Divide:return h=>l[0](h)/l[1](h);case Q.Add:return h=>{let u=0;for(let c=0;c<a;++c)u+=l[c](h);return u};case Q.Subtract:return h=>l[0](h)-l[1](h);case Q.Clamp:return h=>{const u=l[0](h),c=l[1](h);if(u<c)return c;const d=l[2](h);return u>d?d:u};case Q.Mod:return h=>l[0](h)%l[1](h);case Q.Pow:return h=>Math.pow(l[0](h),l[1](h));case Q.Abs:return h=>Math.abs(l[0](h));case Q.Floor:return h=>Math.floor(l[0](h));case Q.Ceil:return h=>Math.ceil(l[0](h));case Q.Round:return h=>Math.round(l[0](h));case Q.Sin:return h=>Math.sin(l[0](h));case Q.Cos:return h=>Math.cos(l[0](h));case Q.Atan:return 2===a?h=>Math.atan2(l[0](h),l[1](h)):h=>Math.atan(l[0](h));case Q.Sqrt:return h=>Math.sqrt(l[0](h));default:throw new Error(`Unsupported numeric operator ${o}`)}}(n,t);case Q.Match:return function(r,s){const o=r.args.length,a=new Array(o);for(let l=0;l<o;++l)a[l]=Br(r.args[l],s);return l=>{const h=a[0](l);for(let u=1;u<o;u+=2)if(h===a[u](l))return a[u+1](l);return a[o-1](l)}}(n,t);case Q.Interpolate:return function(r,s){const o=r.args.length,a=new Array(o);for(let l=0;l<o;++l)a[l]=Br(r.args[l],s);return l=>{const h=a[0](l),u=a[1](l);let c,d;for(let p=2;p<o;p+=2){const f=a[p](l);let g=a[p+1](l);const m=Array.isArray(g);if(m&&(g=jC(g)),f>=u)return 2===p?g:m?YS(h,u,c,d,f,g):Ql(h,u,c,d,f,g);c=f,d=g}return d}}(n,t);default:throw new Error(`Unsupported operator ${e}`)}}function Ql(n,t,e,i,r,s){const o=r-e;if(0===o)return i;const a=t-e;return i+(1===n?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1))*(s-i)}function YS(n,t,e,i,r,s){if(r-e==0)return i;const o=Z1(i),a=Z1(s);let l=a[2]-o[2];return l>180?l-=360:l<-180&&(l+=360),B1(function(u){const c=ir.rgb(LC.xyz(u));return c[3]=u[3],c}([Ql(n,t,e,o[0],r,a[0]),Ql(n,t,e,o[1],r,a[1]),o[2]+Ql(n,t,e,0,r,l),Ql(n,t,e,i[3],r,s[3])]))}function KS(n){return!0}function gx(n){const t=px(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=mg(n[o],t);const r={variables:{},properties:{},resolution:NaN,featureId:null},s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const h=o.getId();r.featureId=void 0!==h?h:null}let l=0;for(let h=0;h<e;++h){const u=i[h](r);u&&(s[l]=u,l+=1)}return s.length=l,s}}function mg(n,t){const e=th(n,"",t),i=eh(n,"",t),r=function(h,u){const c="text-",d=Rs(h,c+"value",u);if(!d)return null;const p=th(h,c,u),f=th(h,c+"background-",u),g=eh(h,c,u),m=eh(h,c+"background-",u),y=Rs(h,c+"font",u),_=gn(h,c+"max-angle",u),v=gn(h,c+"offset-x",u),x=gn(h,c+"offset-y",u),b=ih(h,c+"overflow",u),M=Rs(h,c+"placement",u),w=gn(h,c+"repeat",u),S=yc(h,c+"scale",u),R=ih(h,c+"rotate-with-view",u),P=gn(h,c+"rotation",u),A=Rs(h,c+"align",u),T=Rs(h,c+"justify",u),K=Rs(h,c+"baseline",u),N=yx(h,c+"padding",u),F=new sx({});return function(j){if(F.setText(d(j)),p&&F.setFill(p(j)),f&&F.setBackgroundFill(f(j)),g&&F.setStroke(g(j)),m&&F.setBackgroundStroke(m(j)),y&&F.setFont(y(j)),_&&F.setMaxAngle(_(j)),v&&F.setOffsetX(v(j)),x&&F.setOffsetY(x(j)),b&&F.setOverflow(b(j)),M){const q=M(j);if("point"!==q&&"line"!==q)throw new Error("Expected point or line for text-placement");F.setPlacement(q)}if(w&&F.setRepeat(w(j)),S&&F.setScale(S(j)),R&&F.setRotateWithView(R(j)),P&&F.setRotation(P(j)),A){const q=A(j);if("left"!==q&&"center"!==q&&"right"!==q&&"end"!==q&&"start"!==q)throw new Error("Expected left, right, center, start, or end for text-align");F.setTextAlign(q)}if(T){const q=T(j);if("left"!==q&&"right"!==q&&"center"!==q)throw new Error("Expected left, right, or center for text-justify");F.setJustify(q)}if(K){const q=K(j);if("bottom"!==q&&"top"!==q&&"middle"!==q&&"alphabetic"!==q&&"hanging"!==q)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");F.setTextBaseline(q)}return N&&F.setPadding(N(j)),F}}(n,t),s=(u=t,"icon-src"in(h=n)?function(d,p){const f="icon-",g=f+"src",m=xx(d[g],g),y=mc(d,f+"anchor",p),_=yc(d,f+"scale",p),v=gn(d,f+"opacity",p),x=mc(d,f+"displacement",p),b=gn(d,f+"rotation",p),M=ih(d,f+"rotate-with-view",p),w=_x(d,f+"anchor-origin"),S=vx(d,f+"anchor-x-units"),R=vx(d,f+"anchor-y-units"),P=function(dt,D){const V=dt[D];if(void 0!==V)return wx(V,D)}(d,f+"color"),A=function(dt,D){const V=dt[D];if(void 0!==V){if("string"!=typeof V)throw new Error(`Expected a string for ${D}`);return V}}(d,f+"cross-origin"),T=function(dt,D){const V=dt[D];if(void 0!==V)return nh(V,D)}(d,f+"offset"),K=_x(d,f+"offset-origin"),N=ba(d,f+"width"),F=ba(d,f+"height"),j=function(dt,D){const V=dt[D];if(void 0!==V){if("number"==typeof V)return Xi(V);if(!Array.isArray(V))throw new Error(`Expected a number or size array for ${D}`);if(2!==V.length||"number"!=typeof V[0]||"number"!=typeof V[1])throw new Error(`Expected a number or size array for ${D}`);return V}}(d,f+"size"),q=yg(d,f+"declutter"),$=new rc({src:m,anchorOrigin:w,anchorXUnits:S,anchorYUnits:R,color:P,crossOrigin:A,offset:T,offsetOrigin:K,height:F,width:N,size:j,declutterMode:q});return function(ct){return v&&$.setOpacity(v(ct)),x&&$.setDisplacement(x(ct)),b&&$.setRotation(b(ct)),M&&$.setRotateWithView(M(ct)),_&&$.setScale(_(ct)),y&&$.setAnchor(y(ct)),$}}(h,u):"shape-points"in h?function(d,p){const f="shape-",g=f+"points",m=bx(d[g],g),y=th(d,f,p),_=eh(d,f,p),v=yc(d,f+"scale",p),x=mc(d,f+"displacement",p),b=gn(d,f+"rotation",p),M=ih(d,f+"rotate-with-view",p),w=ba(d,f+"radius"),S=ba(d,f+"radius1"),R=ba(d,f+"radius2"),P=ba(d,f+"angle"),A=yg(d,f+"declutter-mode"),T=new tx({points:m,radius:w,radius1:S,radius2:R,angle:P,declutterMode:A});return function(K){return y&&T.setFill(y(K)),_&&T.setStroke(_(K)),x&&T.setDisplacement(x(K)),b&&T.setRotation(b(K)),M&&T.setRotateWithView(M(K)),v&&T.setScale(v(K)),T}}(h,u):"circle-radius"in h?function(d,p){const f="circle-",g=th(d,f,p),m=eh(d,f,p),y=gn(d,f+"radius",p),_=yc(d,f+"scale",p),v=mc(d,f+"displacement",p),x=gn(d,f+"rotation",p),b=ih(d,f+"rotate-with-view",p),M=yg(d,f+"declutter-mode"),w=new $l({radius:5,declutterMode:M});return function(S){return y&&w.setRadius(y(S)),g&&w.setFill(g(S)),m&&w.setStroke(m(S)),v&&w.setDisplacement(v(S)),x&&w.setRotation(x(S)),b&&w.setRotateWithView(b(S)),_&&w.setScale(_(S)),w}}(h,u):null),o=gn(n,"z-index",t);var h,u;if(!(e||i||r||s||us(n)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Pn;return function(l){let h=!0;if(e){const u=e(l);u&&(h=!1),a.setFill(u)}if(i){const u=i(l);u&&(h=!1),a.setStroke(u)}if(r){const u=r(l);u&&(h=!1),a.setText(u)}if(s){const u=s(l);u&&(h=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),h?null:a}}function th(n,t,e){const i=mx(n,t+"fill-color",e);if(!i)return null;const r=new Wn;return function(s){const o=i(s);return"none"===o?null:(r.setColor(o),r)}}function eh(n,t,e){const i=gn(n,t+"stroke-width",e),r=mx(n,t+"stroke-color",e);if(!i&&!r)return null;const s=Rs(n,t+"stroke-line-cap",e),o=Rs(n,t+"stroke-line-join",e),a=yx(n,t+"stroke-line-dash",e),l=gn(n,t+"stroke-line-dash-offset",e),h=gn(n,t+"stroke-miter-limit",e),u=new Un;return function(c){if(r){const d=r(c);if("none"===d)return null;u.setColor(d)}if(i&&u.setWidth(i(c)),s){const d=s(c);if("butt"!==d&&"round"!==d&&"square"!==d)throw new Error("Expected butt, round, or square line cap");u.setLineCap(d)}if(o){const d=o(c);if("bevel"!==d&&"round"!==d&&"miter"!==d)throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(d)}return a&&u.setLineDash(a(c)),l&&u.setLineDashOffset(l(c)),h&&u.setMiterLimit(h(c)),u}}function gn(n,t,e){if(!(t in n))return;const i=Ps(n[t],At,e);return function(r){return bx(i(r),t)}}function Rs(n,t,e){if(!(t in n))return null;const i=Ps(n[t],sr,e);return function(r){return xx(i(r),t)}}function ih(n,t,e){if(!(t in n))return null;const i=Ps(n[t],Ci,e);return function(r){const s=i(r);if("boolean"!=typeof s)throw new Error(`Expected a boolean for ${t}`);return s}}function mx(n,t,e){if(!(t in n))return null;const i=Ps(n[t],$i|sr,e);return function(r){return wx(i(r),t)}}function yx(n,t,e){if(!(t in n))return null;const i=Ps(n[t],ks,e);return function(r){return nh(i(r),t)}}function mc(n,t,e){if(!(t in n))return null;const i=Ps(n[t],ks,e);return function(r){const s=nh(i(r),t);if(2!==s.length)throw new Error(`Expected two numbers for ${t}`);return s}}function yc(n,t,e){if(!(t in n))return null;const i=Ps(n[t],ks|At,e);return function(r){return function(o,a){if("number"==typeof o)return o;const l=nh(o,a);if(2!==l.length)throw new Error(`Expected an array of two numbers for ${a}`);return l}(i(r),t)}}function ba(n,t){const e=n[t];if(void 0!==e){if("number"!=typeof e)throw new Error(`Expected a number for ${t}`);return e}}function _x(n,t){const e=n[t];if(void 0!==e){if("bottom-left"!==e&&"bottom-right"!==e&&"top-left"!==e&&"top-right"!==e)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function vx(n,t){const e=n[t];if(void 0!==e){if("pixels"!==e&&"fraction"!==e)throw new Error(`Expected pixels or fraction for ${t}`);return e}}function yg(n,t){const e=n[t];if(void 0!==e){if("string"!=typeof e)throw new Error(`Expected a string for ${t}`);if("declutter"!==e&&"obstacle"!==e&&"none"!==e)throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function nh(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if("number"!=typeof n[i])throw new Error(`Expected an array of numbers for ${t}`);return n}function xx(n,t){if("string"!=typeof n)throw new Error(`Expected a string for ${t}`);return n}function bx(n,t){if("number"!=typeof n)throw new Error(`Expected a number for ${t}`);return n}function wx(n,t){if("string"==typeof n)return n;const e=nh(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}const Cx=class extends Du{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get("renderOrder")}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new cx(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set("renderOrder",t)}setStyle(t){this.style_=function(i){if(void 0===i)return NS;if(!i)return null;if("function"==typeof i||i instanceof Pn)return i;if(!Array.isArray(i))return gx([i]);if(0===i.length)return[];const r=i.length,s=i[0];if(s instanceof Pn){const o=new Array(r);for(let a=0;a<r;++a){const l=i[a];if(!(l instanceof Pn))throw new Error("Expected a list of style instances");o[a]=l}return o}if("style"in s){const o=new Array(r);for(let a=0;a<r;++a){const l=i[a];if(!("style"in l))throw new Error("Expected a list of rules with a style property");o[a]=l}return function(l){const h=px(),u=function(p,f){const g=p.length,m=new Array(g);for(let y=0;y<g;++y){const _=p[y],v="filter"in _?Ps(_.filter,Ci,f):KS;let x;if(Array.isArray(_.style)){const b=_.style.length;x=new Array(b);for(let M=0;M<b;++M)x[M]=mg(_.style[M],f)}else x=[mg(_.style,f)];m[y]={filter:v,styles:x}}return function(y){const _=[];let v=!1;for(let x=0;x<g;++x)if((0,m[x].filter)(y)&&(!p[x].else||!v)){v=!0;for(const b of m[x].styles){const M=b(y);M&&_.push(M)}}return _}}(l,h),c={variables:{},properties:{},resolution:NaN,featureId:null};return function(d,p){if(c.properties=d.getPropertiesInternal(),c.resolution=p,h.featureId){const f=d.getId();c.featureId=void 0!==f?f:null}return u(c)}}(o)}return gx(i)}(t),this.styleFunction_=null===t?void 0:function(i){let r;if("function"==typeof i)r=i;else{let s;Array.isArray(i)?s=i:(Me("function"==typeof i.getZIndex,"Expected an `Style` or an array of `Style`"),s=[i]),r=function(){return s}}return r}(this.style_),this.changed()}},rh={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},_c=[rh.FILL],Fs=[rh.STROKE],ao=[rh.BEGIN_PATH],Mx=[rh.CLOSE_PATH],Zt=rh,Sx=class{drawCustom(t,e,i,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},sh=class extends Sx{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],_u(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,i,r,s,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=r);let u=t[e],c=t[e+1];const d=this.tmpCoordinate_;let p,f,g,m=!0;for(p=e+r;p<i;p+=r)d[0]=t[p],d[1]=t[p+1],g=Np(h,d),g!==f?(m&&(a[l++]=u,a[l++]=c,m=!1),a[l++]=d[0],a[l++]=d[1]):g===Li.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],m=!1):m=!0,u=d[0],c=d[1],f=g;return(s&&m||p===e+r)&&(a[l++]=u,a[l++]=c),l}drawCustomCoordinates_(t,e,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(h),e=l}return e}drawCustom(t,e,i,r){this.beginGeometry(t,e);const s=t.getType(),o=t.getStride(),a=this.coordinates.length;let l,h,u,c,d;switch(s){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),c=[];const p=t.getEndss();d=0;for(let f=0,g=p.length;f<g;++f){const m=[];d=this.drawCustomCoordinates_(l,d,p[f],o,m),c.push(m)}this.instructions.push([Zt.CUSTOM,a,c,t,i,pf]),this.hitDetectionInstructions.push([Zt.CUSTOM,a,c,t,r||i,pf]);break;case"Polygon":case"MultiLineString":u=[],l="Polygon"==s?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),o,u),this.instructions.push([Zt.CUSTOM,a,u,t,i,Ml]),this.hitDetectionInstructions.push([Zt.CUSTOM,a,u,t,r||i,Ml]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([Zt.CUSTOM,a,h,t,i,ys]),this.hitDetectionInstructions.push([Zt.CUSTOM,a,h,t,r||i,ys]);break;case"MultiPoint":l=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(l,o),h>a&&(this.instructions.push([Zt.CUSTOM,a,h,t,i,ys]),this.hitDetectionInstructions.push([Zt.CUSTOM,a,h,t,r||i,ys]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),h=this.coordinates.length,this.instructions.push([Zt.CUSTOM,a,h,t,i]),this.hitDetectionInstructions.push([Zt.CUSTOM,a,h,t,r||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Zt.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Zt.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let r,s,o=-1;for(e=0;e<i;++e)r=t[e],s=r[0],s==Zt.END_GEOMETRY?o=e:s==Zt.BEGIN_GEOMETRY&&(r[2]=e,IC(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const r=t.getColor();i.fillStyle=xr(r||dn)}else i.fillStyle=void 0;if(e){const r=e.getColor();i.strokeStyle=xr(r||kl);const s=e.getLineCap();i.lineCap=void 0!==s?s:Qo;const o=e.getLineDash();i.lineDash=o?o.slice():Gr;const a=e.getLineDashOffset();i.lineDashOffset=a||0;const l=e.getLineJoin();i.lineJoin=void 0!==l?l:ta;const h=e.getWidth();i.lineWidth=void 0!==h?h:1;const u=e.getMiterLimit();i.miterLimit=void 0!==u?u:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Zt.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Zt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;("string"!=typeof i||t.currentFillStyle!=i)&&(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||s!=t.currentLineDash&&!hs(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Zt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){return!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=O1(this.maxExtent),this.maxLineWidth>0)&&ds(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_),this.bufferedMaxExtent_}},Ex=class extends sh{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){const s=this.state,o=void 0!==s.fillStyle,a=void 0!==s.strokeStyle,l=i.length;this.instructions.push(ao),this.hitDetectionInstructions.push(ao);for(let h=0;h<l;++h){const u=i[h],c=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,u,r,!0,!a),p=[Zt.MOVE_TO_LINE_TO,c,d];this.instructions.push(p),this.hitDetectionInstructions.push(p),a&&(this.instructions.push(Mx),this.hitDetectionInstructions.push(Mx)),e=u}return o&&(this.instructions.push(_c),this.hitDetectionInstructions.push(_c)),a&&(this.instructions.push(Fs),this.hitDetectionInstructions.push(Fs)),e}drawCircle(t,e){const i=this.state;if(void 0===i.fillStyle&&void 0===i.strokeStyle)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Zt.SET_FILL_STYLE,dn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Zt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Gr,0]);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length;this.appendFlatLineCoordinates(r,0,r.length,s,!1,!1);const a=[Zt.CIRCLE,o];this.instructions.push(ao,a),this.hitDetectionInstructions.push(ao,a),void 0!==i.fillStyle&&(this.instructions.push(_c),this.hitDetectionInstructions.push(_c)),void 0!==i.strokeStyle&&(this.instructions.push(Fs),this.hitDetectionInstructions.push(Fs)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state;if(void 0===i.fillStyle&&void 0===i.strokeStyle)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Zt.SET_FILL_STYLE,dn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Zt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Gr,0]);const r=t.getEnds(),s=t.getOrientedFlatCoordinates(),o=t.getStride();this.drawFlatCoordinatess_(s,0,r,o),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state;if(void 0===i.fillStyle&&void 0===i.strokeStyle)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Zt.SET_FILL_STYLE,dn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Zt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Gr,0]);const r=t.getEndss(),s=t.getOrientedFlatCoordinates(),o=t.getStride();let a=0;for(let l=0,h=r.length;l<h;++l)a=this.drawFlatCoordinatess_(s,a,r[l],o);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=eo(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function JS(n,t,e,i,r){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<n&&o+r<i;){const[h,u]=l.slice(-2),c=t[o+r],d=t[o+r+1],p=Math.sqrt((c-h)*(c-h)+(d-u)*(d-u));if(a+=p,a>=n){const f=(n-a+p)/p,g=Tn(h,c,f),m=Tn(u,d,f);l.push(g,m),s.push(l),l=[g,m],a==n&&(o+=r),a=0}else if(a<n)l.push(t[o+r],t[o+r+1]),o+=r;else{const f=p-a,g=Tn(h,c,f/p),m=Tn(u,d,f/p);l.push(g,m),s.push(l),l=[g,m],a=0,o+=r}}return a>0&&s.push(l),s}function QS(n,t,e,i,r){let s,o,a,l,h,u,c,d,p,f,g=e,m=e,y=0,_=0,v=e;for(o=e;o<i;o+=r){const x=t[o],b=t[o+1];void 0!==h&&(p=x-h,f=b-u,l=Math.sqrt(p*p+f*f),void 0!==c&&(_+=a,s=Math.acos((c*p+d*f)/(a*l)),s>n&&(_>y&&(y=_,g=v,m=o),_=0,v=o-r)),a=l,c=p,d=f),h=x,u=b}return _+=l,_>y?[v,o]:[g,m]}const vc={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},tE={Circle:Ex,Default:sh,Image:class extends sh{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([Zt.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Zt.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([Zt.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Zt.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends sh{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[Zt.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e){const i=this.state;if(void 0===i.strokeStyle||void 0===i.lineWidth)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Gr,0],ao);const r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(Fs),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state;if(void 0===i.strokeStyle||void 0===i.lineWidth)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Gr,0],ao);const r=t.getEnds(),s=t.getFlatCoordinates(),o=t.getStride();let a=0;for(let l=0,h=r.length;l<h;++l)a=this.drawFlatCoordinates_(s,a,r[l],o);this.hitDetectionInstructions.push(Fs),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Fs),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Fs),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(ao)}},Polygon:Ex,Text:class extends sh{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[dn]={fillStyle:dn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textState_;if(""===this.text_||!i||!this.textFillState_&&!this.textStrokeState_)return;const r=this.coordinates;let s=r.length;const o=t.getType();let a=null,l=t.getStride();if("line"!==i.placement||"LineString"!=o&&"MultiLineString"!=o&&"Polygon"!=o&&"MultiPolygon"!=o){let h=i.overflow?null:[];switch(o){case"Point":case"MultiPoint":a=t.getFlatCoordinates();break;case"LineString":a=t.getFlatMidpoint();break;case"Circle":a=t.getCenter();break;case"MultiLineString":a=t.getFlatMidpoints(),l=2;break;case"Polygon":a=t.getFlatInteriorPoint(),i.overflow||h.push(a[2]/this.resolution),l=3;break;case"MultiPolygon":const g=t.getFlatInteriorPoints();a=[];for(let m=0,y=g.length;m<y;m+=3)i.overflow||h.push(g[m+2]/this.resolution),a.push(g[m],g[m+1]);if(0===a.length)return;l=2}const u=this.appendFlatPointCoordinates(a,l);if(u===s)return;if(h&&(u-s)/2!=a.length/l){let g=s/2;h=h.filter((m,y)=>{const _=r[2*(g+y)]===a[y*l]&&r[2*(g+y)+1]===a[y*l+1];return _||--g,_})}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&this.updateFillStyle(this.state,this.createFill),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let c=i.padding;if(c!=no&&(i.scale[0]<0||i.scale[1]<0)){let g=i.padding[0],m=i.padding[1],y=i.padding[2],_=i.padding[3];i.scale[0]<0&&(m=-m,_=-_),i.scale[1]<0&&(g=-g,y=-y),c=[g,m,y,_]}const d=this.pixelRatio;this.instructions.push([Zt.DRAW_IMAGE,s,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==no?no:c.map(function(g){return g*d}),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);const p=1/d,f=this.state.fillStyle;i.backgroundFill&&(this.state.fillStyle=dn,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Zt.DRAW_IMAGE,s,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,void 0,this.declutterImageWithText_,c,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?dn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),i.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!_i(this.getBufferedMaxExtent(),t.getExtent()))return;let h;if(a=t.getFlatCoordinates(),"LineString"==o)h=[a.length];else if("MultiLineString"==o)h=t.getEnds();else if("Polygon"==o)h=t.getEnds().slice(0,1);else if("MultiPolygon"==o){const p=t.getEndss();h=[];for(let f=0,g=p.length;f<g;++f)h.push(p[f][0])}this.beginGeometry(t,e);const u=i.repeat,c=u?void 0:i.textAlign;let d=0;for(let p=0,f=h.length;p<f;++p){let g;g=u?JS(u*this.resolution,a,d,h[p],l):[a.slice(d,h[p])];for(let m=0,y=g.length;m<y;++m){const _=g[m];let v=0,x=_.length;if(null==c){const M=QS(i.maxAngle,_,0,_.length,2);v=M[0],x=M[1]}for(let M=v;M<x;M+=l)r.push(_[M],_[M+1]);const b=r.length;d=h[p],this.drawChars_(s,b),s=b}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Il,justify:e.justify,textBaseline:e.textBaseline||qu,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=vc[r.textBaseline],u=this.textOffsetY_*l,c=this.text_,d=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Zt.DRAW_CHARS,t,e,h,r.overflow,a,r.maxAngle,l,u,s,d*l,c,o,1]),this.hitDetectionInstructions.push([Zt.DRAW_CHARS,t,e,h,r.overflow,a&&dn,r.maxAngle,l,u,s,d*l,c,o,1/l])}setTextStyle(t,e){let i,r,s;if(t){const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=xr(o.getColor()||dn)):(r=null,this.textFillState_=r);const a=t.getStroke();if(a){s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const f=a.getLineDash(),g=a.getLineDashOffset(),m=a.getWidth(),y=a.getMiterLimit();s.lineCap=a.getLineCap()||Qo,s.lineDash=f?f.slice():Gr,s.lineDashOffset=void 0===g?0:g,s.lineJoin=a.getLineJoin()||ta,s.lineWidth=void 0===m?1:m,s.miterLimit=void 0===y?10:y,s.strokeStyle=xr(a.getColor()||kl)}else s=null,this.textStrokeState_=s;i=this.textState_;const l=t.getFont()||z_;j_(l);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||qu,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||no,i.scale=void 0===h?[1,1]:h;const u=t.getOffsetX(),c=t.getOffsetY(),d=t.getRotateWithView(),p=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===u?0:u,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0===p?0:p,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:Qt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+Qt(r.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}},xc=class{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const r in i){const s=i[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let r=this.buildersByZIndex_[i];void 0===r&&(r={},this.buildersByZIndex_[i]=r);let s=r[e];return void 0===s&&(s=new tE[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s),s}},eE=class extends C1{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return Wt()}getData(t){return null}prepareFrame(t){return Wt()}renderFrame(t,e){return Wt()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(r,s)=>{const o=this.loadedTileCallback.bind(this,i,r);return t.forEachLoadedTile(e,r,s,o)}}forEachFeatureAtCoordinate(t,e,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(2===e.getState()||3===e.getState())&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener("change",this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}},Tx=[];let wa=null;const kx=class extends eE{constructor(t){super(t),this.container=null,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let r;wa||(wa=Vi(1,1,void 0,{willReadFrequently:!0})),wa.clearRect(0,0,1,1);try{wa.drawImage(t,e,i,1,1,0,0,1,1),r=wa.getImageData(0,0,1,1).data}catch{return wa=null,null}return r}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&hs(Cu(t.style.backgroundColor),Cu(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Vi();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=Gn(i),s=ml(i),o=gl(i),a=Zo(i);Fi(e.coordinateToPixelTransform,r),Fi(e.coordinateToPixelTransform,s),Fi(e.coordinateToPixelTransform,o),Fi(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Fi(l,r),Fi(l,s),Fi(l,o),Fi(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const s=new F_(t,this.inversePixelTransform,i,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}postRender(t,e){this.dispatchRenderEvent_("postrender",t,e)}getRenderTransform(t,e,i,r,s,o,a){const l=r/e;return Dr(this.tempTransform,s/2,o/2,l,-l,-i,-t[0]+a,-t[1])}disposeInternal(){delete this.frameState,super.disposeInternal()}};function iE(n,t,e,i,r,s,o,a,l,h,u,c){let d=n[t],p=n[t+1],f=0,g=0,m=0,y=0;function _(){f=d,g=p,d=n[t+=i],p=n[t+1],y+=m,m=Math.sqrt((d-f)*(d-f)+(p-g)*(p-g))}do{_()}while(t<e-i&&y+m<s);let v=0===m?0:(s-y)/m;const x=Tn(f,d,v),b=Tn(g,p,v),M=t-i,w=y,S=s+a*l(h,r,u);for(;t<e-i&&y+m<S;)_();v=0===m?0:(S-y)/m;const R=Tn(f,d,v),P=Tn(g,p,v);let A;if(c){const j=[x,b,R,P];af(j,0,4,2,c,j,j),A=j[0]>j[2]}else A=x>R;const T=Math.PI,K=[],N=M+i===t;let F;if(m=0,y=w,d=n[t=M],p=n[t+1],N)return _(),F=Math.atan2(p-g,d-f),A&&(F+=F>0?-T:T),K[0]=[(R+x)/2,(P+b)/2,(S-s)/2,F,r],K;for(let j=0,q=(r=r.replace(/\n/g," ")).length;j<q;){_();let $=Math.atan2(p-g,d-f);if(A&&($+=$>0?-T:T),void 0!==F){let yt=$-F;if(yt+=yt>T?-2*T:yt<-T?2*T:0,Math.abs(yt)>o)return null}F=$;const ct=j;let dt=0;for(;j<q;++j){const yt=a*l(h,r[A?q-j-1:j],u);if(t+i<e&&y+m<s+dt+yt/2)break;dt+=yt}if(j===ct)continue;const D=A?r.substring(q-ct,q-j):r.substring(ct,j);v=0===m?0:(s+dt/2-y)/m;const V=Tn(f,d,v),It=Tn(g,p,v);K.push([V,It,dt/2,$,D]),s+=dt}return K}const Ca=[1/0,1/0,-1/0,-1/0],Os=[],Wr=[],Hr=[],As=[];function Ix(n){return n[3].declutterBox}const Px=new RegExp("[\u0591-\u08ff\ufb1d-\ufdff\ufe70-\ufefc\u0800-\u0fff\ue800-\uefff]");function _g(n,t){return"start"===t?t=Px.test(n)?"right":"left":"end"===t&&(t=Px.test(n)?"left":"right"),vc[t]}function nE(n,t,e){return e>0&&n.push("\n",""),n.push(t,""),n}const rE=class{constructor(t,e,i,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,r){const s=t+e+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,u=[l.scale[0]*h,l.scale[1]*h],c=Array.isArray(t),d=l.justify?vc[l.justify]:_g(Array.isArray(t)?t[0]:t,l.textAlign||Il),p=r&&o.lineWidth?o.lineWidth:0,f=c?t:t.split("\n").reduce(nE,[]),{width:g,height:m,widths:y,heights:_,lineWidths:v}=function(ct,dt){const D=[],V=[],It=[];let yt=0,Xt=0,he=0,Ee=0;for(let Ie=0,De=dt.length;Ie<=De;Ie+=2){const oi=dt[Ie];if("\n"===oi||Ie===De){yt=Math.max(yt,Xt),It.push(Xt),Xt=0,he+=Ee;continue}const st=dt[Ie+1]||ct.font,ci=Vu(st,oi);D.push(ci),Xt+=ci;const ti=oM(st);V.push(ti),Ee=Math.max(Ee,ti)}return{width:yt,height:he,widths:D,heights:V,lineWidths:It}}(l,f),x=g+p,b=[],M=(x+2)*u[0],w=(m+p)*u[1],S={width:M<0?Math.floor(M):Math.ceil(M),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:b};(1!=u[0]||1!=u[1])&&b.push("scale",u),r&&(b.push("strokeStyle",o.strokeStyle),b.push("lineWidth",p),b.push("lineCap",o.lineCap),b.push("lineJoin",o.lineJoin),b.push("miterLimit",o.miterLimit),b.push("setLineDash",[o.lineDash]),b.push("lineDashOffset",o.lineDashOffset)),i&&b.push("fillStyle",a.fillStyle),b.push("textBaseline","middle"),b.push("textAlign","center");const R=.5-d;let P=d*x+R*p;const A=[],T=[];let K,N=0,F=0,j=0,q=0;for(let $=0,ct=f.length;$<ct;$+=2){const dt=f[$];if("\n"===dt){F+=N,N=0,P=d*x+R*p,++q;continue}const D=f[$+1]||l.font;D!==K&&(r&&A.push("font",D),i&&T.push("font",D),K=D),N=Math.max(N,_[j]);const V=[dt,P+R*y[j]+d*(y[j]-v[q]),.5*(p+N)+F];P+=y[j],r&&A.push("strokeText",V),i&&T.push("fillText",V),++j}return Array.prototype.push.apply(b,A),Array.prototype.push.apply(b,T),this.labels_[s]=S,S}replayTextBackground_(t,e,i,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,s,o,a,l,h,u,c,d,p,f,g,m){let y=i-(a*=d[0]),_=r-(l*=d[1]);const v=s+h>t?t-h:s,x=o+u>e?e-u:o,b=f[3]+v*d[0]+f[1],M=f[0]+x*d[1]+f[2],w=y-f[3],S=_-f[0];let R;return(g||0!==c)&&(Os[0]=w,As[0]=w,Os[1]=S,Wr[1]=S,Wr[0]=w+b,Hr[0]=Wr[0],Hr[1]=S+M,As[1]=Hr[1]),0!==c?(R=Dr([1,0,0,1,0,0],i,r,1,1,c,-i,-r),Fi(R,Os),Fi(R,Wr),Fi(R,Hr),Fi(R,As),fr(Math.min(Os[0],Wr[0],Hr[0],As[0]),Math.min(Os[1],Wr[1],Hr[1],As[1]),Math.max(Os[0],Wr[0],Hr[0],As[0]),Math.max(Os[1],Wr[1],Hr[1],As[1]),Ca)):fr(Math.min(w,w+b),Math.min(S,S+M),Math.max(w,w+b),Math.max(S,S+M),Ca),p&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:v,drawImageH:x,originX:h,originY:u,declutterBox:{minX:Ca[0],minY:Ca[1],maxX:Ca[2],maxY:Ca[3],value:m},canvasTransform:R,scale:d}}replayImageOrLabel_(t,e,i,r,s,o,a){const l=r.declutterBox,h=t.canvas,u=a?a[2]*r.scale[0]/2:0;return l.minX-u<=h.width/e&&l.maxX+u>=0&&l.minY-u<=h.height/e&&l.maxY+u>=0&&(!(!o&&!a)&&this.replayTextBackground_(t,Os,Wr,Hr,As,o,a),p=r.canvasTransform,f=s,g=i,m=r.originX,y=r.originY,_=r.drawImageW,v=r.drawImageH,x=r.drawImageX,b=r.drawImageY,M=r.scale,(d=t).save(),1!==f&&(d.globalAlpha*=f),p&&d.transform.apply(d,p),g.contextInstructions?(d.translate(x,b),d.scale(M[0],M[1]),function(S,R){const P=S.contextInstructions;for(let A=0,T=P.length;A<T;A+=2)Array.isArray(P[A+1])?R[P[A]].apply(R,P[A+1]):R[P[A]]=P[A+1]}(g,d)):M[0]<0||M[1]<0?(d.translate(x,b),d.scale(M[0],M[1]),d.drawImage(g,m,y,_,v,0,0,_,v)):d.drawImage(g,m,y,_,v,x,b,_*M[0],v*M[1]),d.restore()),!0;var d,p,f,g,m,y,_,v,x,b,M}fill_(t){if(this.alignFill_){const e=Fi(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,r){const s=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],l=this.pixelRatio,h=_g(Array.isArray(t)?t[0]:t,s.textAlign||Il),u=vc[s.textBaseline||qu],c=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:h*(o.width/l-2*s.scale[0])+2*(.5-h)*c,anchorY:u*o.height/l+2*(.5-u)*c}}execute_(t,e,i,r,s,o,a,l){let h;var It,yt;this.pixelCoordinates_&&hs(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=gs(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(It=this.renderedTransform_)[0]=(yt=i)[0],It[1]=yt[1],It[2]=yt[2],It[3]=yt[3],It[4]=yt[4],It[5]=yt[5]);let u=0;const c=r.length;let d,p,f,g,m,y,_,v,x,b,M,w,S=0,R=0,P=0,A=null,T=null;const K=this.coordinateCache_,N=this.viewRotation_,F=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,j={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:N},q=this.instructions!=r||this.overlaps?0:200;let $,ct,dt,D;for(;u<c;){const V=r[u];switch(V[0]){case Zt.BEGIN_GEOMETRY:$=V[1],D=V[3],$.getGeometry()?void 0===a||_i(a,D.getExtent())?++u:u=V[2]+1:u=V[2];break;case Zt.BEGIN_PATH:R>q&&(this.fill_(t),R=0),P>q&&(t.stroke(),P=0),!R&&!P&&(t.beginPath(),g=NaN,m=NaN),++u;break;case Zt.CIRCLE:S=V[1];const It=h[S],yt=h[S+1],Xt=h[S+2]-It,he=h[S+3]-yt,Ee=Math.sqrt(Xt*Xt+he*he);t.moveTo(It+Ee,yt),t.arc(It,yt,Ee,0,2*Math.PI,!0),++u;break;case Zt.CLOSE_PATH:t.closePath(),++u;break;case Zt.CUSTOM:S=V[1],d=V[2];const Ie=V[4],De=6==V.length?V[5]:void 0;j.geometry=V[3],j.feature=$,u in K||(K[u]=[]);const oi=K[u];De?De(h,S,d,2,oi):(oi[0]=h[S],oi[1]=h[S+1],oi.length=2),Ie(oi,j),++u;break;case Zt.DRAW_IMAGE:S=V[1],d=V[2],v=V[3],p=V[4],f=V[5];let st=V[6];const ci=V[7],ti=V[8],Nt=V[9],Ye=V[10];let Te=V[11];const ye=V[12];let Si=V[13];const Di=V[14],nn=V[15];if(!v&&V.length>=20){x=V[19],b=V[20],M=V[21],w=V[22];const Re=this.drawLabelWithPointPlacement_(x,b,M,w);v=Re.label,V[3]=v,p=(Re.anchorX-V[23])*this.pixelRatio,V[4]=p,f=(Re.anchorY-V[24])*this.pixelRatio,V[5]=f,st=v.height,V[6]=st,Si=v.width,V[13]=Si}let ei,mi,Ht,An;V.length>25&&(ei=V[25]),V.length>17?(mi=V[16],Ht=V[17],An=V[18]):(mi=no,Ht=!1,An=!1),Ye&&F?Te+=N:!Ye&&!F&&(Te-=N);let ii=0;for(;S<d;S+=2){if(ei&&ei[ii++]<Si/this.pixelRatio)continue;const Re=this.calculateImageOrLabelDimensions_(v.width,v.height,h[S],h[S+1],Si,st,p,f,ti,Nt,Te,ye,s,mi,Ht||An,$),yn=[t,e,v,Re,ci,Ht?A:null,An?T:null];if(l){if("none"===Di)continue;if("obstacle"===Di){l.insert(Re.declutterBox);continue}{let on,js;if(nn){const Jr=d-S;if(!nn[Jr]){nn[Jr]=yn;continue}if(on=nn[Jr],delete nn[Jr],js=Ix(on),l.collides(js))continue}if(l.collides(Re.declutterBox))continue;on&&(l.insert(js),this.replayImageOrLabel_.apply(this,on)),l.insert(Re.declutterBox)}}this.replayImageOrLabel_.apply(this,yn)}++u;break;case Zt.DRAW_CHARS:const Ke=V[1],Pe=V[2],Ne=V[3],pe=V[4];w=V[5];const Yt=V[6],We=V[7],vi=V[8];M=V[9];const Ei=V[10];x=V[11],b=V[12];const Ni=[V[13],V[13]],rn=this.textStates[b],Wi=rn.font,He=[rn.scale[0]*We,rn.scale[1]*We];let zi;Wi in this.widths_?zi=this.widths_[Wi]:(zi={},this.widths_[Wi]=zi);const sn=ox(h,Ke,Pe,2),Ln=Math.abs(He[0])*q_(Wi,x,zi);if(pe||Ln<=sn){const Re=iE(h,Ke,Pe,2,x,(sn-Ln)*_g(x,this.textStates[b].textAlign),Yt,Math.abs(He[0]),q_,Wi,zi,F?0:this.viewRotation_);t:if(Re){const yn=[];let on,js,Jr,_n,$n;if(M)for(on=0,js=Re.length;on<js;++on){$n=Re[on],Jr=$n[4],_n=this.createLabel(Jr,b,"",M),p=$n[2]+(He[0]<0?-Ei:Ei),f=Ne*_n.height+2*(.5-Ne)*Ei*He[1]/He[0]-vi;const Qr=this.calculateImageOrLabelDimensions_(_n.width,_n.height,$n[0],$n[1],_n.width,_n.height,p,f,0,0,$n[3],Ni,!1,no,!1,$);if(l&&l.collides(Qr.declutterBox))break t;yn.push([t,e,_n,Qr,1,null,null])}if(w)for(on=0,js=Re.length;on<js;++on){$n=Re[on],Jr=$n[4],_n=this.createLabel(Jr,b,w,""),p=$n[2],f=Ne*_n.height-vi;const Qr=this.calculateImageOrLabelDimensions_(_n.width,_n.height,$n[0],$n[1],_n.width,_n.height,p,f,0,0,$n[3],Ni,!1,no,!1,$);if(l&&l.collides(Qr.declutterBox))break t;yn.push([t,e,_n,Qr,1,null,null])}l&&l.load(yn.map(Ix));for(let Qr=0,Ck=yn.length;Qr<Ck;++Qr)this.replayImageOrLabel_.apply(this,yn[Qr])}}++u;break;case Zt.END_GEOMETRY:if(void 0!==o){$=V[1];const Re=o($,D);if(Re)return Re}++u;break;case Zt.FILL:q?R++:this.fill_(t),++u;break;case Zt.MOVE_TO_LINE_TO:for(S=V[1],d=V[2],ct=h[S],dt=h[S+1],y=ct+.5|0,_=dt+.5|0,(y!==g||_!==m)&&(t.moveTo(ct,dt),g=y,m=_),S+=2;S<d;S+=2)ct=h[S],dt=h[S+1],y=ct+.5|0,_=dt+.5|0,(S==d-2||y!==g||_!==m)&&(t.lineTo(ct,dt),g=y,m=_);++u;break;case Zt.SET_FILL_STYLE:A=V,this.alignFill_=V[2],R&&(this.fill_(t),R=0,P&&(t.stroke(),P=0)),t.fillStyle=V[1],++u;break;case Zt.SET_STROKE_STYLE:T=V,P&&(t.stroke(),P=0),this.setStrokeStyle_(t,V),++u;break;case Zt.STROKE:q?P++:t.stroke(),++u;break;default:++u}}R&&this.fill_(t),P&&t.stroke()}execute(t,e,i,r,s,o){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,r,s){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,r,s)}},vg=["Polygon","Circle","LineString","Image","Text","Default"],xg={},bc=class{constructor(t,e,i,r,s,o){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(s)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const r=t[e];for(const s in r)i[s]=new rE(this.resolution_,this.pixelRatio_,this.overlaps_,r[s])}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,s,o){const a=2*(r=Math.round(r))+1,l=Dr(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Vi(a,a,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;let c;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):h||u.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(c=[1/0,1/0,-1/0,-1/0],fl(c,t),ds(c,e*(this.renderBuffer_+r),c));const d=function(M){if(void 0!==xg[M])return xg[M];const w=2*M+1,S=M*M,R=new Array(S+1);for(let A=0;A<=M;++A)for(let T=0;T<=M;++T){const K=A*A+T*T;if(K>S)break;let N=R[K];N||(N=[],R[K]=N),N.push(4*((M+A)*w+(M+T))+3),A>0&&N.push(4*((M-A)*w+(M+T))+3),T>0&&(N.push(4*((M+A)*w+(M-T))+3),A>0&&N.push(4*((M-A)*w+(M-T))+3))}const P=[];for(let A=0,T=R.length;A<T;++A)R[A]&&P.push(...R[A]);return xg[M]=P,P}(r);let p;function f(b,M){const w=u.getImageData(0,0,a,a).data;for(let S=0,R=d.length;S<R;S++)if(w[d[S]]>0){if(!o||"Image"!==p&&"Text"!==p||o.includes(b)){const P=(d[S]-3)/4,A=r-P%a,T=r-(P/a|0),K=s(b,M,A*A+T*T);if(K)return K}u.clearRect(0,0,a,a);break}}const g=Object.keys(this.executorsByZIndex_).map(Number);let m,y,_,v,x;for(g.sort(ls),m=g.length-1;m>=0;--m){const b=g[m].toString();for(_=this.executorsByZIndex_[b],y=vg.length-1;y>=0;--y)if(p=vg[y],v=_[p],void 0!==v&&(x=v.executeHitDetection(u,l,i,f,c),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],r=e[1],s=e[2],o=e[3],a=[i,r,i,o,s,o,s,r];return gs(a,0,8,2,t,a),a}isEmpty(){return us(this.executorsByZIndex_)}execute(t,e,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);let h,u,c,d,p,f;for(l.sort(ls),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||vg,a&&l.reverse(),h=0,u=l.length;h<u;++h){const g=l[h].toString();for(p=this.executorsByZIndex_[g],c=0,d=o.length;c<d;++c)f=p[o[c]],void 0!==f&&f.execute(t,e,i,r,s,a)}this.maxExtent_&&t.restore()}},sE=class extends Sx{constructor(t,e,i,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?xu(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,r){if(!this.image_)return;const s=gs(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;0===this.transformRotation_&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let u=0,c=s.length;u<c;u+=2){const d=s[u]-this.imageAnchorX_,p=s[u+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const f=d+this.imageAnchorX_,g=p+this.imageAnchorY_;Dr(a,f,g,1,1,h,-f,-g),o.save(),o.transform.apply(o,a),o.translate(f,g),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,p,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=l)}drawText_(t,e,i,r){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=gs(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(0===this.transformRotation_&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){const l=s[e]+this.textOffsetX_,h=s[e+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(t,e,i,r,s){const o=this.context_,a=gs(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(t,e,i,r){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),_i(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(l,h,u){const c=l.getFlatCoordinates();if(!c)return null;const d=l.getStride();return gs(c,0,c.length,d,h,u)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),_i(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(_i(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(""!==this.text_){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),_i(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),_i(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a)r=this.drawRings_(i,r,s[a],o);this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),hs(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:Il;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const i=t.getColor();this.fillState_={fillStyle:xr(i||dn)}}else this.fillState_=null;if(e){const i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),u=s||Gr;this.strokeState_={lineCap:void 0!==r?r:Qo,lineDash:1===this.pixelRatio_?u:u.map(c=>c*this.pixelRatio_),lineDashOffset:(o||0)*this.pixelRatio_,lineJoin:void 0!==a?a:ta,lineWidth:(void 0!==l?l:1)*this.pixelRatio_,miterLimit:void 0!==h?h:10,strokeStyle:xr(i||kl)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const p=e.getColor();this.textFillState_={fillStyle:xr(p||dn)}}else this.textFillState_=null;const i=t.getStroke();if(i){const p=i.getColor(),f=i.getLineCap(),g=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),_=i.getWidth(),v=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==f?f:Qo,lineDash:g||Gr,lineDashOffset:m||0,lineJoin:void 0!==y?y:ta,lineWidth:void 0!==_?_:1,miterLimit:void 0!==v?v:10,strokeStyle:xr(p||kl)}}else this.textStrokeState_=null;const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),u=t.getText(),c=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:void 0!==r?r:z_,textAlign:void 0!==c?c:Il,textBaseline:void 0!==d?d:qu},this.text_=void 0!==u?Array.isArray(u)?u.reduce((p,f,g)=>p+(g%2?" ":f),""):u:"",this.textOffsetX_=void 0!==s?this.pixelRatio_*s:0,this.textOffsetY_=void 0!==o?this.pixelRatio_*o:0,this.textRotateWithView_=void 0!==a&&a,this.textRotation_=void 0!==l?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}else this.text_=""}},Rn=.5;function Rx(n,t,e,i,r,s,o){const a=Vi(n[0]*Rn,n[1]*Rn);a.imageSmoothingEnabled=!1;const l=a.canvas,h=new sE(a,Rn,r,null,o),u=e.length,c=Math.floor(16777215/u),d={};for(let f=1;f<=u;++f){const g=e[f-1],m=g.getStyleFunction()||i;if(!m)continue;let y=m(g,s);if(!y)continue;Array.isArray(y)||(y=[y]);const _=(f*c).toString(16).padStart(7,"#00000");for(let v=0,x=y.length;v<x;++v){const b=y[v],M=b.getGeometryFunction()(g);if(!M||!_i(r,M.getExtent()))continue;const w=b.clone(),S=w.getFill();S&&S.setColor(_);const R=w.getStroke();R&&(R.setColor(_),R.setLineDash(null)),w.setText(void 0);const P=b.getImage();if(P){const N=P.getImageSize();if(!N)continue;const F=Vi(N[0],N[1],void 0,{alpha:!1}),j=F.canvas;F.fillStyle=_,F.fillRect(0,0,j.width,j.height),w.setImage(new rc({img:j,anchor:P.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:P.getOrigin(),opacity:1,size:P.getSize(),scale:P.getScale(),rotation:P.getRotation(),rotateWithView:P.getRotateWithView()}))}const A=w.getZIndex()||0;let T=d[A];T||(T={},d[A]=T,T.Polygon=[],T.Circle=[],T.LineString=[],T.Point=[]);const K=M.getType();if("GeometryCollection"===K){const N=M.getGeometriesArrayRecursive();for(let F=0,j=N.length;F<j;++F){const q=N[F];T[q.getType().replace("Multi","")].push(q,w)}}else T[K.replace("Multi","")].push(M,w)}}const p=Object.keys(d).map(Number).sort(ls);for(let f=0,g=p.length;f<g;++f){const m=d[p[f]];for(const y in m){const _=m[y];for(let v=0,x=_.length;v<x;v+=2){h.setStyle(_[v+1]);for(let b=0,M=t.length;b<M;++b)h.setTransform(t[b]),h.drawGeometry(_[v])}}}return a.getImageData(0,0,l.width,l.height)}function Fx(n,t,e){const i=[];if(e){const r=Math.floor(Math.round(n[0])*Rn),s=Math.floor(Math.round(n[1])*Rn),o=4*(gi(r,0,e.width-1)+gi(s,0,e.height-1)*e.width),a=e.data[o+2]+256*(e.data[o+1]+256*e.data[o]),l=Math.floor(16777215/t.length);a&&a%l==0&&i.push(t[a/l-1])}return i}const oE=.5,Ox={Point:function(t,e,i,r,s){const o=i.getImage(),a=i.getText();let l;if(o){if(2!=o.getImageState())return;let h=t;if(s){const c=o.getDeclutterMode();if("none"!==c)if(h=s,"obstacle"===c){const d=t.getBuilder(i.getZIndex(),"Image");d.setImageStyle(o,l),d.drawPoint(e,r)}else a&&a.getText()&&(l={})}const u=h.getBuilder(i.getZIndex(),"Image");u.setImageStyle(o,l),u.drawPoint(e,r)}if(a&&a.getText()){let h=t;s&&(h=s);const u=h.getBuilder(i.getZIndex(),"Text");u.setTextStyle(a,l),u.drawText(e,r)}},LineString:function(t,e,i,r,s){const o=i.getStroke();if(o){const l=t.getBuilder(i.getZIndex(),"LineString");l.setFillStrokeStyle(null,o),l.drawLineString(e,r)}const a=i.getText();if(a&&a.getText()){const l=(s||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}},Polygon:function(t,e,i,r,s){const o=i.getFill(),a=i.getStroke();if(o||a){const h=t.getBuilder(i.getZIndex(),"Polygon");h.setFillStrokeStyle(o,a),h.drawPolygon(e,r)}const l=i.getText();if(l&&l.getText()){const h=(s||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,r)}},MultiPoint:function(t,e,i,r,s){const o=i.getImage(),a=i.getText();let l;if(o){if(2!=o.getImageState())return;let h=t;if(s){const c=o.getDeclutterMode();if("none"!==c)if(h=s,"obstacle"===c){const d=t.getBuilder(i.getZIndex(),"Image");d.setImageStyle(o,l),d.drawMultiPoint(e,r)}else a&&a.getText()&&(l={})}const u=h.getBuilder(i.getZIndex(),"Image");u.setImageStyle(o,l),u.drawMultiPoint(e,r)}if(a&&a.getText()){let h=t;s&&(h=s);const u=h.getBuilder(i.getZIndex(),"Text");u.setTextStyle(a,l),u.drawText(e,r)}},MultiLineString:function(t,e,i,r,s){const o=i.getStroke();if(o){const l=t.getBuilder(i.getZIndex(),"LineString");l.setFillStrokeStyle(null,o),l.drawMultiLineString(e,r)}const a=i.getText();if(a&&a.getText()){const l=(s||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}},MultiPolygon:function(t,e,i,r,s){const o=i.getFill(),a=i.getStroke();if(a||o){const h=t.getBuilder(i.getZIndex(),"Polygon");h.setFillStrokeStyle(o,a),h.drawMultiPolygon(e,r)}const l=i.getText();if(l&&l.getText()){const h=(s||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,r)}},GeometryCollection:function(t,e,i,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a)(0,Ox[o[a].getType()])(t,o[a],i,r,s)},Circle:function(t,e,i,r,s){const o=i.getFill(),a=i.getStroke();if(o||a){const h=t.getBuilder(i.getZIndex(),"Circle");h.setFillStrokeStyle(o,a),h.drawCircle(e,r)}const l=i.getText();if(l&&l.getText()){const h=(s||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(l),h.drawText(e,r)}}};function aE(n,t){return parseInt(Qt(n),10)-parseInt(Qt(t),10)}function Ax(n,t){const e=bg(n,t);return e*e}function bg(n,t){return oE*n/t}function wc(n,t,e,i,r,s,o){let a=!1;const l=e.getImage();if(l){const h=l.getImageState();2==h||3==h?l.unlistenImageChange(r):(0==h&&l.load(),l.listenImageChange(r),a=!0)}return function(u,c,d,p,f,g){const m=d.getGeometryFunction()(c);if(!m)return;const y=m.simplifyTransformed(p,f);d.getRenderer()?Lx(u,y,d,c):(0,Ox[y.getType()])(u,y,d,c,g)}(n,t,e,i,s,o),a}function Lx(n,t,e,i){if("GeometryCollection"!=t.getType())n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer());else{const r=t.getGeometries();for(let s=0,o=r.length;s<o;++s)Lx(n,r[s],e,i)}}const lE=class extends kx{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,h=s.rotation,u=l.getExtent(),c=this.getLayer().getSource(),d=e.pixelRatio,p=e.viewHints,f=!(p[0]||p[1]),g=this.compositionContext_,m=Math.round(e.size[0]*d),y=Math.round(e.size[1]*d),_=c.getWrapX()&&l.canWrapX(),v=_?qe(u):null,x=_?Math.ceil((r[2]-u[2])/v)+1:1;let b=_?Math.floor((r[0]-u[0])/v):0;do{const M=this.getRenderTransform(o,a,h,d,m,y,b*v);t.execute(g,1,M,h,f,void 0,i)}while(++b<x)}setupCompositionContext_(){if(1!==this.opacity_){const t=Vi(this.context.canvas.width,this.context.canvas.height,Tx);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Tl(this.compositionContext_),Tx.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];yu(this.pixelTransform,1/i,0,0,1/i,0,0),Lp(this.inversePixelTransform,this.pixelTransform);const s=F1(this.pixelTransform);this.useContainer(e,s,this.getBackground(t));const o=this.context,a=o.canvas,l=this.replayGroup_,h=this.declutterExecutorGroup;let u=l&&!l.isEmpty()||h&&!h.isEmpty();if(!u&&!this.getLayer().hasListener("prerender")&&!this.getLayer().hasListener("postrender"))return null;const c=Math.round(t.size[0]*i),d=Math.round(t.size[1]*i);a.width!=c||a.height!=d?(a.width=c,a.height=d,a.style.transform!==s&&(a.style.transform=s)):this.containerReused||o.clearRect(0,0,c,d),this.preRender(o,t);const p=t.viewState,f=p.projection;this.opacity_=r.opacity,this.setupCompositionContext_();let g=!1;if(u&&r.extent&&this.clipping){const m=Qs(r.extent,f);u=_i(m,t.extent),g=u&&!ps(m,t.extent),g&&this.clipUnrotated(this.compositionContext_,t,m)}return u&&this.renderWorlds(l,t),g&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==p.rotation&&(this.renderedRotation_=p.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=[this.context.canvas.width,this.context.canvas.height];Fi(this.pixelTransform,i);const r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),u=[],c=i[0]*Rn,d=i[1]*Rn;u.push(this.getRenderTransform(r,s,o,Rn,c,d,0).slice());const p=h.getSource(),f=a.getExtent();if(p.getWrapX()&&a.canWrapX()&&!ps(f,l)){let g=l[0];const m=qe(f);let y,_=0;for(;g<f[0];)--_,y=m*_,u.push(this.getRenderTransform(r,s,o,Rn,c,d,y).slice()),g+=m;for(_=0,g=l[2];g>f[2];)++_,y=m*_,u.push(this.getRenderTransform(r,s,o,Rn,c,d,y).slice()),g-=m}this.hitDetectionImageData_=Rx(i,u,this.renderedFeatures_,h.getStyleFunction(),l,s,o)}e(Fx(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),h={},u=function(p,f,g){const m=Qt(p),y=h[m];if(y){if(!0!==y&&g<y.distanceSq){if(0===g)return h[m]=!0,s.splice(s.lastIndexOf(y),1),r(p,l,f);y.geometry=f,y.distanceSq=g}}else{if(0===g)return h[m]=!0,r(p,l,f);s.push(h[m]={feature:p,layer:l,geometry:f,distanceSq:g,callback:r})}};let c;const d=[this.replayGroup_];return this.declutterExecutorGroup&&d.push(this.declutterExecutorGroup),d.some(p=>c=p.forEachFeatureAtCoordinate(t,o,a,i,u,p===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(f=>f.value):null)),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const r=t.viewHints[0],s=t.viewHints[1],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,u=h.projection,c=h.resolution,d=t.pixelRatio,p=e.getRevision(),f=e.getRenderBuffer();let g=e.getRenderOrder();void 0===g&&(g=aE);const m=h.center.slice(),y=ds(l,f*c),_=y.slice(),v=[y.slice()],x=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!ps(x,t.extent)){const j=qe(x),q=Math.max(qe(y)/2,j);y[0]=x[0]-q,y[2]=x[2]+q,Yp(m,u);const $=z1(v[0],u);$[0]<x[0]&&$[2]<x[2]?v.push([$[0]+j,$[1],$[2]+j,$[3]]):$[0]>x[0]&&$[2]>x[2]&&v.push([$[0]-j,$[1],$[2]-j,$[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==p&&this.renderedRenderOrder_==g&&ps(this.wrappedRenderedExtent_,y))return hs(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const b=new xc(bg(c,d),y,c,d);let M;this.getLayer().getDeclutter()&&(M=new xc(bg(c,d),y,c,d));const w=wl();let S;if(w){for(let j=0,q=v.length;j<q;++j){const $=nf(v[j],u);i.loadFeatures($,XC(c,u),w)}S=bl(w,u)}else for(let j=0,q=v.length;j<q;++j)i.loadFeatures(v[j],c,u);const R=Ax(c,d);let P=!0;const A=j=>{let q;const $=j.getStyleFunction()||e.getStyleFunction();if($&&(q=$(j,c)),q){const ct=this.renderFeature(j,R,q,b,S,M);P=P&&!ct}},T=nf(y,u),K=i.getFeaturesInExtent(T);g&&K.sort(g);for(let j=0,q=K.length;j<q;++j)A(K[j]);this.renderedFeatures_=K,this.ready=P;const N=b.finish(),F=new bc(y,c,d,i.getOverlaps(),N,e.getRenderBuffer());return M&&(this.declutterExecutorGroup=new bc(y,c,d,i.getOverlaps(),M.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=p,this.renderedRenderOrder_=g,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=u,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,s,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,h=i.length;l<h;++l)a=wc(r,t,i[l],e,this.boundHandleStyleImageChange_,s,o)||a;else a=wc(r,t,i,e,this.boundHandleStyleImageChange_,s,o);return a}},Cc=class extends Cx{constructor(t){super(t)}createRenderer(){return new lE(this)}},Dx=class{constructor(t){this.rbush_=new cx(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Qt(e)]=i}load(t,e){const i=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[Qt(a)]=l}this.rbush_.load(i)}remove(t){const e=Qt(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[Qt(e)];Vo([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(t){return this.rbush_.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}).map(function(e){return e.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,s=t.length;r<s;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return us(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return fr(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function hE(n,t){return[[-1/0,-1/0,1/0,1/0]]}function uE(n,t){return[n]}class Ls extends cr{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const lo=class extends nv{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.loader_=Go,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(Me(this.format_,"`format` must be set when `url` is set"),this.loader_=fv(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:hE;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,r;this.featuresRtree_=e?new Dx:null,this.loadedExtentsRtree_=new Dx,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&void 0===i&&(i=new pr(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Qt(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ls("addfeature",t))}setupChangeEvents_(t,e){e instanceof Hn||(this.featureChangeKeys_[t]=[_e(e,"change",this.handleFeatureChange_,this),_e(e,"propertychange",this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const r=String(e.getId());if(r in this.idIndex_)if(e instanceof Hn){const s=this.idIndex_[r];s instanceof Hn?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:i=!1}else i=!1;else this.idIndex_[r]=e}return i&&(Me(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=Qt(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=Qt(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const u=h.getExtent();e.push(u),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener("addfeature"))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Ls("addfeature",i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener("addfeature",function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener("removefeature",function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener("add",i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener("remove",i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(si);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Ls("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){return this.forEachFeatureInExtent([t[0],t[1],t[0],t[1]],function(i){const r=i.getGeometry();if(r instanceof Hn||r.intersectsCoordinate(t))return e(i)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const r=i.getGeometry();if(r instanceof Hn||r.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),us(this.nullGeometryFeatures_)||dr(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(s,o){if(o.canWrapX()){const a=o.getExtent();if(!isFinite(s[0])||!isFinite(s[2]))return[[a[0],s[1],a[2],s[3]]];z1(s,o);const l=qe(a);if(qe(s)>l)return[[a[0],s[1],a[2],s[3]]];if(s[0]<a[0])return[[s[0]+l,s[1],a[2],s[3]],[a[0],s[1],s[2],s[3]]];if(s[2]>a[2])return[[s[0],s[1],a[2],s[3]],[a[0],s[1],s[2]-l,s[3]]]}return[s]}(t,e);return[].concat(...i.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||zo,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const u=h.getGeometry(),c=a;if(a=u instanceof Hn?0:u.closestPointXY(i,r,o,a),a<c){s=h;const d=Math.sqrt(a);l[0]=i-d,l[1]=r-d,l[2]=i+d,l[3]=r+d}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=Qt(e),r=e.getGeometry();if(r){const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const s=e.getId();if(void 0!==s){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Ls("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:Qt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&us(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return ps(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ls("featuresloadstart")),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ls("featuresloadend",void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ls("featuresloaderror"))}),r.insert(l,{extent:l.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(r){if(Vo(r.extent,t))return i=r,!0}),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=Qt(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Qt(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(si),delete this.featureChangeKeys_[e];const r=t.getId();return void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Ls("removefeature",t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_){const r=this.idIndex_[i];if(t instanceof Hn&&Array.isArray(r)&&r.includes(t))r.splice(r.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){Me(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(fv(t,this.format_))}},Nx=class extends kx{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedProjection=null,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new sv(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),r=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!r}getTile(t,e,i,r){const s=r.pixelRatio,o=r.viewState.projection,a=this.getLayer();let l=a.getSource().getTile(t,e,i,s,o);return 3==l.getState()&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(l)||(l=l.getInterimTile()),l}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=Fi(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!_u(s,r))return null;const o=e.pixelRatio,a=e.viewState.projection,l=e.viewState,h=i.getRenderSource(),u=h.getTileGridForProjection(l.projection),c=h.getTilePixelRatio(e.pixelRatio);for(let d=u.getZForResolution(l.resolution);d>=u.getMinZoom();--d){const p=u.getTileCoordForCoordAndZ(r,d),f=h.getTile(d,p[1],p[2],o,a);if(!(f instanceof Y_||f instanceof Lf)||f instanceof Lf&&4===f.getState())return null;if(2!==f.getState())continue;const g=u.getOrigin(d),m=Xi(u.getTileSize(d)),y=u.getResolution(d),_=Math.floor(c*((r[0]-g[0])/y-p[1]*m[0])),v=Math.floor(c*((g[1]-r[1])/y-p[2]*m[1])),x=Math.round(c*h.getGutterForProjection(l.projection));return this.getImageData(f.getImage(),_+x,v+x)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,l=r.rotation,h=t.pixelRatio,u=this.getLayer(),c=u.getSource(),d=c.getRevision(),p=c.getTileGridForProjection(s),f=p.getZForResolution(o,c.zDirection),g=p.getResolution(f);let m=t.extent;const y=t.viewState.resolution,_=c.getTilePixelRatio(h),v=Math.round(qe(m)/y*h),x=Math.round(En(m)/y*h),b=i.extent&&Qs(i.extent,s);b&&(m=Ks(m,Qs(i.extent,s)));const M=g*v/2/_,w=g*x/2/_,S=[a[0]-M,a[1]-w,a[0]+M,a[1]+w],R=p.getTileRangeForExtentAndZ(m,f),P={};P[f]={};const A=this.createLoadedTileFinder(c,s,P),T=this.tmpExtent,K=this.tmpTileRange_;this.newTiles_=!1;const N=l?Vp(r.center,y,l,t.size):void 0;for(let It=R.minX;It<=R.maxX;++It)for(let yt=R.minY;yt<=R.maxY;++yt){if(l&&!p.tileCoordIntersectsViewport([f,It,yt],N))continue;const Xt=this.getTile(f,It,yt,t);if(this.isDrawableTile(Xt)){const Ie=Qt(this);if(2==Xt.getState()){P[f][Xt.tileCoord.toString()]=Xt;let De=Xt.inTransition(Ie);De&&1!==i.opacity&&(Xt.endTransition(Ie),De=!1),!this.newTiles_&&(De||!this.renderedTiles.includes(Xt))&&(this.newTiles_=!0)}if(1===Xt.getAlpha(Ie,t.time))continue}const he=p.getTileCoordChildTileRange(Xt.tileCoord,K,T);let Ee=!1;he&&(Ee=A(f+1,he)),Ee||p.forEachTileCoordParentTileRange(Xt.tileCoord,A,K,T)}const F=g/o*h/_;Dr(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-v/2,-x/2);const j=F1(this.pixelTransform);this.useContainer(e,j,this.getBackground(t));const q=this.context,$=q.canvas;Lp(this.inversePixelTransform,this.pixelTransform),Dr(this.tempTransform,v/2,x/2,F,F,0,-v/2,-x/2),$.width!=v||$.height!=x?($.width=v,$.height=x):this.containerReused||q.clearRect(0,0,v,x),b&&this.clipUnrotated(q,t,b),c.getInterpolate()||(q.imageSmoothingEnabled=!1),this.preRender(q,t),this.renderedTiles.length=0;let ct,dt,D,V=Object.keys(P).map(Number);V.sort(ls),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(ct=[],dt=[]):V=V.reverse();for(let It=V.length-1;It>=0;--It){const yt=V[It],Xt=c.getTilePixelSize(yt,h,s),he=p.getResolution(yt)/g,Ee=Xt[0]*he*F,Ie=Xt[1]*he*F,De=p.getTileCoordForCoordAndZ(Gn(S),yt),oi=p.getTileCoordExtent(De),st=Fi(this.tempTransform,[_*(oi[0]-S[0])/g,_*(S[3]-oi[3])/g]),ci=_*c.getGutterForProjection(s),ti=P[yt];for(const Nt in ti){const Ye=ti[Nt],Te=Ye.tileCoord,ye=De[1]-Te[1],Si=Math.round(st[0]-(ye-1)*Ee),Di=De[2]-Te[2],nn=Math.round(st[1]-(Di-1)*Ie),ei=Math.round(st[0]-ye*Ee),mi=Math.round(st[1]-Di*Ie),Ht=Si-ei,An=nn-mi,ii=f===yt,Ke=ii&&1!==Ye.getAlpha(Qt(this),t.time);let Pe=!1;if(!Ke)if(ct){D=[ei,mi,ei+Ht,mi,ei+Ht,mi+An,ei,mi+An];for(let Ne=0,pe=ct.length;Ne<pe;++Ne)if(f!==yt&&yt<dt[Ne]){const Yt=ct[Ne];_i([ei,mi,ei+Ht,mi+An],[Yt[0],Yt[3],Yt[4],Yt[7]])&&(Pe||(q.save(),Pe=!0),q.beginPath(),q.moveTo(D[0],D[1]),q.lineTo(D[2],D[3]),q.lineTo(D[4],D[5]),q.lineTo(D[6],D[7]),q.moveTo(Yt[6],Yt[7]),q.lineTo(Yt[4],Yt[5]),q.lineTo(Yt[2],Yt[3]),q.lineTo(Yt[0],Yt[1]),q.clip())}ct.push(D),dt.push(yt)}else q.clearRect(ei,mi,Ht,An);this.drawTileImage(Ye,t,ei,mi,Ht,An,ci,ii),ct&&!Ke?(Pe&&q.restore(),this.renderedTiles.unshift(Ye)):this.renderedTiles.push(Ye),this.updateUsedTiles(t.usedTiles,c,Ye)}}return this.renderedRevision=d,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Vo(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=s,this.manageTilePyramid(t,c,p,h,s,m,f,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(q,t),i.extent&&q.restore(),q.imageSmoothingEnabled=!0,j!==$.style.transform&&($.style.transform=j),this.container}drawTileImage(t,e,i,r,s,o,a,l){const h=this.getTileImage(t);if(!h)return;const u=Qt(this),c=e.layerStatesArray[e.layerIndex],d=c.opacity*(l?t.getAlpha(u,e.time):1),p=d!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),p&&this.context.restore(),d!==c.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(r,s,o){const a=Qt(r);a in o.usedTiles&&r.expireCache(o.viewState.projection,o.usedTiles[a])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const r=Qt(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}manageTilePyramid(t,e,i,r,s,o,a,l,h){const u=Qt(e);u in t.wantedTiles||(t.wantedTiles[u]={});const c=t.wantedTiles[u],d=t.tileQueue,p=i.getMinZoom(),f=t.viewState.rotation,g=f?Vp(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let m,y,_,v,x,b,M=0;for(b=p;b<=a;++b)for(y=i.getTileRangeForExtentAndZ(o,b,y),_=i.getResolution(b),v=y.minX;v<=y.maxX;++v)for(x=y.minY;x<=y.maxY;++x)f&&!i.tileCoordIntersectsViewport([b,v,x],g)||(a-b<=l?(++M,m=e.getTile(b,v,x,r,s),0==m.getState()&&(c[m.getKey()]=!0,d.isKeyQueued(m.getKey())||d.enqueue([m,u,i.getTileCoordCenter(m.tileCoord),_])),void 0!==h&&h(m)):e.useTile(b,v,x,s));e.updateCacheSize(M,s)}},cE={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},dE={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},pE=class extends Nx{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedPixelToCoordinateTransform_=null,this.tmpTransform_=[1,0,0,1,0,0]}prepareTile(t,e,i){let r;const s=t.getState();return(2===s||3===s)&&(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t)&&(r=!0)),r}getTile(t,e,i,r){const s=r.pixelRatio,o=r.viewState,a=o.resolution,l=o.projection,h=this.getLayer(),u=h.getSource().getTile(t,e,i,s,l),c=r.viewHints,d=!(c[0]||c[1]);return(d||!u.wantedResolution)&&(u.wantedResolution=a),this.prepareTile(u,s,l)&&(d||Date.now()-r.time<8)&&"vector"!==h.getRenderMode()&&this.renderTileImage_(u,r),super.getTile(t,e,i,r)}isDrawableTile(t){const e=this.getLayer();return super.isDrawableTile(t)&&("vector"===e.getRenderMode()?Qt(e)in t.executorGroups:t.hasContext(e))}getTileImage(t){return t.getImage(this.getLayer())}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const r=this.getLayer(),s=r.getRevision(),o=r.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(r);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const h=r.getSource(),u=r.getDeclutter(),c=h.getTileGrid(),d=h.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),p=h.getSourceTiles(e,i,t),f=Qt(r);delete t.hitDetectionImageData[f],t.executorGroups[f]=[],u&&(t.declutterExecutorGroups[f]=[]),l.dirty=!1;for(let g=0,m=p.length;g<m;++g){const y=p[g];if(2!=y.getState())continue;const _=c.getTileCoordExtent(y.tileCoord),v=Ks(d,_),x=ds(v,r.getRenderBuffer()*a,this.tmpExtent),b=Vo(_,v)?null:x,M=new xc(0,x,a,e),w=u?new xc(0,v,a,e):void 0,S=Ax(a,e),R=function(N){let F;const j=N.getStyleFunction()||r.getStyleFunction();if(j&&(F=j(N,a)),F){const q=this.renderFeature(N,S,F,M,w);l.dirty=l.dirty||q}},P=y.getFeatures();o&&o!==l.renderedRenderOrder&&P.sort(o);for(let N=0,F=P.length;N<F;++N){const j=P[N];(!b||_i(b,j.getGeometry().getExtent()))&&R.call(this,j)}const A=M.finish(),T="vector"!==r.getRenderMode()&&u&&1===p.length?null:v,K=new bc(T,a,e,h.getOverlaps(),A,r.getRenderBuffer());if(t.executorGroups[f].push(K),w){const N=new bc(null,a,e,h.getOverlaps(),w.finish(),r.getRenderBuffer());t.declutterExecutorGroups[f].push(N)}}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,r,s){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),h=l.getSource().getTileGridForProjection(e.viewState.projection),u=pl([t]);ds(u,o*i,u);const c={},d=function(g,m,y){let _=g.getId();void 0===_&&(_=Qt(g));const v=c[_];if(v){if(!0!==v&&y<v.distanceSq){if(0===y)return c[_]=!0,s.splice(s.lastIndexOf(v),1),r(g,l,m);v.geometry=m,v.distanceSq=y}}else{if(0===y)return c[_]=!0,r(g,l,m);s.push(c[_]={feature:g,layer:l,geometry:m,distanceSq:y,callback:r})}},p=this.renderedTiles;let f;for(let g=0,m=p.length;!f&&g<m;++g){const y=p[g];if(!_i(h.getTileCoordExtent(y.wrappedTileCoord),u))continue;const _=Qt(l),v=[y.executorGroups[_]],x=y.declutterExecutorGroups[_];x&&v.push(x),v.some(b=>{const M=b===x?e.declutterTree.all().map(w=>w.value):null;for(let w=0,S=b.length;w<S;++w)if(f=b[w].forEachFeatureAtCoordinate(t,o,a,i,d,M),f)return!0})}return f}getFeatures(t){return new Promise((e,i)=>{const r=this.getLayer(),s=Qt(r),o=r.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,u=o.getTileGridForProjection(a),c=Fi(this.renderedPixelToCoordinateTransform_,t.slice()),d=u.getTileCoordForCoordAndResolution(c,h);let p;for(let _=0,v=this.renderedTiles.length;_<v;++_)if(d.toString()===this.renderedTiles[_].tileCoord.toString()){if(p=this.renderedTiles[_],2===p.getState()){const x=u.getTileCoordExtent(p.tileCoord);o.getWrapX()&&a.canWrapX()&&!ps(l,x)&&Yp(c,a);break}p=void 0}if(!p||p.loadingSourceTiles>0)return void e([]);const f=Gn(u.getTileCoordExtent(p.wrappedTileCoord)),g=[(c[0]-f[0])/h,(f[1]-c[1])/h],m=p.getSourceTiles().reduce(function(_,v){return _.concat(v.getFeatures())},[]);let y=p.hitDetectionImageData[s];if(!y){const _=Xi(u.getTileSize(u.getZForResolution(h,o.zDirection))),v=this.renderedRotation_;y=Rx(_,[this.getRenderTransform(u.getTileCoordCenter(p.wrappedTileCoord),h,0,Rn,_[0]*Rn,_[1]*Rn,0)],m,r.getStyleFunction(),u.getTileCoordExtent(p.wrappedTileCoord),p.getReplayState(r).renderedResolution,v),p.hitDetectionImageData[s]=y}e(Fx(g,m,y))})}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t){const e=this.context,i=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();const r=t.viewHints,s=!(r[0]||r[1]),o=this.renderedTiles;for(let a=0,l=o.length;a<l;++a){const h=o[a],u=h.declutterExecutorGroups[Qt(this.getLayer())];if(u)for(let c=u.length-1;c>=0;--c)u[c].execute(this.context,1,this.getTileRenderTransform(h,t),t.viewState.rotation,s,void 0,t.declutterTree)}e.globalAlpha=i}getTileRenderTransform(t,e){const i=e.pixelRatio,r=e.viewState,s=r.center,o=r.resolution,a=r.rotation,l=e.size,h=Math.round(l[0]*i),u=Math.round(l[1]*i),c=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,p=c.getTileCoordExtent(t.wrappedTileCoord),f=c.getTileCoordExtent(d,this.tmpExtent)[0]-p[0];return Op(Ap(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(s,o,a,i,h,u,f))}postRender(t,e){const i=e.viewHints,r=!(i[0]||i[1]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;const s=this.getLayer(),o=s.getRenderMode(),a=t.globalAlpha;t.globalAlpha=s.getOpacity();const l=dE[o],h=e.viewState,u=h.rotation,c=s.getSource(),d=c.getTileGridForProjection(h.projection).getZForResolution(h.resolution,c.zDirection),p=this.renderedTiles,f=[],g=[];let m=!0;for(let y=p.length-1;y>=0;--y){const _=p[y];m=m&&!_.getReplayState(s).dirty;const v=_.executorGroups[Qt(s)].filter(S=>S.hasExecutors(l));if(0===v.length)continue;const x=this.getTileRenderTransform(_,e),b=_.tileCoord[0];let M=!1;const w=v[0].getClipCoords(x);if(w){for(let S=0,R=f.length;S<R;++S)if(d!==b&&b<g[S]){const P=f[S];_i([w[0],w[3],w[4],w[7]],[P[0],P[3],P[4],P[7]])&&(M||(t.save(),M=!0),t.beginPath(),t.moveTo(w[0],w[1]),t.lineTo(w[2],w[3]),t.lineTo(w[4],w[5]),t.lineTo(w[6],w[7]),t.moveTo(P[6],P[7]),t.lineTo(P[4],P[5]),t.lineTo(P[2],P[3]),t.lineTo(P[0],P[1]),t.clip())}f.push(w),g.push(b)}for(let S=0,R=v.length;S<R;++S)v[S].execute(t,1,x,u,r,l);M&&t.restore()}t.globalAlpha=a,this.ready=m,super.postRender(t,e)}renderFeature(t,e,i,r,s){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,l=i.length;a<l;++a)o=wc(r,t,i[a],e,this.boundHandleStyleImageChange_,void 0,s)||o;else o=wc(r,t,i,e,this.boundHandleStyleImageChange_,void 0,s);return o}tileImageNeedsRender_(t){const e=this.getLayer();if("vector"===e.getRenderMode())return!1;const i=t.getReplayState(e),r=e.getRevision();return i.renderedTileResolution!==t.wantedResolution||i.renderedTileRevision!==r}renderTileImage_(t,e){const i=this.getLayer(),r=t.getReplayState(i),s=i.getRevision(),o=t.executorGroups[Qt(i)];r.renderedTileRevision=s;const a=t.wrappedTileCoord,l=a[0],h=i.getSource();let u=e.pixelRatio;const c=e.viewState.projection,d=h.getTileGridForProjection(c),p=d.getResolution(t.tileCoord[0]),f=e.pixelRatio/t.wantedResolution*p,g=d.getResolution(l),m=t.getContext(i);u=Math.round(Math.max(u,f/u));const y=h.getTilePixelSize(l,u,c);m.canvas.width=y[0],m.canvas.height=y[1];const _=u/f;if(1!==_){const M=P1(this.tmpTransform_);Ap(M,_,_),m.setTransform.apply(m,M)}const v=d.getTileCoordExtent(a,this.tmpExtent),x=f/g,b=P1(this.tmpTransform_);Ap(b,x,-x),Op(b,yu(I1,1,0,0,1,-v[0],-v[3]));for(let M=0,w=o.length;M<w;++M)o[M].execute(m,_,b,0,!0,cE[i.getRenderMode()]);r.renderedTileResolution=t.wantedResolution}},oh=class extends Cx{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e);const i=t.renderMode||"hybrid";Me("hybrid"==i||"vector"==i,"`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}createRenderer(){return new pE(this)}getFeatures(t){return super.getFeatures(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get("preload")}getUseInterimTilesOnError(){return this.get("useInterimTilesOnError")}setPreload(t){this.set("preload",t)}setUseInterimTilesOnError(t){this.set("useInterimTilesOnError",t)}};function zx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jx,Gx={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Mc(n){return(n=Math.round(n))<0?0:n>255?255:n}function wg(n){return Mc("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function Sc(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function Cg(n,t,e){return e<0?e+=1:e>1&&(e-=1),6*e<1?n+(t-n)*e*6:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n}try{jx={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in Gx)return Gx[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var r=i.indexOf("("),s=i.indexOf(")");if(-1!==r&&s+1===i.length){var o=i.substr(0,r),a=i.substr(r+1,s-(r+1)).split(","),l=1;switch(o){case"rgba":if(4!==a.length)return null;l=Sc(a.pop());case"rgb":return 3!==a.length?null:[wg(a[0]),wg(a[1]),wg(a[2]),l];case"hsla":if(4!==a.length)return null;l=Sc(a.pop());case"hsl":if(3!==a.length)return null;var h=(parseFloat(a[0])%360+360)%360/360,u=Sc(a[1]),c=Sc(a[2]),d=c<=.5?c*(u+1):c+u-c*u,p=2*c-d;return[Mc(255*Cg(p,d,h+1/3)),Mc(255*Cg(p,d,h)),Mc(255*Cg(p,d,h-1/3)),l];default:return null}}return null}}catch{}class mn{constructor(t,e,i,r=1){this.r=t,this.g=e,this.b=i,this.a=r}static parse(t){if(!t)return;if(t instanceof mn)return t;if("string"!=typeof t)return;const e=jx(t);return e?new mn(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,i,r]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(i)},${r})`}toArray(){const{r:t,g:e,b:i,a:r}=this;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*i/r,r]}toArray01(){const{r:t,g:e,b:i,a:r}=this;return 0===r?[0,0,0,0]:[t/r,e/r,i/r,r]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:i,a:r}=this;return[t,e,i,r]}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1),mn.blue=new mn(0,0,1,1);var Fn=mn;function ah(n){return"object"==typeof n?["literal",n]:n}function Mg(n){switch(n.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function qx(n,t){const e=ah(function(r,s){return void 0!==r?r:void 0!==s?s:void 0}(n.default,t.default));return void 0===e&&"resolvedImage"===t.type?"":e}function Sg(n,t,e){const i=Tg(n,t),r=["get",n.property];if("categorical"===i&&"boolean"==typeof e[0][0]){const s=["case"];for(const o of e)s.push(["==",r,o[0]],o[1]);return s.push(qx(n,t)),s}if("categorical"===i){const s=["match",r];for(const o of e)Ma(s,o[0],o[1],!1);return s.push(qx(n,t)),s}if("interval"===i){const s=["step",["number",r]];for(const o of e)Ma(s,o[0],o[1],!0);return Eg(s),void 0===n.default?s:["case",["==",["typeof",r],"number"],s,ah(n.default)]}if("exponential"===i){const s=void 0!==n.base?n.base:1,o=[Mg(n),1===s?["linear"]:["exponential",s],["number",r]];for(const a of e)Ma(o,a[0],a[1],!1);return void 0===n.default?o:["case",["==",["typeof",r],"number"],o,ah(n.default)]}throw new Error(`Unknown property function type ${i}`)}function Eg(n){"step"===n[0]&&3===n.length&&(n.push(0),n.push(n[3]))}function Ma(n,t,e,i){n.length>3&&t===n[n.length-2]||(i&&2===n.length||n.push(t),n.push(e))}function Tg(n,t){return n.type?n.type:t.expression.interpolated?"exponential":"interval"}function fE(n){const t=["concat"],e=/{([^{}]+)}/g;let i=0;for(let r=e.exec(n);null!==r;r=e.exec(n)){const s=n.slice(i,e.lastIndex-r[0].length);i=e.lastIndex,s.length>0&&t.push(s),t.push(["get",r[1]])}if(1===t.length)return n;if(i<n.length)t.push(n.slice(i));else if(2===t.length)return["to-string",t[1]];return t}class gE extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var Cr=gE;class kg{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[i,r]of e)this.bindings[i]=r}concat(t){return new kg(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var mE=kg;const Ec={kind:"null"},at={kind:"number"},le={kind:"string"},ne={kind:"boolean"},Ur={kind:"color"},Sa={kind:"object"},re={kind:"value"},Tc={kind:"collator"},kc={kind:"formatted"},lh={kind:"resolvedImage"};function Xn(n,t){return{kind:"array",itemType:n,N:t}}function fi(n){if("array"===n.kind){const t=fi(n.itemType);return"number"==typeof n.N?`array<${t}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${t}>`}return n.kind}const yE=[Ec,at,le,ne,Ur,kc,Sa,Xn(re),lh];function hh(n,t){if("error"===t.kind)return null;if("array"===n.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!hh(n.itemType,t.itemType))&&("number"!=typeof n.N||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if("value"===n.kind)for(const e of yE)if(!hh(e,t))return null}return`Expected ${fi(n)} but found ${fi(t)} instead.`}function Ig(n,t){return t.some(e=>e.kind===n.kind)}function uh(n,t){return t.some(e=>"null"===e?null===n:"array"===e?Array.isArray(n):"object"===e?n&&!Array.isArray(n)&&"object"==typeof n:e===typeof n)}class Pg{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rg{constructor(t,e,i,r,s){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=i,this.fontStack=r,this.textColor=s}}class Mr{constructor(t){this.sections=t}static fromString(t){return new Mr([new Rg(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof Mr?t:Mr.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const i={};e.fontStack&&(i["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(i["font-scale"]=e.scale),e.textColor&&(i["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(i)}return t}}class Ds{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ds({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Vx(n,t,e,i){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255?typeof i>"u"||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[n,t,e,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[n,t,e,i]:[n,t,e]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ic(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof Fn||n instanceof Pg||n instanceof Mr||n instanceof Ds)return!0;if(Array.isArray(n)){for(const t of n)if(!Ic(t))return!1;return!0}if("object"==typeof n){for(const t in n)if(!Ic(n[t]))return!1;return!0}return!1}function Oi(n){if(null===n)return Ec;if("string"==typeof n)return le;if("boolean"==typeof n)return ne;if("number"==typeof n)return at;if(n instanceof Fn)return Ur;if(n instanceof Pg)return Tc;if(n instanceof Mr)return kc;if(n instanceof Ds)return lh;if(Array.isArray(n)){const t=n.length;let e;for(const i of n){const r=Oi(i);if(e){if(e===r)continue;e=re;break}e=r}return Xn(e||re,t)}return Sa}function ch(n){const t=typeof n;return null===n?"":"string"===t||"number"===t||"boolean"===t?String(n):n instanceof Fn||n instanceof Mr||n instanceof Ds?n.toString():JSON.stringify(n)}class Fg{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ic(t[1]))return e.error("invalid value");const i=t[1];let r=Oi(i);const s=e.expectedType;return"array"===r.kind&&0===r.N&&s&&"array"===s.kind&&("number"!=typeof s.N||0===s.N)&&(r=s),new Fg(r,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Fn?["rgba"].concat(this.value.toArray()):this.value instanceof Mr?this.value.serialize():this.value}}var Pc=Fg,Bi=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Og={string:le,number:at,boolean:ne,object:Sa};class Ag{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,r=1;const s=t[0];if("array"===s){let a,l;if(t.length>2){const h=t[1];if("string"!=typeof h||!(h in Og)||"object"===h)return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=Og[h],r++}else a=re;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);l=t[2],r++}i=Xn(a,l)}else i=Og[s];const o=[];for(;r<t.length;r++){const a=e.parse(t[r],r,re);if(!a)return null;o.push(a)}return new Ag(i,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!hh(this.type,Oi(i)))return i;if(e===this.args.length-1)throw new Bi(`Expected value to be of type ${fi(this.type)}, but found ${fi(Oi(i))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){e.push(i.kind);const r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map(i=>i.serialize()))}}var Xr=Ag;class Rc{constructor(t){this.type=kc,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const r=[];let s=!1;for(let o=1;o<=t.length-1;++o){const a=t[o];if(s&&"object"==typeof a&&!Array.isArray(a)){s=!1;let l=null;if(a["font-scale"]&&(l=e.parse(a["font-scale"],1,at),!l))return null;let h=null;if(a["text-font"]&&(h=e.parse(a["text-font"],1,Xn(le)),!h))return null;let u=null;if(a["text-color"]&&(u=e.parse(a["text-color"],1,Ur),!u))return null;const c=r[r.length-1];c.scale=l,c.font=h,c.textColor=u}else{const l=e.parse(t[o],1,re);if(!l)return null;const h=l.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");s=!0,r.push({content:l,scale:null,font:null,textColor:null})}}return new Rc(r)}evaluate(t){return new Mr(this.sections.map(e=>{const i=e.content.evaluate(t);return Oi(i)===lh?new Rg("",i,null,null,null):new Rg(ch(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const i={};e.scale&&(i["font-scale"]=e.scale.serialize()),e.font&&(i["text-font"]=e.font.serialize()),e.textColor&&(i["text-color"]=e.textColor.serialize()),t.push(i)}return t}}class Fc{constructor(t){this.type=lh,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,le);return i?new Fc(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=Ds.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _E={"to-boolean":ne,"to-color":Ur,"to-number":at,"to-string":le};class Lg{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const r=_E[i],s=[];for(let o=1;o<t.length;o++){const a=e.parse(t[o],o,re);if(!a)return null;s.push(a)}return new Lg(r,s)}evaluate(t){if("boolean"===this.type.kind)return!!this.args[0].evaluate(t);if("color"===this.type.kind){let e,i;for(const r of this.args){if(e=r.evaluate(t),i=null,e instanceof Fn)return e;if("string"==typeof e){const s=t.parseColor(e);if(s)return s}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:Vx(e[0],e[1],e[2],e[3]),!i))return new Fn(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Bi(i||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const i of this.args){if(e=i.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new Bi(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?Mr.fromString(ch(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ds.fromString(ch(this.args[0].evaluate(t))):ch(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Rc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Fc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(e=>{t.push(e.serialize())}),t}}var Ea=Lg;const vE=["Unknown","Point","LineString","Polygon"];var Zx=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?vE[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:r}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-t[0])+this.featureDistanceData.bearing[1]*(r*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Fn.parse(t)),e}};class Ta{constructor(t,e,i,r){this.name=t,this.type=e,this._evaluate=i,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const i=t[0],r=Ta.definitions[i];if(!r)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const s=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=o.filter(([h])=>!Array.isArray(h)||h.length===t.length-1);let l=null;for(const[h,u]of a){l=new Kx(e.registry,e.path,null,e.scope);const c=[];let d=!1;for(let p=1;p<t.length;p++){const f=t[p],g=Array.isArray(h)?h[p-1]:h.type,m=l.parse(f,1+c.length,g);if(!m){d=!0;break}c.push(m)}if(!d){if(Array.isArray(h)&&h.length!==c.length){l.error(`Expected ${h.length} arguments, but found ${c.length} instead.`);continue}for(let p=0;p<c.length;p++){const f=Array.isArray(h)?h[p]:h.type,g=c[p];l.concat(p+1).checkSubtype(f,g.type)}if(0===l.errors.length)return new Ta(i,s,u,c)}}if(1===a.length)e.errors.push(...l.errors);else{const h=(a.length?a:o).map(([c])=>{return p=c,Array.isArray(p)?`(${p.map(fi).join(", ")})`:`(${fi(p.type)}...)`;var p}).join(" | "),u=[];for(let c=1;c<t.length;c++){const d=e.parse(t[c],1+u.length);if(!d)return null;u.push(fi(d.type))}e.error(`Expected arguments of type ${h}, but found (${u.join(", ")}) instead.`)}return null}static register(t,e){Ta.definitions=e;for(const i in e)t[i]=Ta}}var ka=Ta;class Oc{constructor(t,e,i){this.type=Tc,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,ne);if(!r)return null;const s=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,ne);if(!s)return null;let o=null;return i.locale&&(o=e.parse(i.locale,1,le),!o)?null:new Oc(r,s,o)}evaluate(t){return new Pg(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ns=8192;function Dg(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Ac(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function xE(n,t){const e=(180+n[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(e*r*Ns),Math.round(i*r*Ns)]}function bE(n,t,e){const i=n[0]-t[0],r=n[1]-t[1],s=n[0]-e[0],o=n[1]-e[1];return i*o-s*r==0&&i*s<=0&&r*o<=0}function wE(n,t,e){return t[1]>n[1]!=e[1]>n[1]&&n[0]<(e[0]-t[0])*(n[1]-t[1])/(e[1]-t[1])+t[0]}function Ng(n,t){let e=!1;for(let i=0,r=t.length;i<r;i++){const s=t[i];for(let o=0,a=s.length;o<a-1;o++){if(bE(n,s[o],s[o+1]))return!1;wE(n,s[o],s[o+1])&&(e=!e)}}return e}function CE(n,t){for(let e=0;e<t.length;e++)if(Ng(n,t[e]))return!0;return!1}function Bx(n,t,e,i){const r=i[0]-e[0],s=i[1]-e[1],o=(n[0]-e[0])*s-r*(n[1]-e[1]),a=(t[0]-e[0])*s-r*(t[1]-e[1]);return o>0&&a<0||o<0&&a>0}function ME(n,t,e,i){return 0!==function(s,o){return s[0]*o[1]-s[1]*o[0]}([i[0]-e[0],i[1]-e[1]],[t[0]-n[0],t[1]-n[1]])&&!(!Bx(n,t,e,i)||!Bx(e,i,n,t))}function SE(n,t,e){for(const i of e)for(let r=0;r<i.length-1;++r)if(ME(n,t,i[r],i[r+1]))return!0;return!1}function Wx(n,t){for(let e=0;e<n.length;++e)if(!Ng(n[e],t))return!1;for(let e=0;e<n.length-1;++e)if(SE(n[e],n[e+1],t))return!1;return!0}function EE(n,t){for(let e=0;e<t.length;e++)if(Wx(n,t[e]))return!0;return!1}function zg(n,t,e){const i=[];for(let r=0;r<n.length;r++){const s=[];for(let o=0;o<n[r].length;o++){const a=xE(n[r][o],e);Dg(t,a),s.push(a)}i.push(s)}return i}function Hx(n,t,e){const i=[];for(let r=0;r<n.length;r++){const s=zg(n[r],t,e);i.push(s)}return i}function Ux(n,t,e,i){if(n[0]<e[0]||n[0]>e[2]){const r=.5*i;let s=n[0]-e[0]>r?-i:e[0]-n[0]>r?i:0;0===s&&(s=n[0]-e[2]>r?-i:e[2]-n[0]>r?i:0),n[0]+=s}Dg(t,n)}function Xx(n,t,e,i){const r=Math.pow(2,i.z)*Ns,s=[i.x*Ns,i.y*Ns],o=[];if(!n)return o;for(const a of n)for(const l of a){const h=[l.x+s[0],l.y+s[1]];Ux(h,t,e,r),o.push(h)}return o}function $x(n,t,e,i){const r=Math.pow(2,i.z)*Ns,s=[i.x*Ns,i.y*Ns],o=[];if(!n)return o;for(const a of n){const l=[];for(const h of a){const u=[h.x+s[0],h.y+s[1]];Dg(t,u),l.push(u)}o.push(l)}if(t[2]-t[0]<=r/2){(l=t)[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(const a of o)for(const l of a)Ux(l,t,e,r)}var l;return o}class dh{constructor(t,e){this.type=ne,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ic(t[1])){const i=t[1];if("FeatureCollection"===i.type)for(let r=0;r<i.features.length;++r){const s=i.features[r].geometry.type;if("Polygon"===s||"MultiPolygon"===s)return new dh(i,i.features[r].geometry)}else if("Feature"===i.type){const r=i.geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new dh(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new dh(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(i,r){const s=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if(!a)return!1;if("Polygon"===r.type){const l=zg(r.coordinates,o,a),h=Xx(i.geometry(),s,o,a);if(!Ac(s,o))return!1;for(const u of h)if(!Ng(u,l))return!1}if("MultiPolygon"===r.type){const l=Hx(r.coordinates,o,a),h=Xx(i.geometry(),s,o,a);if(!Ac(s,o))return!1;for(const u of h)if(!CE(u,l))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(i,r){const s=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if(!a)return!1;if("Polygon"===r.type){const l=zg(r.coordinates,o,a),h=$x(i.geometry(),s,o,a);if(!Ac(s,o))return!1;for(const u of h)if(!Wx(u,l))return!1}if("MultiPolygon"===r.type){const l=Hx(r.coordinates,o,a),h=$x(i.geometry(),s,o,a);if(!Ac(s,o))return!1;for(const u of h)if(!EE(u,l))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var jg=dh;function Lc(n){if(n instanceof ka&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof jg)return!1;let t=!0;return n.eachChild(e=>{t&&!Lc(e)&&(t=!1)}),t}function Gg(n){if(n instanceof ka&&"feature-state"===n.name)return!1;let t=!0;return n.eachChild(e=>{t&&!Gg(e)&&(t=!1)}),t}function qg(n,t){if(n instanceof ka&&t.indexOf(n.name)>=0)return!1;let e=!0;return n.eachChild(i=>{e&&!qg(i,t)&&(e=!1)}),e}class Vg{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new Vg(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Yx=Vg;class Zg{constructor(t,e=[],i,r=new mE,s=[]){this.registry=t,this.path=e,this.key=e.map(o=>`[${o}]`).join(""),this.scope=r,this.errors=s,this.expectedType=i}parse(t,e,i,r,s={}){return e?this.concat(e,i,r)._parse(t,s):this._parse(t,s)}_parse(t,e){function i(r,s,o){return"assert"===o?new Xr(s,[r]):"coerce"===o?new Ea(s,[r]):r}if((null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t)&&(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const s=this.registry[r];if(s){let o=s.parse(t,this);if(!o)return null;if(this.expectedType){const a=this.expectedType,l=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==l.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==l.kind&&"string"!==l.kind){if(this.checkSubtype(a,l))return null}else o=i(o,a,e.typeAnnotation||"coerce");else o=i(o,a,e.typeAnnotation||"assert")}if(!(o instanceof Pc)&&"resolvedImage"!==o.type.kind&&Bg(o)){const a=new Zx;try{o=new Pc(o.type,o.evaluate(a))}catch(l){return this.error(l.message),null}}return o}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(typeof t>"u"?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const r="number"==typeof t?this.path.concat(t):this.path,s=i?this.scope.concat(i):this.scope;return new Zg(this.registry,r,e||null,s,this.errors)}error(t,...e){const i=`${this.key}${e.map(r=>`[${r}]`).join("")}`;this.errors.push(new Cr(i,t))}checkSubtype(t,e){const i=hh(t,e);return i&&this.error(i),i}}var Kx=Zg;function Bg(n){if(n instanceof Yx)return Bg(n.boundExpression);if(n instanceof ka&&"error"===n.name||n instanceof Oc||n instanceof jg)return!1;const t=n instanceof Ea||n instanceof Xr;let e=!0;return n.eachChild(i=>{e=t?e&&Bg(i):e&&i instanceof Pc}),!!e&&Lc(n)&&qg(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Jx(n,t){const e=n.length-1;let i,r,s=0,o=e,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),i=n[a],r=n[a+1],i<=t){if(a===e||t<r)return a;s=a+1}else{if(!(i>t))throw new Bi("Input is not a number.");o=a-1}return 0}class Wg{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[r,s]of i)this.labels.push(r),this.outputs.push(s)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,at);if(!i)return null;const r=[];let s=null;e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let o=1;o<t.length;o+=2){const a=1===o?-1/0:t[o],l=t[o+1],h=o,u=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',h);const c=e.parse(l,u,s);if(!c)return null;s=s||c.type,r.push([a,c])}return new Wg(s,i,r)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const s=e.length;return r>=e[s-1]?i[s-1].evaluate(t):i[Jx(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var Qx=Wg,TE=Ia;function Ia(n,t,e,i){this.cx=3*n,this.bx=3*(e-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=i,this.p2x=e,this.p2y=i}Ia.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n},Ia.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n},Ia.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},Ia.prototype.solveCurveX=function(n,t){var e,i,r,s,o;for(typeof t>"u"&&(t=1e-6),r=n,o=0;o<8;o++){if(s=this.sampleCurveX(r)-n,Math.abs(s)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=s/a}if((r=n)<(e=0))return e;if(r>(i=1))return i;for(;e<i;){if(s=this.sampleCurveX(r),Math.abs(s-n)<t)return r;n>s?e=r:i=r,r=.5*(i-e)+e}return r},Ia.prototype.solve=function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))};var kE=zx(TE);function On(n,t,e){return n*(1-e)+t*e}var IE=Object.freeze({__proto__:null,number:On,color:function(t,e,i){return new Fn(On(t.r,e.r,i),On(t.g,e.g,i),On(t.b,e.b,i),On(t.a,e.a,i))},array:function(t,e,i){return t.map((r,s)=>On(r,e[s],i))}});const tb=4/29,Pa=6/29,eb=3*Pa*Pa,PE=Pa*Pa*Pa,RE=Math.PI/180,FE=180/Math.PI;function Hg(n){return n>PE?Math.pow(n,1/3):n/eb+tb}function Ug(n){return n>Pa?n*n*n:eb*(n-tb)}function Xg(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function $g(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function ib(n){const t=$g(n.r),e=$g(n.g),i=$g(n.b),r=Hg((.4124564*t+.3575761*e+.1804375*i)/.95047),s=Hg((.2126729*t+.7151522*e+.072175*i)/1);return{l:116*s-16,a:500*(r-s),b:200*(s-Hg((.0193339*t+.119192*e+.9503041*i)/1.08883)),alpha:n.a}}function nb(n){let t=(n.l+16)/116,e=isNaN(n.a)?t:t+n.a/500,i=isNaN(n.b)?t:t-n.b/200;return t=1*Ug(t),e=.95047*Ug(e),i=1.08883*Ug(i),new Fn(Xg(3.2404542*e-1.5371385*t-.4985314*i),Xg(-.969266*e+1.8760108*t+.041556*i),Xg(.0556434*e-.2040259*t+1.0572252*i),n.alpha)}function OE(n,t,e){const i=t-n;return n+e*(i>180||i<-180?i-360*Math.round(i/360):i)}const Dc={forward:ib,reverse:nb,interpolate:function(t,e,i){return{l:On(t.l,e.l,i),a:On(t.a,e.a,i),b:On(t.b,e.b,i),alpha:On(t.alpha,e.alpha,i)}}},rb=function(t){const{l:e,a:i,b:r}=ib(t),s=Math.atan2(r,i)*FE;return{h:s<0?s+360:s,c:Math.sqrt(i*i+r*r),l:e,alpha:t.a}};class Nc{constructor(t,e,i,r,s){this.type=t,this.operator=e,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(const[o,a]of s)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(t,e,i,r){let s=0;if("exponential"===t.name)s=Yg(e,t.base,i,r);else if("linear"===t.name)s=Yg(e,1,i,r);else if("cubic-bezier"===t.name){const o=t.controlPoints;s=new kE(o[0],o[1],o[2],o[3]).solve(Yg(e,1,i,r))}return s}static parse(t,e){let[i,r,s,...o]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const h=r[1];if("number"!=typeof h)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:h}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const h=r.slice(1);if(4!==h.length||h.some(u=>"number"!=typeof u||u<0||u>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:h}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(s=e.parse(s,2,at),!s)return null;const a=[];let l=null;"interpolate-hcl"===i||"interpolate-lab"===i?l=Ur:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(let h=0;h<o.length;h+=2){const u=o[h],c=o[h+1],d=h+3,p=h+4;if("number"!=typeof u)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(a.length&&a[a.length-1][0]>=u)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);const f=e.parse(c,p,l);if(!f)return null;l=l||f.type,a.push([u,f])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Nc(l,i,r,s,a):e.error(`Type ${fi(l)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const s=e.length;if(r>=e[s-1])return i[s-1].evaluate(t);const o=Jx(e,r),a=Nc.interpolationFactor(this.interpolation,r,e[o],e[o+1]),l=i[o].evaluate(t),h=i[o+1].evaluate(t);return"interpolate"===this.operator?IE[this.type.kind.toLowerCase()](l,h,a):"interpolate-hcl"===this.operator?function(t){const e=t.h*RE,i=t.c;return nb({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})}(function(t,e,i){return{h:OE(t.h,e.h,i),c:On(t.c,e.c,i),l:On(t.l,e.l,i),alpha:On(t.alpha,e.alpha,i)}}(rb(l),rb(h),a)):Dc.reverse(Dc.interpolate(Dc.forward(l),Dc.forward(h),a))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e}}function Yg(n,t,e,i){const r=i-e,s=n-e;return 0===r?0:1===t?s/r:(Math.pow(t,s)-1)/(Math.pow(t,r)-1)}var ho=Nc;class zc{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const r=e.expectedType;r&&"value"!==r.kind&&(i=r);const s=[];for(const o of t.slice(1)){const a=e.parse(o,1+s.length,i,void 0,{typeAnnotation:"omit"});if(!a)return null;i=i||a.type,s.push(a)}return r&&s.some(o=>hh(r,o.type))?new zc(re,s):new zc(i,s)}evaluate(t){let e,i=null,r=0;for(const s of this.args){if(r++,i=s.evaluate(t),i&&i instanceof Ds&&!i.available&&(e||(e=i),i=null,r===this.args.length))return e;if(null!==i)break}return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var sb=zc;class Kg{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let s=1;s<t.length-1;s+=2){const o=t[s];if("string"!=typeof o)return e.error(`Expected string, but found ${typeof o} instead.`,s);if(/[^a-zA-Z0-9_]/.test(o))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);const a=e.parse(t[s+1],s+1);if(!a)return null;i.push([o,a])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return r?new Kg(i,r):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,i]of this.bindings)t.push(e,i.serialize());return t.push(this.result.serialize()),t}}var ob=Kg;class Jg{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,at),r=e.parse(t[2],2,Xn(e.expectedType||re));return i&&r?new Jg(r.type.itemType,i,r):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Bi(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new Bi(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new Bi(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var DE=Jg;class Qg{constructor(t,e){this.type=ne,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,re),r=e.parse(t[2],2,re);return i&&r?Ig(i.type,[ne,le,at,Ec,re])?new Qg(i,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(null==i)return!1;if(!uh(e,["boolean","string","number","null"]))throw new Bi(`Expected first argument to be of type boolean, string, number or null, but found ${fi(Oi(e))} instead.`);if(!uh(i,["string","array"]))throw new Bi(`Expected second argument to be of type array or string, but found ${fi(Oi(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var NE=Qg;class jc{constructor(t,e,i){this.type=at,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,re),r=e.parse(t[2],2,re);if(!i||!r)return null;if(!Ig(i.type,[ne,le,at,Ec,re]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(i.type)} instead`);if(4===t.length){const s=e.parse(t[3],3,at);return s?new jc(i,r,s):null}return new jc(i,r)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!uh(e,["boolean","string","number","null"]))throw new Bi(`Expected first argument to be of type boolean, string, number or null, but found ${fi(Oi(e))} instead.`);if(!uh(i,["string","array"]))throw new Bi(`Expected second argument to be of type array or string, but found ${fi(Oi(i))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return i.indexOf(e,r)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var zE=jc;class t0{constructor(t,e,i,r,s,o){this.inputType=t,this.type=e,this.input=i,this.cases=r,this.outputs=s,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const s={},o=[];for(let h=2;h<t.length-1;h+=2){let u=t[h];const c=t[h+1];Array.isArray(u)||(u=[u]);const d=e.concat(h);if(0===u.length)return d.error("Expected at least one branch label.");for(const f of u){if("number"!=typeof f&&"string"!=typeof f)return d.error("Branch labels must be numbers or strings.");if("number"==typeof f&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return d.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof f&&Math.floor(f)!==f)return d.error("Numeric branch labels must be integer values.");if(i){if(d.checkSubtype(i,Oi(f)))return null}else i=Oi(f);if(typeof s[String(f)]<"u")return d.error("Branch labels must be unique.");s[String(f)]=o.length}const p=e.parse(c,h,r);if(!p)return null;r=r||p.type,o.push(p)}const a=e.parse(t[1],1,re);if(!a)return null;const l=e.parse(t[t.length-1],t.length-1,r);return!l||"value"!==a.type.kind&&e.concat(1).checkSubtype(i,a.type)?null:new t0(i,r,a,s,o,l)}evaluate(t){const e=this.input.evaluate(t);return(Oi(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),i=[],r={};for(const o of e){const a=r[this.cases[o]];void 0===a?(r[this.cases[o]]=i.length,i.push([this.cases[o],[o]])):i[a][1].push(o)}const s=o=>"number"===this.inputType.kind?Number(o):o;for(const[o,a]of i)t.push(1===a.length?s(a[0]):a.map(s)),t.push(this.outputs[o].serialize());return t.push(this.otherwise.serialize()),t}}var jE=t0;class e0{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r=[];for(let o=1;o<t.length-1;o+=2){const a=e.parse(t[o],o,ne);if(!a)return null;const l=e.parse(t[o+1],o+1,i);if(!l)return null;r.push([a,l]),i=i||l.type}const s=e.parse(t[t.length-1],t.length-1,i);return s?new e0(i,r,s):null}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var GE=e0;class Gc{constructor(t,e,i,r){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,re),r=e.parse(t[2],2,at);if(!i||!r)return null;if(!Ig(i.type,[Xn(re),le,re]))return e.error(`Expected first argument to be of type array or string, but found ${fi(i.type)} instead`);if(4===t.length){const s=e.parse(t[3],3,at);return s?new Gc(i.type,i,r,s):null}return new Gc(i.type,i,r)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!uh(e,["string","array"]))throw new Bi(`Expected first argument to be of type array or string, but found ${fi(Oi(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(i,r)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var qE=Gc;function ab(n,t){return"=="===n||"!="===n?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function lb(n,t,e,i){return 0===i.compare(t,e)}function Ra(n,t,e){const i="=="!==n&&"!="!==n;return class Rw{constructor(s,o,a){this.type=ne,this.lhs=s,this.rhs=o,this.collator=a,this.hasUntypedArgument="value"===s.type.kind||"value"===o.type.kind}static parse(s,o){if(3!==s.length&&4!==s.length)return o.error("Expected two or three arguments.");const a=s[0];let l=o.parse(s[1],1,re);if(!l)return null;if(!ab(a,l.type))return o.concat(1).error(`"${a}" comparisons are not supported for type '${fi(l.type)}'.`);let h=o.parse(s[2],2,re);if(!h)return null;if(!ab(a,h.type))return o.concat(2).error(`"${a}" comparisons are not supported for type '${fi(h.type)}'.`);if(l.type.kind!==h.type.kind&&"value"!==l.type.kind&&"value"!==h.type.kind)return o.error(`Cannot compare types '${fi(l.type)}' and '${fi(h.type)}'.`);i&&("value"===l.type.kind&&"value"!==h.type.kind?l=new Xr(h.type,[l]):"value"!==l.type.kind&&"value"===h.type.kind&&(h=new Xr(l.type,[h])));let u=null;if(4===s.length){if("string"!==l.type.kind&&"string"!==h.type.kind&&"value"!==l.type.kind&&"value"!==h.type.kind)return o.error("Cannot use collator to compare non-string types.");if(u=o.parse(s[3],3,Tc),!u)return null}return new Rw(l,h,u)}evaluate(s){const o=this.lhs.evaluate(s),a=this.rhs.evaluate(s);if(i&&this.hasUntypedArgument){const l=Oi(o),h=Oi(a);if(l.kind!==h.kind||"string"!==l.kind&&"number"!==l.kind)throw new Bi(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${l.kind}, ${h.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const l=Oi(o),h=Oi(a);if("string"!==l.kind||"string"!==h.kind)return t(s,o,a)}return this.collator?e(s,o,a,this.collator.evaluate(s)):t(s,o,a)}eachChild(s){s(this.lhs),s(this.rhs),this.collator&&s(this.collator)}outputDefined(){return!0}serialize(){const s=[n];return this.eachChild(o=>{s.push(o.serialize())}),s}}}const VE=Ra("==",function(t,e,i){return e===i},lb),ZE=Ra("!=",function(t,e,i){return e!==i},function(t,e,i,r){return!lb(0,e,i,r)}),BE=Ra("<",function(t,e,i){return e<i},function(t,e,i,r){return r.compare(e,i)<0}),WE=Ra(">",function(t,e,i){return e>i},function(t,e,i,r){return r.compare(e,i)>0}),HE=Ra("<=",function(t,e,i){return e<=i},function(t,e,i,r){return r.compare(e,i)<=0}),UE=Ra(">=",function(t,e,i){return e>=i},function(t,e,i,r){return r.compare(e,i)>=0});class i0{constructor(t,e,i,r,s,o){this.type=le,this.number=t,this.locale=e,this.currency=i,this.unit=r,this.minFractionDigits=s,this.maxFractionDigits=o}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,at);if(!i)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let s=null;if(r.locale&&(s=e.parse(r.locale,1,le),!s))return null;let o=null;if(r.currency&&(o=e.parse(r.currency,1,le),!o))return null;let a=null;if(r.unit&&(a=e.parse(r.unit,1,le),!a))return null;let l=null;if(r["min-fraction-digits"]&&(l=e.parse(r["min-fraction-digits"],1,at),!l))return null;let h=null;return r["max-fraction-digits"]&&(h=e.parse(r["max-fraction-digits"],1,at),!h)?null:new i0(i,s,o,a,l,h)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class n0{constructor(t){this.type=at,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${fi(i.type)} instead.`):new n0(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e||Array.isArray(e))return e.length;throw new Bi(`Expected value to be of type string or array, but found ${fi(Oi(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const hb={"==":VE,"!=":ZE,">":WE,"<":BE,">=":UE,"<=":HE,array:Xr,at:DE,boolean:Xr,case:GE,coalesce:sb,collator:Oc,format:Rc,image:Fc,in:NE,"index-of":zE,interpolate:ho,"interpolate-hcl":ho,"interpolate-lab":ho,length:n0,let:ob,literal:Pc,match:jE,number:Xr,"number-format":i0,object:Xr,slice:qE,step:Qx,string:Xr,"to-boolean":Ea,"to-color":Ea,"to-number":Ea,"to-string":Ea,var:Yx,within:jg};function ub(n,[t,e,i,r]){t=t.evaluate(n),e=e.evaluate(n),i=i.evaluate(n);const s=r?r.evaluate(n):1,o=Vx(t,e,i,s);if(o)throw new Bi(o);return new Fn(t/255*s,e/255*s,i/255*s,s)}function cb(n,t){return n in t}function r0(n,t){const e=t[n];return typeof e>"u"?null:e}function uo(n){return{type:n}}ka.register(hb,{error:[{kind:"error"},[le],(n,[t])=>{throw new Bi(t.evaluate(n))}],typeof:[le,[re],(n,[t])=>fi(Oi(t.evaluate(n)))],"to-rgba":[Xn(at,4),[Ur],(n,[t])=>t.evaluate(n).toArray()],rgb:[Ur,[at,at,at],ub],rgba:[Ur,[at,at,at,at],ub],has:{type:ne,overloads:[[[le],(n,[t])=>cb(t.evaluate(n),n.properties())],[[le,Sa],(n,[t,e])=>cb(t.evaluate(n),e.evaluate(n))]]},get:{type:re,overloads:[[[le],(n,[t])=>r0(t.evaluate(n),n.properties())],[[le,Sa],(n,[t,e])=>r0(t.evaluate(n),e.evaluate(n))]]},"feature-state":[re,[le],(n,[t])=>r0(t.evaluate(n),n.featureState||{})],properties:[Sa,[],n=>n.properties()],"geometry-type":[le,[],n=>n.geometryType()],id:[re,[],n=>n.id()],zoom:[at,[],n=>n.globals.zoom],pitch:[at,[],n=>n.globals.pitch||0],"distance-from-center":[at,[],n=>n.distanceFromCenter()],"heatmap-density":[at,[],n=>n.globals.heatmapDensity||0],"line-progress":[at,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[at,[],n=>n.globals.skyRadialProgress||0],accumulated:[re,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[at,uo(at),(n,t)=>{let e=0;for(const i of t)e+=i.evaluate(n);return e}],"*":[at,uo(at),(n,t)=>{let e=1;for(const i of t)e*=i.evaluate(n);return e}],"-":{type:at,overloads:[[[at,at],(n,[t,e])=>t.evaluate(n)-e.evaluate(n)],[[at],(n,[t])=>-t.evaluate(n)]]},"/":[at,[at,at],(n,[t,e])=>t.evaluate(n)/e.evaluate(n)],"%":[at,[at,at],(n,[t,e])=>t.evaluate(n)%e.evaluate(n)],ln2:[at,[],()=>Math.LN2],pi:[at,[],()=>Math.PI],e:[at,[],()=>Math.E],"^":[at,[at,at],(n,[t,e])=>Math.pow(t.evaluate(n),e.evaluate(n))],sqrt:[at,[at],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[at,[at],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[at,[at],(n,[t])=>Math.log(t.evaluate(n))],log2:[at,[at],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[at,[at],(n,[t])=>Math.sin(t.evaluate(n))],cos:[at,[at],(n,[t])=>Math.cos(t.evaluate(n))],tan:[at,[at],(n,[t])=>Math.tan(t.evaluate(n))],asin:[at,[at],(n,[t])=>Math.asin(t.evaluate(n))],acos:[at,[at],(n,[t])=>Math.acos(t.evaluate(n))],atan:[at,[at],(n,[t])=>Math.atan(t.evaluate(n))],min:[at,uo(at),(n,t)=>Math.min(...t.map(e=>e.evaluate(n)))],max:[at,uo(at),(n,t)=>Math.max(...t.map(e=>e.evaluate(n)))],abs:[at,[at],(n,[t])=>Math.abs(t.evaluate(n))],round:[at,[at],(n,[t])=>{const e=t.evaluate(n);return e<0?-Math.round(-e):Math.round(e)}],floor:[at,[at],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[at,[at],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[ne,[le,re],(n,[t,e])=>n.properties()[t.value]===e.value],"filter-id-==":[ne,[re],(n,[t])=>n.id()===t.value],"filter-type-==":[ne,[le],(n,[t])=>n.geometryType()===t.value],"filter-<":[ne,[le,re],(n,[t,e])=>{const i=n.properties()[t.value],r=e.value;return typeof i==typeof r&&i<r}],"filter-id-<":[ne,[re],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e<i}],"filter->":[ne,[le,re],(n,[t,e])=>{const i=n.properties()[t.value],r=e.value;return typeof i==typeof r&&i>r}],"filter-id->":[ne,[re],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e>i}],"filter-<=":[ne,[le,re],(n,[t,e])=>{const i=n.properties()[t.value],r=e.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[ne,[re],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e<=i}],"filter->=":[ne,[le,re],(n,[t,e])=>{const i=n.properties()[t.value],r=e.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[ne,[re],(n,[t])=>{const e=n.id(),i=t.value;return typeof e==typeof i&&e>=i}],"filter-has":[ne,[re],(n,[t])=>t.value in n.properties()],"filter-has-id":[ne,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[ne,[Xn(le)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[ne,[Xn(re)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[ne,[le,Xn(re)],(n,[t,e])=>e.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[ne,[le,Xn(re)],(n,[t,e])=>function(r,s,o,a){for(;o<=a;){const l=o+a>>1;if(s[l]===r)return!0;s[l]>r?a=l-1:o=l+1}return!1}(n.properties()[t.value],e.value,0,e.value.length-1)],all:{type:ne,overloads:[[[ne,ne],(n,[t,e])=>t.evaluate(n)&&e.evaluate(n)],[uo(ne),(n,t)=>{for(const e of t)if(!e.evaluate(n))return!1;return!0}]]},any:{type:ne,overloads:[[[ne,ne],(n,[t,e])=>t.evaluate(n)||e.evaluate(n)],[uo(ne),(n,t)=>{for(const e of t)if(e.evaluate(n))return!0;return!1}]]},"!":[ne,[ne],(n,[t])=>!t.evaluate(n)],"is-supported-script":[ne,[le],(n,[t])=>{const e=n.globals&&n.globals.isSupportedScript;return!e||e(t.evaluate(n))}],upcase:[le,[le],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[le,[le],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[le,uo(re),(n,t)=>t.map(e=>ch(e.evaluate(n))).join("")],"resolved-locale":[le,[Tc],(n,[t])=>t.evaluate(n).resolvedLocale()]});var db=hb;function s0(n){return{result:"success",value:n}}function Fa(n){return{result:"error",value:n}}function pb(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}class XE{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Zx,this._defaultValue=e?function(r){return"color"===r.type&&(pb(r.default)||Array.isArray(r.default))?new Fn(0,0,0,0):"color"===r.type?Fn.parse(r.default)||null:void 0===r.default?null:r.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,r,s,o,a,l){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=r||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,r,s,o,a,l){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=l||null;try{const h=this.expression.evaluate(this._evaluator);if(null==h||"number"==typeof h&&h!=h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new Bi(`Expected value to be one of ${Object.keys(this._enumValues).map(u=>JSON.stringify(u)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function o0(n,t){const e=new Kx(db,[],t?function(s){const o={color:Ur,string:le,number:at,enum:le,boolean:ne,formatted:kc,resolvedImage:lh};return"array"===s.type?Xn(o[s.value]||re,s.length):o[s.type]}(t):void 0),i=e.parse(n,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?s0(new XE(i,t)):Fa(e.errors)}class $E{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Gg(e.expression)}evaluateWithoutErrorHandling(t,e,i,r,s,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,s,o)}evaluate(t,e,i,r,s,o){return this._styleExpression.evaluate(t,e,i,r,s,o)}}class YE{constructor(t,e,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Gg(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,i,r,s,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,s,o)}evaluate(t,e,i,r,s,o){return this._styleExpression.evaluate(t,e,i,r,s,o)}interpolationFactor(t,e,i){return this.interpolationType?ho.interpolationFactor(this.interpolationType,t,e,i):0}}function KE(n,t){if("error"===(n=o0(n,t)).result)return n;const e=n.value.expression,i=Lc(e);if(!i&&"data-driven"!==t["property-type"])return Fa([new Cr("","data expressions not supported")]);const r=qg(e,["zoom","pitch","distance-from-center"]);if(!(r||(a=t,a.expression&&a.expression.parameters.indexOf("zoom")>-1)))return Fa([new Cr("","zoom expressions not supported")]);var a;const s=qc(e);return s||r?s instanceof Cr?Fa([s]):s instanceof ho&&!function(a){return!!a.expression&&a.expression.interpolated}(t)?Fa([new Cr("",'"interpolate" expressions cannot be used with this property')]):s0(s?new YE(i?"camera":"composite",n.value,s.labels,s instanceof ho?s.interpolation:void 0):new $E(i?"constant":"source",n.value)):Fa([new Cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function qc(n){let t=null;if(n instanceof ob)t=qc(n.result);else if(n instanceof sb){for(const e of n.args)if(t=qc(e),t)break}else(n instanceof Qx||n instanceof ho)&&n.input instanceof ka&&"zoom"===n.input.name&&(t=n);return t instanceof Cr||n.eachChild(e=>{const i=qc(e);i instanceof Cr?t=i:!t&&i?t=new Cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new Cr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function a0(n){if(Array.isArray(n))return n.map(a0);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const e in n)t[e]=a0(n[e]);return t}return(e=n)instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e;var e}var fb={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["fill-extrusion-edge-radius"]}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function gb(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!gb(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function JE(n,t="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gb(n)||(n=Vc(n));const e=n;let i=!0;try{i=function(u){if(!Oa(u))return u;let c=a0(u);return yb(c),c=mb(c),c}(e)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(e,null,2)}\n        `)}const r=fb[`filter_${t}`],s=o0(i,r);let o=null;if("error"===s.result)throw new Error(s.value.map(h=>`${h.key}: ${h.message}`).join(", "));o=(h,u,c)=>s.value.evaluate(h,u,{},c);let a=null,l=null;if(i!==e){const h=o0(e,r);if("error"===h.result)throw new Error(h.value.map(u=>`${u.key}: ${u.message}`).join(", "));a=(u,c,d,p,f)=>h.value.evaluate(u,c,{},d,void 0,void 0,p,f),l=!Lc(h.value.expression)}return{filter:o,dynamicFilter:a||void 0,needGeometry:_b(i),needFeature:!!l}}function mb(n){if(!Array.isArray(n))return n;const t=function(i){if(QE.has(i[0]))for(let r=1;r<i.length;r++)if(Oa(i[r]))return!0;return i}(n);return!0===t?t:t.map(e=>mb(e))}function yb(n){let t=!1;const e=[];if("case"===n[0]){for(let i=1;i<n.length-1;i+=2)t=t||Oa(n[i]),e.push(n[i+1]);e.push(n[n.length-1])}else if("match"===n[0]){t=t||Oa(n[1]);for(let i=2;i<n.length-1;i+=2)e.push(n[i+1]);e.push(n[n.length-1])}else if("step"===n[0]){t=t||Oa(n[1]);for(let i=1;i<n.length-1;i+=2)e.push(n[i+1])}t&&(n.length=0,n.push("any",...e));for(let i=1;i<n.length;i++)yb(n[i])}function Oa(n){if(!Array.isArray(n))return!1;if(function(e){return"pitch"===e||"distance-from-center"===e}(n[0]))return!0;for(let t=1;t<n.length;t++)if(Oa(n[t]))return!0;return!1}const QE=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function tT(n,t){return n<t?-1:n>t?1:0}function _b(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let t=1;t<n.length;t++)if(_b(n[t]))return!0;return!1}function Vc(n){if(!n)return!0;const t=n[0];return n.length<=1?"any"!==t:"=="===t?l0(n[1],n[2],"=="):"!="===t?Zc(l0(n[1],n[2],"==")):"<"===t||">"===t||"<="===t||">="===t?l0(n[1],n[2],t):"any"===t?function(i){return["any"].concat(i.map(Vc))}(n.slice(1)):"all"===t?["all"].concat(n.slice(1).map(Vc)):"none"===t?["all"].concat(n.slice(1).map(Vc).map(Zc)):"in"===t?vb(n[1],n.slice(2)):"!in"===t?Zc(vb(n[1],n.slice(2))):"has"===t?xb(n[1]):"!has"===t?Zc(xb(n[1])):"within"!==t||n}function l0(n,t,e){switch(n){case"$type":return[`filter-type-${e}`,t];case"$id":return[`filter-id-${e}`,t];default:return[`filter-${e}`,n,t]}}function vb(n,t){if(0===t.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",n,["literal",t.sort(tT)]]:["filter-in-small",n,["literal",t]]}}function xb(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Zc(n){return["!",n]}var eT=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function iT(n,t){const e={};for(const i in n)"ref"!==i&&(e[i]=n[i]);return eT.forEach(i=>{i in t&&(e[i]=t[i])}),e}var bb={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},wb=/(italic|oblique)$/i,Cb={},h0=zx(function(n,t,e){var i=Cb[n];if(!i){Array.isArray(n)||(n=[n]);for(var r,s,o=400,a="normal",l=[],h=0,u=n.length;h<u;++h){var c=n[h].split(" "),d=c[c.length-1].toLowerCase();for(var p in"normal"==d||"italic"==d||"oblique"==d?(a=s?a:d,s=!0,c.pop(),d=c[c.length-1].toLowerCase()):wb.test(d)&&(d=d.replace(wb,""),a=s?a:c[c.length-1].replace(d,""),s=!0),bb){var f=c.length>1?c[c.length-2].toLowerCase():"";if(d==p||d==p.replace("-","")||f+"-"+d==p){o=r?o:bb[p],c.pop(),f&&p.startsWith(f)&&c.pop();break}}!r&&"number"==typeof d&&(o=d,r=!0);var g=c.join(" ").replace("Klokantech Noto Sans","Noto Sans");-1!==g.indexOf(" ")&&(g='"'+g+'"'),l.push(g)}i=Cb[n]=[a,o,l]}return i[0]+" "+i[1]+" "+t+"px"+(e?"/"+e:"")+" "+i[2]});const Mb="https://api.mapbox.com";function u0(n){return 0!==n.indexOf("mapbox://")?"":n.slice(9)}function Sb(n,t){const e=u0(n);if(!e)return decodeURI(new URL(n,location.href).href);if(0!==e.indexOf("styles/"))throw new Error(`unexpected style url: ${n}`);const i=e.slice(7);return`${Mb}/styles/v1/${i}?&access_token=${t}`}function Bc(n,t,e,i){const r=new URL(n,i),s=u0(n);return s?"mapbox.satellite"===s?`https://api.mapbox.com/v4/${s}/{z}/{x}/{y}${window.devicePixelRatio>=1.5?"@2x":""}.webp?access_token=${t}`:`https://{a-d}.tiles.mapbox.com/v4/${s}/{z}/{x}/{y}.vector.pbf?access_token=${t}`:(t&&(r.searchParams.has(e)||r.searchParams.set(e,t)),decodeURI(r.href))}const Eb={},Tb={};let nT=0;function c0(n){return n.id||(n.id=nT++),n.id}function d0(n){return n*Math.PI/180}const Wc=function(){const n=[];for(let t=78271.51696402048;n.length<=24;t/=2)n.push(t);return n}();function kb(n,t){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(n,t);const e=document.createElement("canvas");return e.width=n,e.height=t,e}new xs({extent:Se("EPSG:3857").getExtent(),resolutions:Wc});const Aa={};function La(n,t,e={},i){if(t in Aa)return i&&(i.request=Aa[t][0]),Aa[t][1];const r=e.transformRequest&&e.transformRequest(t,n)||t,s=pu(()=>r).then(o=>(o instanceof Request||(o=new Request(o)),o.headers.get("Accept")||o.headers.set("Accept","application/json"),i&&(i.request=o),fetch(o).then(function(a){return delete Aa[t],a.ok?a.json():Promise.reject(new Error("Error fetching source "+t))}).catch(function(a){return delete Aa[t],Promise.reject(new Error("Error fetching source "+t))})));return Aa[t]=[r,s],s}const Ib={};function Pb(n,t,e,i){const r=document.createElement("canvas"),s=[2*e*t.pixelRatio+t.width,2*e*t.pixelRatio+t.height];r.width=s[0],r.height=s[1];const o=r.getContext("2d");o.drawImage(n,t.x,t.y,t.width,t.height,e*t.pixelRatio,e*t.pixelRatio,t.width,t.height);const a=o.getImageData(0,0,s[0],s[1]);o.globalCompositeOperation="destination-over",o.fillStyle=`rgba(${255*i.r},${255*i.g},${255*i.b},${i.a})`;const l=a.data;for(let h=0,u=a.width;h<u;++h)for(let c=0,d=a.height;c<d;++c)l[4*(c*u+h)+3]>0&&o.arc(h,c,e*t.pixelRatio,0,2*Math.PI);return o.fill(),r}function rT(n,t,e){const i=Math.max(0,Math.min(1,(e-n)/(t-n)));return i*i*(3-2*i)}function Rb(n,t,e){const i=document.createElement("canvas");i.width=t.width,i.height=t.height;const r=i.getContext("2d");r.drawImage(n,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const s=r.getImageData(0,0,t.width,t.height),o=s.data;for(let a=0,l=s.width;a<l;++a)for(let h=0,u=s.height;h<u;++h){const c=4*(h*l+a),d=.75,p=.1,f=rT(d-p,d+p,o[c+3]/255);f>0?(o[c+0]=Math.round(255*e.r*f),o[c+1]=Math.round(255*e.g*f),o[c+2]=Math.round(255*e.b*f),o[c+3]=Math.round(255*f)):o[c+3]=0}return r.putImageData(s,0,0),i}const sT=Array(256).join("\u200a");function p0(n,t){if(t>=.05){let e="";const i=n.split("\n"),r=sT.slice(0,Math.round(t/.1));for(let s=0,o=i.length;s<o;++s)s>0&&(e+="\n"),e+=i[s].split("").join(r);return e}return n}let f0;function Fb(){return f0||(f0=kb(1,1).getContext("2d")),f0}function co(n,t){return Fb().measureText(n).width+(n.length-1)*t}const Ob={};function g0(n,t,e,i){if(-1!==n.indexOf("\n")){const o=n.split("\n"),a=[];for(let l=0,h=o.length;l<h;++l)a.push(g0(o[l],t,e,i));return a.join("\n")}const r=e+","+t+","+n+","+i;let s=Ob[r];if(!s){const o=n.split(" ");if(o.length>1){const a=Fb();a.font=t;const l=a.measureText("M").width*e;let h="";const u=[];for(let c=0,d=o.length;c<d;++c){const p=o[c],f=h+(h?" ":"")+p;co(f,i)<=l?h=f:(h&&u.push(h),h=p)}h&&u.push(h);for(let c=0,d=u.length;c<d&&d>1;++c){const p=u[c];if(co(p,i)<.35*l){const f=c>0?co(u[c-1],i):1/0,g=c<d-1?co(u[c+1],i):1/0;u.splice(c,1),d-=1,f<g?(u[c-1]+=" "+p,c-=1):u[c]=p+" "+u[c]}}for(let c=0,d=u.length-1;c<d;++c){const p=u[c],f=u[c+1];if(co(p,i)>.7*l&&co(f,i)<.6*l){const g=p.split(" "),m=g.pop();co(m,i)<.2*l&&(u[c]=g.join(" "),u[c+1]=m+" "+f),d-=1}}s=u.join("\n")}else s=n;s=p0(s,i),Ob[r]=s}return s}const oT=/font-family: ?([^;]*);/,aT=/("|')/g;let Hc;function lT(n){if(!Hc){Hc={};const t=document.styleSheets;for(let e=0,i=t.length;e<i;++e){const r=t[e];try{const s=r.rules||r.cssRules;if(s)for(let o=0,a=s.length;o<a;++o){const l=s[o];if(5==l.type){const h=l.cssText.match(oT);Hc[h[1].replace(aT,"")]=!0}}}catch{}}}return n in Hc}const m0={};function hT(n,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const e=n.toString();if(e in m0)return m0[e];const i=[];for(let r=0,s=n.length;r<s;++r){n[r]=n[r].replace("Arial Unicode MS","Arial");const o=h0(n[r],1);j_(o);const a=o.split(" ");i.push([a.slice(3).join(" ").replace(/"/g,""),a[1],a[0]])}for(let r=0,s=i.length;r<s;++r){const o=i[r],a=o[0];if(!lT(a)&&100!==gr.get(`${o[2]}\n${o[1]} \n${a}`)){const l=t.replace("{font-family}",a.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",a.replace(/ /g,"+")).replace("{fontweight}",o[1]).replace("{-fontstyle}",o[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",o[2]);if(!document.querySelector('link[href="'+l+'"]')){const h=document.createElement("link");h.href=l,h.rel="stylesheet",document.head.appendChild(h)}}}return m0[e]=n,n}const uT={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},cT={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},dT=function(n,t){const e=KE(n,t);if("error"===e.result)throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return e.value},y0={},Uc={zoom:0};let Xc,_0;function Gt(n,t,e,i,r,s,o){const a=n.id;s||(s={},console.warn("No functionCache provided to getValue()")),s[a]||(s[a]={});const l=s[a];if(!l[e]){let h=(n[t]||y0)[e];const u=fb[`${t}_${n.type}`][e];void 0===h&&(h=u.default);let c=(p=h,Array.isArray(p)&&p.length>0&&"string"==typeof p[0]&&p[0]in db);if(!c&&pb(h)&&(h=function(p,f){let g=p.stops;if(!g)return function(x,b){const M=["get",x.property];if(void 0===x.default)return"string"===b.type?["string",M]:M;if("enum"===b.type)return["match",M,Object.keys(b.values),M,x.default];{const w=["color"===b.type?"to-color":b.type,M,ah(x.default)];return"array"===b.type&&w.splice(1,0,b.value,b.length||null),w}}(p,f);const m=g&&"object"==typeof g[0][0],y=m||void 0!==p.property,_=m||!y;return g=g.map(v=>!y&&f.tokens&&"string"==typeof v[1]?[v[0],fE(v[1])]:[v[0],ah(v[1])]),m?function(x,b,M){const w={},S={},R=[];for(let P=0;P<M.length;P++){const A=M[P],T=A[0].zoom;void 0===w[T]&&(w[T]={zoom:T,type:x.type,property:x.property,default:x.default},S[T]=[],R.push(T)),S[T].push([A[0].value,A[1]])}if("exponential"===Tg({},b)){const P=[Mg(x),["linear"],["zoom"]];for(const A of R)Ma(P,A,Sg(w[A],b,S[A]),!1);return P}{const P=["step",["zoom"]];for(const A of R)Ma(P,A,Sg(w[A],b,S[A]),!0);return Eg(P),P}}(p,f,g):_?function(x,b,M,w=["zoom"]){const S=Tg(x,b);let R,P=!1;if("interval"===S)R=["step",w],P=!0;else{if("exponential"!==S)throw new Error(`Unknown zoom function type "${S}"`);{const A=void 0!==x.base?x.base:1;R=[Mg(x),1===A?["linear"]:["exponential",A],w]}}for(const A of M)Ma(R,A[0],A[1],P);return Eg(R),R}(p,f,g):Sg(p,f,g)}(h,u),c=!0),c){const d=dT(h,u);l[e]=d.evaluate.bind(d)}else"color"==u.type&&(h=Fn.parse(h)),l[e]=function(){return h}}var p;return Uc.zoom=i,l[e](Uc,r,o)}function Ab(n,t,e,i,r){return Gt(n,"layout",`${i}-allow-overlap`,t,e,r)?Gt(n,"layout",`${i}-ignore-placement`,t,e,r)?"none":"obstacle":"declutter"}function pT(n,t,e,i,r){return r||console.warn("No filterCache provided to evaluateFilter()"),n in r||(r[n]=JE(t).filter),Uc.zoom=i,r[n](Uc,e)}let fT=!1;function po(n,t){if(n){if(!fT&&(0===n.a||0===t))return;const e=n.a;return t=void 0===t?1:t,0===e?"transparent":"rgba("+Math.round(255*n.r/e)+","+Math.round(255*n.g/e)+","+Math.round(255*n.b/e)+","+e*t+")"}return n}const gT=/\{[^{}}]*\}/g;function v0(n,t){return n.replace(gT,function(e){return t[e.slice(1,-1)]||""})}let Lb=!1;const mT={};function _T(n,t=512){return n.getExtent()?Bu({extent:n.getExtent(),tileSize:t,maxZoom:22}).getResolutions():Wc}function Db(n,t,e="",i={},r=void 0){let s,o,a,l,h=!0;return"string"==typeof e||Array.isArray(e)?l=e:(a=e,l=a.source||a.layers,i=a),"string"==typeof i?(s=i,a={}):(s=i.styleUrl,a=i),!1===a.updateSource&&(h=!1),r||(r=a.resolutions),!s&&"string"==typeof t&&!t.trim().startsWith("{")&&(s=t),s&&(s=s.startsWith("data:")?location.href:Sb(s,a.accessToken),c=s,(d=a).accessToken||(d=Object.assign({},d),new URL(c).searchParams.forEach((p,f)=>{d.accessToken=p,d.accessTokenParam=f})),a=d),new Promise(function(u,c){(function(p,f){if("string"!=typeof p)return Promise.resolve(p);if(!p.trim().startsWith("{"))return La("Style",p=Sb(p,f.accessToken),f);try{const g=JSON.parse(p);return Promise.resolve(g)}catch(g){return Promise.reject(g)}})(t,a).then(function(d){if(8!=d.version)return c(new Error("glStyle version 8 required."));if(!(n instanceof Cc||n instanceof oh))return c(new Error("Can only apply to VectorLayer or VectorTileLayer"));const p=n instanceof oh?"vector":"geojson";if(l?o=Array.isArray(l)?d.layers.find(function(x){return x.id===l[0]}).source:l:(o=Object.keys(d.sources).find(function(x){return d.sources[x].type===p}),l=o),!o)return c(new Error(`No ${p} source found in the glStyle.`));function f(){if(!h)return Promise.resolve();if(n instanceof oh)return(S=d.sources[o],R=s,P=a,new Promise(function(A,T){(function(N,F,j={}){const q=[F,JSON.stringify(N)].toString();let $=Ib[q];if(!$||j.transformRequest){let ct;j.transformRequest&&(ct=(D,V)=>{const It=j.transformRequest&&j.transformRequest(V,"Tiles")||V;if(D instanceof cv)D.setLoader((yt,Xt,he)=>{pu(()=>It).then(Ee=>{fetch(Ee).then(Ie=>Ie.arrayBuffer()).then(Ie=>{const De=D.getFormat().readFeatures(Ie,{extent:yt,featureProjection:he});D.setFeatures(De)}).catch(Ie=>D.setState(3))})});else{const yt=D.getImage();pu(()=>It).then(Xt=>{Xt instanceof Request?fetch(Xt).then(he=>he.blob()).then(he=>{const Ee=URL.createObjectURL(he);yt.addEventListener("load",()=>URL.revokeObjectURL(Ee)),yt.addEventListener("error",()=>URL.revokeObjectURL(Ee)),yt.src=Ee}).catch(he=>D.setState(3)):yt.src=Xt})}});const dt=N.url;if(dt&&!N.tiles){const D=Bc(dt,j.accessToken,j.accessTokenParam||"access_token",F||location.href);if(dt.startsWith("mapbox://"))$=Promise.resolve({tileJson:Object.assign({},N,{url:void 0,tiles:zf(D)}),tileLoadFunction:ct});else{const V={};$=La("Source",D,j,V).then(function(It){return It.tiles=It.tiles.map(function(yt){return"tms"===It.scheme&&(yt=yt.replace("{y}","{-y}")),Bc(yt,j.accessToken,j.accessTokenParam||"access_token",V.request.url)}),Promise.resolve({tileJson:It,tileLoadFunction:ct})})}}else N=Object.assign({},N,{tiles:N.tiles.map(function(D){return"tms"===N.scheme&&(D=D.replace("{y}","{-y}")),Bc(D,j.accessToken,j.accessTokenParam||"access_token",F||location.href)})}),$=Promise.resolve({tileJson:Object.assign({},N),tileLoadFunction:ct});Ib[q]=$}return $})(S,R,P).then(function({tileJson:K,tileLoadFunction:N}){const F=function(q,$,ct){const dt=new WS({tileJSON:$,tileSize:q.tileSize||$.tileSize||512}),D=dt.getTileJSON(),V=dt.getTileGrid(),It=Se(ct.projection||"EPSG:3857"),yt=function(oi,st){const ci=oi.bounds;if(ci){const ti=u_([ci[0],ci[1]],st),Nt=u_([ci[2],ci[3]],st);return[ti[0],ti[1],Nt[0],Nt[1]]}return Se(st).getExtent()}(D,It),Xt=It.getExtent(),he=D.minzoom||0,Ee=D.maxzoom||22,Ie={attributions:dt.getAttributions(),projection:It,tileGrid:new xs({origin:Xt?Gn(Xt):V.getOrigin(0),extent:yt||V.getExtent(),minZoom:he,resolutions:_T(It,$.tileSize).slice(0,Ee+1),tileSize:V.getTileSize(0)})};return Array.isArray(D.tiles)?Ie.urls=D.tiles:Ie.url=D.tiles,Ie}(S,K,P);F.tileLoadFunction=N,F.format=new gg,A(new qf(F))}).catch(T)})).then(function(w){const S=n.getSource();if(S?w!==S&&(S.setTileUrlFunction(w.getTileUrlFunction()),"function"==typeof S.setUrls&&"function"==typeof w.getUrls&&S.setUrls(w.getUrls()),S.format_||(S.format_=w.format_),S.getAttributions()||S.setAttributions(w.getAttributions()),S.getTileLoadFunction()===gv&&S.setTileLoadFunction(w.getTileLoadFunction()),fs(S.getProjection(),w.getProjection())&&(S.tileGrid=w.getTileGrid())):n.setSource(w),!isFinite(n.getMaxResolution())&&!isFinite(n.getMinZoom())){const R=n.getSource().getTileGrid();n.setMaxResolution(R.getResolution(R.getMinZoom()))}});var S,R,P;const x=d.sources[o];let b=n.getSource();(!b||b.get("mapbox-source")!==x)&&(b=function(S,R,P){const A=P.projection?new fg({dataProjection:P.projection}):new fg,T=S.data,K={};if("string"==typeof T){const F=Bc(T,P.accessToken,P.accessTokenParam||"access_token",R||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(F)){const q=(ct,dt,D)=>{const V=`{bbox-${((yt=D)?yt.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`;var yt;return F.replace(V,`${ct.join(",")}`)},$=new lo({attributions:S.attribution,format:A,loader:(ct,dt,D,V,It)=>{La("GeoJSON","function"==typeof q?q(ct,dt,D):q,P).then(yt=>{const Xt=$.getFormat().readFeatures(yt,{featureProjection:D});$.addFeatures(Xt),V(Xt)}).catch(yt=>{$.removeLoadedExtent(ct),It()})},strategy:uE});return $.set("mapbox-source",S),$}const j=new lo({attributions:S.attribution,format:A,url:F,loader:(q,$,ct,dt,D)=>{La("GeoJSON",F,P).then(V=>{const It=j.getFormat().readFeatures(V,{featureProjection:ct});j.addFeatures(It),dt(It)}).catch(V=>{j.removeLoadedExtent(q),D()})}});return j}K.features=A.readFeatures(T,{featureProjection:wl()||"EPSG:3857"});const N=new lo(Object.assign({attributions:S.attribution,format:A},K));return N.set("mapbox-source",S),N}(x,s,a));const M=n.getSource();return M?b!==M&&(M.getAttributions()||M.setAttributions(b.getAttributions()),M.format_||(M.format_=b.getFormat()),M.url_=b.getUrl()):n.setSource(b),Promise.resolve()}let g,m,y,_;function v(){if(_||d.sprite&&!m)_?(n.setStyle(_),f().then(u).catch(c)):c(new Error("Something went wrong trying to apply style."));else{if(a.projection&&!r){const x=Se(a.projection).getUnits();"m"!==x&&(r=Wc.map(b=>b/Ho[x]))}_=function yT(n,t,e,i=Wc,r,s,o,a){if("string"==typeof t&&(t=JSON.parse(t)),8!=t.version)throw new Error("glStyle version 8 required.");let l,h,u;if(mT[(S=t,R=n,c0(S)+"."+Qt(R))]=Array.from(arguments),s)if(typeof Image<"u"){const w=new Image;let S;pu(()=>s).then(R=>{R instanceof Request?fetch(R).then(P=>P.blob()).then(P=>{S=URL.createObjectURL(P),w.src=S}).catch(()=>{}):(w.crossOrigin="anonymous",w.src=R,S&&URL.revokeObjectURL(S))}),w.onload=function(){l=w,h=[w.width,w.height],n.changed(),w.onload=null}}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){const w=self;w.postMessage({action:"loadImage",src:s}),w.addEventListener("message",function(S){"imageLoaded"===S.data.action&&S.data.src===s&&(l=S.data.image,h=[l.width,l.height])})}var S,R;const c=function(S){S=S.slice();const R=Object.create(null);for(let P=0;P<S.length;P++)R[S[P].id]=S[P];for(let P=0;P<S.length;P++)"ref"in S[P]&&(S[P]=iT(S[P],R[S[P].ref]));return S}(t.layers),d={},p=[],f={},g={},m=function(S){let R=Eb[S.id];return R||(R={},Eb[c0(S)]=R),R}(t),y=function(S){let R=Tb[S.id];return R||(R={},Tb[c0(S)]=R),R}(t);let _;for(let w=0,S=c.length;w<S;++w){const R=c[w],P=R.id;if("string"==typeof e&&R.source==e||Array.isArray(e)&&-1!==e.indexOf(P)){const A=R["source-layer"];if(_){if(R.source!==_)throw new Error(`Layer "${P}" does not use source "${_}`)}else{_=R.source;const K=t.sources[_];if(!K)throw new Error(`Source "${_}" is not defined`);const N=K.type;if("vector"!==N&&"geojson"!==N)throw new Error(`Source "${_}" is not of type "vector" or "geojson", but "${N}"`)}let T=d[A];T||(T=[],d[A]=T),T.push({layer:R,index:w}),p.push(P)}}const v=new Un,x=new Wn,b=[],M=function(w,S,R){const P=w.getProperties(),A=d[P.layer];if(!A)return;let T=i.indexOf(S);-1==T&&(T=function(ct,dt){let D=0;const V=dt.length;for(;D<V;++D)if(dt[D]<ct&&D+1<V){const It=dt[D]/dt[D+1];return D+Math.log(dt[D]/ct)/Math.log(It)}return V-1}(S,i));const K=uT[w.getGeometry().getType()],N={id:w.getId(),properties:P,type:K},F=n.get("mapbox-featurestate")[w.getId()];let j,q=-1;for(let $=0,ct=A.length;$<ct;++$){const dt=A[$],D=dt.layer,V=D.id;if(void 0!==R&&R!==V)continue;const It=D.layout||y0,yt=D.paint||y0;if("none"===It.visibility||"minzoom"in D&&T<D.minzoom||"maxzoom"in D&&T>=D.maxzoom)continue;const Xt=D.filter;if(!Xt||pT(V,Xt,N,T,y)){let he,Ee,Ie,De,oi,st;j=D;const ci=dt.index;if(3==K&&("fill"==D.type||"fill-extrusion"==D.type))if(Ee=Gt(D,"paint",D.type+"-opacity",T,N,m,F),D.type+"-pattern"in yt){const ii=Gt(D,"paint",D.type+"-pattern",T,N,m,F);if(ii){const Ke="string"==typeof ii?v0(ii,P):ii.toString();if(l&&r&&r[Ke]){++q,st=b[q],(!st||!st.getFill()||st.getStroke()||st.getText())&&(st=new Pn({fill:new Wn}),b[q]=st),Ie=st.getFill(),st.setZIndex(ci);const Pe=Ke+"."+Ee;let Ne=g[Pe];if(!Ne){const pe=r[Ke],Yt=kb(pe.width,pe.height),We=Yt.getContext("2d");We.globalAlpha=Ee,We.drawImage(l,pe.x,pe.y,pe.width,pe.height,0,0,pe.width,pe.height),Ne=We.createPattern(Yt,"repeat"),g[Pe]=Ne}Ie.setColor(Ne)}}}else he=po(Gt(D,"paint",D.type+"-color",T,N,m,F),Ee),D.type+"-outline-color"in yt&&(oi=po(Gt(D,"paint",D.type+"-outline-color",T,N,m,F),Ee)),oi||(oi=he),(he||oi)&&(++q,st=b[q],(!st||he&&!st.getFill()||!he&&st.getFill()||oi&&!st.getStroke()||!oi&&st.getStroke()||st.getText())&&(st=new Pn({fill:he?new Wn:void 0,stroke:oi?new Un:void 0}),b[q]=st),he&&(Ie=st.getFill(),Ie.setColor(he)),oi&&(De=st.getStroke(),De.setColor(oi),De.setWidth(.5)),st.setZIndex(ci));if(1!=K&&"line"==D.type){he="line-pattern"in yt?void 0:po(Gt(D,"paint","line-color",T,N,m,F),Gt(D,"paint","line-opacity",T,N,m,F));const ii=Gt(D,"paint","line-width",T,N,m,F);he&&ii>0&&(++q,st=b[q],(!st||!st.getStroke()||st.getFill()||st.getText())&&(st=new Pn({stroke:new Un}),b[q]=st),De=st.getStroke(),De.setLineCap(Gt(D,"layout","line-cap",T,N,m,F)),De.setLineJoin(Gt(D,"layout","line-join",T,N,m,F)),De.setMiterLimit(Gt(D,"layout","line-miter-limit",T,N,m,F)),De.setColor(he),De.setWidth(ii),De.setLineDash(yt["line-dasharray"]?Gt(D,"paint","line-dasharray",T,N,m,F).map(function(Ke){return Ke*ii}):null),st.setZIndex(ci))}let ti,Nt,Ye,Te,ye,Si,Di,nn,ei,mi=!1,Ht=null,An=0;if((1==K||2==K)&&"icon-image"in It){const ii=Gt(D,"layout","icon-image",T,N,m,F);if(ii){let Ke;ti="string"==typeof ii?v0(ii,P):ii.toString();const Pe=a?a(n,ti):void 0;if(l&&r&&r[ti]||Pe){const Ne=Gt(D,"layout","icon-rotation-alignment",T,N,m,F);if(2==K){const pe=w.getGeometry();if(pe.getFlatMidpoint||pe.getFlatMidpoints){const Yt=pe.getExtent();if(Math.sqrt(Math.max(Math.pow((Yt[2]-Yt[0])/S,2),Math.pow((Yt[3]-Yt[1])/S,2)))>150){const We="MultiLineString"===pe.getType()?pe.getFlatMidpoints():pe.getFlatMidpoint();if(_0||(Xc=[NaN,NaN],_0=new Hn("Point",Xc,[],2,{},void 0)),Ke=_0,Xc[0]=We[0],Xc[1]=We[1],"line"===Gt(D,"layout","symbol-placement",T,N,m,F)&&"map"===Ne){const vi=pe.getStride(),Ei=pe.getFlatCoordinates();for(let Ni=0,rn=Ei.length-vi;Ni<rn;Ni+=vi){const Wi=Ei[Ni],He=Ei[Ni+1],zi=Ei[Ni+vi],sn=Ei[Ni+vi+1],Ln=Math.min(Wi,zi),Re=Math.min(He,sn),yn=Math.max(Wi,zi),on=Math.max(He,sn);if(We[0]>=Ln&&We[0]<=yn&&We[1]>=Re&&We[1]<=on){An=Math.atan2(He-sn,zi-Wi);break}}}}}}if(2!==K||Ke){const pe=Gt(D,"layout","icon-size",T,N,m,F),Yt=void 0!==yt["icon-color"]?Gt(D,"paint","icon-color",T,N,m,F):null;if(!Yt||0!==Yt.a){const We=Gt(D,"paint","icon-halo-color",T,N,m,F),vi=Gt(D,"paint","icon-halo-width",T,N,m,F);let Ei=`${ti}.${pe}.${vi}.${We}`;if(null!==Yt&&(Ei+=`.${Yt}`),Nt=f[Ei],!Nt){const Ni=Ab(D,T,N,"icon",m);let rn;"icon-offset"in It&&(rn=Gt(D,"layout","icon-offset",T,N,m,F).slice(0),rn[0]*=pe,rn[1]*=-pe);let Wi=Yt?[255*Yt.r,255*Yt.g,255*Yt.b,Yt.a]:void 0;if(Pe){const He={color:Wi,rotateWithView:"map"===Ne,displacement:rn,declutterMode:Ni,scale:pe};"string"==typeof Pe?He.src=Pe:(He.img=Pe,He.imgSize=[Pe.width,Pe.height]),Nt=new rc(He)}else{const He=r[ti];let zi,sn,Ln;vi?He.sdf?(zi=Pb(Rb(l,He,Yt||[0,0,0,1]),{x:0,y:0,width:He.width,height:He.height,pixelRatio:He.pixelRatio},vi,We),Wi=void 0):zi=Pb(l,He,vi,We):(He.sdf?(u||(u=Rb(l,{x:0,y:0,width:h[0],height:h[1]},{r:1,g:1,b:1,a:1})),zi=u):zi=l,sn=[He.width,He.height],Ln=[He.x,He.y]),Nt=new rc({color:Wi,img:zi,imgSize:h,size:sn,offset:Ln,rotateWithView:"map"===Ne,scale:pe/He.pixelRatio,displacement:rn,declutterMode:Ni})}f[Ei]=Nt}}Nt&&(++q,st=b[q],(!st||!st.getImage()||st.getFill()||st.getStroke())&&(st=new Pn,b[q]=st),st.setGeometry(Ke),Nt.setRotation(An+d0(Gt(D,"layout","icon-rotate",T,N,m,F))),Nt.setOpacity(Gt(D,"paint","icon-opacity",T,N,m,F)),Nt.setAnchor(cT[Gt(D,"layout","icon-anchor",T,N,m,F)]),st.setImage(Nt),Ht=st.getText(),st.setText(void 0),st.setZIndex(ci),mi=!0,Ye=!1)}else Ye=!0}}}if(1==K&&"circle"===D.type){++q,st=b[q],(!st||!st.getImage()||st.getFill()||st.getStroke())&&(st=new Pn,b[q]=st);const ii="circle-radius"in yt?Gt(D,"paint","circle-radius",T,N,m,F):5,Ke=po(Gt(D,"paint","circle-stroke-color",T,N,m,F),Gt(D,"paint","circle-stroke-opacity",T,N,m,F)),Pe=Gt(D,"paint","circle-translate",T,N,m,F),Ne=po(Gt(D,"paint","circle-color",T,N,m,F),Gt(D,"paint","circle-opacity",T,N,m,F)),pe=Gt(D,"paint","circle-stroke-width",T,N,m,F),Yt=ii+"."+Ke+"."+Ne+"."+pe+"."+Pe[0]+"."+Pe[1];Nt=f[Yt],Nt||(Nt=new $l({radius:ii,displacement:[Pe[0],-Pe[1]],stroke:Ke&&pe>0?new Un({width:pe,color:Ke}):void 0,fill:Ne?new Wn({color:Ne}):void 0,declutterMode:"none"}),f[Yt]=Nt),st.setImage(Nt),Ht=st.getText(),st.setText(void 0),st.setGeometry(void 0),st.setZIndex(ci),mi=!0}if("text-field"in It){Di=Math.round(Gt(D,"layout","text-size",T,N,m,F));const ii=Gt(D,"layout","text-font",T,N,m,F);Si=Gt(D,"layout","text-line-height",T,N,m,F),ye=h0(o?o(ii,t.metadata?t.metadata["ol:webfonts"]:void 0):ii,Di,Si),ye.includes("sans-serif")||(ye+=",sans-serif"),nn=Gt(D,"layout","text-letter-spacing",T,N,m,F),ei=Gt(D,"layout","text-max-width",T,N,m,F);const Ke=Gt(D,"layout","text-field",T,N,m,F);Te="object"==typeof Ke&&Ke.sections?1===Ke.sections.length?Ke.toString():Ke.sections.reduce((Pe,Ne,pe)=>{const Yt=Ne.fontStack?Ne.fontStack.split(","):ii,We=h0(o?o(Yt):Yt,Di*(Ne.scale||1),Si);let vi=Ne.text;if("\n"===vi)return Pe.push("\n",""),Pe;if(2!=K){vi=g0(vi,We,ei,nn).split("\n");for(let Ei=0,Ni=vi.length;Ei<Ni;++Ei)Ei>0&&Pe.push("\n",""),Pe.push(vi[Ei],We);return Pe}Pe.push(p0(vi,nn),We)},[]):v0(Ke,P).trim(),Ee=Gt(D,"paint","text-opacity",T,N,m,F)}if(Te&&Ee&&!Ye){mi||(++q,st=b[q],(!st||!st.getText()||st.getFill()||st.getStroke())&&(st=new Pn,b[q]=st),st.setImage(void 0),st.setGeometry(void 0));const ii=Ab(D,T,N,"text",m);st.getText()||st.setText(Ht),Ht=st.getText(),(!Ht||"getDeclutterMode"in Ht&&Ht.getDeclutterMode()!==ii)&&(Ht=new sx({padding:[2,2,2,2],declutterMode:ii}),st.setText(Ht));const Ke=Gt(D,"layout","text-transform",T,N,m,F);"uppercase"==Ke?Te=Array.isArray(Te)?Te.map((Re,yn)=>yn%2?Re:Re.toUpperCase()):Te.toUpperCase():"lowercase"==Ke&&(Te=Array.isArray(Te)?Te.map((Re,yn)=>yn%2?Re:Re.toLowerCase()):Te.toLowerCase());const Pe=Array.isArray(Te)?Te:2==K?p0(Te,nn):g0(Te,ye,ei,nn);Ht.setText(Pe),Ht.setFont(ye),Ht.setRotation(d0(Gt(D,"layout","text-rotate",T,N,m,F)));const Ne=Gt(D,"layout","text-anchor",T,N,m,F),pe=mi||1==K?"point":Gt(D,"layout","symbol-placement",T,N,m,F);let Yt;if("line-center"===pe?(Ht.setPlacement("line"),Yt="center"):Ht.setPlacement(pe),"line"===pe&&"function"==typeof Ht.setRepeat){const Re=Gt(D,"layout","symbol-spacing",T,N,m,F);Ht.setRepeat(2*Re)}Ht.setOverflow("point"===pe);let We=Gt(D,"paint","text-halo-width",T,N,m,F);const vi=Gt(D,"layout","text-offset",T,N,m,F),Ei=Gt(D,"paint","text-translate",T,N,m,F);let Ni=0,rn=0;if("point"==pe){Yt="center",-1!==Ne.indexOf("left")?(Yt="left",rn=We):-1!==Ne.indexOf("right")&&(Yt="right",rn=-We);const Re=Gt(D,"layout","text-rotation-alignment",T,N,m,F);Ht.setRotateWithView("map"==Re)}else Ht.setMaxAngle(d0(Gt(D,"layout","text-max-angle",T,N,m,F))*Te.length/Pe.length),Ht.setRotateWithView(!1);Ht.setTextAlign(Yt);let Wi="middle";0==Ne.indexOf("bottom")?(Wi="bottom",Ni=-We-.5*(Si-1)*Di):0==Ne.indexOf("top")&&(Wi="top",Ni=We+.5*(Si-1)*Di),Ht.setTextBaseline(Wi);const He=Gt(D,"layout","text-justify",T,N,m,F);Ht.setJustify("auto"===He?void 0:He),Ht.setOffsetX(vi[0]*Di+rn+Ei[0]),Ht.setOffsetY(vi[1]*Di+Ni+Ei[1]),x.setColor(po(Gt(D,"paint","text-color",T,N,m,F),Ee)),Ht.setFill(x);const zi=po(Gt(D,"paint","text-halo-color",T,N,m,F),Ee);if(zi&&We>0){v.setColor(zi),We*=2;const Re=.5*Di;v.setWidth(We<=Re?We:Re),Ht.setStroke(v)}else Ht.setStroke(void 0);const sn=Gt(D,"layout","text-padding",T,N,m,F),Ln=Ht.getPadding();sn!==Ln[0]&&(Ln[0]=sn,Ln[1]=sn,Ln[2]=sn,Ln[3]=sn),st.setZIndex(ci)}}}return q>-1?(b.length=q+1,Lb&&("set"in w?w.set("mapbox-layer",j):w.getProperties()["mapbox-layer"]=j),b):void 0};return n.setStyle(M),n.set("mapbox-source",_),n.set("mapbox-layers",p),n.set("mapbox-featurestate",n.get("mapbox-featurestate")||{}),M}(n,d,l,r,m,y,hT,a.getImage),n.getStyle()?f().then(u).catch(c):c(new Error(`Nothing to show for source [${o}]`))}}if(d.sprite){const x=new URL(function(S,R,P){const A=u0(S);if(!A)return decodeURI(new URL(S,P).href);if(0!==A.indexOf("sprites/"))throw new Error(`unexpected sprites url: ${S}`);const T=A.slice(8);return`${Mb}/styles/v1/${T}/sprite?access_token=${R}`}(d.sprite,a.accessToken,s||location.href));g=window.devicePixelRatio>=1.5?.5:1;const b=.5==g?"@2x":"";let M=x.origin+x.pathname+b+".json"+x.search;new Promise(function(w,S){La("Sprite",M,a).then(w).catch(function(R){M=x.origin+x.pathname+".json"+x.search,La("Sprite",M,a).then(w).catch(S)})}).then(function(w){if(void 0===w&&c(new Error("No sprites found.")),m=w,y=x.origin+x.pathname+b+".png"+x.search,a.transformRequest){const S=a.transformRequest(y,"SpriteImage")||y;(S instanceof Request||S instanceof Promise)&&(y=S)}v()}).catch(function(w){c(new Error(`Sprites cannot be loaded: ${M}: ${w.message}`))})}else v()}).catch(c)});var c,d}const Nb=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"];function zb(n){const t=n.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&n.fullscreenEnabled)}function jb(n){return!(!n.webkitIsFullScreen&&!n.fullscreenElement)}function Gb(n){n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}const vT=class extends Rl{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target}),this.keys_=void 0!==t.keys&&t.keys,this.source_=t.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=void 0!==t.className?t.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=void 0!==t.activeClassName?t.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=void 0!==t.inactiveClassName?t.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const e=void 0!==t.label?t.label:"\u2922";this.labelNode_="string"==typeof e?document.createTextNode(e):e;const i=void 0!==t.labelActive?t.labelActive:"\xd7";this.labelActiveNode_="string"==typeof i?document.createTextNode(i):i;const r=t.tipLabel?t.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=r,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener("click",this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${El} ${zu}`,this.element.appendChild(this.button_)}handleClick_(t){t.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const t=this.getMap();if(!t)return;const e=t.getOwnerDocument();if(zb(e))if(jb(e))!function(r){r.exitFullscreen?r.exitFullscreen():r.webkitExitFullscreen&&r.webkitExitFullscreen()}(e);else{let i;i=this.source_?"string"==typeof this.source_?e.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?function(s){s.webkitRequestFullscreen?s.webkitRequestFullscreen():Gb(s)}(i):Gb(i)}}handleFullScreenChange_(){const t=this.getMap();if(!t)return;const e=this.isInFullscreen_;this.isInFullscreen_=jb(t.getOwnerDocument()),e!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(ju(this.labelActiveNode_,this.labelNode_),this.dispatchEvent("enterfullscreen")):(ju(this.labelNode_,this.labelActiveNode_),this.dispatchEvent("leavefullscreen")),t.updateSize())}setClassName_(t,e){e?(t.classList.remove(...this.inactiveClassName_),t.classList.add(...this.activeClassName_)):(t.classList.remove(...this.activeClassName_),t.classList.add(...this.inactiveClassName_))}setMap(t){const e=this.getMap();e&&e.removeChangeListener("target",this.boundHandleMapTargetChange_),super.setMap(t),this.handleMapTargetChange_(),t&&t.addChangeListener("target",this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const t=this.documentListeners_;for(let i=0,r=t.length;i<r;++i)si(t[i]);t.length=0;const e=this.getMap();if(e){const i=e.getOwnerDocument();zb(i)?this.element.classList.remove(O_):this.element.classList.add(O_);for(let r=0,s=Nb.length;r<s;++r)t.push(_e(i,Nb[r],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}},xT=class extends Du{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get("preload")}setPreload(t){this.set("preload",t)}getUseInterimTilesOnError(){return this.get("useInterimTilesOnError")}setUseInterimTilesOnError(t){this.set("useInterimTilesOnError",t)}getData(t){return super.getData(t)}},x0=class extends xT{constructor(t){super(t)}createRenderer(){return new Nx(this)}};function qb(n){return n&&Ct(n.schedule)}function Vb(n){return n[n.length-1]}function Zb(n){return qb(Vb(n))?n.pop():void 0}function Da(n){return this instanceof Da?(this.v=n,this):new Da(n)}"function"==typeof SuppressedError&&SuppressedError;const Bb=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Wb(n){return Ct(n?.then)}function Hb(n){return Ct(n[Gs])}function Ub(n){return Symbol.asyncIterator&&Ct(n?.[Symbol.asyncIterator])}function Xb(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const $b=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Yb(n){return Ct(n?.[$b])}function Kb(n){return function(e,i,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,o=function*(){const t=n.getReader();try{for(;;){const{value:e,done:i}=yield Da(t.read());if(i)return yield Da(void 0);yield yield Da(e)}}finally{t.releaseLock()}}.apply(e,i||[]),a=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(p){o[p]&&(s[p]=function(f){return new Promise(function(g,m){a.push([p,f,g,m])>1||h(p,f)})})}function h(p,f){try{(m=o[p](f)).value instanceof Da?Promise.resolve(m.value.v).then(u,c):d(a[0][2],m)}catch(g){d(a[0][3],g)}var m}function u(p){h("next",p)}function c(p){h("throw",p)}function d(p,f){p(f),a.shift(),a.length&&h(a[0][0],a[0][1])}}(this,arguments)}function Jb(n){return Ct(n?.getReader)}function or(n){if(n instanceof Ai)return n;if(null!=n){if(Hb(n))return e=n,new Ai(i=>{const r=e[Gs]();if(Ct(r.subscribe))return r.subscribe(i);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(Bb(n))return function(e){return new Ai(i=>{for(let r=0;r<e.length&&!i.closed;r++)i.next(e[r]);i.complete()})}(n);if(Wb(n))return function(e){return new Ai(i=>{e.then(r=>{i.closed||(i.next(r),i.complete())},r=>i.error(r)).then(null,C)})}(n);if(Ub(n))return Qb(n);if(Yb(n))return function(e){return new Ai(i=>{for(const r of e)if(i.next(r),i.closed)return;i.complete()})}(n);if(Jb(n))return function(e){return Qb(Kb(e))}(n)}var e;throw Xb(n)}function Qb(n){return new Ai(t=>{(function(i,r){var s,o,a,l,u,d,p;return u=this,p=function*(){try{for(s=function bT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function(s){var o="function"==typeof Symbol&&Symbol.iterator,a=o&&s[o],l=0;if(a)return a.call(s);if(s&&"number"==typeof s.length)return{next:function(){return s&&l>=s.length&&(s=void 0),{value:s&&s[l++],done:!s}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(s){return new Promise(function(o,a){var h,u,c;h=o,u=a,c=(s=n[r](s)).done,Promise.resolve(s.value).then(function(p){h({value:p,done:c})},u)})}}}(i);!(o=yield s.next()).done;)if(r.next(o.value),r.closed)return}catch(h){a={error:h}}finally{try{o&&!o.done&&(l=s.return)&&(yield l.call(s))}finally{if(a)throw a.error}}r.complete()},new((d=void 0)||(d=Promise))(function(f,g){function m(v){try{_(p.next(v))}catch(x){g(x)}}function y(v){try{_(p.throw(v))}catch(x){g(x)}}function _(v){var b;v.done?f(v.value):(b=v.value,b instanceof d?b:new d(function(M){M(b)})).then(m,y)}_((p=p.apply(u,[])).next())})})(n,t).catch(e=>t.error(e))})}function zs(n,t,e,i=0,r=!1){const s=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function tw(n,t=0){return xn((e,i)=>{e.subscribe(an(i,r=>zs(i,n,()=>i.next(r),t),()=>zs(i,n,()=>i.complete(),t),r=>zs(i,n,()=>i.error(r),t)))})}function ew(n,t=0){return xn((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function iw(n,t){if(!n)throw new Error("Iterable cannot be null");return new Ai(e=>{zs(e,t,()=>{const i=n[Symbol.asyncIterator]();zs(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function b0(n,t){return t?function(i,r){if(null!=i){if(Hb(i))return a=r,or(i).pipe(ew(a),tw(a));if(Bb(i))return function(o,a){return new Ai(l=>{let h=0;return a.schedule(function(){h===o.length?l.complete():(l.next(o[h++]),l.closed||this.schedule())})})}(i,r);if(Wb(i))return function(o,a){return or(o).pipe(ew(a),tw(a))}(i,r);if(Ub(i))return iw(i,r);if(Yb(i))return function(o,a){return new Ai(l=>{let h;return zs(l,a,()=>{h=o[$b](),zs(l,a,()=>{let u,c;try{({value:u,done:c}=h.next())}catch(d){return void l.error(d)}c?l.complete():l.next(u)},0,!0)}),()=>Ct(h?.return)&&h.return()})}(i,r);if(Jb(i))return function(o,a){return iw(Kb(o),a)}(i,r)}var a;throw Xb(i)}(n,t):or(n)}function $r(...n){return b0(n,Zb(n))}function $c(n,t,e=1/0){return Ct(t)?$c((i,r)=>bn((s,o)=>t(i,s,r,o))(or(n(i,r))),e):("number"==typeof t&&(e=t),xn((i,r)=>function(o,a,l,h,u,c,d,p){const f=[];let g=0,m=0,y=!1;const _=()=>{y&&!f.length&&!g&&a.complete()},x=b=>{g++;let M=!1;or(l(b,m++)).subscribe(an(a,w=>{a.next(w)},()=>{M=!0},void 0,()=>{if(M)try{for(g--;f.length&&g<h;){const w=f.shift();x(w)}_()}catch(w){a.error(w)}}))};return o.subscribe(an(a,b=>g<h?x(b):f.push(b),()=>{y=!0,_()})),()=>{}}(i,r,n,e)))}function nw(n,t){return Ct(t)?$c(n,t,1):$c(n,1)}function Yc(n,t){return xn((e,i)=>{let r=0;e.subscribe(an(i,s=>n.call(t,s,r++)&&i.next(s)))})}function rw(n){return xn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}function sw(n,t){return xn((e,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();e.subscribe(an(i,l=>{r?.unsubscribe();let h=0;const u=s++;or(n(l,u)).subscribe(r=an(i,c=>i.next(t?t(l,c,u,h++):c),()=>{r=null,a()}))},()=>{o=!0,a()}))})}class w0{}class Kc{}class Sr{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const r=e.slice(0,i),s=r.toLowerCase(),o=e.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.setHeaderEntries(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Sr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Sr;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Sr?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":const s=t.value;if(s){let o=this.headers.get(e);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const i=(Array.isArray(e)?e:[e]).map(s=>s.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class wT{encodeKey(t){return ow(t)}encodeValue(t){return ow(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const CT=/%(\d[a-f0-9])/gi,MT={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ow(n){return encodeURIComponent(n).replace(CT,(t,e)=>MT[e]??t)}function Jc(n){return`${n}`}class Yr{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new wT,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(i,r){const s=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(o=>{const a=o.indexOf("="),[l,h]=-1==a?[r.decodeKey(o),""]:[r.decodeKey(o.slice(0,a)),r.decodeValue(o.slice(a+1))],u=s.get(l)||[];u.push(h),s.set(l,u)}),s}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],r=Array.isArray(i)?i.map(Jc):[Jc(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{e.push({param:i,value:s,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Yr({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Jc(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(Jc(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class ST{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function aw(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function lw(n){return typeof Blob<"u"&&n instanceof Blob}function hw(n){return typeof FormData<"u"&&n instanceof FormData}class fo{constructor(t,e,i,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(a){switch(a){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers||(this.headers=new Sr),this.context||(this.context=new ST),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+o}}else this.params=new Yr,this.urlWithParams=e}serializeBody(){return null===this.body?null:aw(this.body)||lw(this.body)||hw(this.body)||typeof URLSearchParams<"u"&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Yr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||hw(this.body)?null:lw(this.body)?this.body.type||null:aw(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Yr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,h=t.params||this.params;const u=t.context??this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((c,d)=>c.set(d,t.setHeaders[d]),l)),t.setParams&&(h=Object.keys(t.setParams).reduce((c,d)=>c.set(d,t.setParams[d]),h)),new fo(e,i,s,{params:h,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var Na=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Na||{});class C0{constructor(t,e=200,i="OK"){this.headers=t.headers||new Sr,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class M0 extends C0{constructor(t={}){super(t),this.type=Na.ResponseHeader}clone(t={}){return new M0({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class za extends C0{constructor(t={}){super(t),this.type=Na.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new za({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class uw extends C0{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function S0(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let Qc=(()=>{class n{constructor(e){this.handler=e}request(e,i,r={}){let s;if(e instanceof fo)s=e;else{let l,h;l=r.headers instanceof Sr?r.headers:new Sr(r.headers),r.params&&(h=r.params instanceof Yr?r.params:new Yr({fromObject:r.params})),s=new fo(e,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:h,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=$r(s).pipe(nw(l=>this.handler.handle(l)));if(e instanceof fo||"events"===r.observe)return o;const a=o.pipe(Yc(l=>l instanceof za));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(bn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(bn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(bn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(bn(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Yr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,S0(r,i))}post(e,i,r={}){return this.request("POST",e,S0(r,i))}put(e,i,r={}){return this.request("PUT",e,S0(r,i))}static#t=this.\u0275fac=function(e){return new(e||n)(X(w0))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();function cw(n,t){return t(n)}function ET(n,t){return(e,i)=>t.intercept(e,{handle:r=>n(r,i)})}const TT=new jt(""),E0=new jt(""),kT=new jt(""),IT=new jt("");function PT(){let n=null;return(t,e)=>{null===n&&(n=(ht(TT,{optional:!0})??[]).reduceRight(ET,cw));const i=ht(tu),r=i.add();return n(t,e).pipe(rw(()=>i.remove(r)))}}let dw=(()=>{class n extends w0{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null,this.pendingTasks=ht(tu);const r=ht(IT,{optional:!0});this.backend=r??e}handle(e){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(E0),...this.injector.get(kT,[])]));this.chain=r.reduceRight((s,o)=>function(l,h,u){return(c,d)=>function(f,g){f instanceof Od&&f.assertNotDestroyed();const m=Pi(f),y=et(void 0);try{return h(c,p=>l(p,d))}finally{Pi(m),et(y)}}(u)}(s,o,this.injector),cw)}const i=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(rw(()=>this.pendingTasks.remove(i)))}static#t=this.\u0275fac=function(e){return new(e||n)(X(Kc),X(Ws))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const RT=/^\)\]\}',?\n/;let pw=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new z(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?b0(i.\u0275loadImpl()):$r(null)).pipe(sw(()=>new Ai(r=>{const s=i.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((f,g)=>s.setRequestHeader(f,g.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const f=e.detectContentTypeHeader();null!==f&&s.setRequestHeader("Content-Type",f)}if(e.responseType){const f=e.responseType.toLowerCase();s.responseType="json"!==f?f:"text"}const o=e.serializeBody();let a=null;const l=()=>{if(null!==a)return a;const f=s.statusText||"OK",g=new Sr(s.getAllResponseHeaders()),m=("responseURL"in(_=s)&&_.responseURL?_.responseURL:/^X-Request-URL:/m.test(_.getAllResponseHeaders())?_.getResponseHeader("X-Request-URL"):null)||e.url;var _;return a=new M0({headers:g,status:s.status,statusText:f,url:m}),a},h=()=>{let{headers:f,status:g,statusText:m,url:y}=l(),_=null;204!==g&&(_=typeof s.response>"u"?s.responseText:s.response),0===g&&(g=_?200:0);let v=g>=200&&g<300;if("json"===e.responseType&&"string"==typeof _){const x=_;_=_.replace(RT,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=x,v&&(v=!1,_={error:b,text:_})}}v?(r.next(new za({body:_,headers:f,status:g,statusText:m,url:y||void 0})),r.complete()):r.error(new uw({error:_,headers:f,status:g,statusText:m,url:y||void 0}))},u=f=>{const{url:g}=l(),m=new uw({error:f,status:s.status||0,statusText:s.statusText||"Unknown Error",url:g||void 0});r.error(m)};let c=!1;const d=f=>{c||(r.next(l()),c=!0);let g={type:Na.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(g.total=f.total),"text"===e.responseType&&s.responseText&&(g.partialText=s.responseText),r.next(g)},p=f=>{let g={type:Na.UploadProgress,loaded:f.loaded};f.lengthComputable&&(g.total=f.total),r.next(g)};return s.addEventListener("load",h),s.addEventListener("error",u),s.addEventListener("timeout",u),s.addEventListener("abort",u),e.reportProgress&&(s.addEventListener("progress",d),null!==o&&s.upload&&s.upload.addEventListener("progress",p)),s.send(o),r.next({type:Na.Sent}),()=>{s.removeEventListener("error",u),s.removeEventListener("abort",u),s.removeEventListener("load",h),s.removeEventListener("timeout",u),e.reportProgress&&(s.removeEventListener("progress",d),null!==o&&s.upload&&s.upload.removeEventListener("progress",p)),s.readyState!==s.DONE&&s.abort()}})))}static#t=this.\u0275fac=function(e){return new(e||n)(X(p1))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();const fw=new jt("XSRF_ENABLED"),FT=new jt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),OT=new jt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class gw{}let AT=(()=>{class n{constructor(e,i,r){this.doc=e,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=a1(e,this.cookieName),this.lastCookieString=e),this.lastToken}static#t=this.\u0275fac=function(e){return new(e||n)(X(as),X(Io),X(FT))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac})}return n})();function LT(n,t){const e=n.url.toLowerCase();if(!ht(fw)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=ht(gw).getToken(),r=ht(OT);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}var mw=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(mw||{});function DT(...n){const t=[Qc,pw,dw,{provide:w0,useExisting:dw},{provide:Kc,useExisting:pw},{provide:E0,useValue:LT,multi:!0},{provide:fw,useValue:!0},{provide:gw,useClass:AT}];for(const e of n)t.push(...e.\u0275providers);return function(i){return{\u0275providers:i}}(t)}const yw=new jt("LEGACY_INTERCEPTOR_FN");function NT(){return function(t,e){return{\u0275kind:t,\u0275providers:e}}(mw.LegacyInterceptors,[{provide:yw,useFactory:PT},{provide:E0,useExisting:yw,multi:!0}])}let zT=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275mod=vo({type:n});static#i=this.\u0275inj=ge({providers:[DT(NT())]})}return n})();class jT extends ke{constructor(t,e){super()}schedule(t,e=0){return this}}const td={setInterval(n,t,...e){const{delegate:i}=td;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=td;return(t?.clearInterval||clearInterval)(n)},delegate:void 0},T0={now:()=>(T0.delegate||Date).now(),delegate:void 0};class ph{constructor(t,e=ph.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}ph.now=T0.now;const GT=new class extends ph{constructor(t,e=ph.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}(class extends jT{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,i=0){return td.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&td.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i,r=!1;try{this.work(t)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Fe(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}});function _w(n=0,t,e=GT){let i=-1;return null!=t&&(qb(t)?e=t:i=t),new Ai(r=>{let s=(l=n)instanceof Date&&!isNaN(l)?+n-e.now():n;var l;s<0&&(s=0);let o=0;return e.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}class vw extends ts{constructor(t=1/0,e=1/0,i=T0){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;e||(i.push(t),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!t.closed;o+=i?1:2)t.next(s[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*t;if(t<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=e.now();let a=0;for(let l=1;l<i.length&&i[l]<=o;l+=2)a=l;a&&i.splice(0,a+1)}}}function k0(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new ui({next:()=>{i.unsubscribe(),n()}});return or(t(...e)).subscribe(i)}function xw(n,t,e){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:e}=n):i=n??1/0,function(o={}){const{connector:a=(()=>new ts),resetOnError:l=!0,resetOnComplete:h=!0,resetOnRefCountZero:u=!0}=o;return c=>{let d,p,f,g=0,m=!1,y=!1;const _=()=>{p?.unsubscribe(),p=void 0},v=()=>{_(),d=f=void 0,m=y=!1},x=()=>{const b=d;v(),b?.unsubscribe()};return xn((b,M)=>{g++,!y&&!m&&_();const w=f=f??a();M.add(()=>{g--,0===g&&!y&&!m&&(p=k0(x,u))}),w.subscribe(M),!d&&g>0&&(d=new ui({next:S=>w.next(S),error:S=>{y=!0,_(),p=k0(v,l,S),w.error(S)},complete:()=>{m=!0,_(),p=k0(v,h),w.complete()}}),or(b).subscribe(d))})(c)}}({connector:()=>new vw(i,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function I0(n){return xn((t,e)=>{let i,r=null,s=!1;r=t.subscribe(an(e,void 0,void 0,o=>{i=or(n(o,I0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}const bw=new Ai(n=>n.complete());function P0(n){return n<=0?()=>bw:xn((t,e)=>{let i=0;t.subscribe(an(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}var ww={},qT={};function VT(n){for(var t=[],e=0,i=0,r=0;r<n.length;r+=1){var s=ww[n[r]];if(void 0===s)throw new Error("Invalid character ("+n[r]+")");var o=32&s;if(i+=(s&=31)<<e,o)e+=5;else{var a=1&i;i>>>=1,t.push(a?0===i?-2147483648:-i:i),i=e=0}}return t}"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(function(n,t){ww[n]=t,qT[t]=n});const ed="TOKEN_LOGGER_CONFIG";class ZT{constructor(t){this.config=this._clone(t)}get level(){return this.config.level}get serverLogLevel(){return this.config.serverLogLevel}updateConfig(t){this.config=this._clone(t)}partialUpdateConfig(t){t&&Object.keys(t).forEach(e=>{this.config[e]=t[e]})}getConfig(){return this._clone(this.config)}_clone(t){const e={level:null};return Object.keys(t).forEach(i=>{e[i]=t[i]}),e}}const fh="TOKEN_LOGGER_CONFIG_ENGINE_FACTORY";class BT{provideConfigEngine(t){return new ZT(t)}}const gh="TOKEN_LOGGER_MAPPER_SERVICE";let WT=(()=>{class n{constructor(e){this.httpBackend=e,this.sourceMapCache=new Map,this.logPositionCache=new Map}getLogPosition(e,i){const r=this.getStackLine(e);if(!r)return $r({fileName:"",lineNumber:0,columnNumber:0});const s=this.getLocalPosition(r);if(!e.enableSourceMaps)return $r(s);const o=this.getSourceMapLocation(r);return this.getSourceMap(o,s)}getStackLine(e){const i=new Error;try{throw i}catch{try{let r=4;return i.stack.split("\n")[0].includes(".js:")||(r+=1),i.stack.split("\n")[r+(e.proxiedSteps||0)]}catch{return null}}}getLocalPosition(e){const i=e.lastIndexOf("/");let r=e.indexOf(")");r<0&&(r=void 0);const s=e.substring(i+1,r).split(":");return 3===s.length?{fileName:s[0],lineNumber:+s[1],columnNumber:+s[2]}:{fileName:"unknown",lineNumber:0,columnNumber:0}}getTranspileLocation(e){let i=e.indexOf("(");i<0&&(i=e.lastIndexOf("@"),i<0&&(i=e.lastIndexOf(" ")));let r=e.indexOf(")");return r<0&&(r=void 0),e.substring(i+1,r)}getSourceMapLocation(e){const i=this.getTranspileLocation(e),r=i.substring(0,i.lastIndexOf(":"));return r.substring(0,r.lastIndexOf(":"))+".map"}getMapping(e,i){let r=0,s=0,o=0;const a=e.mappings.split(";");for(let l=0;l<a.length;l++){let h=0;const u=a[l].split(",");for(let c=0;c<u.length;c++){const d=VT(u[c]);if(d.length>=4&&(h+=d[0],r+=d[1],s+=d[2],o+=d[3]),l===i.lineNumber){if(h===i.columnNumber)return{fileName:e.sources[r],lineNumber:s,columnNumber:o};if(c+1===u.length)return{fileName:e.sources[r],lineNumber:s,columnNumber:0}}}}return{fileName:"unknown",lineNumber:0,columnNumber:0}}getSourceMap(e,i){const r=new fo("GET",e),s=`${i.fileName}:${i.lineNumber}:${i.columnNumber}`;if(this.logPositionCache.has(s))return this.logPositionCache.get(s);this.sourceMapCache.has(e)||(this.httpBackend?this.sourceMapCache.set(e,this.httpBackend.handle(r).pipe(Yc(a=>a instanceof za),bn(a=>a.body),function(l=1/0){let h;h=l&&"object"==typeof l?l:{count:l};const{count:u=1/0,delay:c,resetOnSuccess:d=!1}=h;return u<=0?ar:xn((p,f)=>{let g,m=0;const y=()=>{let _=!1;g=p.subscribe(an(f,v=>{d&&(m=0),f.next(v)},void 0,v=>{if(m++<u){const x=()=>{g?(g.unsubscribe(),g=null,y()):_=!0};if(null!=c){const b="number"==typeof c?_w(c):or(c(v,m)),M=an(f,()=>{M.unsubscribe(),x()},()=>{f.complete()});b.subscribe(M)}else x()}else f.error(v)})),_&&(g.unsubscribe(),g=null,y())};y()})}(3),xw(1))):(console.error("NGXLogger : Can't get sourcemap because HttpBackend is not provided. You need to import HttpClientModule"),this.sourceMapCache.set(e,$r(null))));const o=this.sourceMapCache.get(e).pipe(bn(a=>a?this.getMapping(a,i):i),I0(()=>$r(i)),xw(1));return this.logPositionCache.set(s,o),o}}return n.\u0275fac=function(t){return new(t||n)(X(Kc,8))},n.\u0275prov=vt({token:n,factory:n.\u0275fac}),n})();const mh="TOKEN_LOGGER_METADATA_SERVICE";let HT=(()=>{class n{constructor(e){this.datePipe=e}computeTimestamp(e){const i=()=>(new Date).toISOString();return e.timestampFormat?this.datePipe?this.datePipe.transform(new Date,e.timestampFormat):(console.error("NGXLogger : Can't use timeStampFormat because DatePipe is not provided. You need to provide DatePipe"),i()):i()}getMetadata(e,i,r,s){const o={level:e,additional:s};return o.message=r&&"function"==typeof r?r():r,o.timestamp=this.computeTimestamp(i),o}}return n.\u0275fac=function(t){return new(t||n)(X(gC,8))},n.\u0275prov=vt({token:n,factory:n.\u0275fac}),n})();const yh="TOKEN_LOGGER_RULES_SERVICE";let UT=(()=>{class n{shouldCallWriter(e,i,r,s){return!i.disableConsoleLogging&&e>=i.level}shouldCallServer(e,i,r,s){return!!i.serverLoggingUrl&&e>=i.serverLogLevel}shouldCallMonitor(e,i,r,s){return this.shouldCallWriter(e,i,r,s)||this.shouldCallServer(e,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=vt({token:n,factory:n.\u0275fac}),n})();const _h="TOKEN_LOGGER_SERVER_SERVICE";let XT=(()=>{class n{constructor(e,i){this.httpBackend=e,this.ngZone=i,this.serverCallsQueue=[],this.flushingQueue=new Va(!1)}ngOnDestroy(){this.flushingQueue&&(this.flushingQueue.complete(),this.flushingQueue=null),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null)}secureErrorObject(e){return e?.stack}secureAdditionalParameters(e){return null==e?null:e.map((i,r)=>{try{return i instanceof Error?this.secureErrorObject(i):("object"==typeof i&&JSON.stringify(i),i)}catch{return`The additional[${r}] value could not be parsed using JSON.stringify().`}})}secureMessage(e){try{if(e instanceof Error)return this.secureErrorObject(e);"string"!=typeof e&&(e=JSON.stringify(e,null,2))}catch{e='The provided "message" value could not be parsed with JSON.stringify().'}return e}alterHttpRequest(e){return e}logOnServer(e,i,r){if(!this.httpBackend)return console.error("NGXLogger : Can't log on server because HttpBackend is not provided. You need to import HttpClientModule"),$r(null);let s=new fo("POST",e,i,r||{}),o=$r(s);const a=this.alterHttpRequest(s);return(h=a)&&(h instanceof Ai||Ct(h.lift)&&Ct(h.subscribe))?o=a:a?o=$r(a):console.warn("NGXLogger : alterHttpRequest returned an invalid request. Using default one instead"),o.pipe(nw(l=>l?this.httpBackend.handle(l):(console.warn("NGXLogger : alterHttpRequest returned an invalid request (observable). Using default one instead"),this.httpBackend.handle(s))),Yc(l=>l instanceof za),bn(l=>l.body));var h}customiseRequestBody(e){return e}flushQueue(e){this.flushingQueue.next(!0),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null),this.serverCallsQueue&&this.serverCallsQueue.length>0&&this.sendToServerAction(this.serverCallsQueue,e),this.serverCallsQueue=[],this.flushingQueue.next(!1)}sendToServerAction(e,i){let r;const s=l=>{const h={...l};return h.additional=this.secureAdditionalParameters(h.additional),h.message=this.secureMessage(h.message),h};Array.isArray(e)?(r=[],e.forEach(l=>{r.push(s(l))})):r=s(e),r=this.customiseRequestBody(r);const o=i.customHttpHeaders||new Sr;o.has("Content-Type")||o.set("Content-Type","application/json");const a=()=>{this.logOnServer(i.serverLoggingUrl,r,{headers:o,params:i.customHttpParams||new Yr,responseType:i.httpResponseType||"json",withCredentials:i.withCredentials||!1}).pipe(I0(l=>(console.error("NGXLogger: Failed to log on server",l),function(u,c){const d=Ct(u)?u:()=>u;return new Ai(f=>f.error(d()))}(l)))).subscribe()};if(!0===i.serverCallsOutsideNgZone){if(!this.ngZone)return void console.error("NGXLogger: NgZone is not provided and serverCallsOutsideNgZone is set to true");this.ngZone.runOutsideAngular(a)}else a()}sendToServer(e,i){if((!i.serverCallsBatchSize||i.serverCallsBatchSize<=0)&&(!i.serverCallsTimer||i.serverCallsTimer<=0))return void this.sendToServerAction(e,i);const r=()=>{this.serverCallsQueue.push({...e}),i.serverCallsBatchSize&&this.serverCallsQueue.length>i.serverCallsBatchSize&&this.flushQueue(i),i.serverCallsTimer>0&&!this.addToQueueTimer&&(this.addToQueueTimer=_w(i.serverCallsTimer).subscribe(s=>{this.flushQueue(i)}))};!0===this.flushingQueue.value?this.flushingQueue.pipe(Yc(s=>!1===s),P0(1)).subscribe(s=>{r()}):r()}}return n.\u0275fac=function(t){return new(t||n)(X(Kc,8),X(Ri,8))},n.\u0275prov=vt({token:n,factory:n.\u0275fac}),n})();const vh="TOKEN_LOGGER_WRITER_SERVICE";var Mi=function(n){return n[n.TRACE=0]="TRACE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.LOG=3]="LOG",n[n.WARN=4]="WARN",n[n.ERROR=5]="ERROR",n[n.FATAL=6]="FATAL",n[n.OFF=7]="OFF",n}(Mi||{});const $T=["purple","teal","gray","gray","red","red","red"];let YT=(()=>{class n{constructor(e){this.platformId=e,this.prepareMetaStringFuncs=[this.getTimestampToWrite,this.getLevelToWrite,this.getFileDetailsToWrite,this.getContextToWrite],this.isIE=function(r){return r===c1}(e)&&navigator&&navigator.userAgent&&!(-1===navigator.userAgent.indexOf("MSIE")&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.logFunc=this.isIE?this.logIE.bind(this):this.logModern.bind(this)}getTimestampToWrite(e,i){return e.timestamp}getLevelToWrite(e,i){return Mi[e.level]}getFileDetailsToWrite(e,i){return!0===i.disableFileDetails?"":`[${e.fileName}:${e.lineNumber}:${e.columnNumber}]`}getContextToWrite(e,i){return i.context?`{${i.context}}`:""}prepareMetaString(e,i){let r="";return this.prepareMetaStringFuncs.forEach(s=>{const o=s(e,i);o&&(r=r+" "+o)}),r.trim()}getColor(e,i){if(e.level!==Mi.OFF)return(i.colorScheme??$T)[e.level]}logIE(e,i,r){const s=e.additional||[];switch(e.level){case Mi.WARN:console.warn(`${r} `,e.message,...s);break;case Mi.ERROR:case Mi.FATAL:console.error(`${r} `,e.message,...s);break;case Mi.INFO:console.info(`${r} `,e.message,...s);break;default:console.log(`${r} `,e.message,...s)}}logModern(e,i,r){const s=this.getColor(e,i),o=e.additional||[];switch(e.level){case Mi.WARN:console.warn(`%c${r}`,`color:${s}`,e.message,...o);break;case Mi.ERROR:case Mi.FATAL:console.error(`%c${r}`,`color:${s}`,e.message,...o);break;case Mi.INFO:console.info(`%c${r}`,`color:${s}`,e.message,...o);break;case Mi.DEBUG:console.debug(`%c${r}`,`color:${s}`,e.message,...o);break;default:console.log(`%c${r}`,`color:${s}`,e.message,...o)}}writeMessage(e,i){const r=this.prepareMetaString(e,i);this.logFunc(e,i,r)}}return n.\u0275fac=function(t){return new(t||n)(X(Io))},n.\u0275prov=vt({token:n,factory:n.\u0275fac}),n})(),go=(()=>{class n{constructor(e,i,r,s,o,a,l){this.metadataService=r,this.ruleService=s,this.mapperService=o,this.writerService=a,this.serverService=l,this.configEngine=i.provideConfigEngine(e)}get level(){return this.configEngine.level}get serverLogLevel(){return this.configEngine.serverLogLevel}trace(e,...i){this._log(Mi.TRACE,e,i)}debug(e,...i){this._log(Mi.DEBUG,e,i)}info(e,...i){this._log(Mi.INFO,e,i)}log(e,...i){this._log(Mi.LOG,e,i)}warn(e,...i){this._log(Mi.WARN,e,i)}error(e,...i){this._log(Mi.ERROR,e,i)}fatal(e,...i){this._log(Mi.FATAL,e,i)}setCustomHttpHeaders(e){const i=this.getConfigSnapshot();i.customHttpHeaders=e,this.updateConfig(i)}setCustomParams(e){const i=this.getConfigSnapshot();i.customHttpParams=e,this.updateConfig(i)}setWithCredentialsOptionValue(e){const i=this.getConfigSnapshot();i.withCredentials=e,this.updateConfig(i)}registerMonitor(e){this._loggerMonitor=e}updateConfig(e){this.configEngine.updateConfig(e)}partialUpdateConfig(e){this.configEngine.partialUpdateConfig(e)}getConfigSnapshot(){return this.configEngine.getConfig()}flushServerQueue(){this.serverService.flushQueue(this.getConfigSnapshot())}_log(e,i,r=[]){const s=this.configEngine.getConfig(),o=this.ruleService.shouldCallWriter(e,s,i,r),a=this.ruleService.shouldCallServer(e,s,i,r),l=this.ruleService.shouldCallMonitor(e,s,i,r);if(!o&&!a&&!l)return;const h=this.metadataService.getMetadata(e,s,i,r);this.mapperService.getLogPosition(s,h).pipe(P0(1)).subscribe(u=>{u&&(h.fileName=u.fileName,h.lineNumber=u.lineNumber,h.columnNumber=u.columnNumber),l&&this._loggerMonitor&&this._loggerMonitor.onLog(h,s),o&&this.writerService.writeMessage(h,s),a&&this.serverService.sendToServer(h,s)})}}return n.\u0275fac=function(t){return new(t||n)(X(ed),X(fh),X(mh),X(yh),X(gh),X(vh),X(_h))},n.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),KT=(()=>{class n{constructor(e,i,r,s,o,a,l){this.logger=e,this.configEngineFactory=i,this.metadataService=r,this.ruleService=s,this.mapperService=o,this.writerService=a,this.serverService=l}create(e,i,r,s){return this.getNewInstance({config:e,serverService:i,logMonitor:r,mapperService:s})}getNewInstance(e){const i=new go(e?.config??this.logger.getConfigSnapshot(),e?.configEngineFactory??this.configEngineFactory,e?.metadataService??this.metadataService,e?.ruleService??this.ruleService,e?.mapperService??this.mapperService,e?.writerService??this.writerService,e?.serverService??this.serverService);return e?.partialConfig&&i.partialUpdateConfig(e.partialConfig),e?.logMonitor&&i.registerMonitor(e.logMonitor),i}}return n.\u0275fac=function(t){return new(t||n)(X(go),X(fh),X(mh),X(yh),X(gh),X(vh),X(_h))},n.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JT=(()=>{class n{static forRoot(e,i){if(i||(i={}),i.configProvider){if(i.configProvider.provide!==ed)throw new Error(`Wrong injection token for configProvider, it should be ${ed} and you used ${i.configProvider.provide}`)}else i.configProvider={provide:ed,useValue:e||{}};if(i.configEngineFactoryProvider){if(i.configEngineFactoryProvider.provide!==fh)throw new Error(`Wrong injection token for configEngineFactoryProvider, it should be '${fh}' and you used '${i.configEngineFactoryProvider.provide}'`)}else i.configEngineFactoryProvider={provide:fh,useClass:BT};if(i.metadataProvider){if(i.metadataProvider.provide!==mh)throw new Error(`Wrong injection token for metadataProvider, it should be '${mh}' and you used '${i.metadataProvider.provide}'`)}else i.metadataProvider={provide:mh,useClass:HT};if(i.ruleProvider){if(i.ruleProvider.provide!==yh)throw new Error(`Wrong injection token for ruleProvider, it should be '${yh}' and you used '${i.ruleProvider.provide}'`)}else i.ruleProvider={provide:yh,useClass:UT};if(i.mapperProvider){if(i.mapperProvider.provide!==gh)throw new Error(`Wrong injection token for mapperProvider, it should be '${gh}' and you used '${i.mapperProvider.provide}'`)}else i.mapperProvider={provide:gh,useClass:WT};if(i.writerProvider){if(i.writerProvider.provide!==vh)throw new Error(`Wrong injection token for writerProvider, it should be '${vh}' and you used '${i.writerProvider.provide}'`)}else i.writerProvider={provide:vh,useClass:YT};if(i.serverProvider){if(i.serverProvider.provide!==_h)throw new Error(`Wrong injection token for serverProvider, it should be '${_h}' and you used '${i.writerProvider.provide}'`)}else i.serverProvider={provide:_h,useClass:XT};return{ngModule:n,providers:[go,i.configProvider,i.configEngineFactoryProvider,i.metadataProvider,i.ruleProvider,i.mapperProvider,i.writerProvider,i.serverProvider,KT]}}static forChild(){return{ngModule:n}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=vo({type:n}),n.\u0275inj=ge({imports:[[ul]]}),n})(),QT=(()=>{class n{constructor(e){this.http=e}getMatrixSet(e){return this.http.get(e)}getMatrix(e){return this.http.get(e)}static#t=this.\u0275fac=function(e){return new(e||n)(X(Qc))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tk(n,t){1&n&&Do(0,"app-objectinfo-view",3),2&n&&os("feature",Jh().curFeature)}function Cw(n){return null!=n&&"false"!=`${n}`}let Mw=(()=>{class n{set showGrid(e){this._showGrid=Cw(e)}get showGrid(){return this._showGrid}set showObjectInfo(e){this._showObjectInfo=Cw(e)}get showObjectInfo(){return this._showObjectInfo}set zoom(e){this._zoom=e,-1!=e&&(this.map.getView().setZoom(e),this.currentZoomLevel.next(e))}get zoom(){return this._zoom}constructor(e,i,r,s){this.logger=e,this.elementRef=i,this.matrixsetService=r,this.cdf=s,this.title="view-component",this.map=new ra({}),this.xyzSelector="/{z}/{y}/{x}?f=mvt",this._showGrid=!1,this._showObjectInfo=!1,this._zoom=-1,this.tileUrl=Qf,this.currentZoomLevel=new Cn,this.activeFeature=new Cn,this.activeTileUrl=new Cn,this.mapHeight=600,this.mapWidth=800}ngOnChanges(e){e.styleUrl?.previousValue!==e.styleUrl?.currentValue&&(e.styleUrl.isFirstChange()||this.vectorTileLayer&&this.setStyle(this.vectorTileLayer)),e.tileUrl?.previousValue!==e.tileUrl?.currentValue&&(this.maxZoom=void 0,this.minZoom=void 0,this.zoom=-1,this.checkParams(),this.initialize())}initialize(){this.vectorTileLayer=void 0;let e=this.tileUrl.replace("tiles","tileMatrixSets")+"?f=json";this.matrixsetService.getMatrix(this.tileUrl).subscribe({next:i=>{const r=this.FindMatrixUrl(i.links);r?e=r:this.logger.log("tileurl :"+this.tileUrl+"not found"),this.drawFromMatrixUrl(i,e),this.SetZoomLevel(i),this.cdf.detectChanges()},error:i=>{this.logger.log(this.id+"error: "+JSON.stringify(i))}})}SetZoomLevel(e){e.tileMatrixSetLimits.forEach(i=>{this.minZoom||(this.minZoom=parseFloat(i.tileMatrix)+.01,this.zoom=this.minZoom),this.maxZoom=parseFloat(i.tileMatrix)+1})}FindMatrixUrl(e){let i;return e.forEach(r=>{if("http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"==r.rel){const s=new URL(this.tileUrl);i=this.isFullURL(r.href)?r.href:new URL(s.origin+r.href).href}}),i}drawFromMatrixUrl(e,i){this.matrixsetService.getMatrixSet(i).subscribe({next:r=>{const s=[],o=[],a=[];r.tileMatrices.forEach(l=>{s[l.id]=l.cellSize,o[l.id]=this.tileUrl.includes(Yv)?[l.pointOfOrigin[1],l.pointOfOrigin[0]]:l.pointOfOrigin,a[l.id]=[l.tileWidth,l.tileHeight]}),this.tileGrid=new xs({resolutions:s,tileSizes:a,origins:o}),this.drawMap(e)},error:r=>{this.logger.log(this.id+"tilematrixset not found: "+i,r),this.projection=new Jv(this.tileUrl).Projection,this.tileGrid=new xs({extent:this.projection.getExtent(),resolutions:this.calcResolutions(this.projection),tileSize:[256,256],origin:Gn(this.projection.getExtent())}),this.drawMap(e)}})}drawMap(e){this.map.setTarget(void 0),this.map=new ra({});const i=this.getMap();i.on("pointermove",s=>{i.forEachFeatureAtPixel(s.pixel,o=>{o&&(this._showObjectInfo&&(this.curFeature=o,this.cdf.detectChanges()),this.activeFeature.emit(o))},{hitTolerance:3})}),i.getView().on("change:resolution",()=>{const s=this.map.getView().getZoom();this.logger.log("zoom"+s),s&&(this._zoom=s,this.currentZoomLevel.next(s))}),this.SetZoomLevel(e);const r=this.elementRef.nativeElement.querySelector("[id='map']");this.mapWidth=this.elementRef.nativeElement.offsetWidth,this.mapHeight=.75*this.elementRef.nativeElement.offsetWidth,i.setTarget(r),this.cdf.detectChanges()}checkParams(){this.logger.log(this.id),this.tileUrl||this.logger.error("No TilteUrl was provided for the app-vectortile-view"),this.styleUrl||this.logger.log("No StyleUrl was provided for the app-vectortile-view"),this.centerX?this.logger.log("center-x="+this.centerX):this.logger.error("No zoom center-x was provided for the app-vectortile-view"),this.centerY?this.logger.log("center-y="+this.centerY):this.logger.error("No center-y was provided for the app-vectortile-view")}getMap(){qn=Se("EPSG:4326");const e=this.generateLayers(),i=e.layers,r=[this.centerX,this.centerY];this.vectorTileLayer=e.vectorTileLayer;const s=V_({zoom:this.maxZoom-this.minZoom>1}).extend([new vT]);return this.map=new ra({controls:s,layers:i,view:new kn({center:r,zoom:this.zoom,maxZoom:this.maxZoom,minZoom:this.minZoom,enableRotation:!1,projection:this.projection})}),this.map}generateLayers(){this.projection=new Jv(this.tileUrl).Projection;const e=this.getVectorTileLayer(this.projection);this.setStyle(e);let i=[e];if(this.showGrid){const r=e.getSource();if(r){const s=r.getTileGrid();s&&(i=[e,new x0({source:new LM({template:"z:{z} y:{y} x:{x}",projection:this.projection,tileGrid:s,wrapX:r.getWrapX(),zDirection:1})})])}}return{vectorTileLayer:e,layers:i}}setStyle(e){if(this.styleUrl){const i=e.getSource()?.getProjection();Db(e,this.styleUrl).then(()=>{this.tileUrl!==Qf&&e.setSource(this.getVectorTileSource(i,this.tileUrl))}).catch(r=>this.logger.error("error loading: "+this.id+" "+this.styleUrl+" "+r))}else{const i=new Pn({fill:new Wn({color:"rgba(255,255,255,0.4)"}),stroke:new Un({color:"#3399CC",width:1.25})});e.setStyle(i)}}getVectorTileLayer(e){return new oh({source:this.getVectorTileSource(e,this.tileUrl),renderMode:"hybrid",declutter:!0,useInterimTilesOnError:!1,minZoom:-1})}calcResolutions(e){const i=qe(e.getExtent())/256,r=[];for(let s=0;s<=21;s++)r[s]=i/Math.pow(2,s);return r}getVectorTileSource(e,i){const r=new qf({format:new gg,projection:e,tileGrid:this.tileGrid,url:i+this.xyzSelector,cacheSize:0});return r.on(["tileloadend"],s=>{this.activeTileUrl.next(s.tile.key)}),r}isFullURL(e){return e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")}static#t=this.\u0275fac=function(e){return new(e||n)(bi(go),bi(nl),bi(QT),bi(Py))};static#e=this.\u0275cmp=hn({type:n,selectors:[["app-vectortile-view"]],inputs:{showGrid:"showGrid",showObjectInfo:"showObjectInfo",tileUrl:"tileUrl",styleUrl:"styleUrl",id:"id",zoom:"zoom",centerX:"centerX",centerY:"centerY"},outputs:{currentZoomLevel:"currentZoomLevel",activeFeature:"activeFeature",activeTileUrl:"activeTileUrl"},standalone:!0,features:[Ph,al],decls:3,vars:5,consts:[["id","map",1,"maparea"],[1,"toprightpanel"],["class","objectinfopanel","id","objectinfo",3,"feature",4,"ngIf"],["id","objectinfo",1,"objectinfopanel",3,"feature"]],template:function(e,i){1&e&&(cn(0,"div",0)(1,"div",1),Lo(2,tk,1,1,"app-objectinfo-view",2),Mn()()),2&e&&($h("width",i.mapWidth,"px")("height",i.mapHeight,"px"),ss(2),os("ngIf",i.showObjectInfo))},dependencies:[ul,wp],styles:[".maparea[_ngcontent-%COMP%]{z-index:1;position:relative;display:flex;background:#fff}.toprightpanel[_ngcontent-%COMP%]{position:absolute;flex:1;top:6%;right:1%;z-index:2;max-height:90%;max-width:40%;height:100%}"],changeDetection:0})}return n})();const id={schedule(n,t){const e=setTimeout(n,t);return()=>clearTimeout(e)},scheduleBeforeRender(n){if(typeof window>"u")return id.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return id.schedule(n,16);const t=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(t)}};let R0;function ek(n,t,e){let i=e;return function(s){return!!s&&s.nodeType===Node.ELEMENT_NODE}(n)&&t.some((r,s)=>!("*"===r||!function(a,l){if(!R0){const h=Element.prototype;R0=h.matches||h.matchesSelector||h.mozMatchesSelector||h.msMatchesSelector||h.oMatchesSelector||h.webkitMatchesSelector}return a.nodeType===Node.ELEMENT_NODE&&R0.call(a,l)}(n,r)||(i=s,0))),i}class ik{constructor(t,e){this.componentFactory=e.get(Ro).resolveComponentFactory(t)}create(t){return new nk(this.componentFactory,t)}}class nk{constructor(t,e){this.componentFactory=t,this.injector=e,this.eventEmitters=new vw(1),this.events=this.eventEmitters.pipe(sw(i=>function(...s){const o=Zb(s),a="number"==typeof Vb(u=s)?u.pop():1/0,l=s;var u;return l.length?1===l.length?or(l[0]):function(u=1/0){return $c(ar,u)}(a)(b0(l,o)):bw}(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(Ri),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=id.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(t){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e,i){this.runInZone(()=>{i&&(e=i.call(this.componentRef?.instance,e)),null!==this.componentRef?function(s,o){return s===o||s!=s&&o!=o}(e,this.getInputValue(t))&&(void 0!==e||!this.unchangedInputs.has(t))||(this.recordInputChange(t,e),this.unchangedInputs.delete(t),this.hasInputChanges=!0,this.componentRef.instance[t]=e,this.scheduleDetectChanges()):this.initialInputValues.set(t,e)})}initializeComponent(t){const e=il.create({providers:[],parent:this.injector}),i=function(s,o){const a=s.childNodes,l=o.map(()=>[]);let h=-1;o.some((u,c)=>"*"===u&&(h=c,!0));for(let u=0,c=a.length;u<c;++u){const d=a[u],p=ek(d,o,h);-1!==p&&l[p].push(d)}return l}(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,i,t),this.viewChangeDetectorRef=this.componentRef.injector.get(Py),this.implementsOnChanges=function(s){return"function"==typeof s}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(iu).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:t,transform:e})=>{this.initialInputValues.has(t)&&this.setInputValue(t,this.initialInputValues.get(t),e)}),this.initialInputValues.clear()}initializeOutputs(t){const e=this.componentFactory.outputs.map(({propName:i,templateName:r})=>t.instance[i].pipe(bn(s=>({name:r,value:s}))));this.eventEmitters.next(e)}callNgOnChanges(t){if(!this.implementsOnChanges||null===this.inputChanges)return;const e=this.inputChanges;this.inputChanges=null,t.instance.ngOnChanges(e)}markViewForCheck(t){this.hasInputChanges&&(this.hasInputChanges=!1,t.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=id.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(t,e){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[t];if(i)return void(i.currentValue=e);const r=this.unchangedInputs.has(t),s=r?void 0:this.getInputValue(t);this.inputChanges[t]=new X0(s,e,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}}class rk extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function nd(n,t){const e=(a=n,t.injector.get(Ro).resolveComponentFactory(a).inputs),i=t.strategyFactory||new ik(n,t.injector),r=function(a){const l={};return a.forEach(({propName:h,templateName:u,transform:c})=>{var p;l[(p=u,p.replace(/[A-Z]/g,f=>`-${f.toLowerCase()}`))]=[h,c]}),l}(e);var a;class s extends rk{static#t=this.observedAttributes=Object.keys(r);get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||t.injector);e.forEach(({propName:l,transform:h})=>{if(!this.hasOwnProperty(l))return;const u=this[l];delete this[l],a.setInputValue(l,u,h)})}return this._ngElementStrategy}constructor(a){super(),this.injector=a}attributeChangedCallback(a,l,h,u){const[c,d]=r[a];this.ngElementStrategy.setInputValue(c,h,d)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(l)})}}return e.forEach(({propName:o,transform:a})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(l){this.ngElementStrategy.setInputValue(o,l,a)},configurable:!0,enumerable:!0})}),s}function sk(n,t){if(1&n&&(cn(0,"tr")(1,"td"),No(2),Mn(),cn(3,"td"),No(4),Mn()()),2&n){const e=t.$implicit;ss(2),Qh(e.title),ss(2),Qh(e.value)}}function ok(n,t){if(1&n&&(cn(0,"table",2)(1,"caption",3),No(2," Object Informatie: "),Mn(),cn(3,"thead")(4,"th",4),No(5,"Veld"),Mn(),cn(6,"th",5),No(7,"Waarde"),Mn()(),cn(8,"tbody"),Lo(9,sk,5,2,"tr",6),Mn()()),2&n){const e=Jh();ss(9),os("ngForOf",e.getFeatureProperties())}}let ak=(()=>{class n{getFeatureProperties(){const e=[];if(this.feature){const i=this.feature.getProperties();for(const r in i)"mapbox-layer"!==r&&e.push({title:r,value:i[r]});return e}return[]}static#t=this.\u0275fac=function(e){return new(e||n)};static#e=this.\u0275cmp=hn({type:n,selectors:[["app-object-info"]],inputs:{feature:"feature"},standalone:!0,features:[al],decls:2,vars:1,consts:[["tabindex","0",1,"objectinfo"],["class","featuretable",4,"ngIf"],[1,"featuretable"],[1,"featuretablecaption"],["id","Veld"],["id","Waarde"],[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(cn(0,"div",0),Lo(1,ok,10,1,"table",1),Mn()),2&e&&(ss(),os("ngIf",i.getFeatureProperties().length>0))},dependencies:[ul,l1,wp],styles:[".objectinfo{margin-top:0;margin-bottom:0;margin-right:0;background-color:#fff;overflow-y:auto;overflow-x:auto;max-height:98%}.featuretable{text-align:left}.featuretablecaption{text-align:left;font-weight:700}\n"],encapsulation:3})}return n})();var Kr=function(n){return n.Circle="circle",n.Fill="fill",n.Line="line",n.Raster="raster",n.Symbol="symbol",n}(Kr||{});let Sw=(()=>{class n{constructor(e){this.http=e}getMapboxStyle(e){return this.http.get(e)}getLayersids(e){const i=[];return e.layers.forEach(r=>{i.push(r.id)}),i}removeRasterLayers(e){return e.layers=e.layers.filter(i=>i.type!==Kr.Raster),e}isFillPatternWithStops(e){return void 0!==e.stops}getItems(e,i,r){const s=[];return e.layers.forEach(o=>{const a=(h={},function c(d){if(Array.isArray(d)){const p=d[0],f=d.slice(1);"all"===p||"any"===p?f.forEach(g=>c(g)):("string"==typeof d[1]&&"string"==typeof d[2]&&(h[d[1]]=d[2]),"string"==typeof d[1]&&"number"==typeof d[2]&&(h[d[1]]=d[2]))}}(o.filter),h);var h;if(o.layout?.["text-field"]){const l=o.layout?.["text-field"].replace("{","").replace("}","");a[""+l]=l.substring(0,6);const h=i(o["source-layer"],a,r,o.id),u=l[0].toUpperCase()+l.substring(1);this.pushItem(h+" "+u,o,s,a)}else{let l=i(o["source-layer"],a,r,o.id);this.pushItem(l,o,s,a);let h={};o.type==Kr.Circle&&(h=o.paint["circle-color"]),o.type==Kr.Fill&&(h=o.paint["fill-color"],h||(h=o.paint["fill-pattern"])),h&&this.isFillPatternWithStops(h)&&h.stops.forEach(u=>{const c={};c[""+h.property]=u[0],l=u[0],this.pushItem(l,o,s,c)})}}),s.sort((o,a)=>o.title.localeCompare(a.title))}capitalizeFirstLetter(e){return[...e][0].toUpperCase()+e.slice(1)}idTitle(e,i,r,s){return s}customTitle(e,i,r){let s="";return r.forEach(o=>{var l,h;l=s,s=i[h=o]?l+" "+i[h]:l}),""===s&&(s=e+" "),s=s.trimStart(),s=s.replace("_"," "),[...s][0].toUpperCase()+s.slice(1)}pushItem(e,i,r,s={}){r.find(o=>o.title===e)||r.push({name:i.id,title:e,geoType:i.type,style:[],sourceLayer:i["source-layer"],feature:void 0,properties:s})}static#t=this.\u0275fac=function(e){return new(e||n)(X(Qc))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lk=(()=>{class n{constructor(e,i,r){this.logger=e,this.mapboxStyleService=i,this.elementRef=r,this._itemHeight=40,this._itemWidth=60,this.itemLeft=10,this.itemRight=50,this.extent=[0,0,this.itemWidth,this.itemHeight],this.projection=new zr({code:"pixel-map",units:"pixels",extent:this.extent}),this.map=new ra({}),this.vectorSource=new qf({format:new gg,projection:this.projection}),this.vectorLayer=new oh({source:this.vectorSource})}get itemHeight(){return this._itemHeight}get itemWidth(){return this._itemWidth}ngOnInit(){const e=this.newFeature(this.item);this.map=new ra({controls:[],interactions:[],layers:[this.vectorLayer],view:new kn({projection:this.projection,center:er(this.extent),zoom:2,minZoom:2,maxZoom:2})}),this.vectorLayer.getSource()?.setTileLoadFunction(s=>{const o=s;o.setLoader(()=>{const a=[];a.push(e),o.setFeatures(a)})});const i=[];i.push(1);const r=this.mapboxStyleService.getLayersids(this.mapboxStyle);Db(this.vectorLayer,this.mapboxStyle,r,void 0,i).then(()=>{this.vectorLayer.getSource()?.refresh();const s=this.elementRef.nativeElement.querySelector("[id='itemmap']");this.map.setTarget(s)}).catch(s=>{this.logger.error("error loading legend style:  "+s)})}newFeature(e){switch(e.geoType){case Kr.Fill:{const i=Au(this.extent);i.scale(.05,.05);const r=new br({geometry:i,layer:e.sourceLayer});return r.setProperties(e.properties),r}case Kr.Circle:case Kr.Raster:case Kr.Symbol:{const i=new br({geometry:new jr(er(this.extent)),layer:e.sourceLayer});return i.setProperties(e.properties),i}case Kr.Line:{const i=this.itemHeight/2,r=new br({geometry:new Zr([[this.itemLeft,i],[this.itemRight,i]]),layer:e.sourceLayer});return r.setProperties(e.properties),r}default:!function(r){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(r)}`)}(e.geoType)}}static#t=this.\u0275fac=function(e){return new(e||n)(bi(go),bi(Sw),bi(nl))};static#e=this.\u0275cmp=hn({type:n,selectors:[["app-legend-item"]],inputs:{item:"item",mapboxStyle:"mapboxStyle"},standalone:!0,features:[al],decls:1,vars:4,consts:[["id","itemmap",1,"legenditem"]],template:function(e,i){1&e&&Do(0,"div",0),2&e&&$h("width",i.itemWidth,"px")("height",i.itemHeight,"px")},changeDetection:0})}return n})();function hk(n,t){if(1&n&&(cn(0,"div",3),Do(1,"app-legend-item",4),cn(2,"div",5),No(3),Mn()()),2&n){const e=t.$implicit,i=Jh(2);ss(),os("item",e)("mapboxStyle",i.mapboxStyle),ss(2),Qh(e.title)}}function uk(n,t){if(1&n&&(cn(0,"div",1),Lo(1,hk,4,3,"div",2),Mn()),2&n){const e=Jh();ss(),os("ngForOf",e.LegendItems)}}let ck=(()=>{class n{constructor(e,i,r){this.logger=e,this.mapboxStyleService=i,this.elementRef=r,this.LegendItems=[],function(o=!1){Lb=o}(!0)}ngOnChanges(e){e.styleUrl?.previousValue!==e.styleUrl?.currentValue&&(e.styleUrl.isFirstChange()||this.generateLegend()),this.titleItems&&e.titleItems.previousValue!==e.titleItems.currentValue&&(e.titleItems.isFirstChange()||this.generateLegend())}ngOnInit(){this.generateLegend()}generateLegend(){this.styleUrl?this.mapboxStyleService.getMapboxStyle(this.styleUrl).subscribe(e=>{if(this.mapboxStyle=this.mapboxStyleService.removeRasterLayers(e),this.titleItems)if("id"===this.titleItems.toLocaleLowerCase())this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.idTitle,[]);else{const i=this.titleItems.split(",");this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.customTitle,i)}else this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.capitalizeFirstLetter,[])}):this.logger.error("no style url supplied")}static#t=this.\u0275fac=function(e){return new(e||n)(bi(go),bi(Sw),bi(nl))};static#e=this.\u0275cmp=hn({type:n,selectors:[["app-legend-view"]],inputs:{styleUrl:"styleUrl",titleItems:"titleItems"},standalone:!0,features:[Ph,al],decls:1,vars:1,consts:[["class","legendContainer",4,"ngIf"],[1,"legendContainer"],["class","legendItem",4,"ngFor","ngForOf"],[1,"legendItem"],[3,"item","mapboxStyle"],[1,"legendText"]],template:function(e,i){1&e&&Lo(0,uk,2,1,"div",0),2&e&&os("ngIf",i.LegendItems.length>0)},dependencies:[ul,l1,wp,lk],styles:[".legendContainer[_ngcontent-%COMP%]{display:flex;flex:0 1 auto;flex-wrap:wrap;flex-direction:column;justify-content:flex-start;align-items:flex-start;max-height:100%;padding:5px;margin:5px;min-height:0}.legendItem[_ngcontent-%COMP%]{max-width:23vw;display:flex;flex-wrap:nowrap;flex-direction:row;align-items:center;flex:0 1 auto}.legendText[_ngcontent-%COMP%]{font-size:calc((var(--h) / 3));margin-left:1em}"]})}return n})();const dk=class extends tr{constructor(t){super(),this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener("element",this.handleElementChanged),this.addChangeListener("map",this.handleMapChanged),this.addChangeListener("offset",this.handleOffsetChanged),this.addChangeListener("position",this.handlePositionChanged),this.addChangeListener("positioning",this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get("element")}getId(){return this.id}getMap(){return this.get("map")||null}getOffset(){return this.get("offset")}getPosition(){return this.get("position")}getPositioning(){return this.get("positioning")}handleElementChanged(){N_(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(Gu(this.element),si(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=_e(t,"postrender",this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set("element",t)}setMap(t){this.set("map",t)}setOffset(t){this.set("offset",t)}setPosition(t){this.set("position",t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get("position"))return;const i=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),s=this.getRect(r,[rM(r),sM(r)]),o=void 0===(t=t||{}).margin?20:t.margin;if(!ps(i,s)){const a=s[0]-i[0],l=i[2]-s[2],h=s[1]-i[1],u=i[3]-s[3],c=[0,0];if(a<0?c[0]=a-o:l<0&&(c[0]=Math.abs(l)+o),h<0?c[1]=h-o:u<0&&(c[1]=Math.abs(u)+o),0!==c[0]||0!==c[1]){const d=e.getView().getCenterInternal(),p=e.getPixelFromCoordinateInternal(d);if(!p)return;const f=[p[0]+c[0],p[1]+c[1]],g=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(f),duration:g.duration,easing:g.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),r=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[r,s,r+e[0],s+e[1]]}setPositioning(t){this.set("positioning",t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(i,r)}updateRenderedPosition(t,e){const i=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);let o="0%",a="0%";"bottom-right"==s||"center-right"==s||"top-right"==s?o="-100%":("bottom-center"==s||"center-center"==s||"top-center"==s)&&(o="-50%"),"bottom-left"==s||"bottom-center"==s||"bottom-right"==s?a="-100%":("center-left"==s||"center-center"==s||"center-right"==s)&&(a="-50%");const l=`translate(${o}, ${a}) translate(${Math.round(t[0]+r[0])+"px"}, ${Math.round(t[1]+r[1])+"px"})`;this.rendered.transform_!=l&&(this.rendered.transform_=l,i.transform=l)}getOptions(){return this.options}},pk=class extends uv{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:void 0!==t.crossOrigin?t.crossOrigin:"anonymous",interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:t.wrapX,zDirection:t.zDirection})}};function Ew(n,t){const e=[];Object.keys(t).forEach(function(r){null!=t[r]&&e.push(r+"="+encodeURIComponent(t[r]))});const i=e.join("&");return n=n.replace(/[?&]$/,""),(n+=n.includes("?")?"&":"?")+i}const fk=class extends Gf{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let r=t.urls;void 0===r&&void 0!==t.url&&(r=zf(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:r,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),r&&r.length>0&&(this.tileUrlFunction=Nf(r.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Nf(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?Ew(t,i):t.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const r=this.tileGrid,s=this.dimensions_;return function(o,a,l){if(!o)return;const h={TileMatrix:r.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,s);let u=t;return u="KVP"==e?Ew(u,h):u.replace(/\{(\w+?)\}/g,function(c,d){return h[d]}),u}}},gk=class extends xs{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}},Tw={bgtBackgroundUrl:"https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0?",loglevel:Mi.OFF},kw={dataProjection:"EPSG:4326",visualProjection:"EPSG:3857"};let mk=(()=>{class n{constructor(e,i){this.logger=e,this.http=i}getFeatures(e){return this.logger.log(JSON.stringify(e)),this.http.get(e.url).pipe(bn(i=>(new fg).readFeatures(i,{dataProjection:e.dataMapping.dataProjection,featureProjection:e.dataMapping.visualProjection})))}getProjectionMapping(e="http://www.opengis.net/def/crs/OGC/1.3/CRS84"){return Kv(),e?"string"==typeof e?"CRS84"===e.substring(e.lastIndexOf("/")+1).toLocaleUpperCase()?kw:e.toLowerCase().startsWith("http://www.opengis.net/def/crs/epsg/")?{dataProjection:"EPSG:"+e.substring(e.lastIndexOf("/")+1),visualProjection:"EPSG:3857"}:{dataProjection:e,visualProjection:e}:(this.logger.error("wrong value:"),this.logger.error(e),e):{dataProjection:e,visualProjection:e}}static#t=this.\u0275fac=function(e){return new(e||n)(X(go),X(Qc))};static#e=this.\u0275prov=vt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class F0 extends ms{constructor(t,e,i){super(),void 0!==i&&void 0===e?this.setFlatCoordinates(i,t):this.setCenterAndRadius(t,e=e||0,i)}clone(){const t=new F0(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=t-s[0],a=e-s[1],l=o*o+a*a;if(l<r){if(0===l)for(let h=0;h<this.stride;++h)i[h]=s[h];else{const h=this.getRadius()/Math.sqrt(l);i[0]=s[0]+h*o,i[1]=s[1]+h*a;for(let u=2;u<this.stride;++u)i[u]=s[u]}return i.length=this.stride,l}return r}containsXY(t,e){const i=this.flatCoordinates,r=t-i[0],s=e-i[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return fr(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){if(_i(t,this.getExtent())){const e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||jp(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+i;for(let s=1;s<e;++s)r[e+s]=t[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=x_(r,0,t);r[s++]=r[0]+e;for(let o=1,a=this.stride;o<a;++o)r[s++]=r[o];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),r=this.getStride();this.setCenter(af(i,0,i.length,r,t,e,i)),this.changed()}}const yk=F0;class rd extends cr{constructor(t,e){super(t),this.feature=e}}function sd(n,t){return Nr(n[0],n[1],t[0],t[1])}function ja(n,t){const e=n.length;return t<0?n[t+e]:t>=e?n[t-e]:n[t]}function od(n,t,e){let i,r;t<e?(i=t,r=e):(i=e,r=t);const s=Math.ceil(i),o=Math.floor(r);if(s>o)return sd(Ga(n,i),Ga(n,r));let a=0;i<s&&(a+=sd(Ga(n,i),ja(n,s))),o<r&&(a+=sd(ja(n,o),Ga(n,r)));for(let l=s;l<o-1;++l)a+=sd(ja(n,l),ja(n,l+1));return a}function Iw(n,t,e){if(t instanceof Zr)ad(n,t.getCoordinates(),!1,e);else if(t instanceof hc){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r)ad(n,i[r],!1,e)}else if(t instanceof _s){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r)ad(n,i[r],!0,e)}else if(t instanceof cc){const i=t.getCoordinates();for(let r=0,s=i.length;r<s;++r){const o=i[r];for(let a=0,l=o.length;a<l;++a)ad(n,o[a],!0,e)}}else if(t instanceof lx){const i=t.getGeometries();for(let r=0;r<i.length;++r)Iw(n,i[r],e)}}const O0={index:-1,endIndex:NaN};function ad(n,t,e,i){const r=n[0],s=n[1];for(let o=0,a=t.length-1;o<a;++o){const l=Pw(r,s,t[o],t[o+1]);if(0===l.squaredDistance){const h=o+l.along;return void i.push({coordinates:t,ring:e,startIndex:h,endIndex:h})}}}const A0={along:0,squaredDistance:0};function Pw(n,t,e,i){const r=e[0],s=e[1],o=i[0]-r,a=i[1]-s;let l=0,h=r,u=s;return(0!==o||0!==a)&&(l=gi(((n-r)*o+(t-s)*a)/(o*o+a*a),0,1),h+=o*l,u+=a*l),A0.along=l,A0.squaredDistance=xu(Nr(n,t,h,u),10),A0}function Ga(n,t){const e=n.length;let i=Math.floor(t);const r=t-i;i>=e?i-=e:i<0&&(i+=e);let s=i+1;s>=e&&(s-=e);const o=n[i],a=o[0],l=o[1],h=n[s];return[a+(h[0]-a)*r,l+(h[1]-l)*r]}function _k(){const n=function(){const e={},i=[255,255,255,1],r=[0,153,255,1];return e.Polygon=[new Ts({fill:new Wn({color:[255,255,255,.5]})})],e.MultiPolygon=e.Polygon,e.LineString=[new Ts({stroke:new Un({color:i,width:5})}),new Ts({stroke:new Un({color:r,width:3})})],e.MultiLineString=e.LineString,e.Circle=e.Polygon.concat(e.LineString),e.Point=[new Ts({image:new $l({radius:6,fill:new Wn({color:r}),stroke:new Un({color:i,width:1.5})}),zIndex:1/0})],e.MultiPoint=e.Point,e.GeometryCollection=e.Polygon.concat(e.LineString,e.Point),e}();return function(t,e){return n[t.getGeometry().getType()]}}const vk=class extends na{constructor(t){const e=t;e.stopDown||(e.stopDown=jo),super(e),this.shouldHandle_=!1,this.downPx_=null,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(s){switch(s){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+s)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:zo,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const r=this.mode_;if("Circle"===r)i=function(s,o,a){const l=o||new yk([NaN,NaN]),h=Vn(s[0],a),u=Q1(h,Vn(s[s.length-1],a));l.setCenterAndRadius(h,Math.sqrt(u),this.geometryLayout_);const c=wl();return c&&l.transform(a,c),l};else{let s;"Point"===r?s=jr:"LineString"===r?s=Zr:"Polygon"===r&&(s=_s),i=function(o,a,l){return a?a.setCoordinates("Polygon"===r?o[0].length?[o[0].concat([o[0][0]])]:[]:o,this.geometryLayout_):a=new s(o,this.geometryLayout_),a}}}this.geometryFunction_=i,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Cc({source:new lo({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:_k(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:Pf,this.freehandCondition_=t.freehand?If:t.freehandCondition?t.freehandCondition:W_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener("active",this.updateState_)}setTrace(t){let e;e=t?!0===t?If:t:mM,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){"contextmenu"===t.originalEvent.type&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);let e=t.type===Ve.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===Ve.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===Ve.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===Ve.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===Ve.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===Ve.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t)):t.type===Ve.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new qr(Ve.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active)return void this.deactivateTrace_();const e=this.getMap(),i=pl([e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_])]),r=this.traceSource_.getFeaturesInExtent(i);if(0===r.length)return;const s=function(a,l){const h=[];for(let u=0;u<l.length;++u)Iw(a,l[u].getGeometry(),h);return h}(t.coordinate,r);s.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:s,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex;i===t.startIndex<=e?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const r=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),i=s-r+1}else{const r=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),i=r-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const r=[];if(e<i){const s=Math.ceil(e);let o=Math.floor(i);o===i&&(o-=1);for(let a=s;a<=o;++a)r.push(ja(t.coordinates,a))}else{const s=Math.floor(e);let o=Math.ceil(i);o===i&&(o+=1);for(let a=s;a>=o;--a)r.push(ja(t.coordinates,a))}r.length&&this.appendCoordinates(r)}updateTrace_(t){const e=this.traceState_;if(!e.active||-1===e.targetIndex&&t_(e.startPx,t.pixel)<this.snapTolerance_)return;const i=function(l,h,u,c){const d=l[0],p=l[1];let f=1/0,g=-1,m=NaN;for(let v=0;v<h.targets.length;++v){const x=h.targets[v],b=x.coordinates;let M,w=1/0;for(let S=0;S<b.length-1;++S){const R=Pw(d,p,b[S],b[S+1]);R.squaredDistance<w&&(w=R.squaredDistance,M=S+R.along)}w<f&&(f=w,x.ring&&h.targetIndex===v&&(x.endIndex>x.startIndex?M<x.startIndex&&(M+=b.length):x.endIndex<x.startIndex&&M>x.startIndex&&(M-=b.length)),m=M,g=v)}const y=h.targets[g];let _=y.ring;if(h.targetIndex===g&&_){const v=Ga(y.coordinates,m);t_(u.getPixelFromCoordinate(v),h.startPx)>c&&(_=!1)}if(_){const v=y.coordinates,x=v.length,b=y.startIndex,M=m;if(b<M){const w=od(v,b,M);od(v,b,M-x)<w&&(m-=x)}else{const w=od(v,b,M);od(v,b,M+x)<w&&(m+=x)}}return O0.index=g,O0.endIndex=m,O0}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(-1!==e.targetIndex){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=e.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else this.addOrRemoveTracedCoordinates_(e.targets[e.targetIndex],i.endIndex);e.targetIndex=i.index;const r=e.targets[e.targetIndex];r.endIndex=i.endIndex;const s=Ga(r.coordinates,r.endIndex),o=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(t){let e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const r=!this.finishCoordinate_;r&&this.startDrawing_(t.coordinate),!r&&this.freehand_?this.finishDrawing():!this.freehand_&&(!r||"Point"===this.mode_)&&(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,r=e[0]-i[0],s=e[1]-i[1],o=r*r+s*s;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(t),this.modifyDrawing_(t.coordinate)):this.createOrUpdateSketchPoint_(t.coordinate.slice())}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let r=!1,s=[this.finishCoordinate_];const o=this.mode_;if("Point"===o)i=!0;else if("Circle"===o)i=2===this.sketchCoords_.length;else if("LineString"===o)r=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===o){const a=this.sketchCoords_;r=a[0].length>this.minPoints_,s=[a[0][0],a[0][a[0].length-2]],s=e?[a[0][0]]:[a[0][0],a[0][a[0].length-2]]}if(r){const a=this.getMap();for(let l=0,h=s.length;l<h;l++){const u=s[l],c=a.getPixelFromCoordinate(u),d=t[0]-c[0],p=t[1]-c[1],f=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(d*d+p*p)<=f,i){this.finishCoordinate_=u;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new br(new jr(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new br);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new Zr(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=ku(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new br(new Zr(this.sketchLineCoords_)));const r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new br,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new rd("drawstart",this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),r=e.getView().getProjection(),s=ku(this.geometryLayout_);let o,a;for(;t.length<s;)t.push(0);"Point"===this.mode_?a=this.sketchCoords_:"Polygon"===this.mode_?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=t[0],a[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===i.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let r,s;const o=this.mode_;"LineString"===o||"Circle"===o?(this.finishCoordinate_=t.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),this.geometryFunction_(s,e,i)):"Polygon"===o&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),r&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),r&&this.finishDrawing()}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),r=this.mode_;for(let s=0;s<t;++s){let o;if("LineString"===r||"Circle"===r){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===r){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,i)}if(1===o.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry(),r=this.getMap().getView().getProjection();"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,i,r)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,i,r),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new ac([e])):"MultiLineString"===this.type_?t.setGeometry(new hc([e])):"MultiPolygon"===this.type_&&t.setGeometry(new cc([e])),this.dispatchEvent(new rd("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new rd("drawabort",t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;let r;if(i&&this.startDrawing_(t[0]),"LineString"===e||"Circle"===e)r=this.sketchCoords_;else{if("Polygon"!==e)return;r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&r.shift(),r.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const s=t[t.length-1];this.addToDrawing_(s),this.modifyDrawing_(s)}extend(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new br(new jr(i)),this.updateSketchFeatures_(),this.dispatchEvent(new rd("drawstart",this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}};class xk extends Rl{constructor(t,e){const i=e||{},r=document.createElement("button"),s=document.createElement("div");s.className="boundingboxcontrol ol-unselectable ol-control",r.title="Draw boundingbox",s.appendChild(r),super({element:s,target:i.target}),this.boxEmitter=t,r.innerHTML='\n      <svg xmlns="http://www.w3.org/2000/svg" class = "innersvg" viewBox="0 0 448 512">\x3c!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M368 80h32v32H368V80zM352 32c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3 0 64v64c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32H96c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V384c0-17.7-14.3-32-32-32V160c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32H352zM96 160c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32V160zM48 400H80v32H48V400zm320 32V400h32v32H368zM48 112V80H80v32H48z"/></svg>\n      ',r.addEventListener("click",this.addBox.bind(this),!1)}addBox(){const t=new vk({source:new lo({}),type:"Circle",geometryFunction:function(e,i,r){const s=pl([e[0],e[e.length-1]].map(function(l){return Vn(l,r)})),o=[[Zo(s),gl(s),ml(s),Gn(s),Zo(s)]];i?i.setCoordinates(o):i=new _s(o);const a=wl();return a&&i.transform(r,a),i}});t.on("drawend",e=>{const i=this.getMap(),r=e.feature,s=r.getGeometry();if(s){if("EPSG:3857"===i.getView().getProjection().getCode()){const h=s.transform(i.getView().getProjection(),"EPSG:4326").getExtent().join(",");this.boxEmitter.emit(h)}else{const h=s.getExtent().join(",");this.boxEmitter.emit(h)}const o=new Pn({stroke:new Un({color:"blue",width:3}),fill:new Wn({color:"rgba(0, 0, 255, 0.06)"})}),a=new lo({});a.addFeature(r);const l=new Cc({source:a,style:o});i.addLayer(l),i.removeInteraction(t)}}),this.getMap().addInteraction(t)}}let bk=(()=>{class n{set projection(e){this._projection=this.featureService.getProjectionMapping(e)}set showBoundingBoxButton(e){this._showBoundingBoxButton=function(r){return null!=r&&"false"!=`${r}`}(e)}get showBoundingBoxButton(){return this._showBoundingBoxButton}constructor(e,i){this.el=e,this.featureService=i,this._projection=kw,this.backgroundMap="OSM",this._showBoundingBoxButton=!0,this.box=new Cn,this.activeFeature=new Cn,this.mapHeight=400,this.mapWidth=600,this.map=this.getMap(),this.features=[]}getMap(){return new ra({view:new kn({projection:this._projection.visualProjection})})}init(){this.mapWidth=.99*this.el.nativeElement.offsetWidth,this.mapHeight=.75*this.mapWidth;const e=this.el.nativeElement.querySelector("#featuremap");this.map.setTarget(e),this.featureService.getFeatures({url:this.itemsUrl,dataMapping:this._projection}).pipe(P0(1)).subscribe(i=>{this.features=i,this.map.setLayerGroup(new Pl),this.loadFeatures(this.features),this.loadBackground()})}ngAfterViewInit(){this._showBoundingBoxButton&&this.map.addControl(new xk(this.box,{})),this.addFeatureEmit()}ngOnChanges(e){(e.itemsUrl?.previousValue!==e.itemsUrl?.currentValue||e.projection?.previousValue!==e.projection?.currentValue)&&e.itemsUrl?.currentValue&&this.init()}loadBackground(){switch(this.backgroundMap){case"OSM":{const e=new x0({source:new pk});return void this.map.addLayer(e)}case"BRT":return void this.map.addLayer(this.brtLayer(function(){const i=new zr({code:"EPSG:3857",units:"m",extent:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],worldExtent:[-180,-85,180,85],axisOrientation:"enu",global:!0}),r=qe(i.getExtent())/256,s=new Array(20),o=new Array(20);for(let a=0;a<20;++a)s[a]=r/Math.pow(2,a),o[a]=("0"+a).slice(-2);return{projection:i,resolutions:s,matrixIds:o}}()));default:!function(i){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(i)}`)}(this.backgroundMap)}}loadFeatures(e){const i=new lo({features:e});this.map.addLayer(new Cc({source:i,style:this.getStyle(),zIndex:10}));const r=i.getExtent();return e.length>0&&this.setViewExtent(r,e.length<3?10:1.05),r}getStyle(){const e=new Wn({color:"rgba(0,0,255)"}),i=new Un({color:"#3399CC",width:1.25});return[new Pn({image:new $l({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}setViewExtent(e,i){const r=new kn({}),s={size:this.map.getSize()},o=Au(e);o.scale(i),r.fit(o,s),this.map.setView(r)}brtLayer(e){return new x0({source:new fk({attributions:'Kaartgegevens: &copy; <a href="https://www.kadaster.nl">Kadaster</a>',url:Tw.bgtBackgroundUrl,layer:"grijs",matrixSet:e.projection.getCode(),format:"image/png",projection:e.projection,tileGrid:new gk({origin:Gn(e.projection.getExtent()),resolutions:e.resolutions,matrixIds:e.matrixIds}),style:"default",wrapX:!1})})}addFeatureEmit(){const e=this.el.nativeElement.querySelector("[id='tooltip']");e.style.visibility="hidden";const i=this.el.nativeElement.querySelector("[id='tooltip-content']"),r=new dk({element:e,autoPan:{duration:250}});this.map.addOverlay(r),this.map.on("pointermove",s=>{this.map.forEachFeatureAtPixel(s.pixel,o=>{if(o){const a=o.getId();if(a){const l="items",h=this.itemsUrl.toLowerCase(),u=new URL(h.substring(0,h.indexOf(l)+l.length));i.innerHTML='<a href="'+u.protocol+"//"+u.host+u.pathname+"/"+a+'">'+a+"</a>";const c=o.getGeometry();c&&(r.setPosition(er(c.getExtent())),e.style.visibility="visible"),this.activeFeature.emit(o)}}},{hitTolerance:3})})}static#t=this.\u0275fac=function(e){return new(e||n)(bi(nl),bi(mk))};static#e=this.\u0275cmp=hn({type:n,selectors:[["app-feature-view"]],inputs:{itemsUrl:"itemsUrl",backgroundMap:"backgroundMap",projection:"projection",showBoundingBoxButton:"showBoundingBoxButton"},outputs:{box:"box",activeFeature:"activeFeature"},standalone:!0,features:[Ph,al],decls:3,vars:4,consts:[["id","featuremap",1,"featuremaparea"],["id","tooltip",1,"maptooltip"],["id","tooltip-content"]],template:function(e,i){1&e&&(Do(0,"div",0),cn(1,"div",1),Do(2,"div",2),Mn()),2&e&&$h("width",i.mapWidth,"px")("height",i.mapHeight,"px")},styles:[".featuremaparea[_ngcontent-%COMP%]{height:100vh}.maptooltip[_ngcontent-%COMP%]{visibility:hidden;font-weight:700;margin:1px;text-decoration:none;text-align:center;border-radius:2px;font-size:16px;background-color:#fff;border:1px solid rgb(26,30,79);padding:5px 10px}"],changeDetection:0})}return n})(),wk=(()=>{class n{constructor(e){this.injector=e;const i=nd(Mw,{injector:e});customElements.define("app-vectortile-view",i);const r=nd(ak,{injector:e});customElements.define("app-objectinfo-view",r);const s=nd(ck,{injector:e});customElements.define("app-legend-view",s);const o=nd(bk,{injector:e});customElements.define("app-feature-view",o)}ngDoBootstrap(){}static#t=this.\u0275fac=function(e){return new(e||n)(X(il))};static#e=this.\u0275mod=vo({type:n});static#i=this.\u0275inj=ge({imports:[kC,zT,Mw,JT.forRoot({serverLoggingUrl:"/api/logs",level:Tw.loglevel,serverLogLevel:Mi.OFF})]})}return n})();MC().bootstrapModule(wk).catch(n=>console.error(n))},605:Ue=>{"use strict";Ue.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},20:(Ue,vn)=>{vn.read=function(ai,ie,ot,$t,se){var Kt,Dt,fe=8*se-$t-1,ue=(1<<fe)-1,Je=ue>>1,Ct=-7,Xe=ot?se-1:0,qt=ot?-1:1,Fe=ai[ie+Xe];for(Xe+=qt,Kt=Fe&(1<<-Ct)-1,Fe>>=-Ct,Ct+=fe;Ct>0;Kt=256*Kt+ai[ie+Xe],Xe+=qt,Ct-=8);for(Dt=Kt&(1<<-Ct)-1,Kt>>=-Ct,Ct+=$t;Ct>0;Dt=256*Dt+ai[ie+Xe],Xe+=qt,Ct-=8);if(0===Kt)Kt=1-Je;else{if(Kt===ue)return Dt?NaN:1/0*(Fe?-1:1);Dt+=Math.pow(2,$t),Kt-=Je}return(Fe?-1:1)*Dt*Math.pow(2,Kt-$t)},vn.write=function(ai,ie,ot,$t,se,Kt){var Dt,fe,ue,Je=8*Kt-se-1,Ct=(1<<Je)-1,Xe=Ct>>1,qt=23===se?Math.pow(2,-24)-Math.pow(2,-77):0,Fe=$t?0:Kt-1,ke=$t?1:-1,L=ie<0||0===ie&&1/ie<0?1:0;for(ie=Math.abs(ie),isNaN(ie)||ie===1/0?(fe=isNaN(ie)?1:0,Dt=Ct):(Dt=Math.floor(Math.log(ie)/Math.LN2),ie*(ue=Math.pow(2,-Dt))<1&&(Dt--,ue*=2),(ie+=Dt+Xe>=1?qt/ue:qt*Math.pow(2,1-Xe))*ue>=2&&(Dt++,ue/=2),Dt+Xe>=Ct?(fe=0,Dt=Ct):Dt+Xe>=1?(fe=(ie*ue-1)*Math.pow(2,se),Dt+=Xe):(fe=ie*Math.pow(2,Xe-1)*Math.pow(2,se),Dt=0));se>=8;ai[ot+Fe]=255&fe,Fe+=ke,fe/=256,se-=8);for(Dt=Dt<<se|fe,Je+=se;Je>0;ai[ot+Fe]=255&Dt,Fe+=ke,Dt/=256,Je-=8);ai[ot+Fe-ke]|=128*L}},496:(Ue,vn,ai)=>{"use strict";Ue.exports=ot;var ie=ai(20);function ot(C){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(C)?C:new Uint8Array(C||0),this.pos=0,this.type=0,this.length=this.buf.length}ot.Varint=0,ot.Fixed64=1,ot.Bytes=2,ot.Fixed32=5;var $t=4294967296,se=1/$t,Kt=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Dt(C){return C.type===ot.Bytes?C.readVarint()+C.pos:C.pos+1}function fe(C,k,W){var mt=k<=16383?1:k<=2097151?2:k<=268435455?3:Math.floor(Math.log(k)/(7*Math.LN2));W.realloc(mt);for(var pt=W.pos-1;pt>=C;pt--)W.buf[pt+mt]=W.buf[pt]}function ue(C,k){for(var W=0;W<C.length;W++)k.writeVarint(C[W])}function Je(C,k){for(var W=0;W<C.length;W++)k.writeSVarint(C[W])}function Ct(C,k){for(var W=0;W<C.length;W++)k.writeFloat(C[W])}function Xe(C,k){for(var W=0;W<C.length;W++)k.writeDouble(C[W])}function qt(C,k){for(var W=0;W<C.length;W++)k.writeBoolean(C[W])}function Fe(C,k){for(var W=0;W<C.length;W++)k.writeFixed32(C[W])}function ke(C,k){for(var W=0;W<C.length;W++)k.writeSFixed32(C[W])}function L(C,k){for(var W=0;W<C.length;W++)k.writeFixed64(C[W])}function H(C,k){for(var W=0;W<C.length;W++)k.writeSFixed64(C[W])}function rt(C,k){return(C[k]|C[k+1]<<8|C[k+2]<<16)+16777216*C[k+3]}function gt(C,k,W){C[W]=k,C[W+1]=k>>>8,C[W+2]=k>>>16,C[W+3]=k>>>24}function bt(C,k){return(C[k]|C[k+1]<<8|C[k+2]<<16)+(C[k+3]<<24)}ot.prototype={destroy:function(){this.buf=null},readFields:function(C,k,W){for(W=W||this.length;this.pos<W;){var mt=this.readVarint(),pt=mt>>3,Bt=this.pos;this.type=7&mt,C(pt,k,this),this.pos===Bt&&this.skip(mt)}return k},readMessage:function(C,k){return this.readFields(C,k,this.readVarint()+this.pos)},readFixed32:function(){var C=rt(this.buf,this.pos);return this.pos+=4,C},readSFixed32:function(){var C=bt(this.buf,this.pos);return this.pos+=4,C},readFixed64:function(){var C=rt(this.buf,this.pos)+rt(this.buf,this.pos+4)*$t;return this.pos+=8,C},readSFixed64:function(){var C=rt(this.buf,this.pos)+bt(this.buf,this.pos+4)*$t;return this.pos+=8,C},readFloat:function(){var C=ie.read(this.buf,this.pos,!0,23,4);return this.pos+=4,C},readDouble:function(){var C=ie.read(this.buf,this.pos,!0,52,8);return this.pos+=8,C},readVarint:function(C){var k,W,mt=this.buf;return k=127&(W=mt[this.pos++]),W<128||(k|=(127&(W=mt[this.pos++]))<<7,W<128)||(k|=(127&(W=mt[this.pos++]))<<14,W<128)||(k|=(127&(W=mt[this.pos++]))<<21,W<128)?k:function(Bt,Pt,it){var zt,Ft,xe,Qe,ui=it.buf;if(zt=(112&(Ft=ui[it.pos++]))>>4,Ft<128||(zt|=(127&(Ft=ui[it.pos++]))<<3,Ft<128)||(zt|=(127&(Ft=ui[it.pos++]))<<10,Ft<128)||(zt|=(127&(Ft=ui[it.pos++]))<<17,Ft<128)||(zt|=(127&(Ft=ui[it.pos++]))<<24,Ft<128)||(zt|=(1&(Ft=ui[it.pos++]))<<31,Ft<128))return xe=Bt,Qe=zt,Pt?4294967296*Qe+(xe>>>0):4294967296*(Qe>>>0)+(xe>>>0);throw new Error("Expected varint not more than 10 bytes")}(k|=(15&(W=mt[this.pos]))<<28,C,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var C=this.readVarint();return C%2==1?(C+1)/-2:C/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var C=this.readVarint()+this.pos,k=this.pos;return this.pos=C,C-k>=12&&Kt?Kt.decode(this.buf.subarray(k,C)):function(mt,pt,Bt){for(var Pt="",it=pt;it<Bt;){var zt,Ft,ui,ve=mt[it],xe=null,Qe=ve>239?4:ve>223?3:ve>191?2:1;if(it+Qe>Bt)break;1===Qe?ve<128&&(xe=ve):2===Qe?128==(192&(zt=mt[it+1]))&&(xe=(31&ve)<<6|63&zt)<=127&&(xe=null):3===Qe?(Ft=mt[it+2],128==(192&(zt=mt[it+1]))&&128==(192&Ft)&&((xe=(15&ve)<<12|(63&zt)<<6|63&Ft)<=2047||xe>=55296&&xe<=57343)&&(xe=null)):4===Qe&&(Ft=mt[it+2],ui=mt[it+3],128==(192&(zt=mt[it+1]))&&128==(192&Ft)&&128==(192&ui)&&((xe=(15&ve)<<18|(63&zt)<<12|(63&Ft)<<6|63&ui)<=65535||xe>=1114112)&&(xe=null)),null===xe?(xe=65533,Qe=1):xe>65535&&(xe-=65536,Pt+=String.fromCharCode(xe>>>10&1023|55296),xe=56320|1023&xe),Pt+=String.fromCharCode(xe),it+=Qe}return Pt}(this.buf,k,C)},readBytes:function(){var C=this.readVarint()+this.pos,k=this.buf.subarray(this.pos,C);return this.pos=C,k},readPackedVarint:function(C,k){if(this.type!==ot.Bytes)return C.push(this.readVarint(k));var W=Dt(this);for(C=C||[];this.pos<W;)C.push(this.readVarint(k));return C},readPackedSVarint:function(C){if(this.type!==ot.Bytes)return C.push(this.readSVarint());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readSVarint());return C},readPackedBoolean:function(C){if(this.type!==ot.Bytes)return C.push(this.readBoolean());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readBoolean());return C},readPackedFloat:function(C){if(this.type!==ot.Bytes)return C.push(this.readFloat());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readFloat());return C},readPackedDouble:function(C){if(this.type!==ot.Bytes)return C.push(this.readDouble());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readDouble());return C},readPackedFixed32:function(C){if(this.type!==ot.Bytes)return C.push(this.readFixed32());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readFixed32());return C},readPackedSFixed32:function(C){if(this.type!==ot.Bytes)return C.push(this.readSFixed32());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readSFixed32());return C},readPackedFixed64:function(C){if(this.type!==ot.Bytes)return C.push(this.readFixed64());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readFixed64());return C},readPackedSFixed64:function(C){if(this.type!==ot.Bytes)return C.push(this.readSFixed64());var k=Dt(this);for(C=C||[];this.pos<k;)C.push(this.readSFixed64());return C},skip:function(C){var k=7&C;if(k===ot.Varint)for(;this.buf[this.pos++]>127;);else if(k===ot.Bytes)this.pos=this.readVarint()+this.pos;else if(k===ot.Fixed32)this.pos+=4;else{if(k!==ot.Fixed64)throw new Error("Unimplemented type: "+k);this.pos+=8}},writeTag:function(C,k){this.writeVarint(C<<3|k)},realloc:function(C){for(var k=this.length||16;k<this.pos+C;)k*=2;if(k!==this.length){var W=new Uint8Array(k);W.set(this.buf),this.buf=W,this.length=k}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(C){this.realloc(4),gt(this.buf,C,this.pos),this.pos+=4},writeSFixed32:function(C){this.realloc(4),gt(this.buf,C,this.pos),this.pos+=4},writeFixed64:function(C){this.realloc(8),gt(this.buf,-1&C,this.pos),gt(this.buf,Math.floor(C*se),this.pos+4),this.pos+=8},writeSFixed64:function(C){this.realloc(8),gt(this.buf,-1&C,this.pos),gt(this.buf,Math.floor(C*se),this.pos+4),this.pos+=8},writeVarint:function(C){(C=+C||0)>268435455||C<0?function(W,mt){var pt,Bt,it,Ft;if(W>=0?(pt=W%4294967296|0,Bt=W/4294967296|0):(Bt=~(-W/4294967296),4294967295^(pt=~(-W%4294967296))?pt=pt+1|0:(pt=0,Bt=Bt+1|0)),W>=0x10000000000000000||W<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");mt.realloc(10),it=pt,(Ft=mt).buf[Ft.pos++]=127&it|128,it>>>=7,Ft.buf[Ft.pos++]=127&it|128,it>>>=7,Ft.buf[Ft.pos++]=127&it|128,it>>>=7,Ft.buf[Ft.pos++]=127&it|128,Ft.buf[Ft.pos]=127&(it>>>=7),function(it,zt){var Ft=(7&it)<<4;zt.buf[zt.pos++]|=Ft|((it>>>=3)?128:0),it&&(zt.buf[zt.pos++]=127&it|((it>>>=7)?128:0),it&&(zt.buf[zt.pos++]=127&it|((it>>>=7)?128:0),it&&(zt.buf[zt.pos++]=127&it|((it>>>=7)?128:0),it&&(zt.buf[zt.pos++]=127&it|((it>>>=7)?128:0),it&&(zt.buf[zt.pos++]=127&it)))))}(Bt,mt)}(C,this):(this.realloc(4),this.buf[this.pos++]=127&C|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=C>>>7&127))))},writeSVarint:function(C){this.writeVarint(C<0?2*-C-1:2*C)},writeBoolean:function(C){this.writeVarint(!!C)},writeString:function(C){C=String(C),this.realloc(4*C.length),this.pos++;var k=this.pos;this.pos=function(pt,Bt,Pt){for(var it,zt,Ft=0;Ft<Bt.length;Ft++){if((it=Bt.charCodeAt(Ft))>55295&&it<57344){if(!zt){it>56319||Ft+1===Bt.length?(pt[Pt++]=239,pt[Pt++]=191,pt[Pt++]=189):zt=it;continue}if(it<56320){pt[Pt++]=239,pt[Pt++]=191,pt[Pt++]=189,zt=it;continue}it=zt-55296<<10|it-56320|65536,zt=null}else zt&&(pt[Pt++]=239,pt[Pt++]=191,pt[Pt++]=189,zt=null);it<128?pt[Pt++]=it:(it<2048?pt[Pt++]=it>>6|192:(it<65536?pt[Pt++]=it>>12|224:(pt[Pt++]=it>>18|240,pt[Pt++]=it>>12&63|128),pt[Pt++]=it>>6&63|128),pt[Pt++]=63&it|128)}return Pt}(this.buf,C,this.pos);var W=this.pos-k;W>=128&&fe(k,W,this),this.pos=k-1,this.writeVarint(W),this.pos+=W},writeFloat:function(C){this.realloc(4),ie.write(this.buf,C,this.pos,!0,23,4),this.pos+=4},writeDouble:function(C){this.realloc(8),ie.write(this.buf,C,this.pos,!0,52,8),this.pos+=8},writeBytes:function(C){var k=C.length;this.writeVarint(k),this.realloc(k);for(var W=0;W<k;W++)this.buf[this.pos++]=C[W]},writeRawMessage:function(C,k){this.pos++;var W=this.pos;C(k,this);var mt=this.pos-W;mt>=128&&fe(W,mt,this),this.pos=W-1,this.writeVarint(mt),this.pos+=mt},writeMessage:function(C,k,W){this.writeTag(C,ot.Bytes),this.writeRawMessage(k,W)},writePackedVarint:function(C,k){k.length&&this.writeMessage(C,ue,k)},writePackedSVarint:function(C,k){k.length&&this.writeMessage(C,Je,k)},writePackedBoolean:function(C,k){k.length&&this.writeMessage(C,qt,k)},writePackedFloat:function(C,k){k.length&&this.writeMessage(C,Ct,k)},writePackedDouble:function(C,k){k.length&&this.writeMessage(C,Xe,k)},writePackedFixed32:function(C,k){k.length&&this.writeMessage(C,Fe,k)},writePackedSFixed32:function(C,k){k.length&&this.writeMessage(C,ke,k)},writePackedFixed64:function(C,k){k.length&&this.writeMessage(C,L,k)},writePackedSFixed64:function(C,k){k.length&&this.writeMessage(C,H,k)},writeBytesField:function(C,k){this.writeTag(C,ot.Bytes),this.writeBytes(k)},writeFixed32Field:function(C,k){this.writeTag(C,ot.Fixed32),this.writeFixed32(k)},writeSFixed32Field:function(C,k){this.writeTag(C,ot.Fixed32),this.writeSFixed32(k)},writeFixed64Field:function(C,k){this.writeTag(C,ot.Fixed64),this.writeFixed64(k)},writeSFixed64Field:function(C,k){this.writeTag(C,ot.Fixed64),this.writeSFixed64(k)},writeVarintField:function(C,k){this.writeTag(C,ot.Varint),this.writeVarint(k)},writeSVarintField:function(C,k){this.writeTag(C,ot.Varint),this.writeSVarint(k)},writeStringField:function(C,k){this.writeTag(C,ot.Bytes),this.writeString(k)},writeFloatField:function(C,k){this.writeTag(C,ot.Fixed32),this.writeFloat(k)},writeDoubleField:function(C,k){this.writeTag(C,ot.Fixed64),this.writeDouble(k)},writeBooleanField:function(C,k){this.writeVarintField(C,!!k)}}},218:function(Ue){Ue.exports=function(){"use strict";function vn(L,H,rt,gt,bt){!function C(k,W,mt,pt,Bt){for(;pt>mt;){if(pt-mt>600){var Pt=pt-mt+1,it=W-mt+1,zt=Math.log(Pt),Ft=.5*Math.exp(2*zt/3),ui=.5*Math.sqrt(zt*Ft*(Pt-Ft)/Pt)*(it-Pt/2<0?-1:1);C(k,W,Math.max(mt,Math.floor(W-it*Ft/Pt+ui)),Math.min(pt,Math.floor(W+(Pt-it)*Ft/Pt+ui)),Bt)}var ve=k[W],xe=mt,Qe=pt;for(ai(k,mt,W),Bt(k[pt],ve)>0&&ai(k,mt,pt);xe<Qe;){for(ai(k,xe,Qe),xe++,Qe--;Bt(k[xe],ve)<0;)xe++;for(;Bt(k[Qe],ve)>0;)Qe--}0===Bt(k[mt],ve)?ai(k,mt,Qe):ai(k,++Qe,pt),Qe<=W&&(mt=Qe+1),W<=Qe&&(pt=Qe-1)}}(L,H,rt||0,gt||L.length-1,bt||ie)}function ai(L,H,rt){var gt=L[H];L[H]=L[rt],L[rt]=gt}function ie(L,H){return L<H?-1:L>H?1:0}var ot=function(L){void 0===L&&(L=9),this._maxEntries=Math.max(4,L),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function $t(L,H,rt){if(!rt)return H.indexOf(L);for(var gt=0;gt<H.length;gt++)if(rt(L,H[gt]))return gt;return-1}function se(L,H){Kt(L,0,L.children.length,H,L)}function Kt(L,H,rt,gt,bt){bt||(bt=Fe(null)),bt.minX=1/0,bt.minY=1/0,bt.maxX=-1/0,bt.maxY=-1/0;for(var C=H;C<rt;C++){var k=L.children[C];Dt(bt,L.leaf?gt(k):k)}return bt}function Dt(L,H){return L.minX=Math.min(L.minX,H.minX),L.minY=Math.min(L.minY,H.minY),L.maxX=Math.max(L.maxX,H.maxX),L.maxY=Math.max(L.maxY,H.maxY),L}function fe(L,H){return L.minX-H.minX}function ue(L,H){return L.minY-H.minY}function Je(L){return(L.maxX-L.minX)*(L.maxY-L.minY)}function Ct(L){return L.maxX-L.minX+(L.maxY-L.minY)}function Xe(L,H){return L.minX<=H.minX&&L.minY<=H.minY&&H.maxX<=L.maxX&&H.maxY<=L.maxY}function qt(L,H){return H.minX<=L.maxX&&H.minY<=L.maxY&&H.maxX>=L.minX&&H.maxY>=L.minY}function Fe(L){return{children:L,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ke(L,H,rt,gt,bt){for(var C=[H,rt];C.length;)if(!((rt=C.pop())-(H=C.pop())<=gt)){var k=H+Math.ceil((rt-H)/gt/2)*gt;vn(L,k,H,rt,bt),C.push(H,k,k,rt)}}return ot.prototype.all=function(){return this._all(this.data,[])},ot.prototype.search=function(L){var H=this.data,rt=[];if(!qt(L,H))return rt;for(var gt=this.toBBox,bt=[];H;){for(var C=0;C<H.children.length;C++){var k=H.children[C],W=H.leaf?gt(k):k;qt(L,W)&&(H.leaf?rt.push(k):Xe(L,W)?this._all(k,rt):bt.push(k))}H=bt.pop()}return rt},ot.prototype.collides=function(L){var H=this.data;if(!qt(L,H))return!1;for(var rt=[];H;){for(var gt=0;gt<H.children.length;gt++){var bt=H.children[gt],C=H.leaf?this.toBBox(bt):bt;if(qt(L,C)){if(H.leaf||Xe(L,C))return!0;rt.push(bt)}}H=rt.pop()}return!1},ot.prototype.load=function(L){if(!L||!L.length)return this;if(L.length<this._minEntries){for(var H=0;H<L.length;H++)this.insert(L[H]);return this}var rt=this._build(L.slice(),0,L.length-1,0);if(this.data.children.length)if(this.data.height===rt.height)this._splitRoot(this.data,rt);else{if(this.data.height<rt.height){var gt=this.data;this.data=rt,rt=gt}this._insert(rt,this.data.height-rt.height-1,!0)}else this.data=rt;return this},ot.prototype.insert=function(L){return L&&this._insert(L,this.data.height-1),this},ot.prototype.clear=function(){return this.data=Fe([]),this},ot.prototype.remove=function(L,H){if(!L)return this;for(var rt,gt,bt,C=this.data,k=this.toBBox(L),W=[],mt=[];C||W.length;){if(C||(C=W.pop(),gt=W[W.length-1],rt=mt.pop(),bt=!0),C.leaf){var pt=$t(L,C.children,H);if(-1!==pt)return C.children.splice(pt,1),W.push(C),this._condense(W),this}bt||C.leaf||!Xe(C,k)?gt?(rt++,C=gt.children[rt],bt=!1):C=null:(W.push(C),mt.push(rt),rt=0,gt=C,C=C.children[0])}return this},ot.prototype.toBBox=function(L){return L},ot.prototype.compareMinX=function(L,H){return L.minX-H.minX},ot.prototype.compareMinY=function(L,H){return L.minY-H.minY},ot.prototype.toJSON=function(){return this.data},ot.prototype.fromJSON=function(L){return this.data=L,this},ot.prototype._all=function(L,H){for(var rt=[];L;)L.leaf?H.push.apply(H,L.children):rt.push.apply(rt,L.children),L=rt.pop();return H},ot.prototype._build=function(L,H,rt,gt){var bt,C=rt-H+1,k=this._maxEntries;if(C<=k)return se(bt=Fe(L.slice(H,rt+1)),this.toBBox),bt;gt||(gt=Math.ceil(Math.log(C)/Math.log(k)),k=Math.ceil(C/Math.pow(k,gt-1))),(bt=Fe([])).leaf=!1,bt.height=gt;var W=Math.ceil(C/k),mt=W*Math.ceil(Math.sqrt(k));ke(L,H,rt,mt,this.compareMinX);for(var pt=H;pt<=rt;pt+=mt){var Bt=Math.min(pt+mt-1,rt);ke(L,pt,Bt,W,this.compareMinY);for(var Pt=pt;Pt<=Bt;Pt+=W){var it=Math.min(Pt+W-1,Bt);bt.children.push(this._build(L,Pt,it,gt-1))}}return se(bt,this.toBBox),bt},ot.prototype._chooseSubtree=function(L,H,rt,gt){for(;gt.push(H),!H.leaf&&gt.length-1!==rt;){for(var bt=1/0,C=1/0,k=void 0,W=0;W<H.children.length;W++){var mt=H.children[W],pt=Je(mt),Bt=(Pt=L,it=mt,(Math.max(it.maxX,Pt.maxX)-Math.min(it.minX,Pt.minX))*(Math.max(it.maxY,Pt.maxY)-Math.min(it.minY,Pt.minY))-pt);Bt<C?(C=Bt,bt=pt<bt?pt:bt,k=mt):Bt===C&&pt<bt&&(bt=pt,k=mt)}H=k||H.children[0]}var Pt,it;return H},ot.prototype._insert=function(L,H,rt){var gt=rt?L:this.toBBox(L),bt=[],C=this._chooseSubtree(gt,this.data,H,bt);for(C.children.push(L),Dt(C,gt);H>=0&&bt[H].children.length>this._maxEntries;)this._split(bt,H),H--;this._adjustParentBBoxes(gt,bt,H)},ot.prototype._split=function(L,H){var rt=L[H],gt=rt.children.length,bt=this._minEntries;this._chooseSplitAxis(rt,bt,gt);var C=this._chooseSplitIndex(rt,bt,gt),k=Fe(rt.children.splice(C,rt.children.length-C));k.height=rt.height,k.leaf=rt.leaf,se(rt,this.toBBox),se(k,this.toBBox),H?L[H-1].children.push(k):this._splitRoot(rt,k)},ot.prototype._splitRoot=function(L,H){this.data=Fe([L,H]),this.data.height=L.height+1,this.data.leaf=!1,se(this.data,this.toBBox)},ot.prototype._chooseSplitIndex=function(L,H,rt){for(var gt,bt,C,k,W,mt,pt,Bt=1/0,Pt=1/0,it=H;it<=rt-H;it++){var zt=Kt(L,0,it,this.toBBox),Ft=Kt(L,it,rt,this.toBBox),ui=(bt=zt,C=Ft,k=Math.max(bt.minX,C.minX),W=Math.max(bt.minY,C.minY),mt=Math.min(bt.maxX,C.maxX),pt=Math.min(bt.maxY,C.maxY),Math.max(0,mt-k)*Math.max(0,pt-W)),ve=Je(zt)+Je(Ft);ui<Bt?(Bt=ui,gt=it,Pt=ve<Pt?ve:Pt):ui===Bt&&ve<Pt&&(Pt=ve,gt=it)}return gt||rt-H},ot.prototype._chooseSplitAxis=function(L,H,rt){var gt=L.leaf?this.compareMinX:fe,bt=L.leaf?this.compareMinY:ue;this._allDistMargin(L,H,rt,gt)<this._allDistMargin(L,H,rt,bt)&&L.children.sort(gt)},ot.prototype._allDistMargin=function(L,H,rt,gt){L.children.sort(gt);for(var bt=this.toBBox,C=Kt(L,0,H,bt),k=Kt(L,rt-H,rt,bt),W=Ct(C)+Ct(k),mt=H;mt<rt-H;mt++){var pt=L.children[mt];Dt(C,L.leaf?bt(pt):pt),W+=Ct(C)}for(var Bt=rt-H-1;Bt>=H;Bt--){var Pt=L.children[Bt];Dt(k,L.leaf?bt(Pt):Pt),W+=Ct(k)}return W},ot.prototype._adjustParentBBoxes=function(L,H,rt){for(var gt=rt;gt>=0;gt--)Dt(H[gt],L)},ot.prototype._condense=function(L){for(var H=L.length-1,rt=void 0;H>=0;H--)0===L[H].children.length?H>0?(rt=L[H-1].children).splice(rt.indexOf(L[H]),1):this.clear():se(L[H],this.toBBox)},ot}()}},Ue=>{Ue(Ue.s=319)}]),(()=>{"use strict";var Ue,vn={},ai={};function ie(ot){var $t=ai[ot];if(void 0!==$t)return $t.exports;var se=ai[ot]={exports:{}};return vn[ot].call(se.exports,se,se.exports,ie),se.exports}ie.m=vn,Ue=[],ie.O=(ot,$t,se,Kt)=>{if(!$t){var Dt=1/0;for(Ct=0;Ct<Ue.length;Ct++){for(var[$t,se,Kt]=Ue[Ct],fe=!0,ue=0;ue<$t.length;ue++)(!1&Kt||Dt>=Kt)&&Object.keys(ie.O).every(ke=>ie.O[ke]($t[ue]))?$t.splice(ue--,1):(fe=!1,Kt<Dt&&(Dt=Kt));if(fe){Ue.splice(Ct--,1);var Je=se();void 0!==Je&&(ot=Je)}}return ot}Kt=Kt||0;for(var Ct=Ue.length;Ct>0&&Ue[Ct-1][2]>Kt;Ct--)Ue[Ct]=Ue[Ct-1];Ue[Ct]=[$t,se,Kt]},ie.o=(ot,$t)=>Object.prototype.hasOwnProperty.call(ot,$t),(()=>{var ot={121:0};ie.O.j=Kt=>0===ot[Kt];var $t=(Kt,Dt)=>{var fe,ue,[Je,Ct,Xe]=Dt,qt=0;if(Je.some(ke=>0!==ot[ke])){for(fe in Ct)ie.o(Ct,fe)&&(ie.m[fe]=Ct[fe]);if(Xe)var Fe=Xe(ie)}for(Kt&&Kt(Dt);qt<Je.length;qt++)ie.o(ot,ue=Je[qt])&&ot[ue]&&ot[ue][0](),ot[ue]=0;return ie.O(Fe)},se=self.webpackChunkview_component=self.webpackChunkview_component||[];se.forEach($t.bind(null,0)),se.push=$t.bind(null,se.push.bind(se))})()})(),(self.webpackChunkview_component=self.webpackChunkview_component||[]).push([[461],{935:()=>{!function(I){const G=I.performance;function z(X){G&&G.mark&&G.mark(X)}function U(X,ht){G&&G.measure&&G.measure(X,ht)}z("Zone");const J=I.__Zone_symbol_prefix||"__zone_symbol__";function tt(X){return J+X}const _t=!0===I[tt("forceDuplicateZoneCheck")];if(I.Zone){if(_t||"function"!=typeof I.Zone.__symbol__)throw new Error("Zone already loaded.");return I.Zone}let Tt=(()=>{class X{static#t=this.__symbol__=tt;static assertZonePatched(){if(I.Promise!==di.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let E=X.current;for(;E.parent;)E=E.parent;return E}static get current(){return ni.zone}static get currentTask(){return qi}static __load_patch(E,O,Z=!1){if(di.hasOwnProperty(E)){if(!Z&&_t)throw Error("Already loaded patch: "+E)}else if(!I["__Zone_disable_"+E]){const B="Zone:"+E;z(B),di[E]=O(I,X,Hi),U(B,B)}}get parent(){return this._parent}get name(){return this._name}constructor(E,O){this._parent=E,this._name=O?O.name||"unnamed":"<root>",this._properties=O&&O.properties||{},this._zoneDelegate=new Vt(this,this._parent&&this._parent._zoneDelegate,O)}get(E){const O=this.getZoneWith(E);if(O)return O._properties[E]}getZoneWith(E){let O=this;for(;O;){if(O._properties.hasOwnProperty(E))return O;O=O._parent}return null}fork(E){if(!E)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,E)}wrap(E,O){if("function"!=typeof E)throw new Error("Expecting function got: "+E);const Z=this._zoneDelegate.intercept(this,E,O),B=this;return function(){return B.runGuarded(Z,this,arguments,O)}}run(E,O,Z,B){ni={parent:ni,zone:this};try{return this._zoneDelegate.invoke(this,E,O,Z,B)}finally{ni=ni.parent}}runGuarded(E,O=null,Z,B){ni={parent:ni,zone:this};try{try{return this._zoneDelegate.invoke(this,E,O,Z,B)}catch(Y){if(this._zoneDelegate.handleError(this,Y))throw Y}}finally{ni=ni.parent}}runTask(E,O,Z){if(E.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(E.zone||Ti).name+"; Execution: "+this.name+")");if(E.state===$e&&(E.type===Gi||E.type===yi))return;const B=E.state!=et;B&&E._transitionTo(et,be),E.runCount++;const Y=qi;qi=E,ni={parent:ni,zone:this};try{E.type==yi&&E.data&&!E.data.isPeriodic&&(E.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,E,O,Z)}catch(xt){if(this._zoneDelegate.handleError(this,xt))throw xt}}finally{E.state!==$e&&E.state!==lt&&(E.type==Gi||E.data&&E.data.isPeriodic?B&&E._transitionTo(be,et):(E.runCount=0,this._updateTaskCount(E,-1),B&&E._transitionTo($e,et,$e))),ni=ni.parent,qi=Y}}scheduleTask(E){if(E.zone&&E.zone!==this){let Z=this;for(;Z;){if(Z===E.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${E.zone.name}`);Z=Z.parent}}E._transitionTo(kt,$e);const O=[];E._zoneDelegates=O,E._zone=this;try{E=this._zoneDelegate.scheduleTask(this,E)}catch(Z){throw E._transitionTo(lt,kt,$e),this._zoneDelegate.handleError(this,Z),Z}return E._zoneDelegates===O&&this._updateTaskCount(E,1),E.state==kt&&E._transitionTo(be,kt),E}scheduleMicroTask(E,O,Z,B){return this.scheduleTask(new Lt(jt,E,O,Z,B,void 0))}scheduleMacroTask(E,O,Z,B,Y){return this.scheduleTask(new Lt(yi,E,O,Z,B,Y))}scheduleEventTask(E,O,Z,B,Y){return this.scheduleTask(new Lt(Gi,E,O,Z,B,Y))}cancelTask(E){if(E.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(E.zone||Ti).name+"; Execution: "+this.name+")");if(E.state===be||E.state===et){E._transitionTo(te,be,et);try{this._zoneDelegate.cancelTask(this,E)}catch(O){throw E._transitionTo(lt,te),this._zoneDelegate.handleError(this,O),O}return this._updateTaskCount(E,-1),E._transitionTo($e,te),E.runCount=0,E}}_updateTaskCount(E,O){const Z=E._zoneDelegates;-1==O&&(E._zoneDelegates=null);for(let B=0;B<Z.length;B++)Z[B]._updateTaskCount(E.type,O)}}return X})();const Mt={name:"",onHasTask:(X,ht,E,O)=>X.hasTask(E,O),onScheduleTask:(X,ht,E,O)=>X.scheduleTask(E,O),onInvokeTask:(X,ht,E,O,Z,B)=>X.invokeTask(E,O,Z,B),onCancelTask:(X,ht,E,O)=>X.cancelTask(E,O)};class Vt{constructor(ht,E,O){this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=ht,this._parentDelegate=E,this._forkZS=O&&(O&&O.onFork?O:E._forkZS),this._forkDlgt=O&&(O.onFork?E:E._forkDlgt),this._forkCurrZone=O&&(O.onFork?this.zone:E._forkCurrZone),this._interceptZS=O&&(O.onIntercept?O:E._interceptZS),this._interceptDlgt=O&&(O.onIntercept?E:E._interceptDlgt),this._interceptCurrZone=O&&(O.onIntercept?this.zone:E._interceptCurrZone),this._invokeZS=O&&(O.onInvoke?O:E._invokeZS),this._invokeDlgt=O&&(O.onInvoke?E:E._invokeDlgt),this._invokeCurrZone=O&&(O.onInvoke?this.zone:E._invokeCurrZone),this._handleErrorZS=O&&(O.onHandleError?O:E._handleErrorZS),this._handleErrorDlgt=O&&(O.onHandleError?E:E._handleErrorDlgt),this._handleErrorCurrZone=O&&(O.onHandleError?this.zone:E._handleErrorCurrZone),this._scheduleTaskZS=O&&(O.onScheduleTask?O:E._scheduleTaskZS),this._scheduleTaskDlgt=O&&(O.onScheduleTask?E:E._scheduleTaskDlgt),this._scheduleTaskCurrZone=O&&(O.onScheduleTask?this.zone:E._scheduleTaskCurrZone),this._invokeTaskZS=O&&(O.onInvokeTask?O:E._invokeTaskZS),this._invokeTaskDlgt=O&&(O.onInvokeTask?E:E._invokeTaskDlgt),this._invokeTaskCurrZone=O&&(O.onInvokeTask?this.zone:E._invokeTaskCurrZone),this._cancelTaskZS=O&&(O.onCancelTask?O:E._cancelTaskZS),this._cancelTaskDlgt=O&&(O.onCancelTask?E:E._cancelTaskDlgt),this._cancelTaskCurrZone=O&&(O.onCancelTask?this.zone:E._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;const Z=O&&O.onHasTask;(Z||E&&E._hasTaskZS)&&(this._hasTaskZS=Z?O:Mt,this._hasTaskDlgt=E,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=ht,O.onScheduleTask||(this._scheduleTaskZS=Mt,this._scheduleTaskDlgt=E,this._scheduleTaskCurrZone=this.zone),O.onInvokeTask||(this._invokeTaskZS=Mt,this._invokeTaskDlgt=E,this._invokeTaskCurrZone=this.zone),O.onCancelTask||(this._cancelTaskZS=Mt,this._cancelTaskDlgt=E,this._cancelTaskCurrZone=this.zone))}fork(ht,E){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,ht,E):new Tt(ht,E)}intercept(ht,E,O){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,ht,E,O):E}invoke(ht,E,O,Z,B){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,ht,E,O,Z,B):E.apply(O,Z)}handleError(ht,E){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,ht,E)}scheduleTask(ht,E){let O=E;if(this._scheduleTaskZS)this._hasTaskZS&&O._zoneDelegates.push(this._hasTaskDlgtOwner),O=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,ht,E),O||(O=E);else if(E.scheduleFn)E.scheduleFn(E);else{if(E.type!=jt)throw new Error("Task is missing scheduleFn.");oe(E)}return O}invokeTask(ht,E,O,Z){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,ht,E,O,Z):E.callback.apply(O,Z)}cancelTask(ht,E){let O;if(this._cancelTaskZS)O=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,ht,E);else{if(!E.cancelFn)throw Error("Task is not cancelable");O=E.cancelFn(E)}return O}hasTask(ht,E){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,ht,E)}catch(O){this.handleError(ht,O)}}_updateTaskCount(ht,E){const O=this._taskCounts,Z=O[ht],B=O[ht]=Z+E;if(B<0)throw new Error("More tasks executed then were scheduled.");0!=Z&&0!=B||this.hasTask(this.zone,{microTask:O.microTask>0,macroTask:O.macroTask>0,eventTask:O.eventTask>0,change:ht})}}class Lt{constructor(ht,E,O,Z,B,Y){if(this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=ht,this.source=E,this.data=Z,this.scheduleFn=B,this.cancelFn=Y,!O)throw new Error("callback is not defined");this.callback=O;const xt=this;this.invoke=ht===Gi&&Z&&Z.useG?Lt.invokeTask:function(){return Lt.invokeTask.call(I,xt,this,arguments)}}static invokeTask(ht,E,O){ht||(ht=this),Pi++;try{return ht.runCount++,ht.zone.runTask(ht,E,O)}finally{1==Pi&&Ot(),Pi--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo($e,kt)}_transitionTo(ht,E,O){if(this._state!==E&&this._state!==O)throw new Error(`${this.type} '${this.source}': can not transition to '${ht}', expecting state '${E}'${O?" or '"+O+"'":""}, was '${this._state}'.`);this._state=ht,ht==$e&&(this._zoneDelegates=null)}toString(){return this.data&&typeof this.data.handleId<"u"?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}const ae=tt("setTimeout"),Ut=tt("Promise"),vt=tt("then");let ge,ce=[],li=!1;function xi(X){if(ge||I[Ut]&&(ge=I[Ut].resolve(0)),ge){let ht=ge[vt];ht||(ht=ge.then),ht.call(ge,X)}else I[ae](X,0)}function oe(X){0===Pi&&0===ce.length&&xi(Ot),X&&ce.push(X)}function Ot(){if(!li){for(li=!0;ce.length;){const X=ce;ce=[];for(let ht=0;ht<X.length;ht++){const E=X[ht];try{E.zone.runTask(E,null,null)}catch(O){Hi.onUnhandledError(O)}}}Hi.microtaskDrainDone(),li=!1}}const Ti={name:"NO ZONE"},$e="notScheduled",kt="scheduling",be="scheduled",et="running",te="canceling",lt="unknown",jt="microTask",yi="macroTask",Gi="eventTask",di={},Hi={symbol:tt,currentZoneFrame:()=>ni,onUnhandledError:pi,microtaskDrainDone:pi,scheduleMicroTask:oe,showUncaughtError:()=>!Tt[tt("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:pi,patchMethod:()=>pi,bindArguments:()=>[],patchThen:()=>pi,patchMacroTask:()=>pi,patchEventPrototype:()=>pi,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>pi,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>pi,wrapWithCurrentZone:()=>pi,filterProperties:()=>[],attachOriginToPatched:()=>pi,_redefineProperty:()=>pi,patchCallbacks:()=>pi,nativeScheduleMicroTask:xi};let ni={parent:null,zone:new Tt(null,null)},qi=null,Pi=0;function pi(){}U("Zone","Zone"),I.Zone=Tt}(globalThis);const Ue=Object.getOwnPropertyDescriptor,vn=Object.defineProperty,ai=Object.getPrototypeOf,ie=Object.create,ot=Array.prototype.slice,$t="addEventListener",se="removeEventListener",Kt=Zone.__symbol__($t),Dt=Zone.__symbol__(se),fe="true",ue="false",Je=Zone.__symbol__("");function Ct(I,G){return Zone.current.wrap(I,G)}function Xe(I,G,z,U,J){return Zone.current.scheduleMacroTask(I,G,z,U,J)}const qt=Zone.__symbol__,Fe=typeof window<"u",ke=Fe?window:void 0,L=Fe&&ke||globalThis,H="removeAttribute";function rt(I,G){for(let z=I.length-1;z>=0;z--)"function"==typeof I[z]&&(I[z]=Ct(I[z],G+"_"+z));return I}function gt(I){return!I||!1!==I.writable&&!("function"==typeof I.get&&typeof I.set>"u")}const bt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,C=!("nw"in L)&&typeof L.process<"u"&&"[object process]"==={}.toString.call(L.process),k=!C&&!bt&&!(!Fe||!ke.HTMLElement),W=typeof L.process<"u"&&"[object process]"==={}.toString.call(L.process)&&!bt&&!(!Fe||!ke.HTMLElement),mt={},pt=function(I){if(!(I=I||L.event))return;let G=mt[I.type];G||(G=mt[I.type]=qt("ON_PROPERTY"+I.type));const z=this||I.target||L,U=z[G];let J;return k&&z===ke&&"error"===I.type?(J=U&&U.call(this,I.message,I.filename,I.lineno,I.colno,I.error),!0===J&&I.preventDefault()):(J=U&&U.apply(this,arguments),null!=J&&!J&&I.preventDefault()),J};function Bt(I,G,z){let U=Ue(I,G);if(!U&&z&&Ue(z,G)&&(U={enumerable:!0,configurable:!0}),!U||!U.configurable)return;const J=qt("on"+G+"patched");if(I.hasOwnProperty(J)&&I[J])return;delete U.writable,delete U.value;const tt=U.get,_t=U.set,Tt=G.slice(2);let Mt=mt[Tt];Mt||(Mt=mt[Tt]=qt("ON_PROPERTY"+Tt)),U.set=function(Vt){let Lt=this;!Lt&&I===L&&(Lt=L),Lt&&("function"==typeof Lt[Mt]&&Lt.removeEventListener(Tt,pt),_t&&_t.call(Lt,null),Lt[Mt]=Vt,"function"==typeof Vt&&Lt.addEventListener(Tt,pt,!1))},U.get=function(){let Vt=this;if(!Vt&&I===L&&(Vt=L),!Vt)return null;const Lt=Vt[Mt];if(Lt)return Lt;if(tt){let ae=tt.call(this);if(ae)return U.set.call(this,ae),"function"==typeof Vt[H]&&Vt.removeAttribute(G),ae}return null},vn(I,G,U),I[J]=!0}function Pt(I,G,z){if(G)for(let U=0;U<G.length;U++)Bt(I,"on"+G[U],z);else{const U=[];for(const J in I)"on"==J.slice(0,2)&&U.push(J);for(let J=0;J<U.length;J++)Bt(I,U[J],z)}}const it=qt("originalInstance");function zt(I){const G=L[I];if(!G)return;L[qt(I)]=G,L[I]=function(){const J=rt(arguments,I);switch(J.length){case 0:this[it]=new G;break;case 1:this[it]=new G(J[0]);break;case 2:this[it]=new G(J[0],J[1]);break;case 3:this[it]=new G(J[0],J[1],J[2]);break;case 4:this[it]=new G(J[0],J[1],J[2],J[3]);break;default:throw new Error("Arg list too long.")}},ve(L[I],G);const z=new G(function(){});let U;for(U in z)"XMLHttpRequest"===I&&"responseBlob"===U||function(J){"function"==typeof z[J]?L[I].prototype[J]=function(){return this[it][J].apply(this[it],arguments)}:vn(L[I].prototype,J,{set:function(tt){"function"==typeof tt?(this[it][J]=Ct(tt,I+"."+J),ve(this[it][J],tt)):this[it][J]=tt},get:function(){return this[it][J]}})}(U);for(U in G)"prototype"!==U&&G.hasOwnProperty(U)&&(L[I][U]=G[U])}function Ft(I,G,z){let U=I;for(;U&&!U.hasOwnProperty(G);)U=ai(U);!U&&I[G]&&(U=I);const J=qt(G);let tt=null;if(U&&(!(tt=U[J])||!U.hasOwnProperty(J))&&(tt=U[J]=U[G],gt(U&&Ue(U,G)))){const _t=z(tt,J,G);U[G]=function(){return _t(this,arguments)},ve(U[G],tt)}return tt}function ui(I,G,z){let U=null;function J(tt){const _t=tt.data;return _t.args[_t.cbIdx]=function(){tt.invoke.apply(this,arguments)},U.apply(_t.target,_t.args),tt}U=Ft(I,G,tt=>function(_t,Tt){const Mt=z(_t,Tt);return Mt.cbIdx>=0&&"function"==typeof Tt[Mt.cbIdx]?Xe(Mt.name,Tt[Mt.cbIdx],Mt,J):tt.apply(_t,Tt)})}function ve(I,G){I[qt("OriginalDelegate")]=G}let xe=!1,Qe=!1;function Gs(){if(xe)return Qe;xe=!0;try{const I=ke.navigator.userAgent;(-1!==I.indexOf("MSIE ")||-1!==I.indexOf("Trident/")||-1!==I.indexOf("Edge/"))&&(Qe=!0)}catch{}return Qe}Zone.__load_patch("ZoneAwarePromise",(I,G,z)=>{const U=Object.getOwnPropertyDescriptor,J=Object.defineProperty,tt=z.symbol,_t=[],Tt=!1!==I[tt("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],Mt=tt("Promise"),Vt=tt("then"),Lt="__creationTrace__";z.onUnhandledError=Z=>{if(z.showUncaughtError()){const B=Z&&Z.rejection;B?console.error("Unhandled Promise rejection:",B instanceof Error?B.message:B,"; Zone:",Z.zone.name,"; Task:",Z.task&&Z.task.source,"; Value:",B,B instanceof Error?B.stack:void 0):console.error(Z)}},z.microtaskDrainDone=()=>{for(;_t.length;){const Z=_t.shift();try{Z.zone.runGuarded(()=>{throw Z.throwOriginal?Z.rejection:Z})}catch(B){Ut(B)}}};const ae=tt("unhandledPromiseRejectionHandler");function Ut(Z){z.onUnhandledError(Z);try{const B=G[ae];"function"==typeof B&&B.call(this,Z)}catch{}}function vt(Z){return Z&&Z.then}function ge(Z){return Z}function ce(Z){return X.reject(Z)}const li=tt("state"),xi=tt("value"),oe=tt("finally"),Ot=tt("parentPromiseValue"),Ti=tt("parentPromiseState"),$e="Promise.then",kt=null,be=!0,et=!1,te=0;function lt(Z,B){return Y=>{try{di(Z,B,Y)}catch(xt){di(Z,!1,xt)}}}const jt=function(){let Z=!1;return function(B){return function(){Z||(Z=!0,B.apply(null,arguments))}}},yi="Promise resolved with itself",Gi=tt("currentTaskTrace");function di(Z,B,Y){const xt=jt();if(Z===Y)throw new TypeError(yi);if(Z[li]===kt){let Rt=null;try{("object"==typeof Y||"function"==typeof Y)&&(Rt=Y&&Y.then)}catch(wt){return xt(()=>{di(Z,!1,wt)})(),Z}if(B!==et&&Y instanceof X&&Y.hasOwnProperty(li)&&Y.hasOwnProperty(xi)&&Y[li]!==kt)ni(Y),di(Z,Y[li],Y[xi]);else if(B!==et&&"function"==typeof Rt)try{Rt.call(Y,xt(lt(Z,B)),xt(lt(Z,!1)))}catch(wt){xt(()=>{di(Z,!1,wt)})()}else{Z[li]=B;const wt=Z[xi];if(Z[xi]=Y,Z[oe]===oe&&B===be&&(Z[li]=Z[Ti],Z[xi]=Z[Ot]),B===et&&Y instanceof Error){const St=G.currentTask&&G.currentTask.data&&G.currentTask.data[Lt];St&&J(Y,Gi,{configurable:!0,enumerable:!1,writable:!0,value:St})}for(let St=0;St<wt.length;)qi(Z,wt[St++],wt[St++],wt[St++],wt[St++]);if(0==wt.length&&B==et){Z[li]=te;let St=Y;try{throw new Error("Uncaught (in promise): "+((je=Y)&&je.toString===Object.prototype.toString?(je.constructor&&je.constructor.name||"")+": "+JSON.stringify(je):je?je.toString():Object.prototype.toString.call(je))+(Y&&Y.stack?"\n"+Y.stack:""))}catch(me){St=me}Tt&&(St.throwOriginal=!0),St.rejection=Y,St.promise=Z,St.zone=G.current,St.task=G.currentTask,_t.push(St),z.scheduleMicroTask()}}}var je;return Z}const Hi=tt("rejectionHandledHandler");function ni(Z){if(Z[li]===te){try{const B=G[Hi];B&&"function"==typeof B&&B.call(this,{rejection:Z[xi],promise:Z})}catch{}Z[li]=et;for(let B=0;B<_t.length;B++)Z===_t[B].promise&&_t.splice(B,1)}}function qi(Z,B,Y,xt,Rt){ni(Z);const wt=Z[li],St=wt?"function"==typeof xt?xt:ge:"function"==typeof Rt?Rt:ce;B.scheduleMicroTask($e,()=>{try{const me=Z[xi],je=!!Y&&oe===Y[oe];je&&(Y[Ot]=me,Y[Ti]=wt);const Ge=B.run(St,void 0,je&&St!==ce&&St!==ge?[]:[me]);di(Y,!0,Ge)}catch(me){di(Y,!1,me)}},Y)}const Pi=function(){},pi=I.AggregateError;class X{static toString(){return"function ZoneAwarePromise() { [native code] }"}static resolve(B){return B instanceof X?B:di(new this(null),be,B)}static reject(B){return di(new this(null),et,B)}static withResolvers(){const B={};return B.promise=new X((Y,xt)=>{B.resolve=Y,B.reject=xt}),B}static any(B){if(!B||"function"!=typeof B[Symbol.iterator])return Promise.reject(new pi([],"All promises were rejected"));const Y=[];let xt=0;try{for(let St of B)xt++,Y.push(X.resolve(St))}catch{return Promise.reject(new pi([],"All promises were rejected"))}if(0===xt)return Promise.reject(new pi([],"All promises were rejected"));let Rt=!1;const wt=[];return new X((St,me)=>{for(let je=0;je<Y.length;je++)Y[je].then(Ge=>{Rt||(Rt=!0,St(Ge))},Ge=>{wt.push(Ge),xt--,0===xt&&(Rt=!0,me(new pi(wt,"All promises were rejected")))})})}static race(B){let Y,xt,Rt=new this((me,je)=>{Y=me,xt=je});function wt(me){Y(me)}function St(me){xt(me)}for(let me of B)vt(me)||(me=this.resolve(me)),me.then(wt,St);return Rt}static all(B){return X.allWithCallback(B)}static allSettled(B){return(this&&this.prototype instanceof X?this:X).allWithCallback(B,{thenCallback:Y=>({status:"fulfilled",value:Y}),errorCallback:Y=>({status:"rejected",reason:Y})})}static allWithCallback(B,Y){let xt,Rt,wt=new this((Ge,Dn)=>{xt=Ge,Rt=Dn}),St=2,me=0;const je=[];for(let Ge of B){vt(Ge)||(Ge=this.resolve(Ge));const Dn=me;try{Ge.then(Ji=>{je[Dn]=Y?Y.thenCallback(Ji):Ji,St--,0===St&&xt(je)},Ji=>{Y?(je[Dn]=Y.errorCallback(Ji),St--,0===St&&xt(je)):Rt(Ji)})}catch(Ji){Rt(Ji)}St++,me++}return St-=2,0===St&&xt(je),wt}constructor(B){const Y=this;if(!(Y instanceof X))throw new Error("Must be an instanceof Promise.");Y[li]=kt,Y[xi]=[];try{const xt=jt();B&&B(xt(lt(Y,be)),xt(lt(Y,et)))}catch(xt){di(Y,!1,xt)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return X}then(B,Y){let xt=this.constructor?.[Symbol.species];(!xt||"function"!=typeof xt)&&(xt=this.constructor||X);const Rt=new xt(Pi),wt=G.current;return this[li]==kt?this[xi].push(wt,Rt,B,Y):qi(this,wt,Rt,B,Y),Rt}catch(B){return this.then(null,B)}finally(B){let Y=this.constructor?.[Symbol.species];(!Y||"function"!=typeof Y)&&(Y=X);const xt=new Y(Pi);xt[oe]=oe;const Rt=G.current;return this[li]==kt?this[xi].push(Rt,xt,B,B):qi(this,Rt,xt,B,B),xt}}X.resolve=X.resolve,X.reject=X.reject,X.race=X.race,X.all=X.all;const ht=I[Mt]=I.Promise;I.Promise=X;const E=tt("thenPatched");function O(Z){const B=Z.prototype,Y=U(B,"then");if(Y&&(!1===Y.writable||!Y.configurable))return;const xt=B.then;B[Vt]=xt,Z.prototype.then=function(Rt,wt){return new X((St,me)=>{xt.call(this,St,me)}).then(Rt,wt)},Z[E]=!0}return z.patchThen=O,ht&&(O(ht),Ft(I,"fetch",Z=>function(Y){return function(xt,Rt){let wt=Y.apply(xt,Rt);if(wt instanceof X)return wt;let St=wt.constructor;return St[E]||O(St),wt}}(Z))),Promise[G.__symbol__("uncaughtPromiseErrors")]=_t,X}),Zone.__load_patch("toString",I=>{const G=Function.prototype.toString,z=qt("OriginalDelegate"),U=qt("Promise"),J=qt("Error"),tt=function(){if("function"==typeof this){const Tt=this[z];if(Tt)return"function"==typeof Tt?G.call(Tt):Object.prototype.toString.call(Tt);if(this===Promise){const Mt=I[U];if(Mt)return G.call(Mt)}if(this===Error){const Mt=I[J];if(Mt)return G.call(Mt)}}return G.call(this)};tt[z]=G,Function.prototype.toString=tt;const _t=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":_t.call(this)}});let ar=!1;if(typeof window<"u")try{const I=Object.defineProperty({},"passive",{get:function(){ar=!0}});window.addEventListener("test",I,I),window.removeEventListener("test",I,I)}catch{ar=!1}const Ai={useG:!0},Ki={},xh={},ts=new RegExp("^"+Je+"(\\w+)(true|false)$"),qa=qt("propagationStopped");function Va(I,G){const z=(G?G(I):I)+ue,U=(G?G(I):I)+fe,J=Je+z,tt=Je+U;Ki[I]={},Ki[I][ue]=J,Ki[I][fe]=tt}function xn(I,G,z,U){const J=U&&U.add||$t,tt=U&&U.rm||se,_t=U&&U.listeners||"eventListeners",Tt=U&&U.rmAll||"removeAllListeners",Mt=qt(J),Vt="."+J+":",Lt="prependListener",ae="."+Lt+":",Ut=function(oe,Ot,Ti){if(oe.isRemoved)return;const $e=oe.callback;let kt;"object"==typeof $e&&$e.handleEvent&&(oe.callback=et=>$e.handleEvent(et),oe.originalDelegate=$e);try{oe.invoke(oe,Ot,[Ti])}catch(et){kt=et}const be=oe.options;return be&&"object"==typeof be&&be.once&&Ot[tt].call(Ot,Ti.type,oe.originalDelegate?oe.originalDelegate:oe.callback,be),kt};function vt(oe,Ot,Ti){if(!(Ot=Ot||I.event))return;const $e=oe||Ot.target||I,kt=$e[Ki[Ot.type][Ti?fe:ue]];if(kt){const be=[];if(1===kt.length){const et=Ut(kt[0],$e,Ot);et&&be.push(et)}else{const et=kt.slice();for(let te=0;te<et.length&&(!Ot||!0!==Ot[qa]);te++){const lt=Ut(et[te],$e,Ot);lt&&be.push(lt)}}if(1===be.length)throw be[0];for(let et=0;et<be.length;et++){const te=be[et];G.nativeScheduleMicroTask(()=>{throw te})}}}const ge=function(oe){return vt(this,oe,!1)},ce=function(oe){return vt(this,oe,!0)};function li(oe,Ot){if(!oe)return!1;let Ti=!0;Ot&&void 0!==Ot.useG&&(Ti=Ot.useG);const $e=Ot&&Ot.vh;let kt=!0;Ot&&void 0!==Ot.chkDup&&(kt=Ot.chkDup);let be=!1;Ot&&void 0!==Ot.rt&&(be=Ot.rt);let et=oe;for(;et&&!et.hasOwnProperty(J);)et=ai(et);if(!et&&oe[J]&&(et=oe),!et||et[Mt])return!1;const te=Ot&&Ot.eventNameToString,lt={},jt=et[Mt]=et[J],yi=et[qt(tt)]=et[tt],Gi=et[qt(_t)]=et[_t],di=et[qt(Tt)]=et[Tt];let Hi;Ot&&Ot.prepend&&(Hi=et[qt(Ot.prepend)]=et[Ot.prepend]);const ni=Ti?function(E){if(!lt.isExisting)return jt.call(lt.target,lt.eventName,lt.capture?ce:ge,lt.options)}:function(E){return jt.call(lt.target,lt.eventName,E.invoke,lt.options)},qi=Ti?function(E){if(!E.isRemoved){const O=Ki[E.eventName];let Z;O&&(Z=O[E.capture?fe:ue]);const B=Z&&E.target[Z];if(B)for(let Y=0;Y<B.length;Y++)if(B[Y]===E){B.splice(Y,1),E.isRemoved=!0,0===B.length&&(E.allRemoved=!0,E.target[Z]=null);break}}if(E.allRemoved)return yi.call(E.target,E.eventName,E.capture?ce:ge,E.options)}:function(E){return yi.call(E.target,E.eventName,E.invoke,E.options)},Pi=Ot&&Ot.diff?Ot.diff:function(E,O){const Z=typeof O;return"function"===Z&&E.callback===O||"object"===Z&&E.originalDelegate===O},pi=Zone[qt("UNPATCHED_EVENTS")],X=I[qt("PASSIVE_EVENTS")],ht=function(E,O,Z,B,Y=!1,xt=!1){return function(){const Rt=this||I;let wt=arguments[0];Ot&&Ot.transferEventName&&(wt=Ot.transferEventName(wt));let St=arguments[1];if(!St)return E.apply(this,arguments);if(C&&"uncaughtException"===wt)return E.apply(this,arguments);let me=!1;if("function"!=typeof St){if(!St.handleEvent)return E.apply(this,arguments);me=!0}if($e&&!$e(E,St,Rt,arguments))return;const je=ar&&!!X&&-1!==X.indexOf(wt),Ge=(wn=arguments[2],!ar&&"object"==typeof wn&&wn?!!wn.capture:ar&&je?"boolean"==typeof wn?{capture:wn,passive:!0}:wn?"object"==typeof wn&&!1!==wn.passive?{...wn,passive:!0}:wn:{passive:!0}:wn),Dn=Ge&&"object"==typeof Ge&&Ge.signal&&"object"==typeof Ge.signal?Ge.signal:void 0;var wn;if(Dn?.aborted)return;if(pi)for(let hn=0;hn<pi.length;hn++)if(wt===pi[hn])return je?E.call(Rt,wt,St,Ge):E.apply(this,arguments);const Ji=!!Ge&&("boolean"==typeof Ge||Ge.capture),bh=!(!Ge||"object"!=typeof Ge)&&Ge.once,wh=Zone.current;let Za=Ki[wt];Za||(Va(wt,te),Za=Ki[wt]);const Ba=Za[Ji?fe:ue];let _o,es=Rt[Ba],ln=!1;if(es){if(ln=!0,kt)for(let hn=0;hn<es.length;hn++)if(Pi(es[hn],St))return}else es=Rt[Ba]=[];const Ch=Rt.constructor.name,Mh=xh[Ch];Mh&&(_o=Mh[wt]),_o||(_o=Ch+O+(te?te(wt):wt)),lt.options=Ge,bh&&(lt.options.once=!1),lt.target=Rt,lt.capture=Ji,lt.eventName=wt,lt.isExisting=ln;const is=Ti?Ai:void 0;is&&(is.taskData=lt),Dn&&(lt.options.signal=void 0);const Nn=wh.scheduleEventTask(_o,St,is,Z,B);return Dn&&(lt.options.signal=Dn,E.call(Dn,"abort",()=>{Nn.zone.cancelTask(Nn)},{once:!0})),lt.target=null,is&&(is.taskData=null),bh&&(Ge.once=!0),!ar&&"boolean"==typeof Nn.options||(Nn.options=Ge),Nn.target=Rt,Nn.capture=Ji,Nn.eventName=wt,me&&(Nn.originalDelegate=St),xt?es.unshift(Nn):es.push(Nn),Y?Rt:void 0}};return et[J]=ht(jt,Vt,ni,qi,be),Hi&&(et[Lt]=ht(Hi,ae,function(E){return Hi.call(lt.target,lt.eventName,E.invoke,lt.options)},qi,be,!0)),et[tt]=function(){const E=this||I;let O=arguments[0];Ot&&Ot.transferEventName&&(O=Ot.transferEventName(O));const Z=arguments[2],B=!!Z&&("boolean"==typeof Z||Z.capture),Y=arguments[1];if(!Y)return yi.apply(this,arguments);if($e&&!$e(yi,Y,E,arguments))return;const xt=Ki[O];let Rt;xt&&(Rt=xt[B?fe:ue]);const wt=Rt&&E[Rt];if(wt)for(let St=0;St<wt.length;St++){const me=wt[St];if(Pi(me,Y))return wt.splice(St,1),me.isRemoved=!0,0===wt.length&&(me.allRemoved=!0,E[Rt]=null,"string"==typeof O)&&(E[Je+"ON_PROPERTY"+O]=null),me.zone.cancelTask(me),be?E:void 0}return yi.apply(this,arguments)},et[_t]=function(){const E=this||I;let O=arguments[0];Ot&&Ot.transferEventName&&(O=Ot.transferEventName(O));const Z=[],B=an(E,te?te(O):O);for(let Y=0;Y<B.length;Y++){const xt=B[Y];Z.push(xt.originalDelegate?xt.originalDelegate:xt.callback)}return Z},et[Tt]=function(){const E=this||I;let O=arguments[0];if(O){Ot&&Ot.transferEventName&&(O=Ot.transferEventName(O));const Z=Ki[O];if(Z){const B=E[Z[ue]],Y=E[Z[fe]];if(B){const xt=B.slice();for(let Rt=0;Rt<xt.length;Rt++){const wt=xt[Rt];this[tt].call(this,O,wt.originalDelegate?wt.originalDelegate:wt.callback,wt.options)}}if(Y){const xt=Y.slice();for(let Rt=0;Rt<xt.length;Rt++){const wt=xt[Rt];this[tt].call(this,O,wt.originalDelegate?wt.originalDelegate:wt.callback,wt.options)}}}}else{const Z=Object.keys(E);for(let B=0;B<Z.length;B++){const Y=ts.exec(Z[B]);let xt=Y&&Y[1];xt&&"removeListener"!==xt&&this[Tt].call(this,xt)}this[Tt].call(this,"removeListener")}if(be)return this},ve(et[J],jt),ve(et[tt],yi),di&&ve(et[Tt],di),Gi&&ve(et[_t],Gi),!0}let xi=[];for(let oe=0;oe<z.length;oe++)xi[oe]=li(z[oe],U);return xi}function an(I,G){if(!G){const tt=[];for(let _t in I){const Tt=ts.exec(_t);let Mt=Tt&&Tt[1];if(Mt&&(!G||Mt===G)){const Vt=I[_t];if(Vt)for(let Lt=0;Lt<Vt.length;Lt++)tt.push(Vt[Lt])}}return tt}let z=Ki[G];z||(Va(G),z=Ki[G]);const U=I[z[ue]],J=I[z[fe]];return U?J?U.concat(J):U.slice():J?J.slice():[]}function ld(I,G){const z=I.Event;z&&z.prototype&&G.patchMethod(z.prototype,"stopImmediatePropagation",U=>function(J,tt){J[qa]=!0,U&&U.apply(J,tt)})}function bn(I,G,z,U,J){const tt=Zone.__symbol__(U);if(G[tt])return;const _t=G[tt]=G[U];G[U]=function(Tt,Mt,Vt){return Mt&&Mt.prototype&&J.forEach(function(Lt){const ae=`${z}.${U}::`+Lt,Ut=Mt.prototype;try{if(Ut.hasOwnProperty(Lt)){const vt=I.ObjectGetOwnPropertyDescriptor(Ut,Lt);vt&&vt.value?(vt.value=I.wrapWithCurrentZone(vt.value,ae),I._redefineProperty(Mt.prototype,Lt,vt)):Ut[Lt]&&(Ut[Lt]=I.wrapWithCurrentZone(Ut[Lt],ae))}else Ut[Lt]&&(Ut[Lt]=I.wrapWithCurrentZone(Ut[Lt],ae))}catch{}}),_t.call(G,Tt,Mt,Vt)},I.attachOriginToPatched(G[U],_t)}function ze(I,G,z){if(!z||0===z.length)return G;const U=z.filter(tt=>tt.target===I);if(!U||0===U.length)return G;const J=U[0].ignoreProperties;return G.filter(tt=>-1===J.indexOf(tt))}function ji(I,G,z,U){I&&Pt(I,ze(I,G,z),U)}function mo(I){return Object.getOwnPropertyNames(I).filter(G=>G.startsWith("on")&&G.length>2).map(G=>G.substring(2))}Zone.__load_patch("util",(I,G,z)=>{const U=mo(I);z.patchOnProperties=Pt,z.patchMethod=Ft,z.bindArguments=rt,z.patchMacroTask=ui;const J=G.__symbol__("BLACK_LISTED_EVENTS"),tt=G.__symbol__("UNPATCHED_EVENTS");I[tt]&&(I[J]=I[tt]),I[J]&&(G[J]=G[tt]=I[J]),z.patchEventPrototype=ld,z.patchEventTarget=xn,z.isIEOrEdge=Gs,z.ObjectDefineProperty=vn,z.ObjectGetOwnPropertyDescriptor=Ue,z.ObjectCreate=ie,z.ArraySlice=ot,z.patchClass=zt,z.wrapWithCurrentZone=Ct,z.filterProperties=ze,z.attachOriginToPatched=ve,z._redefineProperty=Object.defineProperty,z.patchCallbacks=bn,z.getGlobalObjects=()=>({globalSources:xh,zoneSymbolEventNames:Ki,eventNames:U,isBrowser:k,isMix:W,isNode:C,TRUE_STR:fe,FALSE_STR:ue,ZONE_SYMBOL_PREFIX:Je,ADD_EVENT_LISTENER_STR:$t,REMOVE_EVENT_LISTENER_STR:se})});const yo=qt("zoneTask");function Er(I,G,z,U){let J=null,tt=null;z+=U;const _t={};function Tt(Vt){const Lt=Vt.data;return Lt.args[0]=function(){return Vt.invoke.apply(this,arguments)},Lt.handleId=J.apply(I,Lt.args),Vt}function Mt(Vt){return tt.call(I,Vt.data.handleId)}J=Ft(I,G+=U,Vt=>function(Lt,ae){if("function"==typeof ae[0]){const Ut={isPeriodic:"Interval"===U,delay:"Timeout"===U||"Interval"===U?ae[1]||0:void 0,args:ae},vt=ae[0];ae[0]=function(){try{return vt.apply(this,arguments)}finally{Ut.isPeriodic||("number"==typeof Ut.handleId?delete _t[Ut.handleId]:Ut.handleId&&(Ut.handleId[yo]=null))}};const ge=Xe(G,ae[0],Ut,Tt,Mt);if(!ge)return ge;const ce=ge.data.handleId;return"number"==typeof ce?_t[ce]=ge:ce&&(ce[yo]=ge),ce&&ce.ref&&ce.unref&&"function"==typeof ce.ref&&"function"==typeof ce.unref&&(ge.ref=ce.ref.bind(ce),ge.unref=ce.unref.bind(ce)),"number"==typeof ce||ce?ce:ge}return Vt.apply(I,ae)}),tt=Ft(I,z,Vt=>function(Lt,ae){const Ut=ae[0];let vt;"number"==typeof Ut?vt=_t[Ut]:(vt=Ut&&Ut[yo],vt||(vt=Ut)),vt&&"string"==typeof vt.type?"notScheduled"!==vt.state&&(vt.cancelFn&&vt.data.isPeriodic||0===vt.runCount)&&("number"==typeof Ut?delete _t[Ut]:Ut&&(Ut[yo]=null),vt.zone.cancelTask(vt)):Vt.apply(I,ae)})}Zone.__load_patch("legacy",I=>{const G=I[Zone.__symbol__("legacyPatch")];G&&G()}),Zone.__load_patch("timers",I=>{const G="set",z="clear";Er(I,G,z,"Timeout"),Er(I,G,z,"Interval"),Er(I,G,z,"Immediate")}),Zone.__load_patch("requestAnimationFrame",I=>{Er(I,"request","cancel","AnimationFrame"),Er(I,"mozRequest","mozCancel","AnimationFrame"),Er(I,"webkitRequest","webkitCancel","AnimationFrame")}),Zone.__load_patch("blocking",(I,G)=>{const z=["alert","prompt","confirm"];for(let U=0;U<z.length;U++)Ft(I,z[U],(J,tt,_t)=>function(Tt,Mt){return G.current.run(J,I,Mt,_t)})}),Zone.__load_patch("EventTarget",(I,G,z)=>{var _t;(_t=z).patchEventPrototype(I,_t),function(tt,_t){if(Zone[_t.symbol("patchEventTarget")])return;const{eventNames:Tt,zoneSymbolEventNames:Mt,TRUE_STR:Vt,FALSE_STR:Lt,ZONE_SYMBOL_PREFIX:ae}=_t.getGlobalObjects();for(let vt=0;vt<Tt.length;vt++){const ge=Tt[vt],ce=ae+(ge+Lt),li=ae+(ge+Vt);Mt[ge]={},Mt[ge][Lt]=ce,Mt[ge][Vt]=li}const Ut=tt.EventTarget;Ut&&Ut.prototype&&_t.patchEventTarget(tt,_t,[Ut&&Ut.prototype])}(I,z);const U=I.XMLHttpRequestEventTarget;U&&U.prototype&&z.patchEventTarget(I,z,[U.prototype])}),Zone.__load_patch("MutationObserver",(I,G,z)=>{zt("MutationObserver"),zt("WebKitMutationObserver")}),Zone.__load_patch("IntersectionObserver",(I,G,z)=>{zt("IntersectionObserver")}),Zone.__load_patch("FileReader",(I,G,z)=>{zt("FileReader")}),Zone.__load_patch("on_property",(I,G,z)=>{!function(J,tt){if(C&&!W||Zone[J.symbol("patchEvents")])return;const _t=tt.__Zone_ignore_on_properties;let Tt=[];if(k){const Mt=window;Tt=Tt.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);const Vt=function(){try{const ae=ke.navigator.userAgent;if(-1!==ae.indexOf("MSIE ")||-1!==ae.indexOf("Trident/"))return!0}catch{}return!1}()?[{target:Mt,ignoreProperties:["error"]}]:[];ji(Mt,mo(Mt),_t&&_t.concat(Vt),ai(Mt))}Tt=Tt.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(let Mt=0;Mt<Tt.length;Mt++){const Vt=tt[Tt[Mt]];Vt&&Vt.prototype&&ji(Vt.prototype,mo(Vt.prototype),_t)}}(z,I)}),Zone.__load_patch("customElements",(I,G,z)=>{!function(J,tt){const{isBrowser:_t,isMix:Tt}=tt.getGlobalObjects();(_t||Tt)&&J.customElements&&"customElements"in J&&tt.patchCallbacks(tt,J.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(I,z)}),Zone.__load_patch("XHR",(I,G)=>{!function(Vt){const Lt=Vt.XMLHttpRequest;if(!Lt)return;const ae=Lt.prototype;let Ut=ae[Kt],vt=ae[Dt];if(!Ut){const et=Vt.XMLHttpRequestEventTarget;if(et){const te=et.prototype;Ut=te[Kt],vt=te[Dt]}}const ge="readystatechange",ce="scheduled";function li(et){const te=et.data,lt=te.target;lt[tt]=!1,lt[Tt]=!1;const jt=lt[J];Ut||(Ut=lt[Kt],vt=lt[Dt]),jt&&vt.call(lt,ge,jt);const yi=lt[J]=()=>{if(lt.readyState===lt.DONE)if(!te.aborted&&lt[tt]&&et.state===ce){const Gi=lt[G.__symbol__("loadfalse")];if(0!==lt.status&&Gi&&Gi.length>0){const di=et.invoke;et.invoke=function(){const Hi=lt[G.__symbol__("loadfalse")];for(let ni=0;ni<Hi.length;ni++)Hi[ni]===et&&Hi.splice(ni,1);!te.aborted&&et.state===ce&&di.call(et)},Gi.push(et)}else et.invoke()}else!te.aborted&&!1===lt[tt]&&(lt[Tt]=!0)};return Ut.call(lt,ge,yi),lt[z]||(lt[z]=et),kt.apply(lt,te.args),lt[tt]=!0,et}function xi(){}function oe(et){const te=et.data;return te.aborted=!0,be.apply(te.target,te.args)}const Ot=Ft(ae,"open",()=>function(et,te){return et[U]=0==te[2],et[_t]=te[1],Ot.apply(et,te)}),Ti=qt("fetchTaskAborting"),$e=qt("fetchTaskScheduling"),kt=Ft(ae,"send",()=>function(et,te){if(!0===G.current[$e]||et[U])return kt.apply(et,te);{const lt={target:et,url:et[_t],isPeriodic:!1,args:te,aborted:!1},jt=Xe("XMLHttpRequest.send",xi,lt,li,oe);et&&!0===et[Tt]&&!lt.aborted&&jt.state===ce&&jt.invoke()}}),be=Ft(ae,"abort",()=>function(et,te){const lt=et[z];if(lt&&"string"==typeof lt.type){if(null==lt.cancelFn||lt.data&&lt.data.aborted)return;lt.zone.cancelTask(lt)}else if(!0===G.current[Ti])return be.apply(et,te)})}(I);const z=qt("xhrTask"),U=qt("xhrSync"),J=qt("xhrListener"),tt=qt("xhrScheduled"),_t=qt("xhrURL"),Tt=qt("xhrErrorBeforeScheduled")}),Zone.__load_patch("geolocation",I=>{I.navigator&&I.navigator.geolocation&&function(z,U){const J=z.constructor.name;for(let tt=0;tt<U.length;tt++){const _t=U[tt],Tt=z[_t];if(Tt){if(!gt(Ue(z,_t)))continue;z[_t]=(Mt=>{const Vt=function(){return Mt.apply(this,rt(arguments,J+"."+_t))};return ve(Vt,Mt),Vt})(Tt)}}}(I.navigator.geolocation,["getCurrentPosition","watchPosition"])}),Zone.__load_patch("PromiseRejectionEvent",(I,G)=>{function z(U){return function(J){an(I,U).forEach(tt=>{const _t=I.PromiseRejectionEvent;if(_t){const Tt=new _t(U,{promise:J.promise,reason:J.rejection});tt.invoke(Tt)}})}}I.PromiseRejectionEvent&&(G[qt("unhandledPromiseRejectionHandler")]=z("unhandledrejection"),G[qt("rejectionHandledHandler")]=z("rejectionhandled"))}),Zone.__load_patch("queueMicrotask",(I,G,z)=>{z.patchMethod(I,"queueMicrotask",_t=>function(Tt,Mt){Zone.current.scheduleMicroTask("queueMicrotask",Mt[0])})})}},Ue=>{Ue(Ue.s=935)}]);